/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{b as k,c as R,d as E,s as j,f as L}from"./share-Bj4d4icF.js";import{s as M,M as f,B as K,q as P,L as A,N as B,O as Q,F as W,T as O,Q as Y,V as z,d as G,e as H,a9 as J,a8 as X,a5 as Z}from"./index-fDEUsWmJ.js";import{d as C,q as ee,h as I,b as p,c as h,e as te,C as T,k as n,j as l,i as D,B as $,$ as t,r as q,Y as U,y as oe,ab as S,F as ne}from"./vue-office_docx-BTzFQIdC.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{t as ae}from"./useFolderLevelTree-CDJ_26ol.js";import"./useBreadcrumb-DKPyaTjD.js";import"./index-DeLZq7_u.js";const le={class:"min-h-14 flex items-center justify-center"},se={key:0},de={key:1,class:"w-64 flex justify-evenly"},ie={key:3},re=C({__name:"table-cell",props:{column:{},record:{},rowIndex:{}},emits:["updateConfig","updateFile"],setup(r,{emit:_}){const w=_,{shareId:o,config:v,selectedIds:b}=M(k()),{updateData:d}=k(),y=()=>{o.value=r.record.id,v.value.pwd=r.record.pwd,v.value.noDdl=r.record.expire.startsWith("9999"),w("updateConfig")},s=()=>{o.value=r.record.id,b.value=r.record.fileIds,w("updateFile")},e=async()=>{try{const a=await R(r.record.id);a.code===200?(f.success("删除成功"),await d()):f.error(a.message)}catch{f.error("删除失败")}},x=ee(()=>location.protocol+"//"+location.host+"/share/"+r.record.id+(r.record.pwd?`?pwd=${r.record.pwd}`:""));return(a,m)=>{const g=I("icon-file"),i=K,u=I("icon-settings"),F=I("icon-delete"),V=P,N=A;return p(),h("td",null,[te("div",le,[a.column.dataIndex==="index"?(p(),h("div",se,T(a.rowIndex+1),1)):a.column.dataIndex==="operation"?(p(),h("div",de,[n(i,{type:"primary",status:"success",onClick:m[0]||(m[0]=c=>s())},{icon:l(()=>[n(g)]),_:1}),n(i,{onClick:m[1]||(m[1]=c=>y()),type:"primary"},{icon:l(()=>[n(u)]),_:1}),n(V,{type:"warning",position:"lt",content:"确定要删除该分享吗？",onOk:e},{default:l(()=>[n(i,{type:"primary",status:"danger"},{icon:l(()=>[n(F)]),_:1})]),_:1})])):a.column.dataIndex==="link"?(p(),D(N,{key:2,href:t(x),target:"'_blank'"},{default:l(()=>[$(T(t(x)),1)]),_:1},8,["href"])):(p(),h("div",ie,T(a.record[a.column.dataIndex]),1))])])}}}),ce=C({__name:"config-modal",setup(r,{expose:_}){const{shareId:w,config:o,formattedConfig:v}=M(k()),{updateData:b}=k(),d=q(!1),y=async()=>{try{const s=await E({id:w.value,...v.value});s.code===200?(f.success("修改成功"),await b()):f.error(s.message)}catch{f.error("修改失败")}};return _({open(){d.value=!0}}),(s,e)=>{const x=Q,a=W,m=I("icon-info-circle"),g=O,i=Y,u=z,F=G,V=H,N=B;return p(),D(N,{visible:t(d),"onUpdate:visible":e[4]||(e[4]=c=>U(d)?d.value=c:null),title:"修改分享设置",onOk:y,width:480},{default:l(()=>[n(V,{model:t(o),"auto-label-width":""},{default:l(()=>[n(a,{label:"永久有效"},{default:l(()=>[n(x,{"model-value":t(o).noDdl,"onUpdate:modelValue":e[0]||(e[0]=c=>t(o).noDdl=c)},null,8,["model-value"])]),_:1}),n(a,{disabled:t(o).noDdl},{label:l(()=>[e[5]||(e[5]=$(" 有效期 ")),n(g,{content:"从当前时间算起"},{default:l(()=>[n(m)]),_:1})]),default:l(()=>[n(i,{min:1,max:100,modelValue:t(o).value,"onUpdate:modelValue":e[1]||(e[1]=c=>t(o).value=c)},null,8,["modelValue"])]),_:1},8,["disabled"]),n(a,{label:"单位",disabled:t(o).noDdl},{default:l(()=>[n(u,{"model-value":t(o).expire,"onUpdate:modelValue":e[2]||(e[2]=c=>t(o).expire=c),options:t(j)},null,8,["model-value","options"])]),_:1},8,["disabled"]),n(a,{label:"提取码"},{default:l(()=>[n(F,{modelValue:t(o).pwd,"onUpdate:modelValue":e[3]||(e[3]=c=>t(o).pwd=c),modelModifiers:{trim:!0},placeholder:"不设置表示公开",allowClear:"","max-length":12},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])}}}),me=C({__name:"file-modal",setup(r,{expose:_}){const{shareId:w,selectedIds:o,treeDataAllowFile:v}=M(k()),{updateData:b}=k(),d=q(!1),y=async()=>{try{const s=await L(o.value,w.value);s.code===200?(f.success("修改成功"),await b()):f.error(s.message)}catch{f.error("修改失败")}};return _({open(){d.value=!0}}),(s,e)=>{const x=I("icon-info-circle"),a=O,m=J,g=B;return p(),D(g,{visible:t(d),"onUpdate:visible":e[2]||(e[2]=i=>U(d)?d.value=i:null),onOk:y,width:480},{title:l(()=>[e[3]||(e[3]=$(" 修改分享文件  ")),n(a,{content:"文件夹和文件可分别添加"},{default:l(()=>[n(x)]),_:1})]),default:l(()=>[n(m,{data:t(v),fieldNames:t(ae),"checked-keys":t(o),"onUpdate:checkedKeys":e[0]||(e[0]=i=>U(o)?o.value=i:null),"selected-keys":t(o),"onUpdate:selectedKeys":e[1]||(e[1]=i=>U(o)?o.value=i:null),checkable:"",multiple:"","check-strictly":""},null,8,["data","fieldNames","checked-keys","selected-keys"])]),_:1},8,["visible"])}}}),Me=C({__name:"index",setup(r){const{shareData:_}=M(k()),{updateData:w,updateTreeLayerData:o}=k();oe(()=>{w(),o()});const v=[{title:"序号",dataIndex:"index",width:60},{title:"创建时间",dataIndex:"createTime",width:180},{title:"过期时间",dataIndex:"expire",width:180},{title:"链接",dataIndex:"link",width:300},{title:"提取码",dataIndex:"pwd",width:120},{title:"文件/文件夹数量",dataIndex:"itemNum",width:180},{title:"访问量",dataIndex:"visitNum",width:100},{title:"操作",dataIndex:"operation",width:180,fixed:"right"}].map(y=>({...y,align:"center"})),b=S("configModal"),d=S("fileModal");return(y,s)=>{const e=X,x=Z;return p(),h(ne,null,[t(_).length?(p(),D(e,{key:0,columns:t(v),class:"m-3 mt-10",scroll:{x:700},data:t(_),hoverable:"",pagination:!1},{td:l(({column:a,record:m,rowIndex:g})=>[n(re,{column:a,record:m,rowIndex:g,onUpdateConfig:s[0]||(s[0]=i=>{var u;return(u=t(b))==null?void 0:u.open()}),onUpdateFile:s[1]||(s[1]=i=>{var u;return(u=t(d))==null?void 0:u.open()})},null,8,["column","record","rowIndex"])]),_:1},8,["columns","data"])):(p(),D(x,{key:1,class:"mt-24"})),n(ce,{ref:"configModal"},null,512),n(me,{ref:"fileModal"},null,512)],64)}}});export{Me as default};
