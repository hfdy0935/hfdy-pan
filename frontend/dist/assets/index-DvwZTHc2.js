const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/list-layout-DS-dM8dt.js","assets/calc-CYjR0slx.js","assets/blank.vue_vue_type_script_setup_true_lang-I__VKkcy.js","assets/menuData-BfYzelEX.js","assets/useFolderLevelTree-BY3VF7JM.js","assets/index-DeLZq7_u.js","assets/index-CdIjDISF.js","assets/arco-design-vue-wpZPvk8Z.js","assets/arco-design-vue-icon-S64ufJhU.js","assets/index-wkWtydi5.css","assets/useBreadcrumb-DDMjDaLE.js","assets/file-CTjv8ooS.js","assets/file-BMhh5CmS.css","assets/menuData-CqodbKbt.css","assets/index.vue_vue_type_script_setup_true_lang-MDeg8KDO.js","assets/index-CNHuOydc.css","assets/index-CsrA5E6V.css","assets/index-l1mJVvo3.css","assets/index-kGALwHyS.css","assets/index-C7_jW4Bp.css","assets/share-BzanW0kV.js","assets/useEditFileName-BxV89-wi.js","assets/blank-BAa5mAtl.css","assets/index-DsthlvPJ.css","assets/index-BZfi0XrG.css","assets/index-DB1be4Pu.css","assets/index-CFpRJApZ.css","assets/index-B-ljjXbb.css","assets/index-DyocfVfh.css","assets/index-C_dZZQ43.css","assets/index-CB8NxrOK.css","assets/index-CCG0prJs.css","assets/index-D20gUdT1.css","assets/block-layout-DiLjy7wS.js","assets/tree-layout-DWw7LHbA.js","assets/index-C0js0civ.css"])))=>i.map(i=>d[i]);
import{s as f,o as ae,h as P}from"./index-CdIjDISF.js";/* empty css              */import{u as oe,_ as le}from"./index.vue_vue_type_script_setup_true_lang-MDeg8KDO.js";import{i as se,j as Y,u as G,d as ne,T as Z,k as re}from"./useFolderLevelTree-BY3VF7JM.js";/* empty css              *//* empty css              */import{u as z,a as E,b as O,c as ie,e as ue,m as de,f as H}from"./menuData-BfYzelEX.js";import{d as N,c as R,aQ as ce,o as h,a as V,ap as e,ao as s,am as D,bl as me,aG as a,aX as _,aE as B,bm as pe,a_ as A,bn as _e,e as C,av as Q,b1 as fe,bo as ve,be as q,bg as ee,bp as be,an as k,aY as S,bq as j,aq as K,bb as te,aZ as ye,ba as he,b3 as we,b2 as Fe,b0 as ge,b4 as xe,br as Ce,aS as ke,bs as Se,bt as Ie,aT as Te,aU as $e,b9 as Ee,ai as J,bu as Ve,b as Be,bv as M,bw as De}from"./arco-design-vue-wpZPvk8Z.js";/* empty css              *//* empty css              */import{i as W}from"./file-CTjv8ooS.js";import{c as Ne}from"./calc-CYjR0slx.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{u as Le,a as Ue,s as Ae,r as ze,e as Re}from"./share-BzanW0kV.js";import"./arco-design-vue-icon-S64ufJhU.js";import"./index-DeLZq7_u.js";import"./useBreadcrumb-DDMjDaLE.js";const Pe={class:"flex justify-between items-start"},Me=N({__name:"file-operation",setup(L){const{baseQuery:d,isTree:o,currParentFolder:c,isMaxFolderLevel:r}=f(z()),{itemList:w}=f(E()),{prepareCreateFolder:v}=E(),{prepareCreateFolder:m}=O(),{uploadFileList:t}=f(ie()),u=R(()=>w.value.records.map(n=>n.name)),b=ce("inputFile"),p=(n,l)=>{if(u.value.includes(l.name??"")){B.warning("同一个目录下的文件、文件夹名不能重复");return}t.value.push({md5:"",fileItem:l,totalChunks:1,uploadedChunkIndexs:[],index:t.value.length,status:"parse",pid:c.value.id,level:c.value.level})};return(n,l)=>{const i=D("icon-upload"),F=pe,x=A,I=D("icon-folder"),T=me,g=_e;return h(),V("div",Pe,[e(T,{wrap:"",size:"medium"},{default:s(()=>[e(x,{onClick:l[0]||(l[0]=$=>{var U;return(U=a(b))==null?void 0:U.$el.click()}),type:"primary",disabled:a(r)},{icon:s(()=>[e(i,{"stroke-width":6,size:16})]),default:s(()=>[l[3]||(l[3]=_(" 上传 ")),e(F,{onChange:p,multiple:"",ref:"inputFile",style:{display:"none"},"auto-upload":!1,"show-file-list":!1},null,512)]),_:1},8,["disabled"]),e(x,{type:"primary",onClick:l[1]||(l[1]=$=>a(o)?a(m)():a(v)()),status:"success",disabled:a(r)},{icon:s(()=>[e(I,{"stroke-width":6,size:16})]),default:s(()=>[l[4]||(l[4]=_("新建 "))]),_:1},8,["disabled"])]),_:1}),e(T,{size:"medium"},{default:s(()=>[e(g,{modelValue:a(d).keyword,"onUpdate:modelValue":l[2]||(l[2]=$=>a(d).keyword=$),modelModifiers:{trim:!0},placeholder:"输入文件 / 文件夹名","allow-clear":""},null,8,["modelValue"])]),_:1})])}}}),Oe={class:"h-6 flex justify-start items-center"},qe={class:"hover:text-h-blue cursor-pointer"},je=N({__name:"file-breadcrumb",setup(L){const{breadcrumbs:d,isTree:o}=f(z()),{switchTo:c}=z(),{treeSelectedIds:r,treeData:w}=f(O()),{itemList:v,query:m,selectedIds:t}=f(E()),{selectedIds:u}=f(O()),{file:b}=f(oe()),p=async l=>{if(o.value){r.value=[l];const i=se(w.value,l);i?c(i):d.value.splice(1),b.value=null}else{if(v.value.parent.id===l)return;m.value={...m.value,page:1,pid:l},t.value=[]}},n=R({get(){return o.value?w.value.length!==0&&u.value.length===Y(w.value).length:v.value.records.length!==0&&v.value.records.every(l=>t.value.includes(l.id))},set(l){l?o.value?u.value=Y(w.value):t.value=v.value.records.map(i=>i.id):t.value=u.value=[]}});return(l,i)=>{const F=fe,x=D("icon-home"),I=be,T=ve;return h(),V("div",Oe,[C("label",null,[i[2]||(i[2]=_("全选 ")),e(F,{"model-value":a(n),"onUpdate:modelValue":i[0]||(i[0]=g=>Q(n)?n.value=g:null)},null,8,["model-value"])]),i[3]||(i[3]=_("  ")),e(T,{separator:"/",class:"select-none flex flex-wrap translate-y-[2px]"},{default:s(()=>[e(I,{onClick:i[1]||(i[1]=g=>p(a(d)[0].id))},{default:s(()=>[e(x,{size:18,class:"hover:!text-h-blue cursor-pointer"})]),_:1}),(h(!0),V(q,null,ee(a(d).slice(1),g=>(h(),k(I,{key:g.id,onClick:$=>p(g.id)},{default:s(()=>[C("div",qe,S(g.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})])}}}),Ge={class:"flex"},Qe={class:"w-32"},Ke=N({__name:"file-detail-modal",setup(L){const{contextmenuType:d}=f(E()),{detail:o,isDetailModalShow:c}=f(ue()),r=G(),w=R(()=>de[0].children.find(t=>t.path.includes(o.value.category??"")).name),v=["无需转码","转码中","转码成功","转码失败"],m=R(()=>{var t;return[[`文件${d.value==="folder"?"夹":""}名`,o.value.name,!0],["所属用户",o.value.username,!0],["分类",w,!0],["文件类型",o.value.mediaType,!0],["状态",v[o.value.status??0],o.value.category==="video"],["歌词",(t=o.value.lyricPath)!=null&&t.length?"已上传":"未上传",o.value.category==="audio"],["创建时间",o.value.createTime,!0],["更新时间",o.value.updateTime,!0],["删除时间",o.value.deleteTime,!0],["大小",o.value.size?Ne(o.value.size):"",o.value.mediaType!=="folder"],["子项数量",o.value.childNum,o.value.mediaType==="folder"]]});return(t,u)=>{const b=he,p=te,n=j;return h(),k(n,{visible:a(c),"onUpdate:visible":u[0]||(u[0]=l=>Q(c)?c.value=l:null),"unmount-on-close":"",closable:!1,simple:"","hide-cancel":"",width:480},{title:s(()=>[_(S(`文件${a(d)==="folder"?"夹":""}详情`)+" ",1),(h(),k(K(a(r).FileIcons[a(o).mediaType??"folder"]),{class:"scale-150 ml-3"}))]),default:s(()=>[e(p,null,{default:s(()=>[(h(!0),V(q,null,ee(a(m),([l,i,F],x)=>(h(),V(q,{key:x},[F?(h(),k(b,{key:0},{default:s(()=>[C("div",Ge,[C("div",Qe,S(l)+"：",1),C("div",null,S(i),1)])]),_:2},1024)):ye("",!0)],64))),128))]),_:1})]),_:1},8,["visible"])}}}),Xe={class:"flex justify-end mt-6"},Ye=N({__name:"file-share-modal",setup(L){const{show:d,sharedFiles:o}=f(Le()),c=G(),{config:r,formattedConfig:w}=Ue(),v=async()=>{if(o.value.length===0){B.warning("请选择要分享的文件");return}try{const m=await ze({ids:o.value.map(t=>t.id),...w.value});if(m.code===200){const t=location.protocol+"//"+location.host+"/share/"+m.data.shareId+(m.data.pwd?`?pwd=${m.data.pwd}`:""),u=Re[r.value.expire].title;j.info({title:"分享成功",content:()=>e(we,{bodyStyle:{padding:0}},{default:()=>[e("div",{class:"text-wrap"},[_("  我用hfdy云盘分享了一些文件，有效期"),r.value.value,u,_("，快来通过"),e(Fe,{style:{"word-break":"break-all","white-space":"normal"},href:t,target:"_blank"},{default:()=>[t],icon:()=>e(D("icon-share-internal"),null,null)}),_("查看吧~")]),e("div",{class:"flex justify-center my-6"},[e(A,{type:"primary",status:"success",onClick:()=>{H(`我用hfdy云盘分享了一些文件，有效期${r.value.value}${u}，快来通过${t}查看吧~
                            `)}},{default:()=>[_("复制")]}),e(A,{class:"ml-4",type:"primary",onClick:()=>{H(t)}},{default:()=>[_("仅复制链接")]})])]}),footer:!1}),B.success("分享成功")}else B.error(m.message)}catch{B.error("分享失败")}};return(m,t)=>{const u=ge,b=D("icon-close"),p=A,n=xe,l=te,i=Ce,F=ke,x=Se,I=Ie,T=Te,g=$e,$=Ee,U=j;return h(),k(U,{visible:a(d),"onUpdate:visible":t[4]||(t[4]=y=>Q(d)?d.value=y:null),title:"文件分享",footer:!1,"unmount-on-close":"",width:480},{default:s(()=>[_(" 共 "+S(a(o).length)+" 项 ",1),e(l,{data:a(o),class:"mb-5",scrollbar:"","max-height":400},{item:s(({item:y,index:X})=>[e(n,{class:"h-5 m-5"},{default:s(()=>[e(u,{span:2},{default:s(()=>[_(S(X+1),1)]),_:2},1024),e(u,{span:2},{default:s(()=>[(h(),k(K(y.mediaType==="folder"?a(c).FileIcons.folder:a(ne)(y.name)),{class:"scale-150"}))]),_:2},1024),e(u,{span:19,class:"truncate"},{default:s(()=>[_(S(y.name),1)]),_:2},1024),e(u,{span:1},{default:s(()=>[e(p,{type:"text",shape:"circle",onClick:Je=>a(o).splice(X,1)},{default:s(()=>[e(b)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["data"]),e(g,{model:a(r),"auto-label-width":""},{default:s(()=>[e(F,{label:"永久有效"},{default:s(()=>[e(i,{"model-value":a(r).noDdl,"onUpdate:modelValue":t[0]||(t[0]=y=>a(r).noDdl=y)},null,8,["model-value"])]),_:1}),e(F,{label:"有效期",disabled:a(r).noDdl},{default:s(()=>[e(x,{min:1,max:100,modelValue:a(r).value,"onUpdate:modelValue":t[1]||(t[1]=y=>a(r).value=y)},null,8,["modelValue"])]),_:1},8,["disabled"]),e(F,{label:"单位",disabled:a(r).noDdl},{default:s(()=>[e(I,{"model-value":a(r).expire,"onUpdate:modelValue":t[2]||(t[2]=y=>a(r).expire=y),options:a(Ae)},null,8,["model-value","options"])]),_:1},8,["disabled"]),e(F,{label:"提取码"},{default:s(()=>[e(T,{modelValue:a(r).pwd,"onUpdate:modelValue":t[3]||(t[3]=y=>a(r).pwd=y),modelModifiers:{trim:!0},placeholder:"不设置表示公开",allowClear:"","max-length":12},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),C("div",Xe,[e($,{content:"确认要分享的文件及信息",onOk:v},{default:s(()=>[e(p,{type:"primary",disabled:a(o).length===0},{default:s(()=>t[5]||(t[5]=[_("分享")])),_:1},8,["disabled"])]),_:1})])]),_:1},8,["visible"])}}}),Ze={class:"pt-3 pr-3"},He={class:"h-[90%] overflow-auto"},Ft=N({__name:"index",setup(L){const{textColor:d,bgColor:o}=f(G()),{itemList:c,query:r}=f(E()),{updateFileItem:w}=E(),{layoutType:v,isTree:m}=f(z());J(v,async(b,p)=>{p==="tree"&&await w()}),ae(b=>{r.value.page=1});let t=-1;J(c,()=>{clearInterval(t),!m.value&&(t=setInterval(async()=>{const b=c.value.records.filter(n=>W(n)&&n.status===Z.ING);if(b.length===0){clearInterval(t);return}const p=await re(b.map(n=>n.id));p.code===200&&(c.value.records.forEach(n=>{const l=p.data.find(i=>i.id===n.id);l&&(n.status=l.status)}),c.value.records.filter(n=>W(n)).every(n=>n.status===Z.OK)&&clearInterval(t))},1e4))},{immediate:!0}),Ve(()=>{clearInterval(t)});const u={list:M(()=>P(()=>import("./list-layout-DS-dM8dt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]))),block:M(()=>P(()=>import("./block-layout-DiLjy7wS.js"),__vite__mapDeps([33,3,4,5,6,7,8,9,1,10,11,12,13,2,14,15,16,17,18,19,20,21,22,23,26,27,28,29,30,31,32]))),tree:M(()=>P(()=>import("./tree-layout-DWw7LHbA.js"),__vite__mapDeps([34,4,5,6,7,8,9,3,1,10,11,12,13,14,15,16,17,18,19,21,20,35,23,26,27,28,29,30,31,32])))};return(b,p)=>{const n=De;return h(),V("section",{class:"h-full pl-2 flex flex-col",style:Be({color:a(d),backgroundColor:a(o)})},[C("div",Ze,[e(Me),e(je),e(n)]),C("main",He,[(h(),k(K(u[a(v)])))]),e(le),e(Ke),e(Ye)],4)}}});export{Ft as default};
