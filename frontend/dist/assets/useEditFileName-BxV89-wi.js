import{C as w}from"./useFolderLevelTree-BY3VF7JM.js";import{a as v}from"./file-CTjv8ooS.js";import{u as F,a as T,b as B}from"./menuData-BfYzelEX.js";import{s as u}from"./index-CdIjDISF.js";import{ag as N,aE as k}from"./arco-design-vue-wpZPvk8Z.js";function D({fileOrNode:s}){const l=s.name,t=N(l),{editNameOp:r}=u(F()),{itemList:p}=u(T()),{filteredTreeData:m}=u(B()),{finishCreateFolder:c,finishRename:g}=F(),E=()=>{t.value=l},h=(n,i,e)=>new Promise((a,o)=>{var f,d;t.value.trim()===l&&r.value=="change"&&o(),t.value.trim()||((f=e==null?void 0:e.fail)==null||f.call(e),r.value==="create"&&m.value.shift(),o(`文件${v(s)?"夹":""}名不能为空`)),/[\/\\]/.test(t.value)&&((d=e==null?void 0:e.fail)==null||d.call(e),r.value==="create"&&m.value.shift(),o(`文件${v(s)?"夹":""}名不能包含'/'和'\\'`)),n.filter(I=>I===t.value).length>1&&o("同一文件夹下的文件和文件夹不能重名"),a(t.value)}).then(async a=>{switch(r.value){case"create":return await c({name:a,pid:i,...e});case"change":await g({name:a,id:i,...e});return}}).catch(a=>{a&&k.warning(a)});return{name:t,resetName:E,handleFinishEidtInTree:(n,i)=>{const e=w(m.value,null,s.id);h((e==null?void 0:e.children.map(a=>a.name))??[],n,i)},handleFinishEidtInListBlock:(n,i)=>{h(p.value.records.map(e=>e.name),n,i)}}}export{D as u};
