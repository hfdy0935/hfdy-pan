/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{o as k,M as U,B as N,q as T,a8 as F,N as q,a5 as O,am as $,an as K,F as j,Q as R,e as z}from"./index-fDEUsWmJ.js";/* empty css              */import{c as A}from"./calc-CYjR0slx.js";import{d as C,h as g,b as i,c as r,C as c,$ as d,A as G,k as o,j as a,r as B,y as J,m as P,Y as Q,B as f}from"./vue-office_docx-BTzFQIdC.js";function Y(){return k({url:"/admin/users",method:"GET"})}function H(m){return k({url:"/admin/users",method:"DELETE",params:{id:m}})}function W(m){return k({url:"/admin/users",method:"PUT",data:m})}const X={key:0,class:"h-14 flex justify-center items-center"},Z={key:1,class:"w-24 text-center"},h={key:3,class:"w-24 text-center"},ee={key:4,class:"w-28 text-center"},te={key:5,class:"flex w-24 justify-evenly items-center"},oe={key:6,class:"w-48 text-center truncate"},ne=C({__name:"table-cell",props:{column:{},record:{},rowIndex:{}},emits:["deleteUser","openModal"],setup(m,{emit:u}){const y=u,I=async()=>{(await H(m.record.id)).code===200&&(U.success("删除成功"),y("deleteUser",m.rowIndex))};return(n,t)=>{const b=g("icon-edit"),x=N,s=g("icon-delete"),e=T;return i(),r("td",null,[n.column.dataIndex==="index"?(i(),r("div",X,c(n.rowIndex+1),1)):n.column.dataIndex==="downloadSpeed"?(i(),r("div",Z,c(d(A)(n.record.downloadSpeed))+"/s ",1)):n.column.dataIndex==="status"?(i(),r("div",{key:2,class:G(["w-24 text-center font-bold",`${n.record.status?"text-[#23C343]":"text-[red]"}`])},c(n.record.status?"正常":"封禁"),3)):n.column.dataIndex==="isVip"?(i(),r("div",h,c(n.record.isVip?"vip用户":"普通用户"),1)):n.column.dataIndex==="usedSpace"?(i(),r("div",ee,c((n.record.usedSpace*100/n.record.totalSpace).toFixed(2))+"% ",1)):n.column.dataIndex==="operation"?(i(),r("div",te,[o(x,{onClick:t[0]||(t[0]=v=>n.$emit("openModal",n.rowIndex)),type:"primary"},{icon:a(()=>[o(b)]),_:1}),o(e,{type:"warning",position:"lt",content:"确定要删除该用户吗？",onOk:I},{default:a(()=>[o(x,{type:"primary",status:"danger"},{icon:a(()=>[o(s)]),_:1})]),_:1})])):(i(),r("div",oe,c(n.record[n.column.dataIndex]),1))])}}}),ce=C({__name:"index",setup(m){const u=B([]);J(async()=>{const s=await Y();s.code===200&&(u.value=s.data)});const y=[{title:"序号",dataIndex:"index",width:60},{title:"昵称",dataIndex:"nickName"},{title:"邮箱",dataIndex:"email"},{title:"注册时间",dataIndex:"registerTime"},{title:"上次登录时间",dataIndex:"lastLoginTime"},{title:"状态",dataIndex:"status"},{title:"已使用空间",dataIndex:"usedSpace"},{title:"用户身份",dataIndex:"isVip"},{title:"上传并发数量限制",dataIndex:"uploadLimit"},{title:"下载速度",dataIndex:"downloadSpeed"},{title:"操作",dataIndex:"operation",fixed:"right"}].map(s=>({...s,align:"center"})),I=B([]),n=s=>{u.value.splice(s,1)},t=P({show:!1,idx:-1,userInfo:{}}),b=s=>{t.idx=s,t.userInfo=JSON.parse(JSON.stringify(u.value[s])),t.userInfo.downloadSpeed=+(t.userInfo.downloadSpeed/1024).toFixed(2),t.show=!0},x=async()=>{const{userInfo:{isVip:s,status:e,uploadLimit:v,downloadSpeed:S,id:p}}=t,_=S*1024;(await W({isVip:s,status:e,uploadLimit:v,userId:p,downloadSpeed:_})).code===200?(U.success("修改成功"),u.value[t.idx]={...u.value[t.idx],isVip:s,status:e,uploadLimit:v,downloadSpeed:_}):U.error("修改失败")};return(s,e)=>{const v=O,S=F,p=$,_=K,w=j,V=R,D=z,E=q;return i(),r("div",null,[o(S,{columns:d(y),class:"m-3 mt-8",data:d(u),hoverable:"",pagination:!1,selectedKeys:d(I),"onUpdate:selectedKeys":e[0]||(e[0]=l=>Q(I)?I.value=l:null)},{td:a(({column:l,record:L,rowIndex:M})=>[o(ne,{column:l,record:L,rowIndex:M,onDeleteUser:n,onOpenModal:b},null,8,["column","record","rowIndex"])]),empty:a(()=>[o(v,{description:"还没有任何文件~"})]),_:1},8,["columns","data","selectedKeys"]),o(E,{title:"修改用户信息",visible:d(t).show,"onUpdate:visible":e[5]||(e[5]=l=>d(t).show=l),closable:!1,onOk:x},{default:a(()=>[o(D,{model:d(t)},{default:a(()=>[o(w,{label:"状态"},{default:a(()=>[o(_,{type:"button","model-value":d(t).userInfo.status,"onUpdate:modelValue":e[1]||(e[1]=l=>d(t).userInfo.status=l)},{default:a(()=>[o(p,{value:0},{default:a(()=>e[6]||(e[6]=[f("封禁")])),_:1}),o(p,{value:1},{default:a(()=>e[7]||(e[7]=[f("正常")])),_:1})]),_:1},8,["model-value"])]),_:1}),o(w,{label:"身份"},{default:a(()=>[o(_,{type:"button","model-value":d(t).userInfo.isVip,"onUpdate:modelValue":e[2]||(e[2]=l=>d(t).userInfo.isVip=l)},{default:a(()=>[o(p,{value:0},{default:a(()=>e[8]||(e[8]=[f("普通用户")])),_:1}),o(p,{value:1},{default:a(()=>e[9]||(e[9]=[f(" vip ")])),_:1})]),_:1},8,["model-value"])]),_:1}),o(w,{label:"上传并发数"},{default:a(()=>[o(V,{min:1,"model-value":d(t).userInfo.uploadLimit,"onUpdate:modelValue":e[3]||(e[3]=l=>d(t).userInfo.uploadLimit=l),style:{width:"240px"}},null,8,["model-value"]),e[10]||(e[10]=f(" 个 "))]),_:1}),o(w,{label:"下载速度"},{default:a(()=>[o(V,{min:1,"model-value":d(t).userInfo.downloadSpeed,"onUpdate:modelValue":e[4]||(e[4]=l=>d(t).userInfo.downloadSpeed=l),style:{width:"240px"}},null,8,["model-value"]),e[11]||(e[11]=f(" KB/s "))]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])}}});export{ce as default};
