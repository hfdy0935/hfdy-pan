/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{b as x,c as R,d as q,s as j,f as K}from"./share-BzanW0kV.js";import{s as M}from"./index-CdIjDISF.js";import{d as V,c as L,am as I,o as p,a as h,e as P,aY as S,ap as a,ao as l,an as U,aX as T,aG as t,aE as f,a_ as z,b9 as A,b2 as G,ag as O,av as D,bq as B,br as Q,aS as W,bc as E,bs as X,bt as Y,aT as H,aU as J,bx as Z,aV as ee,aQ as $,be as te,by as oe,bz as ae}from"./arco-design-vue-wpZPvk8Z.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{t as ne}from"./useFolderLevelTree-BY3VF7JM.js";import"./useBreadcrumb-DDMjDaLE.js";import"./arco-design-vue-icon-S64ufJhU.js";import"./index-DeLZq7_u.js";const le={class:"min-h-14 flex items-center justify-center"},se={key:0},ie={key:1,class:"w-64 flex justify-evenly"},de={key:3},re=V({__name:"table-cell",props:{column:{},record:{},rowIndex:{}},emits:["updateConfig","updateFile"],setup(r,{emit:_}){const w=_,{shareId:o,config:v,selectedIds:k}=M(x()),{updateData:i}=x(),y=()=>{o.value=r.record.id,v.value.pwd=r.record.pwd,v.value.noDdl=r.record.expire.startsWith("9999"),w("updateConfig")},s=()=>{o.value=r.record.id,k.value=r.record.fileIds,w("updateFile")},e=async()=>{try{const n=await R(r.record.id);n.code===200?(f.success("删除成功"),await i()):f.error(n.message)}catch{f.error("删除失败")}},b=L(()=>location.protocol+"//"+location.host+"/share/"+r.record.id+(r.record.pwd?`?pwd=${r.record.pwd}`:""));return(n,m)=>{const g=I("icon-file"),d=z,u=I("icon-settings"),C=I("icon-delete"),F=A,N=G;return p(),h("td",null,[P("div",le,[n.column.dataIndex==="index"?(p(),h("div",se,S(n.rowIndex+1),1)):n.column.dataIndex==="operation"?(p(),h("div",ie,[a(d,{type:"primary",status:"success",onClick:m[0]||(m[0]=c=>s())},{icon:l(()=>[a(g)]),_:1}),a(d,{onClick:m[1]||(m[1]=c=>y()),type:"primary"},{icon:l(()=>[a(u)]),_:1}),a(F,{type:"warning",position:"lt",content:"确定要删除该分享吗？",onOk:e},{default:l(()=>[a(d,{type:"primary",status:"danger"},{icon:l(()=>[a(C)]),_:1})]),_:1})])):n.column.dataIndex==="link"?(p(),U(N,{key:2,href:t(b),target:"'_blank'"},{default:l(()=>[T(S(t(b)),1)]),_:1},8,["href"])):(p(),h("div",de,S(n.record[n.column.dataIndex]),1))])])}}}),ce=V({__name:"config-modal",setup(r,{expose:_}){const{shareId:w,config:o,formattedConfig:v}=M(x()),{updateData:k}=x(),i=O(!1),y=async()=>{try{const s=await q({id:w.value,...v.value});s.code===200?(f.success("修改成功"),await k()):f.error(s.message)}catch{f.error("修改失败")}};return _({open(){i.value=!0}}),(s,e)=>{const b=Q,n=W,m=I("icon-info-circle"),g=E,d=X,u=Y,C=H,F=J,N=B;return p(),U(N,{visible:t(i),"onUpdate:visible":e[4]||(e[4]=c=>D(i)?i.value=c:null),title:"修改分享设置",onOk:y,width:480},{default:l(()=>[a(F,{model:t(o),"auto-label-width":""},{default:l(()=>[a(n,{label:"永久有效"},{default:l(()=>[a(b,{"model-value":t(o).noDdl,"onUpdate:modelValue":e[0]||(e[0]=c=>t(o).noDdl=c)},null,8,["model-value"])]),_:1}),a(n,{disabled:t(o).noDdl},{label:l(()=>[e[5]||(e[5]=T(" 有效期 ")),a(g,{content:"从当前时间算起"},{default:l(()=>[a(m)]),_:1})]),default:l(()=>[a(d,{min:1,max:100,modelValue:t(o).value,"onUpdate:modelValue":e[1]||(e[1]=c=>t(o).value=c)},null,8,["modelValue"])]),_:1},8,["disabled"]),a(n,{label:"单位",disabled:t(o).noDdl},{default:l(()=>[a(u,{"model-value":t(o).expire,"onUpdate:modelValue":e[2]||(e[2]=c=>t(o).expire=c),options:t(j)},null,8,["model-value","options"])]),_:1},8,["disabled"]),a(n,{label:"提取码"},{default:l(()=>[a(C,{modelValue:t(o).pwd,"onUpdate:modelValue":e[3]||(e[3]=c=>t(o).pwd=c),modelModifiers:{trim:!0},placeholder:"不设置表示公开",allowClear:"","max-length":12},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])}}}),me=V({__name:"file-modal",setup(r,{expose:_}){const{shareId:w,selectedIds:o,treeDataAllowFile:v}=M(x()),{updateData:k}=x(),i=O(!1),y=async()=>{try{const s=await K(o.value,w.value);s.code===200?(f.success("修改成功"),await k()):f.error(s.message)}catch{f.error("修改失败")}};return _({open(){i.value=!0}}),(s,e)=>{const b=I("icon-info-circle"),n=E,m=Z,g=B;return p(),U(g,{visible:t(i),"onUpdate:visible":e[2]||(e[2]=d=>D(i)?i.value=d:null),onOk:y,width:480},{title:l(()=>[e[3]||(e[3]=T(" 修改分享文件  ")),a(n,{content:"文件夹和文件可分别添加"},{default:l(()=>[a(b)]),_:1})]),default:l(()=>[a(m,{data:t(v),fieldNames:t(ne),"checked-keys":t(o),"onUpdate:checkedKeys":e[0]||(e[0]=d=>D(o)?o.value=d:null),"selected-keys":t(o),"onUpdate:selectedKeys":e[1]||(e[1]=d=>D(o)?o.value=d:null),checkable:"",multiple:"","check-strictly":""},null,8,["data","fieldNames","checked-keys","selected-keys"])]),_:1},8,["visible"])}}}),Ne=V({__name:"index",setup(r){const{shareData:_}=M(x()),{updateData:w,updateTreeLayerData:o}=x();ee(()=>{w(),o()});const v=[{title:"序号",dataIndex:"index",width:60},{title:"创建时间",dataIndex:"createTime",width:180},{title:"过期时间",dataIndex:"expire",width:180},{title:"链接",dataIndex:"link",width:300},{title:"提取码",dataIndex:"pwd",width:120},{title:"文件/文件夹数量",dataIndex:"itemNum",width:180},{title:"访问量",dataIndex:"visitNum",width:100},{title:"操作",dataIndex:"operation",width:180,fixed:"right"}].map(y=>({...y,align:"center"})),k=$("configModal"),i=$("fileModal");return(y,s)=>{const e=oe,b=ae;return p(),h(te,null,[t(_).length?(p(),U(e,{key:0,columns:t(v),class:"m-3 mt-10",scroll:{x:700},data:t(_),hoverable:"",pagination:!1},{td:l(({column:n,record:m,rowIndex:g})=>[a(re,{column:n,record:m,rowIndex:g,onUpdateConfig:s[0]||(s[0]=d=>{var u;return(u=t(k))==null?void 0:u.open()}),onUpdateFile:s[1]||(s[1]=d=>{var u;return(u=t(i))==null?void 0:u.open()})},null,8,["column","record","rowIndex"])]),_:1},8,["columns","data"])):(p(),U(b,{key:1,class:"mt-24"})),a(ce,{ref:"configModal"},null,512),a(me,{ref:"fileModal"},null,512)],64)}}});export{Ne as default};
