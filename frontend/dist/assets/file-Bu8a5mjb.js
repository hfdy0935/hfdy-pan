const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BV772zJi.js","assets/useFolderLevelTree-CDJ_26ol.js","assets/index-DeLZq7_u.js","assets/index-fDEUsWmJ.js","assets/vue-office_docx-BTzFQIdC.js","assets/vue-office_docx-QBxTY_vh.css","assets/index-65Il4m2H.css","assets/calc-CYjR0slx.js","assets/useBreadcrumb-DKPyaTjD.js","assets/vue-office_excel-HlhG_4Om.js","assets/vue-office_excel-BcyczgTn.css","assets/vue-office_pdf-1kjn8M9t.js","assets/vue-office_pptx-Ci_UBxwQ.js","assets/index-CsrA5E6V.css","assets/index-Bemu3YX3.css","assets/index-1KASY4po.css","assets/index-DfCcxtoI.js","assets/index-B1v9C8kk.js","assets/index-CFxGOiqx.js","assets/index-Dby_OWeB.js","assets/index-C0EE-4CF.js","assets/index-TEEz0Elb.js","assets/index-DV0vrAiY.js","assets/index-BZDiOY4b.js","assets/index-GenGkzJh.js","assets/index-C_7fShQY.js","assets/index-DZsJf65D.js","assets/index-CFKiZ7gP.js","assets/index-DirDo6j1.js","assets/dockerfile-CfugagWn.js","assets/simple-mode-wTmKiC4w.js","assets/factor-DhWEB9Tq.js","assets/nsis-BORQDQLj.js","assets/pug-BmUsPMDj.js","assets/javascript-iSgyE4tI.js","assets/index-1yibg0MA.js","assets/index-DAfT05qg.js"])))=>i.map(i=>d[i]);
var t5=Object.defineProperty;var Ax=i=>{throw TypeError(i)};var i5=(i,e,t)=>e in i?t5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var pt=(i,e,t)=>i5(i,typeof e!="symbol"?e+"":e,t),Gp=(i,e,t)=>e.has(i)||Ax("Cannot "+t);var P=(i,e,t)=>(Gp(i,e,"read from private field"),t?t.call(i):e.get(i)),je=(i,e,t)=>e.has(i)?Ax("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),ye=(i,e,t,n)=>(Gp(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),ue=(i,e,t)=>(Gp(i,e,"access private method"),t);var Fc=(i,e,t,n)=>({set _(r){ye(i,e,r,t)},get _(){return P(i,e,n)}});import{u as $2,T as GO,i as Px,w as n5,y as r5,z as s5,A as o5,B as a5,C as l5,s as u5,m as c5}from"./useFolderLevelTree-CDJ_26ol.js";import{a as M2,b as F2,d as h5}from"./calc-CYjR0slx.js";import{u as f5}from"./useBreadcrumb-DKPyaTjD.js";import{r as ce,q as De,d as Ze,ab as nf,w as pe,a as Rs,b as Ei,c as $r,e as Ko,$ as ze,F as bo,P as N2,f as d5,y as tl,i as tc,af as p5,a2 as Qn,v as g5,X as Os,o as ft,n as wi,p as xe,k as R,m as di,t as xu,D as Ni,ag as m5,E as Nn,M as v5,u as O5,j as ti,Y as Nc,B as tr,C as y5,z as Q2,N as Rx,O as Lx,h as b5}from"./vue-office_docx-BTzFQIdC.js";import{aq as op,ar as Vl,s as mi,o as x5,_ as ap,a6 as HO,a as Lm,as as U,at as S5,V as k5,F as T5,am as E5,an as w5,G as _5,a5 as C5,B as A5,au as il,M as Dt}from"./index-fDEUsWmJ.js";import{V as P5}from"./vue-office_excel-HlhG_4Om.js";import{J as R5}from"./vue-office_pdf-1kjn8M9t.js";import{K as L5}from"./vue-office_pptx-Ci_UBxwQ.js";/* empty css              *//* empty css              *//* empty css              */var Zl=(i=>(i[i.DEFAULT=-1]="DEFAULT",i[i.ASC=1]="ASC",i[i.DESC=0]="DESC",i))(Zl||{});const B2=i=>(i==null?void 0:i.mediaType)!=="folder",U2=i=>!B2(i),I5=i=>(i==null?void 0:i.category)==="video",Pge=i=>(i==null?void 0:i.category)==="audio",Rge=i=>(i==null?void 0:i.category)==="image",D5=i=>{var e;return((e=i==null?void 0:i.level)==null?void 0:e.split("/").length)??0};function V2(){const i=ce([]),e=()=>{i.value=[]},t=ce(null),n=De(()=>t.value===null?null:U2(t.value)?"folder":"file");return{selectedIds:i,contextmenuItem:t,contextmenuType:n,clearSelected:e}}function Ix(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function St(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ix(Object(t),!0).forEach(function(n){q(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Ix(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function vi(i){"@babel/helpers - typeof";return vi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vi(i)}function ge(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Dx(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,Z2(n.key),n)}}function me(i,e,t){return e&&Dx(i.prototype,e),t&&Dx(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function q(i,e,t){return e=Z2(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ce(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Im(i,e)}function ke(i){return ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ke(i)}function Im(i,e){return Im=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Im(i,e)}function $5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function V(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function XO(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V(i)}function Ae(i){var e=$5();return function(){var n=ke(i),r;if(e){var s=ke(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return XO(this,r)}}function M5(i,e){for(;!Object.prototype.hasOwnProperty.call(i,e)&&(i=ke(i),i!==null););return i}function Ee(){return typeof Reflect<"u"&&Reflect.get?Ee=Reflect.get.bind():Ee=function(e,t,n){var r=M5(e,t);if(r){var s=Object.getOwnPropertyDescriptor(r,t);return s.get?s.get.call(arguments.length<3?e:n):s.value}},Ee.apply(this,arguments)}function ys(i){return F5(i)||N5(i)||Q5(i)||B5()}function F5(i){if(Array.isArray(i))return Dm(i)}function N5(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Q5(i,e){if(i){if(typeof i=="string")return Dm(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Dm(i,e)}}function Dm(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=i[t];return n}function B5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U5(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Z2(i){var e=U5(i,"string");return typeof e=="symbol"?e:String(e)}var j2={exports:{}};(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,h,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new r(c,h||l,f),p=t?t+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],d]:l._events[p].push(d):(l._events[p]=d,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=t?t+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,d=h.length,p=new Array(d);f<d;f++)p[f]=h[f].fn;return p},a.prototype.listenerCount=function(u){var c=t?t+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,f,d,p){var g=t?t+u:u;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,O,y;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,h),!0;case 4:return m.fn.call(m.context,c,h,f),!0;case 5:return m.fn.call(m.context,c,h,f,d),!0;case 6:return m.fn.call(m.context,c,h,f,d,p),!0}for(y=1,O=new Array(v-1);y<v;y++)O[y-1]=arguments[y];m.fn.apply(m.context,O)}else{var x=m.length,b;for(y=0;y<x;y++)switch(m[y].once&&this.removeListener(u,m[y].fn,void 0,!0),v){case 1:m[y].fn.call(m[y].context);break;case 2:m[y].fn.call(m[y].context,c);break;case 3:m[y].fn.call(m[y].context,c,h);break;case 4:m[y].fn.call(m[y].context,c,h,f);break;default:if(!O)for(b=1,O=new Array(v-1);b<v;b++)O[b-1]=arguments[b];m[y].fn.apply(m[y].context,O)}}return!0},a.prototype.on=function(u,c,h){return s(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return s(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,f){var d=t?t+u:u;if(!this._events[d])return this;if(!c)return o(this,d),this;var p=this._events[d];if(p.fn)p.fn===c&&(!f||p.once)&&(!h||p.context===h)&&o(this,d);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==c||f&&!p[g].once||h&&p[g].context!==h)&&m.push(p[g]);m.length?this._events[d]=m.length===1?m[0]:m:o(this,d)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,i.exports=a})(j2);var V5=j2.exports;const G2=op(V5);var Z5=typeof window<"u"&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,Hp={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},Xp="%c[xgplayer]",Qe={config:{debug:Z5?3:0},logInfo:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];this.config.debug>=3&&(t=console).log.apply(t,[Xp,Hp.info,e].concat(r))},logWarn:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];this.config.debug>=1&&(t=console).warn.apply(t,[Xp,Hp.warn,e].concat(r))},logError:function(e){var t;if(!(this.config.debug<1)){for(var n=this.config.debug>=2?"trace":"error",r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];(t=console)[n].apply(t,[Xp,Hp.error,e].concat(s))}}};function j5(i){i.logInfo=Qe.logInfo.bind(i),i.logWarn=Qe.logWarn.bind(i),i.logError=Qe.logError.bind(i)}var G5=function(){function i(e){ge(this,i),this.bufferedList=e}return me(i,[{key:"start",value:function(t){return this.bufferedList[t].start}},{key:"end",value:function(t){return this.bufferedList[t].end}},{key:"length",get:function(){return this.bufferedList.length}}]),i}(),k={};k.createDom=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",r=document.createElement(i);return r.className=n,r.innerHTML=e,Object.keys(t).forEach(function(s){var o=s,a=t[s];i==="video"||i==="audio"||i==="live-video"?a&&r.setAttribute(o,a):r.setAttribute(o,a)}),r};k.createDomFromHtml=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";try{var n=document.createElement("div");n.innerHTML=i;var r=n.children;return n=null,r.length>0?(r=r[0],t&&k.addClass(r,t),e&&Object.keys(e).forEach(function(s){r.setAttribute(s,e[s])}),r):null}catch(s){return Qe.logError("util.createDomFromHtml",s),null}};k.hasClass=function(i,e){if(!i||!e)return!1;try{return Array.prototype.some.call(i.classList,function(n){return n===e})}catch{var t=i.className&&vi(i.className)==="object"?i.getAttribute("class"):i.className;return t&&!!t.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}};k.addClass=function(i,e){if(!(!i||!e))try{e.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(t){t&&i.classList.add(t)})}catch{k.hasClass(i,e)||(i.className&&vi(i.className)==="object"?i.setAttribute("class",i.getAttribute("class")+" "+e):i.className+=" "+e)}};k.removeClass=function(i,e){if(!(!i||!e))try{e.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(t){t&&i.classList.remove(t)})}catch{k.hasClass(i,e)&&e.split(/\s+/g).forEach(function(n){var r=new RegExp("(\\s|^)"+n+"(\\s|$)");i.className&&vi(i.className)==="object"?i.setAttribute("class",i.getAttribute("class").replace(r," ")):i.className=i.className.replace(r," ")})}};k.toggleClass=function(i,e){i&&e.split(/\s+/g).forEach(function(t){k.hasClass(i,t)?k.removeClass(i,t):k.addClass(i,t)})};k.classNames=function(){for(var i=arguments,e=[],t=function(s){k.typeOf(i[s])==="String"?e.push(i[s]):k.typeOf(i[s])==="Object"&&Object.keys(i[s]).map(function(o){i[s][o]&&e.push(o)})},n=0;n<arguments.length;n++)t(n);return e.join(" ")};k.findDom=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0,t;try{t=i.querySelector(e)}catch(n){Qe.logError("util.findDom",n),e.indexOf("#")===0&&(t=i.getElementById(e.slice(1)))}return t};k.getCss=function(i,e){return i.currentStyle?i.currentStyle[e]:document.defaultView.getComputedStyle(i,!1)[e]};k.padStart=function(i,e,t){for(var n=String(t),r=e>>0,s=Math.ceil(r/n.length),o=[],a=String(i);s--;)o.push(n);return o.join("").substring(0,r-a.length)+a};k.format=function(i){if(window.isNaN(i))return"";i=Math.round(i);var e=k.padStart(Math.floor(i/3600),2,0),t=k.padStart(Math.floor((i-e*3600)/60),2,0),n=k.padStart(Math.floor(i-e*3600-t*60),2,0);return(e==="00"?[t,n]:[e,t,n]).join(":")};k.event=function(i){if(i.touches){var e=i.touches[0]||i.changedTouches[0];i.clientX=e.clientX||0,i.clientY=e.clientY||0,i.offsetX=e.pageX-e.target.offsetLeft,i.offsetY=e.pageY-e.target.offsetTop}i._target=i.target||i.srcElement};k.typeOf=function(i){return Object.prototype.toString.call(i).match(/([^\s.*]+)(?=]$)/g)[0]};k.deepCopy=function(i,e){if(k.typeOf(e)==="Object"&&k.typeOf(i)==="Object")return Object.keys(e).forEach(function(t){k.typeOf(e[t])==="Object"&&!(e[t]instanceof Node)?i[t]===void 0||i[t]===void 0?i[t]=e[t]:k.deepCopy(i[t],e[t]):k.typeOf(e[t])==="Array"?i[t]=k.typeOf(i[t])==="Array"?i[t].concat(e[t]):e[t]:i[t]=e[t]}),i};k.deepMerge=function(i,e){return Object.keys(e).map(function(t){if(k.typeOf(e[t])==="Array"&&k.typeOf(i[t])==="Array"){if(k.typeOf(i[t])==="Array"){var n;(n=i[t]).push.apply(n,ys(e[t]))}}else k.typeOf(i[t])===k.typeOf(e[t])&&i[t]!==null&&k.typeOf(i[t])==="Object"&&!(e[t]instanceof window.Node)?k.deepMerge(i[t],e[t]):e[t]!==null&&(i[t]=e[t])}),i};k.getBgImage=function(i){var e=(i.currentStyle||window.getComputedStyle(i,null)).backgroundImage;if(!e||e==="none")return"";var t=document.createElement("a");return t.href=e.replace(/url\("|"\)/g,""),t.href};k.copyDom=function(i){if(i&&i.nodeType===1){var e=document.createElement(i.tagName);return Array.prototype.forEach.call(i.attributes,function(t){e.setAttribute(t.name,t.value)}),i.innerHTML&&(e.innerHTML=i.innerHTML),e}else return""};k.setInterval=function(i,e,t,n){i._interval[e]||(i._interval[e]=window.setInterval(t.bind(i),n))};k.clearInterval=function(i,e){clearInterval(i._interval[e]),i._interval[e]=null};k.setTimeout=function(i,e,t){i._timers||(i._timers=[]);var n=setTimeout(function(){e(),k.clearTimeout(i,n)},t);return i._timers.push(n),n};k.clearTimeout=function(i,e){var t=i._timers;if(k.typeOf(t)==="Array"){for(var n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1),clearTimeout(e);break}}else clearTimeout(e)};k.clearAllTimers=function(i){var e=i._timers;k.typeOf(e)==="Array"&&(e.map(function(t){clearTimeout(t)}),i._timerIds=[])};k.createImgBtn=function(i,e,t,n){var r=k.createDom("xg-".concat(i),"",{},"xgplayer-".concat(i,"-img"));if(r.style.backgroundImage='url("'.concat(e,'")'),t&&n){var s,o,a;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(l){return t.indexOf(l)>-1&&n.indexOf(l)>-1?(s=parseFloat(t.slice(0,t.indexOf(l)).trim()),o=parseFloat(n.slice(0,n.indexOf(l)).trim()),a=l,!1):!0}),r.style.width="".concat(s).concat(a),r.style.height="".concat(o).concat(a),r.style.backgroundSize="".concat(s).concat(a," ").concat(o).concat(a),i==="start"?r.style.margin="-".concat(o/2).concat(a," auto auto -").concat(s/2).concat(a):r.style.margin="auto 5px auto 5px"}return r};k.Hex2RGBA=function(i,e){var t=[];if(/^\#[0-9A-F]{3}$/i.test(i)){var n="#";i.replace(/[0-9A-F]/ig,function(r){n+=r+r}),i=n}return/^#[0-9A-F]{6}$/i.test(i)?(i.replace(/[0-9A-F]{2}/ig,function(r){t.push(parseInt(r,16))}),"rgba(".concat(t.join(","),", ").concat(e,")")):"rgba(255, 255, 255, 0.1)"};k.getFullScreenEl=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement};k.checkIsFunction=function(i){return i&&typeof i=="function"};k.checkIsObject=function(i){return i!==null&&vi(i)==="object"};k.hide=function(i){i.style.display="none"};k.show=function(i,e){i.style.display=e||"block"};k.isUndefined=function(i){if(typeof i>"u"||i===null)return!0};k.setStyleFromCsstext=function(i,e){if(e)if(k.typeOf(e)==="String"){var t=e.replace(/\s+/g,"").split(";");t.map(function(n){if(n){var r=n.split(":");r.length>1&&(i.style[r[0]]=r[1])}})}else Object.keys(e).map(function(n){i.style[n]=e[n]})};function H5(i,e){for(var t=0,n=e.length;t<n;t++)if(i.indexOf(e[t])>-1)return!0;return!1}k.filterStyleFromText=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],t=i.style.cssText;if(!t)return{};var n=t.replace(/\s+/g,"").split(";"),r={},s={};return n.map(function(o){if(o){var a=o.split(":");a.length>1&&(H5(a[0],e)?r[a[0]]=a[1]:s[a[0]]=a[1])}}),i.setAttribute("style",""),Object.keys(s).map(function(o){i.style[o]=s[o]}),r};k.getStyleFromCsstext=function(i){var e=i.style.cssText;if(!e)return{};var t=e.replace(/\s+/g,"").split(";"),n={};return t.map(function(r){if(r){var s=r.split(":");s.length>1&&(n[s[0]]=s[1])}}),n};k.preloadImg=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(i){var n=new window.Image;n.onload=function(r){n=null,e&&e(r)},n.onerror=function(r){n=null,t&&t(r)},n.src=i}};k.stopPropagation=function(i){i&&(i.stopPropagation(),i.cancelable&&i.preventDefault())};k.scrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0};k.scrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0};k.checkTouchSupport=function(){return"ontouchstart"in window};k.getBuffered2=function(i){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,t=[],n=0;n<i.length;n++)t.push({start:i.start(n)<.5?0:i.start(n),end:i.end(n)});t.sort(function(l,u){var c=l.start-u.start;return c||u.end-l.end});var r=[];if(e)for(var s=0;s<t.length;s++){var o=r.length;if(o){var a=r[o-1].end;t[s].start-a<e?t[s].end>a&&(r[o-1].end=t[s].end):r.push(t[s])}else r.push(t[s])}else r=t;return new G5(r)};k.getEventPos=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return i.touches&&i.touches.length>0&&(i=i.touches[0]),{x:i.x/e,y:i.y/e,clientX:i.clientX/e,clientY:i.clientY/e,offsetX:i.offsetX/e,offsetY:i.offsetY/e,pageX:i.pageX/e,pageY:i.pageY/e}};k.requestAnimationFrame=function(i){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(e)return e(i)};k.getHostFromUrl=function(i){if(k.typeOf(i)!=="String")return"";var e=i.split("/"),t="";return e.length>3&&e[2]&&(t=e[2]),t};k.cancelAnimationFrame=function(i){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;e&&e(i)};k.isMSE=function(i){return!i||!(i instanceof HTMLMediaElement)?!1:/^blob/.test(i.currentSrc)||/^blob/.test(i.src)};k.generateSessionId=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=new Date().getTime();try{i=parseInt(i)}catch{i=0}e+=i,window.performance&&typeof window.performance.now=="function"&&(e+=parseInt(window.performance.now()));var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var r=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(n==="x"?r:r&3|8).toString(16)});return t};k.createEvent=function(i){var e;return typeof window.Event=="function"?e=new Event(i):(e=document.createEvent("Event"),e.initEvent(i,!0,!0)),e};k.adjustTimeByDuration=function(i,e,t){return!e||!i?i:i>e||t&&i<e?e:i};k.createPositionBar=function(i,e){var t=k.createDom("xg-bar","",{"data-index":-1},i);return e.appendChild(t),t};function H2(i){var e=vi(i);return i!==null&&(e==="object"||e==="function")}function X5(i,e,t){var n,r,s,o,a,l,u=0,c=!1,h=!1,f=!0,d=!e&&e!==0&&typeof window.requestAnimationFrame=="function";if(typeof i!="function")throw new TypeError("Expected a function");e=+e||0,H2(t)&&(c=!!t.leading,h="maxWait"in t,s=h?Math.max(+t.maxWait||0,e):s,f="trailing"in t?!!t.trailing:f);function p(A){var I=n,L=r;return n=r=void 0,u=A,o=i.apply(L,I),o}function g(A,I){return d?(window.cancelAnimationFrame(a),window.requestAnimationFrame(A)):setTimeout(A,I)}function m(A){if(d)return window.cancelAnimationFrame(A);clearTimeout(A)}function v(A){return u=A,a=g(x,e),c?p(A):o}function O(A){var I=A-l,L=A-u,$=e-I;return h?Math.min($,s-L):$}function y(A){var I=A-l,L=A-u;return l===void 0||I>=e||I<0||h&&L>=s}function x(){var A=Date.now();if(y(A))return b(A);a=g(x,O(A))}function b(A){return a=void 0,f&&n?p(A):(n=r=void 0,o)}function E(){a!==void 0&&m(a),u=0,n=l=r=a=void 0}function T(){return a===void 0?o:b(Date.now())}function _(){return a!==void 0}function D(){for(var A=Date.now(),I=y(A),L=arguments.length,$=new Array(L),B=0;B<L;B++)$[B]=arguments[B];if(n=$,r=this,l=A,I){if(a===void 0)return v(l);if(h)return a=g(x,e),p(l)}return a===void 0&&(a=g(x,e)),o}return D.cancel=E,D.flush=T,D.pending=_,D}function z5(i,e,t){var n=!0,r=!0;if(typeof i!="function")throw new TypeError("Expected a function");return H2(t)&&(n="leading"in t?!!t.leading:n,r="trailing"in t?!!t.trailing:r),X5(i,e,{leading:n,trailing:r,maxWait:e})}function W5(){var i=(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase();return i==="zh-cn"&&(i="zh"),i}function q5(i,e,t){if(i){var n=i.getAttribute(t);return!!(n&&n===e&&(i.tagName==="VIDEO"||i.tagName==="AUDIO"))}}var $x={android:/(Android)\s([\d.]+)/,ios:/(Version)\/([\d.]+)/},Y5=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],Le={get device(){var i=Le.os;return i.isPc?"pc":"mobile"},get browser(){if(typeof navigator>"u")return"";var i=navigator.userAgent.toLowerCase(),e={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(e).filter(function(t){return e[t].test(i)}))[0]},get os(){if(typeof navigator>"u")return{};var i=navigator.userAgent,e=/(?:Windows Phone)/.test(i),t=/(?:SymbianOS)/.test(i)||e,n=/(?:Android)/.test(i),r=/(?:Firefox)/.test(i),s=/(?:iPad|PlayBook)/.test(i)||n&&!/(?:Mobile)/.test(i)||r&&/(?:Tablet)/.test(i),o=/(?:iPhone)/.test(i)&&!s,a=!o&&!n&&!t&&!s,l=/(?:iPad|PlayBook)/.test(i);return{isTablet:s,isPhone:o,isIpad:l,isIos:o||l,isAndroid:n,isPc:a,isSymbian:t,isWindowsPhone:e,isFireFox:r}},get osVersion(){if(typeof navigator>"u")return 0;var i=navigator.userAgent,e="";/(?:iPhone)|(?:iPad|PlayBook)/.test(i)?e=$x.ios:e=$x.android;var t=e?e.exec(i):[];if(t&&t.length>=3){var n=t[2].split(".");return n.length>0?parseInt(n[0]):0}return 0},get isWeixin(){if(typeof navigator>"u")return!1;var i=/(micromessenger)\/([\d.]+)/,e=i.exec(navigator.userAgent.toLocaleLowerCase());return!!e},isSupportMP4:function(){var e={isSupport:!1,mime:""};if(typeof document>"u")return e;if(this.supportResult)return this.supportResult;var t=document.createElement("video");return typeof t.canPlayType=="function"&&Y5.map(function(n){t.canPlayType('video/mp4; codecs="'.concat(n,'"'))==="probably"&&(e.isSupport=!0,e.mime+="||".concat(n))}),this.supportResult=e,t=null,e},isHevcSupported:function(){return typeof MediaSource>"u"||!MediaSource.isTypeSupported?!1:MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"')},probeConfigSupported:function(e){var t={supported:!1,smooth:!1,powerEfficient:!1};if(!e||typeof navigator>"u")return Promise.resolve(t);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(e);var n=e.video||{},r=e.audio||{};try{var s=MediaSource.isTypeSupported(n.contentType),o=MediaSource.isTypeSupported(r.contentType);return Promise.resolve({supported:s&&o,smooth:!1,powerEfficient:!1})}catch{return Promise.resolve(t)}}},$m="3.0.0-next.55-8",K5={1:"network",2:"network",3:"decoder",4:"format"},zO=me(function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};ge(this,i);var n=e&&e.i18n?e.i18n.ERROR_TYPES:null;if(e.media){var r=t.mediaError?t.mediaError:e.media.error||{},s=e.duration,o=e.currentTime,a=e.ended,l=e.src,u=e.currentSrc,c=e.media,h=c.readyState,f=c.networkState,d={playerVersion:$m,currentTime:o,duration:s,ended:a,readyState:h,networkState:f,src:l||u,errorType:t.errorType,errorCode:t.errorCode||r.code,message:t.errorMessage||r.message,mediaError:r,originError:t.originError?t.originError.stack:"",host:k.getHostFromUrl(l||u)};return t.ext&&Object.keys(t.ext).map(function(v){d[v]=t.ext[v]}),d}else if(arguments.length>1){for(var p={playerVersion:$m,domain:document.domain},g=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],m=0;m<arguments.length;m++)p[g[m]]=arguments[m];return p.ex=n?(n[arguments[0]]||{}).msg:"",p}}),dn="play",WO="playing",Ls="ended",nl="pause",ic="error",qO="seeking",Su="seeked",cn="timeupdate",nc="waiting",Dn="canplay",J5="canplaythrough",Is="durationchange",X2="volumechange",co="loadeddata",z2="ratechange",W2="progress",YO="loadstart",rc="emptied",eM="stalled",tM="suspend",iM="abort",nM="bufferedChange",KO="focus",q2="blur",JO="ready",Y2="urlNull",so="autoplay_started",ey="autoplay_was_prevented",lp="complete",ty="replay",iy="destroy",up="urlchange",K2="download_speed_change",is="fullscreen_change",Zf="cssFullscreen_change",jf="mini_state_change",ny="definition_change",rM="before_definition_change",Mm="after_definition_change",sM="SEI_PARSED",oM="retry",Pa="video_resize",Fm="pip_change",J2="rotate",eA="screenShot",Gf="playnext",tA="shortcut",iA="xglog",Hf="user_action",ry="reset",aM="switch_subtitle",nA=["play","playing","ended","pause","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","loadeddata","ratechange","progress","loadstart","emptied","stalled","suspend","abort","lowdecode"],rA={STATS_INFO:"stats_info",STATS_DOWNLOAD:"stats_download",STATS_RESET:"stats_reset"},sA="fps_stuck";const lM=Object.freeze(Object.defineProperty({__proto__:null,ABORT:iM,AFTER_DEFINITION_CHANGE:Mm,AUTOPLAY_PREVENTED:ey,AUTOPLAY_STARTED:so,BEFORE_DEFINITION_CHANGE:rM,BUFFER_CHANGE:nM,CANPLAY:Dn,CANPLAY_THROUGH:J5,COMPLETE:lp,CSS_FULLSCREEN_CHANGE:Zf,DEFINITION_CHANGE:ny,DESTROY:iy,DOWNLOAD_SPEED_CHANGE:K2,DURATION_CHANGE:Is,EMPTIED:rc,ENDED:Ls,ERROR:ic,FPS_STUCK:sA,FULLSCREEN_CHANGE:is,LOADED_DATA:co,LOAD_START:YO,MINI_STATE_CHANGE:jf,PAUSE:nl,PIP_CHANGE:Fm,PLAY:dn,PLAYER_BLUR:q2,PLAYER_FOCUS:KO,PLAYING:WO,PLAYNEXT:Gf,PROGRESS:W2,RATE_CHANGE:z2,READY:JO,REPLAY:ty,RESET:ry,RETRY:oM,ROTATE:J2,SCREEN_SHOT:eA,SEEKED:Su,SEEKING:qO,SEI_PARSED:sM,SHORTCUT:tA,STALLED:eM,STATS_EVENTS:rA,SUSPEND:tM,SWITCH_SUBTITLE:aM,TIME_UPDATE:cn,URL_CHANGE:up,URL_NULL:Y2,USER_ACTION:Hf,VIDEO_EVENTS:nA,VIDEO_RESIZE:Pa,VOLUME_CHANGE:X2,WAITING:nc,XGLOG:iA},Symbol.toStringTag,{value:"Module"}));function zp(i,e){!this||!this.emit||(i==="error"?this.errorHandler(i,e.error):this.emit(i,e))}function uM(i,e){return function(t,n){var r={player:e,eventName:i,originalEvent:t,detail:t.detail||{},timeStamp:t.timeStamp,currentTime:e.currentTime,duration:e.duration,paused:e.paused,ended:e.ended,isInternalOp:!!e._internalOp[t.type],muted:e.muted,volume:e.volume,host:k.getHostFromUrl(e.currentSrc),vtype:e.vtype};if(e.removeInnerOP(t.type),i==="timeupdate"&&(e._currentTime=e.media&&e.media.currentTime),i==="ratechange"){var s=e.media?e.media.playbackRate:0;if(s&&e._rate===s)return;e._rate=e.media&&e.media.playbackRate}if(i==="durationchange"&&(e._duration=e.media.duration),i==="volumechange"&&(r.isMutedChange=e._lastMuted!==e.muted,e._lastMuted=e.muted),i==="error"&&(r.error=n||e.video.error),e.mediaEventMiddleware[i]){var o=zp.bind(e,i,r);try{e.mediaEventMiddleware[i].call(e,r,o)}catch(a){throw zp.call(e,i,r),a}}else zp.call(e,i,r)}}var cM=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;ge(this,t),r=e.call(this,n),r._hasStart=!1,r._currentTime=0,r._duration=0,r._internalOp={},r._lastMuted=!1,r.vtype="MP4",r._rate=-1,r.mediaConfig=Object.assign({},{controls:!1,autoplay:n.autoplay,playsinline:n.playsinline,"x5-playsinline":n.playsinline,"webkit-playsinline":n.playsinline,"x5-video-player-fullscreen":n["x5-video-player-fullscreen"]||n.x5VideoPlayerFullscreen,"x5-video-orientation":n["x5-video-orientation"]||n.x5VideoOrientation,airplay:n.airplay,"webkit-airplay":n.airplay,tabindex:n.tabindex|0,mediaType:n.mediaType||"video"},n.videoConfig,n.videoAttributes);var s=n["x5-video-player-type"]||n.x5VideoPlayerType;return Le.isWeixin&&Le.os.isAndroid&&s&&(r.mediaConfig["x5-video-player-type"]=s,delete r.mediaConfig.playsinline,delete r.mediaConfig["webkit-playsinline"],delete r.mediaConfig["x5-playsinline"]),n.loop&&(r.mediaConfig.loop="loop"),r.media=k.createDom(r.mediaConfig.mediaType,"",r.mediaConfig,""),n.defaultPlaybackRate&&(r.media.defaultPlaybackRate=r.media.playbackRate=n.defaultPlaybackRate),k.typeOf(n.volume)==="Number"&&(r.volume=n.volume),n.autoplayMuted&&(r.media.muted=!0,r._lastMuted=!0),n.autoplay&&(r.media.autoplay=!0),r._interval={},r.mediaEventMiddleware={},r.attachVideoEvents(),r}return me(t,[{key:"setEventsMiddleware",value:function(r){var s=this;Object.keys(r).map(function(o){s.mediaEventMiddleware[o]=r[o]})}},{key:"removeEventsMiddleware",value:function(r){var s=this;Object.keys(r).map(function(o){delete s.mediaEventMiddleware[o]})}},{key:"attachVideoEvents",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers||(this._evHandlers=nA.map(function(o){var a="on".concat(o.charAt(0).toUpperCase()).concat(o.slice(1));return typeof r[a]=="function"&&r.on(o,r[a]),q({},o,uM(o,r))})),this._evHandlers.forEach(function(o){var a=Object.keys(o)[0];s.addEventListener(a,o[a],!1)})}},{key:"detachVideoEvents",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers.forEach(function(o){var a=Object.keys(o)[0];s.removeEventListener(a,o[a],!1)}),this._evHandlers.forEach(function(o){var a=Object.keys(o)[0],l="on".concat(a.charAt(0).toUpperCase()).concat(a.slice(1));typeof r[l]=="function"&&r.off(a,r[l])}),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(r,s){var o=this;r.removeAttribute("src"),r.load(),s.forEach(function(h){o.media.appendChild(k.createDom("source","",{src:"".concat(h.src),type:"".concat(h.type||"")}))});var a=r.children;if(a){this._videoSourceCount=a.length;for(var l=null,u=0;u<this._evHandlers.length;u++)if(Object.keys(this._evHandlers[u])[0]==="error"){l=this._evHandlers[u];break}!this._sourceError&&(this._sourceError=function(h){if(o._videoSourceCount--,o._videoSourceCount===0){var f={code:4,message:"sources load error"};l?l.error(h,f):o.errorHandler("error",f)}});for(var c=0;c<a.length;c++)a[c].addEventListener("error",this._sourceError)}}},{key:"_detachSourceEvents",value:function(r){var s=r.children;if(!(!s||s.length===0||!this._sourceError)){for(var o=0;o<s.length;o++)s[o].removeEventListener("error",this._sourceError);for(;s.length>0;)r.removeChild(s[0])}}},{key:"errorHandler",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.media&&(this.media.error||s)){var o=this.media.error||s,a=o.code?K5[o.code]:"other",l=o.message;this.media.currentSrc||(l="empty_src",o={code:6,message:l}),this.emit(r,new zO(this,{errorType:a,errorCode:o.code,errorMessage:o.message||"",mediaError:o}))}}},{key:"destroy",value:function(){this.media&&(this.media.pause&&(this.media.pause(),this.media.muted=!0),this.media.removeAttribute("src"),this.media.load()),this._currentTime=0,this._duration=0,this.mediaConfig=null;for(var r in this._interval)Object.prototype.hasOwnProperty.call(this._interval,r)&&(clearInterval(this._interval[r]),this._interval[r]=null);this.detachVideoEvents(),this.media=null,this.mediaEventMiddleware={},this.removeAllListeners()}},{key:"video",get:function(){return this.media}},{key:"play",value:function(){var r=this.media?this.media.play():null;return r}},{key:"pause",value:function(){this.media&&this.media.pause()}},{key:"load",value:function(){this.media&&this.media.load()}},{key:"canPlayType",value:function(r){return this.media?this.media.canPlayType(r):!1}},{key:"getBufferedRange",value:function(r){var s=[0,0];if(!this.media)return s;r||(r=this.media.buffered);var o=this.media.currentTime;if(r)for(var a=0,l=r.length;a<l&&(s[0]=r.start(a),s[1]=r.end(a),!(s[0]<=o&&o<=s[1]));a++);return s[0]-o<=0&&o-s[1]<=0?s:[0,0]}},{key:"autoplay",get:function(){return this.media?this.media.autoplay:!1},set:function(r){this.media&&(this.media.autoplay=r)}},{key:"buffered",get:function(){return this.media?this.media.buffered:null}},{key:"buffered2",get:function(){return this.media&&this.media.buffered?k.getBuffered2(this.media.buffered):null}},{key:"bufferedPoint",get:function(){var r={start:0,end:0};if(!this.media)return r;var s=this.media.buffered;if(!s||s.length===0)return r;for(var o=0;o<s.length;o++)if((s.start(o)<=this.currentTime||s.start(o)<.1)&&s.end(o)>=this.currentTime)return{start:s.start(o),end:s.end(o)};return r}},{key:"crossOrigin",get:function(){return this.media?this.media.crossOrigin:""},set:function(r){this.media&&(this.media.crossOrigin=r)}},{key:"currentSrc",get:function(){return this.media?this.media.currentSrc:""},set:function(r){this.media&&(this.media.currentSrc=r)}},{key:"currentTime",get:function(){return this.media?this.media.currentTime!==void 0?this.media.currentTime:this._currentTime:0},set:function(r){this.media&&(this.media.currentTime=r)}},{key:"defaultMuted",get:function(){return this.media?this.media.defaultMuted:!1},set:function(r){this.media&&(this.media.defaultMuted=r)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return this.media?this.media.ended:!1}},{key:"error",get:function(){return this.media.error}},{key:"errorNote",get:function(){var r=this.media.error;if(!r)return"";var s=["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"];return s[this.media.error.code-1]}},{key:"loop",get:function(){return this.media?this.media.loop:!1},set:function(r){this.media&&(this.media.loop=r)}},{key:"muted",get:function(){return this.media?this.media.muted:!1},set:function(r){!this.media||this.media.muted===r||(this._lastMuted=this.media.muted,this.media.muted=r)}},{key:"networkState",get:function(){return this.media.networkStat}},{key:"paused",get:function(){return this.media?this.media.paused:!0}},{key:"playbackRate",get:function(){return this.media?this.media.playbackRate:0},set:function(r){!this.media||r===1/0||(this.media.defaultPlaybackRate=r,this.media.playbackRate=r)}},{key:"played",get:function(){return this.media?this.media.played:null}},{key:"preload",get:function(){return this.media?this.media.preload:!1},set:function(r){this.media&&(this.media.preload=r)}},{key:"readyState",get:function(){return this.media.readyState}},{key:"seekable",get:function(){return this.media?this.media.seekable:!1}},{key:"seeking",get:function(){return this.media?this.media.seeking:!1}},{key:"src",get:function(){return this.media?this.media.src:""},set:function(r){if(this.media){if(this.emit(up,r),this.emit(nc),this._currentTime=0,this._duration=0,/^blob/.test(this.media.currentSrc)||/^blob/.test(this.media.src)){this.onWaiting();return}this._detachSourceEvents(this.media),k.typeOf(r)==="Array"?this._attachSourceEvents(this.media,r):r?this.media.src=r:this.media.removeAttribute("src"),this.load()}}},{key:"volume",get:function(){return this.media?this.media.volume:0},set:function(r){r===1/0||!this.media||(this.media.volume=r)}},{key:"addInnerOP",value:function(r){this._internalOp[r]=!0}},{key:"removeInnerOP",value:function(r){delete this._internalOp[r]}},{key:"emit",value:function(r,s){for(var o,a=arguments.length,l=new Array(a>2?a-2:0),u=2;u<a;u++)l[u-2]=arguments[u];(o=Ee(ke(t.prototype),"emit",this)).call.apply(o,[this,r,s].concat(l))}},{key:"on",value:function(r,s){for(var o,a=arguments.length,l=new Array(a>2?a-2:0),u=2;u<a;u++)l[u-2]=arguments[u];(o=Ee(ke(t.prototype),"on",this)).call.apply(o,[this,r,s].concat(l))}},{key:"once",value:function(r,s){for(var o,a=arguments.length,l=new Array(a>2?a-2:0),u=2;u<a;u++)l[u-2]=arguments[u];(o=Ee(ke(t.prototype),"once",this)).call.apply(o,[this,r,s].concat(l))}},{key:"off",value:function(r,s){for(var o,a=arguments.length,l=new Array(a>2?a-2:0),u=2;u<a;u++)l[u-2]=arguments[u];(o=Ee(ke(t.prototype),"off",this)).call.apply(o,[this,r,s].concat(l))}},{key:"offAll",value:function(){Ee(ke(t.prototype),"removeAllListeners",this).call(this)}}]),t}(G2),hM=function(){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};ge(this,i),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=e}return me(i,[{key:"openDB",value:function(t){var n=this,r=this,s=this.myDB.version||1,o=r.indexedDB.open(r.myDB.name,s);o.onerror=function(a){},o.onsuccess=function(a){n.myDB.db=a.target.result,t.call(r)},o.onupgradeneeded=function(a){var l=a.target.result;a.target.transaction,l.objectStoreNames.contains(r.myDB.ojstore.name)||l.createObjectStore(r.myDB.ojstore.name,{keyPath:r.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){var t=this;t.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(t,n){for(var r=this.myDB.db.transaction(t,"readwrite").objectStore(t),s,o=0;o<n.length;o++)s=r.add(n[o]),s.onerror=function(){},s.onsuccess=function(){}}},{key:"putData",value:function(t,n){for(var r=this.myDB.db.transaction(t,"readwrite").objectStore(t),s,o=0;o<n.length;o++)s=r.put(n[o]),s.onerror=function(){},s.onsuccess=function(){}}},{key:"getDataByKey",value:function(t,n,r){var s=this,o=this.myDB.db.transaction(t,"readwrite").objectStore(t),a=o.get(n);a.onerror=function(){r.call(s,null)},a.onsuccess=function(l){var u=l.target.result;r.call(s,u)}}},{key:"deleteData",value:function(t,n){var r=this.myDB.db.transaction(t,"readwrite").objectStore(t);r.delete(n)}},{key:"clearData",value:function(t){var n=this.myDB.db.transaction(t,"readwrite").objectStore(t);n.clear()}}]),i}(),Mx=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],Fx=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],Nx=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],Hs="data-xgplayerid";function Qc(i,e,t){for(var n=arguments.length,r=new Array(n>3?n-3:0),s=3;s<n;s++)r[s-3]=arguments[s];var o=e.call.apply(e,[i].concat(r));!t||typeof t!="function"||(o&&o.then?o.then(function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];t.call.apply(t,[i].concat(l))}):t.call.apply(t,[i].concat(r)))}function Xf(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{pre:null,next:null};return this.__hooks||(this.__hooks={}),!this.__hooks[i]&&(this.__hooks[i]=null),(function(){var n=arguments,r=this;if(t.pre)try{var s;(s=t.pre).call.apply(s,[this].concat(Array.prototype.slice.call(arguments)))}catch(l){throw l.message="[pluginName: ".concat(this.pluginName,":").concat(i,":pre error] >> ").concat(l.message),l}if(this.__hooks&&this.__hooks[i])try{var o,a=(o=this.__hooks[i]).call.apply(o,[this,this].concat(Array.prototype.slice.call(arguments)));a?a.then?a.then(function(l){l!==!1&&Qc.apply(void 0,[r,e,t.next].concat(ys(n)))}).catch(function(l){throw l}):Qc.apply(void 0,[this,e,t.next].concat(Array.prototype.slice.call(arguments))):a===void 0&&Qc.apply(void 0,[this,e,t.next].concat(Array.prototype.slice.call(arguments)))}catch(l){throw l.message="[pluginName: ".concat(this.pluginName,":").concat(i,"] >> ").concat(l.message),l}else Qc.apply(void 0,[this,e,t.next].concat(Array.prototype.slice.call(arguments)))}).bind(this)}function zf(i,e){var t=this.__hooks;if(t)return t.hasOwnProperty(i)?(t&&(t[i]=e),!0):(console.warn("has no supported hook which name [".concat(i,"]")),!1)}function Wf(i,e){var t=this.__hooks;t&&delete t[i]}function Qx(i){if(!(!this.plugins||!this.plugins[i.toLowerCase()])){for(var e=this.plugins[i.toLowerCase()],t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.useHooks&&e.useHooks.apply(e,n)}}function Bx(i){if(!(!this.plugins||!this.plugins[i.toLowerCase()])){var e=this.plugins[i.toLowerCase()];if(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.removeHooks&&e.removeHooks.apply(e,n)}}}function oA(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];i.__hooks={},e&&e.map(function(t){i.__hooks[t]=null}),Object.defineProperty(i,"hooks",{get:function(){return i.__hooks&&Object.keys(i.__hooks).map(function(n){if(i.__hooks[n])return n})}})}function aA(i){i.__hooks=null}function oa(i,e,t){for(var n=arguments.length,r=new Array(n>3?n-3:0),s=3;s<n;s++)r[s-3]=arguments[s];if(i.__hooks&&i.__hooks[e]){var o,a=(o=i.__hooks[e]).call.apply(o,[i,i].concat(r));if(a&&a.then)a.then(function(l){return l===!1?null:t.call.apply(t,[i,i].concat(r))}).catch(function(l){console.warn("[runHooks]".concat(e," reject"),l.message)});else if(a!==!1)return t.call.apply(t,[i,i].concat(r))}else return t.call.apply(t,[i,i].concat(r))}function Wp(i,e){Qe.logError("[".concat(i,"] event or callback cant be undefined or null when call ").concat(e))}var Ts=function(){function i(e){ge(this,i),k.checkIsFunction(this.beforeCreate)&&this.beforeCreate(e),oA(this),this.__args=e,this.__events={},this.__onceEvents={},this.config=e.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(e)}return me(i,[{key:"beforeCreate",value:function(t){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(t){this.player=t.player,this.playerConfig=t.player&&t.player.config,this.pluginName=t.pluginName?t.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=t.player&&t.player.logger}},{key:"updateLang",value:function(t){t||(t=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var t=k.checkTouchSupport()?"touch":"mouse";return this.playerConfig&&(this.playerConfig.domEventType==="touch"||this.playerConfig.domEventType==="mouse")&&(t=this.playerConfig.domEventType),t}},{key:"on",value:function(t,n){var r=this;if(!t||!n||!this.player){Wp(this.pluginName,"plugin.on(event, callback)");return}typeof t=="string"?(this.__events[t]=n,this.player.on(t,n)):Array.isArray(t)&&t.forEach(function(s){r.__events[s]=n,r.player.on(s,n)})}},{key:"once",value:function(t,n){var r=this;if(!t||!n||!this.player){Wp(this.pluginName,"plugin.once(event, callback)");return}typeof t=="string"?(this.__onceEvents[t]=n,this.player.once(t,n)):Array.isArray(t)&&t.forEach(function(s){r.__onceEvents[s]=n,r.player.once(t,n)})}},{key:"off",value:function(t,n){var r=this;if(!t||!n||!this.player){Wp(this.pluginName,"plugin.off(event, callback)");return}typeof t=="string"?(delete this.__events[t],this.player.off(t,n)):Array.isArray(t)&&t.forEach(function(s){delete r.__events[t],r.player.off(s,n)})}},{key:"offAll",value:function(){var t=this;["__events","__onceEvents"].forEach(function(n){Object.keys(t[n]).forEach(function(r){t[n][r]&&t.off(r,t[n][r]),r&&delete t[n][r]})}),this.__events={},this.__onceEvents={}}},{key:"emit",value:function(t){var n;if(this.player){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];(n=this.player).emit.apply(n,[t].concat(s))}}},{key:"emitUserAction",value:function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.player){var s=St(St({},r),{},{pluginName:this.pluginName});this.player.emitUserAction(t,n,s)}}},{key:"hook",value:function(t,n){return Xf.call.apply(Xf,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(t,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];return zf.call.apply(zf,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(t,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];return Wf.call.apply(Wf,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(this.player)return r&&(n.pluginName=r),this.player.registerPlugin({plugin:t,options:n})}},{key:"getPlugin",value:function(t){return this.player?this.player.getPlugin(t):null}},{key:"__destroy",value:function(){var t=this,n=this.player,r=this.pluginName;this.offAll(),k.clearAllTimers(this),k.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map(function(s){t[s]=null}),n.unRegisterPlugin(r),aA(this)}}],[{key:"defineGetterOrSetter",value:function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&Object.defineProperty(t,r,n[r])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}]),i}(),fM=9;if(typeof Element<"u"&&!Element.prototype.matches){var Lo=Element.prototype;Lo.matches=Lo.matchesSelector||Lo.mozMatchesSelector||Lo.msMatchesSelector||Lo.oMatchesSelector||Lo.webkitMatchesSelector}function dM(i,e){for(;i&&i.nodeType!==fM;){if(typeof i.matches=="function"&&i.matches(e))return i;i=i.parentNode}}var pM=dM,gM=pM;function qp(i,e,t,n,r){var s=vM.apply(this,arguments);return i.addEventListener(t,s,r),{destroy:function(){i.removeEventListener(t,s,r)}}}function mM(i,e,t,n,r){return typeof i.addEventListener=="function"?qp.apply(null,arguments):typeof t=="function"?qp.bind(null,document).apply(null,arguments):(typeof i=="string"&&(i=document.querySelectorAll(i)),Array.prototype.map.call(i,function(s){return qp(s,e,t,n,r)}))}function vM(i,e,t,n){return function(r){r.delegateTarget=gM(r.target,e),r.delegateTarget&&n.call(i,r)}}var OM=mM;const Ux=op(OM);var yM={CONTROLS:"controls",ROOT:"root"},ht={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"};function Yp(i){return i?i.indexOf&&/^(?:http|data:|\/)/.test(i):!1}function bM(i,e){return vi(i)==="object"&&i.class&&typeof i.class=="string"?"".concat(e," ").concat(i.class):e}function xM(i,e){return vi(i)==="object"&&i.attr&&vi(i.attr)==="object"&&Object.keys(i.attr).map(function(t){e[t]=i.attr[t]}),e}function Vx(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",s=null;if(i instanceof window.Element)return k.addClass(i,t),Object.keys(n).map(function(o){i.setAttribute(o,n[o])}),i;if(Yp(i)||Yp(i.url))return n.src=Yp(i)?i:i.url||"",s=k.createDom(i.tag||"img","",n,"xg-img ".concat(t)),s;if(typeof i=="function")try{return s=i(),s instanceof window.Element?(k.addClass(s,t),Object.keys(n).map(function(o){s.setAttribute(o,n[o])}),s):(Qe.logWarn("warn>>icons.".concat(e," in config of plugin named [").concat(r,"] is a function mast return an Element Object")),null)}catch(o){return Qe.logError("Plugin named [".concat(r,"]:createIcon"),o),null}return typeof i=="string"?k.createDomFromHtml(i,n,t):(Qe.logWarn("warn>>icons.".concat(e," in config of plugin named [").concat(r,"] is invalid")),null)}function SM(i,e){var t=e.config.icons||e.playerConfig.icons;Object.keys(i).map(function(n){var r=i[n],s=r&&r.class?r.class:"",o=r&&r.attr?r.attr:{},a=null;t&&t[n]&&(s=bM(t[n],s),o=xM(t[n],o),a=Vx(t[n],n,s,o,e.pluginName)),!a&&r&&(a=Vx(r.icon?r.icon:r,o,s,{},e.pluginName)),e.icons[n]=a})}function kM(i,e){Object.keys(i).map(function(t){Object.defineProperty(e.langText,t,{get:function(){var r=e.lang,s=e.i18n;return s[t]?s[t]:i[t]&&i[t][r]||""}})})}var Re=function(i){Ce(t,i);var e=Ae(t);function t(){var n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ge(this,t),n=e.call(this,r),n.__delegates=[],n}return me(t,[{key:"__init",value:function(r){if(Ee(ke(t.prototype),"__init",this).call(this,r),!!r.root){var s=r.root,o=null;this.icons={},this.root=null,this.parent=null;var a=this.registerIcons()||{};SM(a,this),this.langText={};var l=this.registerLanguageTexts()||{};kM(l,this);var u="";try{u=this.render()}catch(f){throw Qe.logError("Plugin:".concat(this.pluginName,":render"),f),new Error("Plugin:".concat(this.pluginName,":render:").concat(f.message))}if(u)o=t.insert(u,s,r.index),o.setAttribute("data-index",r.index);else if(r.tag)o=k.createDom(r.tag,"",r.attr,r.name),o.setAttribute("data-index",r.index),s.appendChild(o);else return;this.root=o,this.parent=s;var c=this.config.attr||{},h=this.config.style||{};this.setAttr(c),this.setStyle(h),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var r=this;if(this.root){this._children=[];var s=this.children();s&&vi(s)==="object"&&Object.keys(s).length>0&&Object.keys(s).map(function(o){var a=o,l=s[a],u={root:r.root},c,h;typeof l=="function"?(c=r.config[a]||{},h=l):vi(l)==="object"&&typeof l.plugin=="function"&&(c=l.options?k.deepCopy(r.config[a]||{},l.options):r.config[a]||{},h=l.plugin),u.config=c,c.index!==void 0&&(u.index=c.index),c.root&&(u.root=c.root),r.registerPlugin(h,u,a)})}}},{key:"updateLang",value:function(r){r||(r=this.lang);function s(u,c){for(var h=0;h<u.children.length;h++)u.children[h].children.length>0?s(u.children[h],c):c(u.children[h])}var o=this.root,a=this.i18n,l=this.langText;o&&s(o,function(u){var c=u.getAttribute&&u.getAttribute("lang-key");if(c){var h=a[c.toUpperCase()]||l[c];h&&(u.innerHTML=typeof h=="function"?h(r):h)}})}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",o=this.i18n||{},a=this.langText;r.setAttribute&&r.setAttribute("lang-key",s);var l=o[s]||a[s]||"";l&&(r.innerHTML=l)}},{key:"plugins",value:function(){return this._children}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";s.root=s.root||this.root;var a=Ee(ke(t.prototype),"registerPlugin",this).call(this,r,s,o);return this._children.push(a),a}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(r){if(this.root)return this.root.querySelector(r)}},{key:"bind",value:function(r,s,o){var a=this;if(arguments.length<3&&typeof s=="function")Array.isArray(r)?r.forEach(function(u){a.bindEL(u,s)}):this.bindEL(r,s);else{var l=t.delegate.call(this,this.root,r,s,o);this.__delegates=this.__delegates.concat(l)}}},{key:"unbind",value:function(r,s){var o=this;if(arguments.length<3&&typeof s=="function")Array.isArray(r)?r.forEach(function(u){o.unbindEL(u,s)}):this.unbindEL(r,s);else for(var a="".concat(r,"_").concat(s),l=0;l<this.__delegates.length;l++)if(this.__delegates[l].key===a){this.__delegates[l].destroy(),this.__delegates.splice(l,1);break}}},{key:"setStyle",value:function(r,s){var o=this;if(this.root){if(k.typeOf(r)==="String")return this.root.style[r]=s;k.typeOf(r)==="Object"&&Object.keys(r).map(function(a){o.root.style[a]=r[a]})}}},{key:"setAttr",value:function(r,s){var o=this;if(this.root){if(k.typeOf(r)==="String")return this.root.setAttribute(r,s);k.typeOf(r)==="Object"&&Object.keys(r).map(function(a){o.root.setAttribute(a,r[a])})}}},{key:"setHtml",value:function(r,s){this.root&&(this.root.innerHTML=r,typeof s=="function"&&s())}},{key:"bindEL",value:function(r,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(r)in this.root&&typeof s=="function"&&this.root.addEventListener(r,s,o)}},{key:"unbindEL",value:function(r,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(r)in this.root&&typeof s=="function"&&this.root.removeEventListener(r,s,o)}},{key:"show",value:function(r){if(this.root){this.root.style.display=r!==void 0?r:"block";var s=window.getComputedStyle(this.root,null),o=s.getPropertyValue("display");if(o==="none")return this.root.style.display="block"}}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(r,s){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!s||!(s instanceof window.Element))return null;try{return typeof r=="string"?this.find(r).appendChild(s):r.appendChild(s)}catch(o){return Qe.logError("Plugin:appendChild",o),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var r=this,s=this.player;this.__delegates.map(function(o){o.destroy()}),this.__delegates=[],this._children instanceof Array&&(this._children.map(function(o){s.unRegisterPlugin(o.pluginName)}),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),Ee(ke(t.prototype),"__destroy",this).call(this),this.icons={},["root","parent"].map(function(o){r[o]=null})}}],[{key:"insert",value:function(r,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=s.children.length,l=Number(o),u=r instanceof window.Node;if(a){for(var c=0,h=null,f="";c<a;c++){h=s.children[c];var d=Number(h.getAttribute("data-index"));if(d>=l){f="beforebegin";break}else d<l&&(f="afterend")}return u?f==="afterend"?s.appendChild(r):s.insertBefore(r,h):h.insertAdjacentHTML(f,r),f==="afterend"?s.children[s.children.length-1]:s.children[c]}else return u?s.appendChild(r):s.insertAdjacentHTML("beforeend",r),s.children[s.children.length-1]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(r,s,o,a){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=[];if(r instanceof window.Node&&typeof a=="function")if(Array.isArray(o))o.forEach(function(h){var f=Ux(r,s,h,a,l);f.key="".concat(s,"_").concat(h),u.push(f)});else{var c=Ux(r,s,o,a,l);c.key="".concat(s,"_").concat(o),u.push(c)}return u}},{key:"ROOT_TYPES",get:function(){return yM}},{key:"POSITIONS",get:function(){return ht}}]),t}(Ts),TM=function(){function i(){var e=this;if(ge(this,i),q(this,"__trigger",function(t){var n=new Date().getTime();e.timeStamp=n;for(var r=0;r<t.length;r++)e.__runHandler(t[r].target)}),this.__handlers=[],this.timeStamp=0,this.observer=null,!!window.ResizeObserver)try{this.observer=new window.ResizeObserver(z5(this.__trigger,100,{trailing:!0})),this.timeStamp=new Date().getTime()}catch(t){console.error(t)}}return me(i,[{key:"addObserver",value:function(t,n){if(this.observer){this.observer&&this.observer.observe(t);for(var r=t.getAttribute(Hs),s=this.__handlers,o=-1,a=0;a<s.length;a++)s[a]&&t===s[a].target&&(o=a);o>-1?this.__handlers[o].handler=n:this.__handlers.push({target:t,handler:n,playerId:r})}}},{key:"unObserver",value:function(t){var n=-1;this.__handlers.map(function(r,s){t===r.target&&(n=s)});try{this.observer&&this.observer.unobserve(t)}catch{}this.observer&&this.observer.unobserve(t),n>-1&&this.__handlers.splice(n,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(t){for(var n=this.__handlers,r=0;r<n.length;r++)if(n[r]&&t===n[r].target){try{n[r].handler(t)}catch(s){console.error(s)}return!0}return!1}}]),i}(),jl=null;function EM(i,e){return jl||(jl=new TM),jl.addObserver(i,e),jl}function wM(i,e){jl.unObserver(i,e)}var Tt={pluginGroup:{},init:function(e){var t=e._pluginInfoId;t||(t=new Date().getTime(),e._pluginInfoId=t),!e.config.closeResizeObserver&&EM(e.root,function(){e.resize()}),Object.keys(this.pluginGroup).length===0&&(e.isUserActive=!0),this.pluginGroup[t]={_player:e,_originalOptions:e.config||{},_plugins:{}}},checkPlayerRoot:function(e){if(this.pluginGroup){for(var t=Object.keys(this.pluginGroup),n=0;n<t.length;n++){var r=this.pluginGroup[t[n]]._player;if(r.root===e)return r}return null}return null},formatPluginInfo:function(e,t){var n=null,r=null;return e.plugin&&typeof e.plugin=="function"?(n=e.plugin,r=e.options):(n=e,r={}),t&&(r.config=t||{}),{PLUFGIN:n,options:r}},checkPluginIfExits:function(e,t){for(var n=0;n<t.length;n++)if(e.toLowerCase()===t[n].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(e,t){for(var n=Object.keys(t),r=null,s=0;s<n.length;s++)if(e.toLowerCase()===n[s].toLowerCase()){r=t[n[s]];break}return k.typeOf(r)==="Object"?{root:r.root,position:r.position}:{}},lazyRegister:function(e,t){var n=this,r=t.timeout||1500;return Promise.race([t.loader().then(function(s){var o;s&&s.__esModule?o=s.default:o=s,n.register(e,o,s.options)}),new Promise(function(s,o){setTimeout(function(){o(new Error("timeout"))},r)})])},register:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!e||!t||typeof t!="function"||t.prototype===void 0)){var r=e._pluginInfoId;if(!(!r||!this.pluginGroup[r])){this.pluginGroup[r]._plugins||(this.pluginGroup[r]._plugins={});var s=this.pluginGroup[r]._plugins,o=this.pluginGroup[r]._originalOptions;n.player=this.pluginGroup[r]._player;var a=n.pluginName||t.pluginName;if(!a)throw new Error("The property pluginName is necessary");if(t.isSupported&&!t.isSupported(e.config.mediaType,e.config.codecType)){console.warn("not supported plugin [".concat(a,"]"));return}n.config||(n.config={});for(var l=Object.keys(o),u=0;u<l.length;u++)if(a.toLowerCase()===l[u].toLowerCase()){var c=o[l[u]];k.typeOf(c)==="Object"?n.config=Object.assign({},n.config,o[l[u]]):k.typeOf(c)==="Boolean"&&(n.config.disable=!c);break}t.defaultConfig&&Object.keys(t.defaultConfig).forEach(function(f){typeof n.config[f]>"u"&&(n.config[f]=t.defaultConfig[f])}),n.root?typeof n.root=="string"&&(n.root=e[n.root]):n.root=e.root,n.index=n.config.index||0;try{s[a.toLowerCase()]&&(this.unRegister(r,a.toLowerCase()),console.warn("the is one plugin with same pluginName [".concat(a,"] exist, destroy the old instance")));var h=new t(n);return s[a.toLowerCase()]=h,s[a.toLowerCase()].func=t,h&&typeof h.afterCreate=="function"&&h.afterCreate(),h}catch(f){throw console.error(f),f}}}},unRegister:function(e,t){e._pluginInfoId&&(e=e._pluginInfoId),t=t.toLowerCase();try{var n=this.pluginGroup[e]._plugins[t];n&&(n.pluginName&&n.__destroy(),delete this.pluginGroup[e]._plugins[t])}catch(r){console.error("[unRegister:".concat(t,"] cgid:[").concat(e,"] error"),r)}},deletePlugin:function(e,t){var n=e._pluginInfoId;n&&this.pluginGroup[n]&&this.pluginGroup[n]._plugins&&delete this.pluginGroup[n]._plugins[t]},getPlugins:function(e){var t=e._pluginInfoId;return t&&this.pluginGroup[t]?this.pluginGroup[t]._plugins:{}},findPlugin:function(e,t){var n=e._pluginInfoId;if(!n||!this.pluginGroup[n])return null;var r=t.toLowerCase();return this.pluginGroup[n]._plugins[r]},beforeInit:function(e){var t=this;function n(r){return!r||!r.then?new Promise(function(s){s()}):r}return new Promise(function(r){if(t.pluginGroup){var s;return e._loadingPlugins&&e._loadingPlugins.length?s=Promise.all(e._loadingPlugins):s=Promise.resolve(),s.then(function(){var o=e._pluginInfoId;if(!t.pluginGroup[o]){r();return}var a=t.pluginGroup[o]._plugins,l=[];Object.keys(a).forEach(function(u){if(a[u]&&a[u].beforePlayerInit)try{var c=a[u].beforePlayerInit();l.push(n(c))}catch(h){throw l.push(n(null)),h}}),Promise.all([].concat(l)).then(function(){r()}).catch(function(u){console.error(u),r()})})}})},afterInit:function(e){var t=e._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var n=this.pluginGroup[t]._plugins;Object.keys(n).forEach(function(r){n[r]&&n[r].afterPlayerInit&&n[r].afterPlayerInit()})}},setLang:function(e,t){var n=t._pluginInfoId;if(!(!n||!this.pluginGroup[n])){var r=this.pluginGroup[n]._plugins;Object.keys(r).forEach(function(s){if(r[s].updateLang)r[s].updateLang(e);else try{r[s].lang=e}catch{console.warn("".concat(s," setLang"))}})}},reRender:function(e){var t=this,n=e._pluginInfoId;if(!(!n||!this.pluginGroup[n])){var r=[],s=this.pluginGroup[n]._plugins;Object.keys(s).forEach(function(o){o!=="controls"&&s[o]&&(r.push({plugin:s[o].func,options:s[o].__args}),t.unRegister(n,o))}),r.forEach(function(o){t.register(e,o.plugin,o.options)})}},onPluginsReady:function(e){var t=e._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var n=this.pluginGroup[t]._plugins||{};Object.keys(n).forEach(function(r){n[r].onPluginsReady&&typeof n[r].onPluginsReady=="function"&&n[r].onPluginsReady()})}},setCurrentUserActive:function(e,t){if(this.pluginGroup[e]){if(!t)return this.pluginGroup[e]._player.isUserActive=t,e;for(var n=Object.keys(this.pluginGroup),r=0;r<n.length;r++){var s=this.pluginGroup[n[r]];s&&s._player&&(this.pluginGroup[n[r]]._player.isUserActive=!1)}return this.pluginGroup[e]._player.isUserActive=t,e}},getCurrentUseActiveId:function(){if(this.pluginGroup){for(var e=Object.keys(this.pluginGroup),t=0;t<e.length;t++){var n=this.pluginGroup[e[t]];if(n&&n._player&&n._player.isUserActive)return e[t]}return null}},destroy:function(e){var t=e._pluginInfoId;if(this.pluginGroup[t]){wM(e.root);for(var n=this.pluginGroup[t]._plugins,r=0,s=Object.keys(n);r<s.length;r++){var o=s[r];this.unRegister(t,o)}var a=e.isUseActive;if(delete this.pluginGroup[t],delete e._pluginInfoId,a){var l=Object.keys(this.pluginGroup);l.length>0&&this.setCurrentUserActive(l[l.length-1],!0)}}}},K={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-active",INACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",INNER_FULLSCREEN:"xgplayer-fullscreen-inner",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",CONTROLS_AUTOHIDE:"controls-autohide",TOP_BAR_AUTOHIDE:"top-bar-autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function Zx(){return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},ignores:[],whitelist:[],inactive:3e3,lang:W5(),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}}}var _M=function(e,t){var n,r,s;t.preset&&t.options?s=new t.preset(t.options,e.config):s=new t({},e.config);var o=s,a=o.plugins,l=a===void 0?[]:a,u=o.ignores,c=u===void 0?[]:u,h=o.icons,f=h===void 0?{}:h,d=o.i18n,p=d===void 0?[]:d;e.config.plugins||(e.config.plugins=[]),e.config.ignores||(e.config.ignores=[]),(n=e.config.plugins).push.apply(n,ys(l)),(r=e.config.ignores).push.apply(r,ys(c)),Object.keys(f).map(function(m){e.config.icons[m]||(e.config.icons[m]=f[m])});var g=e.config.i18n||[];p.push.apply(p,ys(g)),e.config.i18n=p},CM=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"onMouseEnter",function(a){var l=V(n),u=l.player,c=l.playerConfig;c.closeControlsBlur&&u.focus({autoHide:!1})}),q(V(n),"onMouseLeave",function(){var a=V(n),l=a.player;l.focus()}),n}return me(t,[{key:"beforeCreate",value:function(r){!r.config.mode&&Le.device==="mobile"&&(r.config.mode="flex"),r.player.config.marginControls&&(r.config.autoHide=!1)}},{key:"afterCreate",value:function(){var r=this,s=this.config,o=s.disable,a=s.height,l=s.mode;if(!o){l==="flex"&&this.player.addClass(K.FLEX_CONTROLS);var u={height:"".concat(a,"px")};Object.keys(u).map(function(h){r.root.style[h]=u[h]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(jf,function(h){h?k.addClass(r.root,"mini-controls"):k.removeClass(r.root,"mini-controls")});var c=this.playerConfig.isMobileSimulateMode;Le.device!=="mobile"&&c!=="mobile"&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&k.addClass(this.root,K.CONTROLS_AUTOHIDE)}},{key:"pauseAutoHide",value:function(){k.removeClass(this.root,K.CONTROLS_AUTOHIDE)}},{key:"show",value:function(){k.addClass(this.root,"show")}},{key:"hide",value:function(){k.removeClass(this.root,"show")}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;if(this.root){var a=r.defaultConfig||{};if(!s.root){var l=s.position?s.position:s.config&&s.config.position?s.config.position:a.position;switch(l){case ht.CONTROLS_LEFT:s.root=this.left;break;case ht.CONTROLS_RIGHT:s.root=this.right;break;case ht.CONTROLS_CENTER:s.root=this.center;break;case ht.CONTROLS:s.root=this.root;break;default:s.root=this.left}return Ee(ke(t.prototype),"registerPlugin",this).call(this,r,s,o)}}}},{key:"destroy",value:function(){Le.device!=="mobile"&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var r=this.config,s=r.mode,o=r.autoHide,a=r.initShow,l=r.disable;if(!l){var u=k.classNames({"xgplayer-controls":!0},{"flex-controls":s==="flex"},{"bottom-controls":s==="bottom"},q({},K.CONTROLS_AUTOHIDE,o),{"xgplayer-controls-initshow":a||!o});return'<xg-controls class="'.concat(u,`" unselectable="on" onselectstart="return false">
    <xg-inner-controls class="xg-inner-controls xg-pos">
      <xg-left-grid class="xg-left-grid">
      </xg-left-grid>
      <xg-center-grid class="xg-center-grid"></xg-center-grid>
      <xg-right-grid class="xg-right-grid">
      </xg-right-grid>
    </xg-inner-controls>
    </xg-controls>`)}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}]),t}(Re),AM={LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}},Bi={lang:{},langKeys:[],textKeys:[]};function ku(i,e){return Object.keys(e).forEach(function(t){var n=k.typeOf(e[t]),r=k.typeOf(i[t]);if(n==="Array"){var s;r!=="Array"&&(i[t]=[]),(s=i[t]).push.apply(s,ys(e[t]))}else n==="Object"?(r!=="Object"&&(i[t]={}),ku(i[t],e[t])):i[t]=e[t]}),i}function lA(){Object.keys(Bi.lang.en).map(function(i){Bi.textKeys[i]=i})}function PM(i,e){var t=[];if(e||(e=Bi),!!e.lang){k.typeOf(i)!=="Array"?t=Object.keys(i).map(function(s){var o=s==="zh"?"zh-cn":s;return{LANG:o,TEXT:i[s]}}):t=i;var n=e,r=n.lang;t.map(function(s){s.LANG==="zh"&&(s.LANG="zh-cn"),r[s.LANG]?ku(r[s.LANG]||{},s.TEXT||{}):sy(s,e)}),lA()}}function sy(i,e){var t=i.LANG;if(e||(e=Bi),!!e.lang){var n=i.TEXT||{};t==="zh"&&(t="zh-cn"),e.lang[t]?ku(e.lang[t],n):(e.langKeys.push(t),e.lang[t]=n),lA()}}function RM(i){var e,t={lang:{},langKeys:[],textKeys:{},pId:i};return ku(t.lang,Bi.lang),(e=t.langKeys).push.apply(e,ys(Bi.langKeys)),ku(t.textKeys,Bi.textKeys),t}sy(AM);var aa={get textKeys(){return Bi.textKeys},get langKeys(){return Bi.langKeys},get lang(){var i={};return Bi.langKeys.map(function(e){i[e]=Bi.lang[e]}),Bi.lang["zh-cn"]&&(i.zh=Bi.lang["zh-cn"]||{}),i},extend:PM,use:sy,init:RM},Ge={INITIAL:1,READY:2,ATTACHING:3,ATTACHED:4,NOTALLOW:5,RUNNING:6,ENDED:7,DESTROYED:8},jx=["ERROR","INITIAL","READY","ATTACHING","ATTACHED","NOTALLOW","RUNNING","ENDED","DESTROYED"],LM=["play","pause","replay","retry"],Gx=0,Hx=0,oy=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;ge(this,t);var s=k.deepMerge(Zx(),n);r=e.call(this,s),q(V(r),"canPlayFunc",function(){if(r.config){var p=r.config,g=p.autoplay,m=p.startTime,v=p.defaultPlaybackRate;Qe.logInfo("player","canPlayFunc, startTime",m),m&&(r.currentTime=m>r.duration?r.duration:m,r.config.startTime=0),r.playbackRate=v,(g||r._useAutoplay)&&r.mediaPlay(),r.off(Dn,r.canPlayFunc),r.removeClass(K.ENTER)}}),q(V(r),"onFullscreenChange",function(p,g){var m=function(){k.setTimeout(V(r),function(){r.resize()},100)},v=k.getFullScreenEl();r._fullActionFrom?r._fullActionFrom="":r.emit(Hf,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:r.currentTime,duration:r.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var O=q5(v,r.playerId,Hs);if(g||v&&(v===r._fullscreenEl||O))m(),!r.config.closeFocusVideoFocus&&r.media.focus(),r.fullscreen=!0,r.changeFullStyle(r.root,v,K.FULLSCREEN),r.emit(is,!0,r._fullScreenOffset),r.cssfullscreen&&r.exitCssFullscreen();else if(r.fullscreen){m();var y=V(r),x=y._fullScreenOffset,b=y.config;b.needFullscreenScroll?(window.scrollTo(x.left,x.top),k.setTimeout(V(r),function(){r.fullscreen=!1,r._fullScreenOffset=null},100)):(!r.config.closeFocusVideoFocus&&r.media.focus(),r.fullscreen=!1,r._fullScreenOffset=null),r.cssfullscreen?r.removeClass(K.FULLSCREEN):r.recoverFullStyle(r.root,r._fullscreenEl,K.FULLSCREEN),r._fullscreenEl=null,r.emit(is,!1)}}),q(V(r),"_onWebkitbeginfullscreen",function(p){r._fullscreenEl=r.media,r.onFullscreenChange(p,!0)}),q(V(r),"_onWebkitendfullscreen",function(p){r.onFullscreenChange(p,!1)}),oA(V(r),LM),r.config=s,r._pluginInfoId=k.generateSessionId(),j5(V(r));var o=r.constructor.defaultPreset;if(r.config.presets.length){var a=r.config.presets.indexOf("default");a>=0&&o&&(r.config.presets[a]=o)}else o&&r.config.presets.push(o);r.userTimer=null,r.waitTimer=null,r._state=Ge.INITIAL,r.isError=!1,r._hasStart=!1,r.isSeeking=!1,r.isCanplay=!1,r._useAutoplay=!1,r.rotateDeg=0,r.isActive=!1,r.fullscreen=!1,r.cssfullscreen=!1,r.isRotateFullscreen=!1,r._fullscreenEl=null,r._cssfullscreenEl=null,r.curDefinition=null,r._orgCss="",r._fullScreenOffset=null,r._videoHeight=0,r._videoWidth=0,r._accPlayed={t:0,acc:0,loopAcc:0},r.innerContainer=null,r.controls=null,r.topBar=null,r.root=null,r.__i18n=aa.init(r._pluginInfoId),Le.os.isAndroid&&Le.osVersion>0&&Le.osVersion<6&&(r.config.autoplay=!1),r.database=new hM,r.isUserActive=!1;var l=r._initDOM();if(!l)return console.error(new Error("can't find the dom which id is ".concat(r.config.id," or this.config.el does not exist"))),XO(r);var u=r.config,c=u.definition,h=c===void 0?{}:c,f=u.url;if(!f&&h.list&&h.list.length>0){var d=h.list.find(function(p){return p.definition&&p.definition===h.defaultDefinition});d||(h.defaultDefinition=h.list[0].definition,d=h.list[0]),r.config.url=d.url,r.curDefinition=d}return r._bindEvents(),r._registerPresets(),r._registerPlugins(),Tt.onPluginsReady(V(r)),r.getInitDefinition(),r.setState(Ge.READY),k.setTimeout(V(r),function(){r.emit(JO)},0),r.onReady&&r.onReady(),(r.config.videoInit||r.config.autoplay)&&(!r.hasStart||r.state<Ge.ATTACHED)&&r.start(),r}return me(t,[{key:"_initDOM",value:function(){var r=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var s=this.config.el;if(s&&s.nodeType===1)this.root=s;else return this.emit(ic,new zO("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),console.error("this.confg.id or this.config.el can't be empty"),!1}var o=Tt.checkPlayerRoot(this.root);o&&(Qe.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),o.destroy()),this.root.setAttribute(Hs,this.playerId),Tt.init(this),this._initBaseDoms();var a=this.constructor.XgVideoProxy;if(a&&this.mediaConfig.mediaType===a.mediaType){var l=this.innerContainer||this.root;this.detachVideoEvents(this.media);var u=new a(l,this.config,this.mediaConfig);this.attachVideoEvents(u),this.media=u}if(this.media.setAttribute(Hs,this.playerId),this.config.controls){var c=this.config.controls.root||null,h=Tt.register(this,CM,{root:c});this.controls=h}var f=this.config.isMobileSimulateMode==="mobile"?"mobile":Le.device;if(this.addClass("".concat(K.DEFAULT," ").concat(K.INACTIVE," xgplayer-").concat(f," ").concat(this.config.controls?"":K.NO_CONTROLS)),this.config.autoplay?this.addClass(K.ENTER):this.addClass(K.NO_START),this.config.fluid){var d=this.config,p=d.width,g=d.height;(typeof p!="number"||typeof g!="number")&&(p=600,g=337.5);var m={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(g*100/p,"%")};Object.keys(m).forEach(function(v){r.root.style[v]=m[v]})}else["width","height"].forEach(function(v){r.config[v]&&(typeof r.config[v]!="number"?r.root.style[v]=r.config[v]:r.root.style[v]="".concat(r.config[v],"px"))});return!0}},{key:"_initBaseDoms",value:function(){this.topBar=null,this.leftBar=null,this.rightBar=null,this.config.marginControls&&(this.innerContainer=k.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer))}},{key:"_bindEvents",value:function(){var r=this;["focus","blur"].forEach(function(s){r.on(s,r["on"+s.charAt(0).toUpperCase()+s.slice(1)])}),Mx.forEach(function(s){document&&document.addEventListener(s,r.onFullscreenChange)}),Le.os.isIos&&(this.media.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once(co,this.resize),this.playFunc=function(){r.config.closeFocusVideoFocus||r.media.focus()},this.once(dn,this.playFunc)}},{key:"_unbindEvents",value:function(){var r=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),Mx.forEach(function(s){document.removeEventListener(s,r.onFullscreenChange)}),this.playFunc&&this.off(dn,this.playFunc),this.off(Dn,this.canPlayFunc),this.media.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_startInit",value:function(r){var s=this;if(this.media&&!((!r||r===""||k.typeOf(r)==="Array"&&r.length===0)&&(r="",this.emit(Y2),Qe.logWarn("config.url is null, please get url and run player._startInit(url)"),this.config.nullUrlStart))){this._detachSourceEvents(this.media),k.typeOf(r)==="Array"&&r.length>0?this._attachSourceEvents(this.media,r):!this.media.src||this.media.src!==r?this.media.src=r:r||this.media.removeAttribute("src"),k.typeOf(this.config.volume)==="Number"&&(this.volume=this.config.volume);var o=this.innerContainer?this.innerContainer:this.root;this.media instanceof window.Element&&!o.contains(this.media)&&o.insertBefore(this.media,o.firstChild);var a=this.media.readyState;Qe.logInfo("_startInit readyState",a),this.config.autoplay&&(!(/^blob/.test(this.media.currentSrc)||/^blob/.test(this.media.src))&&this.load(),(Le.os.isIpad||Le.os.isPhone)&&this.mediaPlay()),a>=2?this.canPlayFunc():this.once(Dn,this.canPlayFunc),(!this.hasStart||this.state<Ge.ATTACHED)&&Tt.afterInit(this),this.hasStart=!0,this.setState(Ge.ATTACHED),k.setTimeout(this,function(){s.emit(lp)},0)}}},{key:"_registerPlugins",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._loadingPlugins=[];var o=this.config.ignores||[],a=this.config.plugins||[],l=this.config.i18n||[];s&&aa.extend(l,this.__i18n);var u=o.join("||").toLowerCase().split("||"),c=this.plugins;a.forEach(function(h){try{var f=h.plugin?h.plugin.pluginName:h.pluginName;if(f&&u.indexOf(f.toLowerCase())>-1)return null;if(!s&&c[f.toLowerCase()])return;if(h.lazy&&h.loader){var d=Tt.lazyRegister(r,h);h.forceBeforeInit&&(d.then(function(){r._loadingPlugins.splice(r._loadingPlugins.indexOf(d),1)}).catch(function(p){Qe.logError("_registerPlugins:loadingPlugin",p),r._loadingPlugins.splice(r._loadingPlugins.indexOf(d),1)}),r._loadingPlugins.push(d));return}return r.registerPlugin(h)}catch(p){Qe.logError("_registerPlugins:",p)}})}},{key:"_registerPresets",value:function(){var r=this;this.config.presets.forEach(function(s){_M(r,s)})}},{key:"_getRootByPosition",value:function(r){var s=null;switch(r){case ht.ROOT_RIGHT:this.rightBar||(this.rightBar=k.createPositionBar("xg-right-bar",this.root)),s=this.rightBar;break;case ht.ROOT_LEFT:this.leftBar||(this.leftBar=k.createPositionBar("xg-left-bar",this.root)),s=this.leftBar;break;case ht.ROOT_TOP:this.topBar||(this.topBar=k.createPositionBar("xg-top-bar",this.root),this.config.topBarAutoHide&&k.addClass(this.topBar,K.TOP_BAR_AUTOHIDE)),s=this.topBar;break;default:s=this.innerContainer||this.root;break}return s}},{key:"registerPlugin",value:function(r,s){var o=Tt.formatPluginInfo(r,s),a=o.PLUFGIN,l=o.options,u=this.config.plugins,c=Tt.checkPluginIfExits(a.pluginName,u);!c&&u.push(a);var h=Tt.getRootByConfig(a.pluginName,this.config);h.root&&(l.root=h.root),h.position&&(l.position=h.position);var f=l.position?l.position:l.config&&l.config.position||a.defaultConfig&&a.defaultConfig.position;return!l.root&&typeof f=="string"&&f.indexOf("controls")>-1?this.controls&&this.controls.registerPlugin(a,l,a.pluginName):(l.root||(l.root=this._getRootByPosition(f)),Tt.register(this,a,l))}},{key:"deregister",value:function(r){typeof r=="string"?Tt.unRegister(this,r):r instanceof Ts&&Tt.unRegister(this,r.pluginName)}},{key:"unRegisterPlugin",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.deregister(r),s&&this.removePluginFromConfig(r)}},{key:"removePluginFromConfig",value:function(r){var s;if(typeof r=="string"?s=r:r instanceof Ts&&(s=r.pluginName),!!s)for(var o=this.config.plugins.length-1;o>-1;o--){var a=this.config.plugins[o];if(a.pluginName.toLowerCase()===s.toLowerCase()){this.config.plugins.splice(o,1);break}}}},{key:"plugins",get:function(){return Tt.getPlugins(this)}},{key:"getPlugin",value:function(r){var s=Tt.findPlugin(this,r);return s&&s.pluginName?s:null}},{key:"addClass",value:function(r){this.root&&(k.hasClass(this.root,r)||k.addClass(this.root,r))}},{key:"removeClass",value:function(r){this.root&&k.removeClass(this.root,r)}},{key:"hasClass",value:function(r){if(this.root)return k.hasClass(this.root,r)}},{key:"setAttribute",value:function(r,s){this.root&&this.root.setAttribute(r,s)}},{key:"removeAttribute",value:function(r,s){this.root&&this.root.removeAttribute(r,s)}},{key:"start",value:function(r){var s=this;if(!(this.state>Ge.ATTACHING))return!r&&!this.config.url&&this.getInitDefinition(),this.hasStart=!0,this.setState(Ge.ATTACHING),this._registerPlugins(!1),Tt.beforeInit(this).then(function(){if(s.config){r||(r=s.url||s.config.url);var o=s._startInit(r);return o}}).catch(function(o){throw o.fileName="player",o.lineNumber="236",Qe.logError("start:beforeInit:",o),o})}},{key:"switchURL",value:function(r,s){var o=this,a=r;k.typeOf(r)==="Object"&&(a=r.url);var l=this.currentTime,u=this.paused&&!this.isError;return this.src=a,new Promise(function(c,h){var f=function(g){o.off("timeupdate",d),o.off("canplay",d),h(g)},d=function(){o.currentTime=l,u&&o.once("canplay",function(){o.pause()}),o.off("error",f),c(!0)};if(o.once("error",f),!a){o.errorHandler("error",{code:6,message:"empty_src"});return}Le.os.isAndroid?o.once("timeupdate",d):o.once("canplay",d),o.play()})}},{key:"videoPlay",value:function(){this.mediaPlay()}},{key:"mediaPlay",value:function(){var r=this;if(!this.hasStart&&this.state<Ge.ATTACHED){this.removeClass(K.NO_START),this.addClass(K.ENTER),this.start(),this._useAutoplay=!0;return}this.state<Ge.RUNNING&&(this.removeClass(K.NO_START),!this.isCanplay&&this.addClass(K.ENTER));var s=Ee(ke(t.prototype),"play",this).call(this);return s!==void 0&&s&&s.then?s.then(function(){r.removeClass(K.NOT_ALLOW_AUTOPLAY),r.addClass(K.PLAYING),r.state<Ge.RUNNING&&(Qe.logInfo(">>>>playPromise.then"),r.setState(Ge.RUNNING),r.emit(so))}).catch(function(o){if(Qe.logWarn(">>>>playPromise.catch",o.name),r.media&&r.media.error){r.onError(),r.removeClass(K.ENTER);return}o.name==="NotAllowedError"&&(r._errorTimer=k.setTimeout(r,function(){r._errorTimer=null,r.emit(ey),r.addClass(K.NOT_ALLOW_AUTOPLAY),r.removeClass(K.ENTER),r.pause(),r.setState(Ge.NOTALLOW)},0))}):(Qe.logWarn("video.play not return promise"),this.state<Ge.RUNNING&&(this.setState(Ge.RUNNING),this.removeClass(K.NOT_ALLOW_AUTOPLAY),this.removeClass(K.NO_START),this.removeClass(K.ENTER),this.addClass(K.PLAYING),this.emit(so))),s}},{key:"mediaPause",value:function(){Ee(ke(t.prototype),"pause",this).call(this)}},{key:"videoPause",value:function(){Ee(ke(t.prototype),"pause",this).call(this)}},{key:"play",value:function(){var r=this;this.removeClass(K.PAUSED),oa(this,"play",function(){r.mediaPlay()})}},{key:"pause",value:function(){var r=this;oa(this,"pause",function(){Ee(ke(t.prototype),"pause",r).call(r)})}},{key:"seek",value:function(r,s){var o=this;if(!(!this.media||Number.isNaN(Number(r)||!this.hasStart))){var a=this.config,l=a.isSeekedPlay,u=a.seekedStatus,c=s||(l?"play":u);r=r<0?0:r>this.duration?parseInt(this.duration,10):r,this.once(Dn,function(){switch(o.removeClass(K.ENTER),o.isSeeking=!1,c){case"play":o.play();break;case"pause":o.pause();break;default:!o.paused&&o.play()}}),this.state<Ge.RUNNING?(this.removeClass(K.NO_START),this.addClass(K.ENTER),this.currentTime=r,c==="play"&&this.play()):this.currentTime=r}}},{key:"getInitDefinition",value:function(){var r=this,s=this.config,o=s.definition,a=s.url;!a&&o&&o.list&&o.list.length>0&&o.defaultDefinition&&o.list.map(function(l){l.definition===o.defaultDefinition&&(r.config.url=l.url,r.curDefinition=l)})}},{key:"changeDefinition",value:function(r,s){var o=this,a=this.config.definition;if(Array.isArray(a==null?void 0:a.list)&&a.list.forEach(function(u){(r==null?void 0:r.definition)===u.definition&&(o.curDefinition=u)}),r!=null&&r.bitrate&&typeof r.bitrate!="number"&&(r.bitrate=parseInt(r.bitrate,10)||0),this.emit(ny,{from:s,to:r}),!this.hasStart){this.config.url=r.url;return}var l=this.switchURL(r.url,St({seamless:a.seamless!==!1&&typeof MediaSource<"u"&&typeof MediaSource.isTypeSupported=="function"},r));l&&l.then?l.then(function(){o.emit(Mm,{from:s,to:r})}):this.emit(Mm,{from:s,to:r})}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once(co,this.reloadFunc)}},{key:"resetState",value:function(){var r=this,s=K.NOT_ALLOW_AUTOPLAY,o=K.PLAYING,a=K.NO_START,l=K.PAUSED,u=K.REPLAY,c=K.ENTER,h=K.ENDED,f=K.ERROR,d=K.LOADING,p=[s,o,a,l,u,c,h,f,d];this.hasStart=!1,this.isError=!1,this._useAutoplay=!1,this.mediaPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,p.forEach(function(g){r.removeClass(g)}),this.addClass(K.ENTER),this.emit(ry)}},{key:"reset",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=arguments.length>1?arguments[1]:void 0;this.resetState();var a=this.plugins;if(a&&(s.map(function(u){r.deregister(u)}),o)){var l=Zx();Object.keys(this.config).keys(function(u){r.config[u]!=="undefined"&&(u==="plugins"||u==="presets"||u==="el"||u==="id")&&(r.config[u]=l[u])})}}},{key:"destroy",value:function(){var r=this,s=this.innerContainer,o=this.root,a=this.media;if(!(!o||!a)){if(this.hasStart=!1,this._useAutoplay=!1,o.removeAttribute(Hs),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.media),k.clearAllTimers(this),this.emit(iy),Tt.destroy(this),aA(this),Ee(ke(t.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root&&this.exitFullscreen(),s)for(var l=s.children,u=0;u<l.length;u++)s.removeChild(l[u]);!s&&a instanceof window.Node&&o.contains(a)&&o.removeChild(a),["topBar","leftBar","rightBar","innerContainer"].map(function(h){r[h]&&o.removeChild(r[h]),r[h]=null});var c=o.className.split(" ");c.length>0?o.className=c.filter(function(h){return h.indexOf("xgplayer")<0}).join(" "):o.className="",this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach(function(h){r[h]=!1})}}},{key:"replay",value:function(){var r=this;this.removeClass(K.ENDED),this.currentTime=0,this.isSeeking=!1,oa(this,"replay",function(){r.once(Dn,function(){var s=r.mediaPlay();s&&s.catch&&s.catch(function(o){console.log(o)})}),r.play(),r.emit(ty),r.onPlay()})}},{key:"retry",value:function(){var r=this;this.removeClass(K.ERROR),this.addClass(K.LOADING),oa(this,"retry",function(){var s=r.currentTime;r.src=r.config.url,!r.config.isLive&&(r.currentTime=s),r.once(Dn,function(){r.mediaPlay()})})}},{key:"changeFullStyle",value:function(r,s,o,a){r&&(a||(a=K.PARENT_FULLSCREEN),this._orgCss||(this._orgCss=k.filterStyleFromText(r)),k.addClass(r,o),s&&s!==r&&!this._orgPCss&&(this._orgPCss=k.filterStyleFromText(s),k.addClass(s,a),s.setAttribute(Hs,this.playerId)))}},{key:"recoverFullStyle",value:function(r,s,o,a){a||(a=K.PARENT_FULLSCREEN),this._orgCss&&(k.setStyleFromCsstext(r,this._orgCss),this._orgCss=""),k.removeClass(r,o),s&&s!==r&&this._orgPCss&&(k.setStyleFromCsstext(s,this._orgPCss),this._orgPCss="",k.removeClass(s,a),s.removeAttribute(Hs))}},{key:"getFullscreen",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget,s=this.root,o=this.media;r||(r=s),this._fullScreenOffset={top:k.scrollTop(),left:k.scrollLeft()},this._fullscreenEl=r,this._fullActionFrom="get";var a=k.getFullScreenEl();if(a===this._fullscreenEl){this.onFullscreenChange();return}try{for(var l=0;l<Fx.length;l++){var u=Fx[l];if(r[u]){var c=u==="webkitRequestFullscreen"?r.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):r[u]();return c&&c.then?c:Promise.resolve()}}return o.fullscreenEnabled||o.webkitSupportsFullscreen?(o.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch{return Promise.reject(new Error("call getFullscreen fail"))}}},{key:"exitFullscreen",value:function(r){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),!(!this._fullscreenEl&&!k.getFullScreenEl())){this.root;var s=this.media;this._fullActionFrom="exit";try{for(var o=0;o<Nx.length;o++){var a=Nx[o];if(document[a]){var l=document[a]();return l&&l.then?l:Promise.resolve()}}return s&&s.webkitSupportsFullscreen?(s.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch{return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var s=r?"".concat(K.INNER_FULLSCREEN," ").concat(K.CSS_FULLSCREEN):K.CSS_FULLSCREEN;this.changeFullStyle(this.root,r,s);var o=this.config.fullscreen,a=o===void 0?{}:o,l=a.useCssFullscreen===!0||typeof a.useCssFullscreen=="function"&&a.useCssFullscreen();l&&(this.fullscreen=!0,this.emit(is,!0)),this._cssfullscreenEl=r,this.cssfullscreen=!0,this.emit(Zf,!0)}},{key:"exitCssFullscreen",value:function(){var r=this._cssfullscreenEl?"".concat(K.INNER_FULLSCREEN," ").concat(K.CSS_FULLSCREEN):K.CSS_FULLSCREEN;if(!this.fullscreen)this.recoverFullStyle(this.root,this._cssfullscreenEl,r);else{var s=this.config.fullscreen,o=s===void 0?{}:s,a=o.useCssFullscreen===!0||typeof o.useCssFullscreen=="function"&&o.useCssFullscreen();a?(this.recoverFullStyle(this.root,this._cssfullscreenEl,r),this.fullscreen=!1,this.emit(is,!1)):this.removeClass(r)}this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(Zf,!1)}},{key:"getRotateFullscreen",value:function(r){this.cssfullscreen&&this.exitCssFullscreen(r);var s=r?"".concat(K.INNER_FULLSCREEN," ").concat(K.ROTATE_FULLSCREEN):K.ROTATE_FULLSCREEN;this._fullscreenEl=r||this.root,this.changeFullStyle(this.root,r,s,K.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this.emit(is,!0)}},{key:"exitRotateFullscreen",value:function(r){var s=this._fullscreenEl!==this.root?"".concat(K.INNER_FULLSCREEN," ").concat(K.ROTATE_FULLSCREEN):K.ROTATE_FULLSCREEN;this.recoverFullStyle(this.root,this._fullscreenEl,s,K.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(is,!1)}},{key:"setRotateDeg",value:function(r){window.orientation===90||window.orientation===-90?this.rotateDeg=0:this.rotateDeg=r}},{key:"focus",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};if(this.isActive){this.onFocus(r);return}this.emit(KO,St({paused:this.paused,ended:this.ended},r))}},{key:"blur",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{ignorePaused:!1};if(!this.isActive){this.onBlur(r);return}this.emit(q2,St({paused:this.paused,ended:this.ended},r))}},{key:"onFocus",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=s.autoHide,a=o===void 0?!this.config.closePlayerBlur:o,l=s.delay,u=l===void 0?this.config.inactive:l;if(this.isActive=!0,this.removeClass(K.INACTIVE),this.userTimer&&(k.clearTimeout(this,this.userTimer),this.userTimer=null),!a){this.userTimer&&(k.clearTimeout(this,this.userTimer),this.userTimer=null);return}this.userTimer=k.setTimeout(this,function(){r.userTimer=null,r.blur()},u)}},{key:"onBlur",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=r.ignorePaused,o=s===void 0?!1:s;if(this.isActive){var a=this.config.closePauseVideoFocus;this.isActive=!1,(o||a||!this.paused&&!this.ended)&&this.addClass(K.INACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.removeClass(K.ENTER),this.removeClass(K.ERROR),this.removeClass(K.LOADING),this.isCanplay=!0,this.waitTimer&&k.clearTimeout(this,this.waitTimer)}},{key:"onLoadeddata",value:function(){this.isError=!1}},{key:"onLoadstart",value:function(){this.removeClass(K.ERROR)}},{key:"onPlay",value:function(){this.state===Ge.ENDED&&this.setState(Ge.RUNNING),this.removeClass(K.PAUSED),this.ended&&this.removeClass(K.ENDED),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass(K.PAUSED),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this.userTimer&&(k.clearTimeout(this,this.userTimer),this.userTimer=null),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass(K.ENDED),this.setState(Ge.ENDED)}},{key:"onError",value:function(){this.isError=!0,this.updateAcc("error"),this.removeClass(K.NOT_ALLOW_AUTOPLAY),this.removeClass(K.NO_START),this.removeClass(K.ENTER),this.removeClass(K.LOADING),this.addClass(K.ERROR)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(K.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&k.clearTimeout(this,this.waitTimer),this.removeClass(K.LOADING),this.removeClass(K.SEEKING)}},{key:"onWaiting",value:function(){var r=this;this.waitTimer&&k.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=k.setTimeout(this,function(){r.addClass(K.LOADING),k.clearTimeout(r,r.waitTimer),r.waitTimer=null},200)}},{key:"onPlaying",value:function(){var r=this;this.isError=!1;var s=K.NO_START,o=K.PAUSED,a=K.ENDED,l=K.ERROR,u=K.REPLAY,c=K.LOADING,h=[s,o,a,l,u,c];h.forEach(function(f){r.removeClass(f)})}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.resize(),(this.waitTimer||this.hasClass(K.LOADING))&&this.media.readyState>2&&(this.removeClass(K.LOADING),k.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&this.state<Ge.RUNNING&&this.duration&&(this.setState(Ge.RUNNING),this.emit(so)),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onVolumechange",value:function(){k.typeOf(this.config.volume)==="Number"&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(r,s,o){if(!(!this.media||!s||!r)){var a=k.typeOf(r)==="String"?r:r.type||"";o.props&&k.typeOf(o.props)!=="Array"&&(o.props=[o.props]),this.emit(Hf,St({eventType:a,action:s,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:r},o))}}},{key:"updateAcc",value:function(r){if(this._accPlayed.t){var s=new Date().getTime()-this._accPlayed.t;this._accPlayed.acc+=s,this._accPlayed.t=0,(r==="ended"||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(r){var s=this.media.buffered;if(!s||s.length===0||!this.duration)return!0;for(var o=r||this.media.currentTime||.2,a=s.length,l=0;l<a;l++)if(s.start(l)<=o&&s.end(l)>o)return!0;return!1}},{key:"position",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{h:0,y:0,x:0,w:0};if(!(!this.media||!r||!r.h)){var s=1/r.h,o=s!==1?"scale(".concat(s,")"):"",a=0,l=0;r.y&&(l=(100-r.h*100)/2-r.y*100),r.w&&r.x&&(a=(100-r.w*100)/2-r.x*100),o+=" translate(".concat(a,"%, ").concat(l,"%)"),this.media.style.transform=o,this.media.style.webkitTransform=o}}},{key:"setConfig",value:function(r){var s=this;r&&Object.keys(r).map(function(o){if(o!=="plugins"){s.config[o]=r[o];var a=s.plugins[o.toLowerCase()];a&&k.typeOf(a.setConfig)==="Function"&&a.setConfig(r[o])}})}},{key:"playNext",value:function(r){this.resetState(),this.setConfig(r),this._currentTime=0,this._duration=0,this.play(),this.emit(Gf,r)}},{key:"resize",value:function(){var r=this;if(this.media){var s=this.media,o=s.videoWidth,a=s.videoHeight,l=this.config,u=l.fitVideoSize,c=l.videoFillMode;if((c==="fill"||c==="cover")&&this.setAttribute("data-xgfill",c),!(!a||!o)){this._videoHeight=a,this._videoWidth=o;var h=this.root.getBoundingClientRect(),f=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,d=h.width,p=h.height-f,g=parseInt(o/a*1e3,10),m=parseInt(d/p*1e3,10),v=d,O=p,y={};u==="auto"&&m>g||u==="fixWidth"?(O=d/g*1e3,this.config.fluid?y.paddingTop="".concat(O*100/v,"%"):y.height="".concat(O+f,"px")):(u==="auto"&&m<g||u==="fixHeight")&&(v=g*p/1e3,y.width="".concat(v,"px")),!this.fullscreen&&!this.cssfullscreen&&Object.keys(y).forEach(function(b){r.root.style[b]=y[b]}),(c==="fillHeight"&&m<g||c==="fillWidth"&&m>g)&&this.setAttribute("data-xgfill","cover");var x={videoScale:g,vWidth:v,vHeight:O,cWidth:v,cHeight:O+f};this.emit(Pa,x)}}}},{key:"updateObjectPosition",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.media.updateObjectPosition){this.media.updateObjectPosition(r,s);return}this.media.style.objectPosition="".concat(r*100,"% ").concat(s*100,"%")}},{key:"setState",value:function(r){Qe.logInfo("setState","state from:".concat(jx[this.state]," to:").concat(jx[r])),this._state=r}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(r){typeof r=="boolean"&&(this._hasStart=r,r===!1&&this.setState(Ge.READY),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return this._state===Ge.RUNNING||this._state===Ge.ENDED},set:function(r){r?this.setState(Ge.RUNNING):this._state>=Ge.RUNNING&&this.setState(Ge.ATTACHED)}},{key:"definitionList",get:function(){return!this.config||!this.config.definition?[]:this.config.definition.list||[]},set:function(r){var s=this,o=this.config.definition,a=null,l=null;o.list=r,this.emit("resourceReady",r),r.forEach(function(u){var c;((c=s.curDefinition)===null||c===void 0?void 0:c.definition)===u.definition&&(a=u),o.defaultDefinition===u.definition&&(l=u)}),!l&&r.length>0&&(l=r[0]),a?this.changeDefinition(a):l&&this.changeDefinition(l)}},{key:"videoFrameInfo",get:function(){var r={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.media||!this.media.getVideoPlaybackQuality)return r;var s=this.media.getVideoPlaybackQuality();return r.dropped=s.droppedVideoFrames||0,r.total=s.totalVideoFrames||0,r.corrupted=s.corruptedVideoFrames||0,r.total>0&&(r.droppedRate=r.dropped/r.total*100,r.droppedDuration=parseInt(this.cumulateTime/r.total*r.dropped,0)),r}},{key:"lang",get:function(){return this.config.lang},set:function(r){var s=aa.langKeys.filter(function(o){return o===r});if(s.length===0&&r!=="zh"){console.error("Sorry, set lang fail, because the language [".concat(r,"] is not supported now, list of all supported languages is [").concat(aa.langKeys.join(),"] "));return}this.config.lang=r,Tt.setLang(r,this)}},{key:"i18n",get:function(){var r=this.config.lang;return r==="zh"&&(r="zh-cn"),this.__i18n.lang[r]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return $m}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(r){this.__url=r}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(r){this.plugins.poster&&this.plugins.poster.update(r)}},{key:"readyState",get:function(){return Ee(ke(t.prototype),"readyState",this)}},{key:"error",get:function(){var r=Ee(ke(t.prototype),"error",this);return this.i18n[r]||r}},{key:"networkState",get:function(){return Ee(ke(t.prototype),"networkState",this)}},{key:"fullscreenChanging",get:function(){return this._fullScreenOffset!==null}},{key:"cumulateTime",get:function(){var r=this._accPlayed;return this.updateAcc("get"),r.acc}},{key:"zoom",get:function(){return this.config.zoom},set:function(r){this.config.zoom=r}},{key:"avgSpeed",get:function(){return Hx},set:function(r){Hx=r}},{key:"realTimeSpeed",get:function(){return Gx},set:function(r){Gx=r}},{key:"hook",value:function(r,s){return Xf.call.apply(Xf,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(r,s){return zf.call.apply(zf,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(r,s){return Wf.call.apply(Wf,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(r,s,o){for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];return Qx.call.apply(Qx,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(r,s,o){for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];return Bx.call.apply(Bx,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(r,s){typeof s=="boolean"&&s!==this.muted&&(this.addInnerOP("volumechange"),this.muted=s),Tt.setCurrentUserActive(this.playerId,r)}}],[{key:"debugger",get:function(){return Qe.config.debug},set:function(r){Qe.config.debug=r}},{key:"getCurrentUserActivePlayerId",value:function(){return Tt.getCurrentUseActiveId()}},{key:"setCurrentUserActive",value:function(r,s){Tt.setCurrentUserActive(r,s)}},{key:"isHevcSupported",value:function(){return Le.isHevcSupported()}},{key:"probeConfigSupported",value:function(r){return Le.probeConfigSupported(r)}},{key:"install",value:function(r,s){t.plugins||(t.plugins={}),t.plugins[r]||(t.plugins[r]=s)}},{key:"use",value:function(r,s){t.plugins||(t.plugins={}),t.plugins[r]=s}}]),t}(cM);q(oy,"defaultPreset",null);q(oy,"XgVideoProxy",null);function ai(){return new Date().getTime()}var Gr={LOAD_START:"loadstart",LOADED_DATA:"loadeddata",FIRST_FRAME:"firstFrame",WAIT_START:"waitingStart",WAIT_END:"waitingEnd",SEEK_START:"seekStart",SEEK_END:"seekEnd"},IM=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"_onTimeupdate",function(){n._state.isTimeUpdate=!0,n._state.autoplayStart&&(Qe.logInfo("[xgLogger]".concat(n.player.playerId," _onTimeupdate")),n._sendFF("onTimeupdate"))}),q(V(n),"_onAutoplayStart",function(){Qe.logInfo("[xgLogger]".concat(n.player.playerId," _onAutoplayStart")),n._state.autoplayStart=!0,n.vt&&n._sendFF("onAutoplayStart")}),q(V(n),"_onReset",function(){n._state={autoplayStart:!1,isFFLoading:!1,isTimeUpdate:!1,isFFSend:!1,isLs:!1},n.vt=0,n.pt=0,n.fvt=0,n.newPointTime=ai(),n.loadedCostTime=0,n.startCostTime=0,n._isSeeking=!1,n.seekingStart=0,n.waitingStart=0,n.fixedWaitingStart=0,n._isWaiting=!1,n._waitTimer&&k.clearTimeout(V(n),n._waitTimer),n._waittTimer&&k.clearTimeout(V(n),n._waittTimer),n._waitTimer=null,n._waittTimer=null,n._waitType=0}),q(V(n),"_onSeeking",function(){n.seekingStart||(n.suspendWaitingStatus("seek"),n.seekingStart=ai(),n.emitLog(Gr.SEEK_START,{start:ai()}))}),q(V(n),"_onSeeked",function(){n.suspendSeekingStatus("seeked")}),q(V(n),"_onWaitingLoadStart",function(){n._isWaiting||n.vt||(n._isWaiting=!0,n.waitingStart=ai(),n.fixedWaitingStart=ai(),n._waitType=1,n.emitLog(Gr.WAIT_START,{fixedStart:n.fixedWaitingStart,start:n.waitingStart,type:1,endType:"loadstart"}))}),q(V(n),"_onWaiting",function(){n._isWaiting||!n.vt||(n._isWaiting=!0,n.vt?n.seekingStart?n._waitType=2:n._waitType=0:n._waitType=1,n.fixedWaitingStart=ai(),n._waitTimer=k.setTimeout(V(n),function(){n._isWaiting&&(n.waitingStart=ai(),k.clearTimeout(V(n),n._waitTimer),n._waitTimer=null,n._startWaitTimeout(),n.emitLog(Gr.WAIT_START,{fixedStart:n.fixedWaitingStart,start:n.waitingStart,type:n._waitType,endType:n._waitType===2?"seek":"playing"}))},200))}),q(V(n),"_onError",function(){n.suspendSeekingStatus("error"),n.suspendWaitingStatus("error")}),q(V(n),"_onPlaying",function(){n._isWaiting&&n.suspendWaitingStatus("playing")}),n}return me(t,[{key:"afterCreate",value:function(){var r=this;this._onReset(),this._waitType="firstFrame",this._initOnceEvents(),this.newPointTime=ai(),this.loadedCostTime=0,this.startCostTime=0,this.on(YO,function(){var s=r._state,o=s.autoplayStart,a=s.isFFSend;r.startCostTime=ai()-r.newPointTime,Qe.logInfo("[xgLogger]".concat(r.player.playerId," LOAD_START"),"autoplayStart:".concat(o," isFFSend:").concat(a," startCostTime:").concat(r.startCostTime," newPointTime").concat(r.newPointTime)),!a&&(!s.isLs&&r.emitLog(Gr.LOAD_START,{}),s.isLs=!0,s.isTimeUpdate=!1,s.isFFLoading=!0,r.pt=ai(),r.vt=0,r.fvt=0,r._initOnceEvents(),r._onWaitingLoadStart())}),this.on(co,function(){r.vt=ai(),r.fvt=r.vt-r.pt,r.loadedCostTime=r.vt-r.newPointTime;var s=r._state,o=s.isTimeUpdate,a=s.isFFSend,l=s.autoplayStart;Qe.logInfo("[xgLogger]".concat(r.player.playerId," LOADED_DATA"),"fvt:".concat(r.fvt," isTimeUpdate:").concat(r._state.isTimeUpdate," loadedCostTime:").concat(r.loadedCostTime)),o&&l&&r._sendFF("loadedData"),a||r.emitLog(Gr.LOADED_DATA,{}),r.suspendWaitingStatus("loadeddata")}),this.on(qO,this._onSeeking),this.on(Su,this._onSeeked),this.on(iy,function(){r.endState("destroy")}),this.on(up,function(){r.endState("urlChange"),Qe.logInfo("[xgLogger]".concat(r.player.playerId," URL_CHANGE")),r._state.isFFSend&&r._onReset()}),this.on([WO,Dn],this._onPlaying),this.on(nc,this._onWaiting),this.on(ic,this._onError),this.on(ry,function(){Qe.logInfo("[xgLogger]".concat(r.player.playerId," RESET")),r.endState("reset"),r._initOnceEvents(),r._onReset()})}},{key:"_initOnceEvents",value:function(){this.off(so,this._onAutoplayStart),this.off(cn,this._onTimeupdate),this.once(so,this._onAutoplayStart),this.once(cn,this._onTimeupdate)}},{key:"_sendFF",value:function(r){this.s=ai();var s=this._state,o=s.isFFLoading,a=s.isFFSend;Qe.logInfo("[xgLogger]".concat(this.player.playerId," _sendFF"),"".concat(r," fvt:").concat(this.fvt," isFFLoading:").concat(o," !isFFSend:").concat(!a)),this.vt>0&&o&&!a&&(Qe.logInfo("[xgLogger]".concat(this.player.playerId," emitLog_firstFrame"),r),this._state.isFFLoading=!1,this._state.isFFSend=!0,this.emitLog(Gr.FIRST_FRAME,{fvt:this.fvt,costTime:this.fvt,vt:this.vt,startCostTime:this.startCostTime,loadedCostTime:this.loadedCostTime}))}},{key:"_startWaitTimeout",value:function(){var r=this;this._waittTimer&&k.clearTimeout(this,this._waittTimer),this._waittTimer=k.setTimeout(this,function(){r.suspendWaitingStatus("timeout"),k.clearTimeout(r,r._waittTimer),r._waittTimer=null},this.config.waitTimeout)}},{key:"endState",value:function(r){this.suspendWaitingStatus(r),this.suspendSeekingStatus(r)}},{key:"suspendSeekingStatus",value:function(r){if(this.seekingStart){var s=ai(),o=s-this.seekingStart;this.seekingStart=0,this.emitLog(Gr.SEEK_END,{end:s,costTime:o,endType:r})}}},{key:"suspendWaitingStatus",value:function(r){if(this._waitTimer&&(k.clearTimeout(this,this._waitTimer),this._waitTimer=null),this._waittTimer&&(k.clearTimeout(this,this._waittTimer),this._waittTimer=null),this._isWaiting=!1,!!this.waitingStart){var s=ai(),o=s-this.waitingStart,a=s-this.fixedWaitingStart,l=this.config.waitTimeout;this._isWaiting=!1,this.waitingStart=0,this.fixedWaitingStart=0,this.emitLog(Gr.WAIT_END,{fixedCostTime:a>l?l:a,costTime:o>l?l:o,type:r==="loadeddata"?1:this._waitType,endType:this._waitType===2?"seek":r})}}},{key:"emitLog",value:function(r,s){var o=this.player;this.emit(iA,St({t:ai(),host:k.getHostFromUrl(o.currentSrc),vtype:o.vtype,eventType:r,currentTime:this.player.currentTime,readyState:o.video.readyState,networkState:o.video.networkState},s))}}],[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{waitTimeout:1e4}}}]),t}(Re);function DM(){return new DOMParser().parseFromString(`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78">
  <path fill="#fff" transform="translate(20, 20)" d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`,"image/svg+xml").firstChild}var $M=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"registerIcons",value:function(){return{replay:DM}}},{key:"afterCreate",value:function(){var r=this;Re.insert(this.icons.replay,this.root,0),this.__handleReplay=this.hook("replayClick",function(){r.player.replay()},{pre:function(o){o.preventDefault(),o.stopPropagation()}}),this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay),this.on(Ls,function(){if(r.playerConfig.loop||k.addClass(r.player.root,"replay"),!r.config.disable){r.show();var s=r.root.querySelector("path");if(s){var o=window.getComputedStyle(s).getPropertyValue("transform");if(typeof o=="string"&&o.indexOf("none")>-1)return null;s.setAttribute("transform",o)}}}),this.on(dn,function(){r.hide()})}},{key:"handleReplay",value:function(r){r.preventDefault(),r.stopPropagation(),this.player.replay(),k.removeClass(this.player.root,"replay")}},{key:"show",value:function(){this.config.disable||(this.root.style.display="flex")}},{key:"enable",value:function(){this.config.disable=!1}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return`<xg-replay class="xgplayer-replay">
      <xg-replay-txt class="xgplayer-replay-txt" lang-key="`.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,`</xg-replay-txt>
    </xg-replay>`)}}],[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:!1}}}]),t}(Re),MM=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"isEndedShow",get:function(){return this.config.isEndedShow},set:function(r){this.config.isEndedShow=r}},{key:"hide",value:function(){k.addClass(this.root,"hide")}},{key:"show",value:function(){k.removeClass(this.root,"hide")}},{key:"beforeCreate",value:function(r){typeof r.player.config.poster=="string"&&(r.config.poster=r.player.config.poster)}},{key:"afterCreate",value:function(){var r=this;this.on(Ls,function(){r.isEndedShow&&k.removeClass(r.root,"hide")}),this.config.hideCanplay?(this.once(cn,function(){r.onTimeUpdate()}),this.on(up,function(){k.removeClass(r.root,"hide"),k.addClass(r.root,"xg-showplay"),r.once(cn,function(){r.onTimeUpdate()})})):this.on(dn,function(){k.addClass(r.root,"hide")})}},{key:"onTimeUpdate",value:function(){var r=this;this.player.currentTime?k.removeClass(this.root,"xg-showplay"):this.once(cn,function(){r.onTimeUpdate()})}},{key:"update",value:function(r){r&&(this.config.poster=r,this.root.style.backgroundImage="url(".concat(r,")"))}},{key:"render",value:function(){var r=this.config,s=r.poster,o=r.hideCanplay,a=s?"background-image:url(".concat(s,");"):"";return'<xg-poster class="xgplayer-poster '.concat(o?"xg-showplay":"",'" style="').concat(a,`">
    </xg-poster>`)}}],[{key:"pluginName",get:function(){return"poster"}},{key:"defaultConfig",get:function(){return{isEndedShow:!0,hideCanplay:!1,poster:""}}}]),t}(Re);function ay(){return new DOMParser().parseFromString(`<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`,"image/svg+xml").firstChild}function ly(){return new DOMParser().parseFromString(`<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`,"image/svg+xml").firstChild}var Rr={};function FM(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{start:null,end:null};Rr[i]&&window.clearTimeout(Rr[i].id),Rr[i]={},t.start&&t.start(),Rr[i].id=window.setTimeout(function(){t.end&&t.end(),window.clearTimeout(Rr[i].id),delete Rr[i]},e)}function NM(){Object.keys(Rr).map(function(i){window.clearTimeout(Rr[i].id),delete Rr[i]})}var QM=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),q(V(r),"onAutoplayStart",function(){if(!r.autoPlayStart){var s=r.config.mode==="auto"?"auto-hide":"hide";k.addClass(r.root,s),r.autoPlayStart=!0,r.onPlayPause("play")}}),r.autoPlayStart=!1,r}return me(t,[{key:"afterCreate",value:function(){var r=this,s=this.player,o=this.playerConfig;this.initIcons(),this.once(JO,function(){o&&(o.lang&&o.lang==="en"?k.addClass(s.root,"lang-is-en"):o.lang==="jp"&&k.addClass(s.root,"lang-is-jp"))}),this.on(so,this.onAutoplayStart),o.autoplay||this.show(),this.on(ey,function(){var a=r.config.mode==="auto"?"auto-hide":"hide";r.setAttr("data-state","play"),k.removeClass(r.root,a),r.show()}),this.on(dn,function(){r.onPlayPause("play")}),this.on(nl,function(){r.onPlayPause("pause")}),this.clickHandler=this.hook("startClick",this.switchPausePlay,{pre:function(l){l.cancelable&&l.preventDefault(),l.stopPropagation();var u=r.player.paused;r.emitUserAction(l,"switch_play_pause",{props:"paused",from:u,to:!u})}}),this.bind(["click","touchend"],this.clickHandler)}},{key:"registerIcons",value:function(){return{startPlay:{icon:ay,class:"xg-icon-play"},startPause:{icon:ly,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild("xg-start-inner",r.startPlay),this.appendChild("xg-start-inner",r.startPause)}},{key:"hide",value:function(){k.addClass(this.root,"hide")}},{key:"show",value:function(){k.removeClass(this.root,"hide")}},{key:"focusHide",value:function(){k.addClass(this.root,"focus-hide")}},{key:"recover",value:function(){k.removeClass(this.root,"focus-hide")}},{key:"switchStatus",value:function(r){r?this.setAttr("data-state",this.player.paused?"pause":"play"):this.setAttr("data-state",this.player.paused?"play":"pause")}},{key:"animate",value:function(r){var s=this;FM("pauseplay",400,{start:function(){k.addClass(s.root,"interact"),s.show(),s.switchStatus(!0)},end:function(){k.removeClass(s.root,"interact"),!r&&s.hide()}})}},{key:"switchPausePlay",value:function(r){var s=this.player;if(r.cancelable&&r.preventDefault(),r.stopPropagation(),!(s.state<Ge.READY)){var o=this.player.paused;!o&&s.state===Ge.RUNNING?s.pause():s.play()}}},{key:"onPlayPause",value:function(r){var s=this.config,o=this.player;if(!(o.state<Ge.RUNNING||!this.autoPlayStart)){if(s.mode==="show"){this.switchStatus(),this.show();return}if(s.mode==="auto"){this.switchStatus();return}if(s.isShowPause&&o.paused&&!o.ended||s.isShowEnd&&o.ended){this.switchStatus(),this.show();return}if(s.disableAnimate){this.switchStatus(),this.hide();return}if(r==="play")this.autoPlayStart?this.animate():this.hide();else{if(!this.autoPlayStart||o.ended)return;this.animate()}}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.clickHandler),NM()}},{key:"render",value:function(){var r=this.playerConfig.autoplay?this.config.mode==="auto"?"auto-hide":"hide":"";return`
    <xg-start class="xgplayer-start `.concat(r,`">
    <xg-start-inner></xg-start-inner>
    </xg-start>`)}}],[{key:"pluginName",get:function(){return"start"}},{key:"defaultConfig",get:function(){return{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"}}}]),t}(Re),BM=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"render",value:function(){var r=this.config.innerHtml,s=k.createDom("xg-enter","",{},"xgplayer-enter");if(r&&r instanceof window.HTMLElement)s.appendChild(r);else if(r&&typeof r=="string")s.innerHTML=r;else{for(var o="",a=1;a<=12;a++)o+='<div class="xgplayer-enter-bar'.concat(a,'"></div>');s.innerHTML='<div class="xgplayer-enter-spinner">'.concat(o,"</div>")}return s}}],[{key:"pluginName",get:function(){return"enter"}},{key:"defaultConfig",get:function(){return{innerHtml:"",logo:""}}}]),t}(Re);function Ds(i,e,t){try{return' <div class="xg-tips '.concat(t?"hide":" ",'" lang-key="').concat(i.i18nKeys[e],`">
    `).concat(i.i18n[e],`
    </div>`)}catch{return'<div class="xg-tips hide"></div>'}}var Xx=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"afterCreate",value:function(){this.getMini=this.getMini.bind(this),this.exitMini=this.exitMini.bind(this),this.bind("click",this.getMini)}},{key:"getMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"exitMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var r="MINISCREEN";return`
      <xg-icon class="xgplayer-miniicon">
      <div class="xgplayer-icon btn-text"><span class="icon-text" lang-key="`.concat(this.i18nKeys[r],'">').concat(this.i18n[r],`</span></div>
      </xg-icon>`)}}],[{key:"pluginName",get:function(){return"miniscreenIcon"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:10}}}]),t}(Re);function zx(i){var e=parseFloat(i),t=i.indexOf("%")===-1&&!Number.isNaN(e);return t&&e}var uy=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],uA=uy.length;function UM(){for(var i={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<uA;e++){var t=uy[e];i[t]=0}return i}function VM(i){var e=window.getComputedStyle(i);return e}function Wx(i){if(typeof i=="string"&&(i=document.querySelector(i)),!(!i||vi(i)!=="object"||!i.nodeType)){var e=VM(i);if(e.display==="none")return UM();var t={};t.width=i.offsetWidth,t.height=i.offsetHeight;for(var n=t.isBorderBox=e.boxSizing==="border-box",r=0;r<uA;r++){var s=uy[r],o=e[s],a=parseFloat(o);t[s]=Number.isNaN(a)?0:a}var l=t.paddingLeft+t.paddingRight,u=t.paddingTop+t.paddingBottom,c=t.marginLeft+t.marginRight,h=t.marginTop+t.marginBottom,f=t.borderLeftWidth+t.borderRightWidth,d=t.borderTopWidth+t.borderBottomWidth,p=n,g=zx(e.width);g!==!1&&(t.width=g+(p?0:l+f));var m=zx(e.height);return m!==!1&&(t.height=m+(p?0:u+d)),t.innerWidth=t.width-(l+f),t.innerHeight=t.height-(u+d),t.outerWidth=t.width+c,t.outerHeight=t.height+h,t}}function Kp(i,e){for(var t=0;t<i.length;t++){var n=i[t];if(n.identifier===e)return n}}var Jp={START:"dragStart",MOVE:"dragMove",ENDED:"dragEnded"},qx={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]},ZM=function(i){Ce(t,i);var e=Ae(t);function t(n){var r,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ge(this,t),r=e.call(this),r.isEnabled=!0,r.isDragging=!1,r.isDown=!1,r.position={},r.downPoint={},r.dragPoint={x:0,y:0},r.startPos={x:0,y:0},r._root=n instanceof Element?n:document.querySelector(n),r._handlerDom=s.handle instanceof Element?s.handle:document.querySelector(s.handle),!r._root||!r._handlerDom?XO(r):(r._bindStartEvent(),r)}return me(t,[{key:"_bindStartEvent",value:function(){var r=this;"ontouchstart"in window?this._startKey="touchstart":this._startKey="mousedown",this["on".concat(this._startKey)]=this["on".concat(this._startKey)].bind(this),this._handlerDom.addEventListener(this._startKey,this["on".concat(this._startKey)]),qx[this._startKey].map(function(s){r["on".concat(s)]=r["on".concat(s)].bind(r)})}},{key:"_unbindStartEvent",value:function(){this._handlerDom.removeEventListener(this._startKey,this["on".concat(this._startKey)])}},{key:"_bindPostStartEvents",value:function(r){var s=this;if(r){var o=qx[this._startKey];o.map(function(a){window.addEventListener(a,s["on".concat(a)])}),this._boundPointerEvents=o}}},{key:"_unbindPostStartEvents",value:function(){var r=this;this._boundPointerEvents&&(this._boundPointerEvents.map(function(s){window.removeEventListener(s,r["on".concat(s)])}),delete this._boundPointerEvents)}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1,this.isDragging&&this.onUp()}},{key:"onDocUp",value:function(r){this.onUp()}},{key:"animate",value:function(){var r=this;this.isDragging&&(this.positionDrag(),window.requestAnimationFrame(function(){r.animate()}))}},{key:"positionDrag",value:function(){var r="translate3d(".concat(this.dragPoint.x,"px, ").concat(this.dragPoint.y,"px, 0)");this._root.style.transform=r,this._root.style.webKitTransform=r}},{key:"setLeftTop",value:function(){this._root.style.left=this.position.x+"px",this._root.style.top=this.position.y+"px"}},{key:"onmousedown",value:function(r){this.dragStart(r,r)}},{key:"onmousemove",value:function(r){this.dragMove(r,r)}},{key:"onmouseup",value:function(r){this.dragEnd(r,r)}},{key:"ontouchstart",value:function(r){var s=r.changedTouches[0];this.dragStart(r,s),this.touchIdentifier=s.pointerId!==void 0?s.pointerId:s.identifier,r.preventDefault()}},{key:"ontouchmove",value:function(r){var s=Kp(r.changedTouches,this.touchIdentifier);s&&this.dragMove(r,s)}},{key:"ontouchend",value:function(r){var s=Kp(r.changedTouches,this.touchIdentifier);s&&this.dragEnd(r,s),r.preventDefault()}},{key:"ontouchcancel",value:function(r){var s=Kp(r.changedTouches,this.touchIdentifier);s&&this.dragCancel(r,s)}},{key:"dragStart",value:function(r,s){if(!(!this._root||this.isDown||!this.isEnabled)){this.downPoint=s,this.dragPoint.x=0,this.dragPoint.y=0,this._getPosition();var o=Wx(this._root);this.startPos.x=this.position.x,this.startPos.y=this.position.y,this.startPos.maxY=window.innerHeight-o.height,this.startPos.maxX=window.innerWidth-o.width,this.setLeftTop(),this.isDown=!0,this._bindPostStartEvents(r)}}},{key:"dragRealStart",value:function(r,s){this.isDragging=!0,this.animate(),this.emit(Jp.START,this.startPos)}},{key:"dragEnd",value:function(r,s){this._root&&(this._unbindPostStartEvents(),this.isDragging&&(this._root.style.transform="",this.setLeftTop(),this.emit(Jp.ENDED)),this.presetInfo())}},{key:"_dragPointerMove",value:function(r,s){var o={x:s.pageX-this.downPoint.pageX,y:s.pageY-this.downPoint.pageY};return!this.isDragging&&this.hasDragStarted(o)&&this.dragRealStart(r,s),o}},{key:"dragMove",value:function(r,s){if(r=r||window.event,!!this.isDown){var o=this.startPos,a=o.x,l=o.y,u=this._dragPointerMove(r,s),c=u.x,h=u.y;c=this.checkContain("x",c,a),h=this.checkContain("y",h,l),this.position.x=a+c,this.position.y=l+h,this.dragPoint.x=c,this.dragPoint.y=h,this.emit(Jp.MOVE,this.position)}}},{key:"dragCancel",value:function(r,s){this.dragEnd(r,s)}},{key:"presetInfo",value:function(){this.isDragging=!1,this.startPos={x:0,y:0},this.dragPoint={x:0,y:0},this.isDown=!1}},{key:"destroy",value:function(){this._unbindStartEvent(),this._unbindPostStartEvents(),this.isDragging&&this.dragEnd(),this.removeAllListeners(),this._handlerDom=null}},{key:"hasDragStarted",value:function(r){return Math.abs(r.x)>3||Math.abs(r.y)>3}},{key:"checkContain",value:function(r,s,o){return s+o<0?0-o:r==="x"&&s+o>this.startPos.maxX?this.startPos.maxX-o:r==="y"&&s+o>this.startPos.maxY?this.startPos.maxY-o:s}},{key:"_getPosition",value:function(){var r=window.getComputedStyle(this._root),s=this._getPositionCoord(r.left,"width"),o=this._getPositionCoord(r.top,"height");this.position.x=Number.isNaN(s)?0:s,this.position.y=Number.isNaN(o)?0:o,this._addTransformPosition(r)}},{key:"_addTransformPosition",value:function(r){var s=r.transform;if(s.indexOf("matrix")===0){var o=s.split(","),a=s.indexOf("matrix3d")===0?12:4,l=parseInt(o[a],10),u=parseInt(o[a+1],10);this.position.x+=l,this.position.y+=u}}},{key:"_getPositionCoord",value:function(r,s){if(r.indexOf("%")!==-1){var o=Wx(this._root.parentNode);return o?parseFloat(r)/100*o[s]:0}return parseInt(r,10)}}]),t}(G2),jM=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;ge(this,t),r=e.call(this,n),q(V(r),"onCancelClick",function(a){r.exitMini(),r.isClose=!0}),q(V(r),"onCenterClick",function(a){var l=V(r),u=l.player;u.paused?u.play():u.pause()}),q(V(r),"onScroll",function(a){if(!(!window.scrollY&&window.scrollY!==0||Math.abs(window.scrollY-r.pos.scrollY)<50)){var l=parseInt(k.getCss(r.player.root,"height"));l+=r.config.scrollTop,r.pos.scrollY=window.scrollY,window.scrollY>l+5?!r.isMini&&!r.isClose&&r.getMini():window.scrollY<=l&&(r.isMini&&r.exitMini(),r.isClose=!1)}}),r.isMini=!1,r.isClose=!1;var s=V(r),o=s.config;return r.pos={left:o.left<0?window.innerWidth-o.width-20:o.left,top:o.top<0?window.innerHeight-o.height-20:o.top,height:r.config.height,width:r.config.width,scrollY:window.scrollY||0},r.lastStyle=null,r}return me(t,[{key:"beforeCreate",value:function(r){typeof r.player.config.mini=="boolean"&&(r.config.isShowIcon=r.player.config.mini)}},{key:"afterCreate",value:function(){var r=this;this.initIcons(),this.on(nl,function(){r.setAttr("data-state","pause")}),this.on(dn,function(){r.setAttr("data-state","play")})}},{key:"onPluginsReady",value:function(){var r=this,s=this.player,o=this.config;if(!o.disable){if(this.config.isShowIcon){var a={config:{onClick:function(){r.getMini()}}};s.controls.registerPlugin(Xx,a,Xx.pluginName)}var l=k.checkTouchSupport()?"touchend":"click";this.bind(".mini-cancel-btn",l,this.onCancelClick),this.bind(".play-icon",l,this.onCenterClick),this.config.disableDrag||(this._draggabilly=new ZM(this.player.root,{handle:this.root})),this.config.isScrollSwitch&&window.addEventListener("scroll",this.onScroll)}}},{key:"registerIcons",value:function(){return{play:{icon:ay,class:"xg-icon-play"},pause:{icon:ly,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".play-icon",r.play),this.appendChild(".play-icon",r.pause)}},{key:"getMini",value:function(){var r=this;if(!this.isMini){var s=this.player,o=this.playerConfig,a=this.config.target||this.player.root;this.lastStyle={},k.addClass(s.root,"xgplayer-mini"),["width","height","top","left"].map(function(l){r.lastStyle[l]=a.style[l],a.style[l]="".concat(r.pos[l],"px")}),o.fluid&&(a.style["padding-top"]=""),this.emit(jf,!0),s.isMini=this.isMini=!0}}},{key:"exitMini",value:function(){var r=this;if(!this.isMini)return!1;var s=this.player,o=this.playerConfig,a=this.config.target||this.player.root;k.removeClass(s.root,"xgplayer-mini"),this.lastStyle&&Object.keys(this.lastStyle).map(function(l){a.style[l]=r.lastStyle[l]}),this.lastStyle=null,o.fluid&&(s.root.style.width="100%",s.root.style.height="0",s.root.style["padding-top"]="".concat(o.height*100/o.width,"%")),this.emit(jf,!1),this.isMini=s.isMini=!1}},{key:"destroy",value:function(){window.removeEventListener("scroll",this.onScroll);var r=k.checkTouchSupport()?"touchend":"click";this.unbind(".mini-cancel-btn",r,this.onCancelClick),this.unbind(".play-icon",r,this.onCenterClick),this._draggabilly&&this._draggabilly.destroy(),this._draggabilly=null,this.exitMini()}},{key:"render",value:function(){if(!this.config.disable)return`
      <xg-mini-layer class="xg-mini-layer">
      <xg-mini-header class="xgplayer-mini-header">
      `.concat(Ds(this,"MINI_DRAG",this.playerConfig.isHideTips),`
      </xg-mini-header>
      <div class="mini-cancel-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
          <path fill="#fff" fill-rule="evenodd" d="M3.99 3.49a1 1 0 0 1 1.414 0L10 8.085l4.596-4.595a1 1 0 1 1 1.414 1.414L11.414 9.5l4.596 4.596a1 1 0 0 1 .084 1.32l-.084.094a1 1 0 0 1-1.414 0L10 10.914 5.404 15.51a1 1 0 0 1-1.414-1.414L8.585 9.5 3.99 4.904a1 1 0 0 1-.084-1.32z"></path>
        </svg>
      </div>
      <div class="play-icon">
      </div>
      </xg-mini-layer>`)}}],[{key:"pluginName",get:function(){return"miniscreen"}},{key:"defaultConfig",get:function(){return{index:10,disable:!1,width:320,height:180,left:-1,top:-1,isShowIcon:!1,isScrollSwitch:!1,scrollTop:0,disableDrag:!1}}}]),t}(Re),Bc={mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousemove:"onMouseMove"},eg=["videoClick","videoDbClick"],tg=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"onMouseMove",function(a){var l=V(n),u=l.player,c=l.playerConfig;u.isActive||(u.focus({autoHide:!c.closeDelayBlur}),!c.closeFocusVideoFocus&&u.media.focus())}),q(V(n),"onMouseEnter",function(a){var l=V(n),u=l.playerConfig,c=l.player;!u.closeFocusVideoFocus&&c.media.focus(),u.closeDelayBlur?c.focus({autoHide:!1}):c.focus()}),q(V(n),"onMouseLeave",function(a){var l=n.playerConfig,u=l.closePlayerBlur,c=l.leavePlayerTime,h=l.closeDelayBlur;!u&&!h&&(c?n.player.focus({autoHide:!0,delay:c}):n.player.blur())}),q(V(n),"onVideoClick",function(a){var l=V(n),u=l.player,c=l.playerConfig;a.target&&c.closeVideoClick||(a.target===u.root||a.target===u.media||a.target===u.innerContainer||a.target===u.media.__canvas)&&(a.preventDefault(),c.closeVideoStopPropagation||a.stopPropagation(),n._clickCount++,n.clickTimer&&(clearTimeout(n.clickTimer),n.clickTimer=null),n.clickTimer=setTimeout(function(){n._clickCount&&(n._clickCount--,oa(V(n),eg[0],function(h,f){n.switchPlayPause(f.e)},{e:a,paused:u.paused}),clearTimeout(n.clickTimer),n.clickTimer=null)},300))}),q(V(n),"onVideoDblClick",function(a){var l=V(n),u=l.player,c=l.playerConfig;if(!(c.closeVideoDblclick||!a.target||a.target!==u.media&&a.target!==u.media.__canvas)){if(n._clickCount<2){n._clickCount=0;return}n._clickCount=0,n.clickTimer&&(clearTimeout(n.clickTimer),n.clickTimer=null),a.preventDefault(),a.stopPropagation(),oa(V(n),eg[1],function(h,f){n.emitUserAction(f.e,"switch_fullscreen",{props:"fullscreen",from:u.fullscreen,to:!u.fullscreen}),u.fullscreen?u.exitFullscreen():u.getFullscreen()},{e:a,fullscreen:u.fullscreen})}}),n}return me(t,[{key:"afterCreate",value:function(){var r=this;this._clickCount=0,eg.map(function(o){r.__hooks[o]=null});var s=this.playerConfig.isMobileSimulateMode;s==="mobile"||Le.device==="mobile"&&!Le.os.isIpad||this.initEvents()}},{key:"initEvents",value:function(){var r=this,s=this.player,o=s.video,a=s.root,l=this.playerConfig.enableContextmenu;a&&a.addEventListener("click",this.onVideoClick,!1),a&&a.addEventListener("dblclick",this.onVideoDblClick,!1),Object.keys(Bc).map(function(u){a.addEventListener(u,r[Bc[u]],!1)}),l&&o&&o.addEventListener("contextmenu",this.onContextmenu,!1)}},{key:"switchPlayPause",value:function(r){var s=this.player;this.emitUserAction(r,"switch_play_pause",{props:"paused",from:s.paused,to:!s.paused}),s.ended?s.duration!==1/0&&s.duration>0&&s.replay():s.paused?s.play():s.pause()}},{key:"onContextmenu",value:function(r){r=r||window.event,r.preventDefault&&r.preventDefault(),r.stopPropagation?r.stopPropagation():(r.returnValue=!1,r.cancelBubble=!0)}},{key:"destroy",value:function(){var r=this,s=this.player,o=s.video,a=s.root;this.clickTimer&&clearTimeout(this.clickTimer),a.removeEventListener("click",this.onVideoClick,!1),a.removeEventListener("dblclick",this.onVideoDblClick,!1),o.removeEventListener("contextmenu",this.onContextmenu,!1),Object.keys(Bc).map(function(l){a.removeEventListener(l,r[Bc[l]],!1)})}}],[{key:"pluginName",get:function(){return"pc"}},{key:"defaultConfig",get:function(){return{}}}]),t}(Ts),Hr={PRESS:"press",PRESS_END:"pressend",DOUBlE_CLICK:"doubleclick",CLICK:"click",TOUCH_MOVE:"touchmove",TOUCH_START:"touchstart",TOUCH_END:"touchend"},GM={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},HM={start:"mousedown",end:"mouseup",move:"mousemove",cancel:"mouseleave"};function Yx(i){return i&&i.length>0?i[i.length-1]:null}function Kx(i){var e=navigator.userAgent;/(?:iPhone|iPad)/.test(e)&&i.cancelable&&i.preventDefault()}function XM(){return{pressDelay:600,dbClickDelay:200,disablePress:!1,disableDbClick:!1,miniStep:2,needPreventDefault:!0}}var zM=function(){function i(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{eventType:"touch"};ge(this,i),this._pos={moving:!1,start:!1,x:0,y:0},this.config=XM(),Object.keys(n).map(function(r){t.config[r]=n[r]}),this.root=e,this.events=n.eventType==="mouse"?HM:GM,this.pressIntrvalId=null,this.dbIntrvalId=null,this.__handlers={},this._initEvent()}return me(i,[{key:"_initEvent",value:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchCancel=this.onTouchCancel.bind(this),this.root.addEventListener(this.events.start,this.onTouchStart)}},{key:"__setPress",value:function(t){var n=this,r=this.config;this.pressIntrvalId&&this.__clearPress(),this.pressIntrvalId=setTimeout(function(){n.trigger(Hr.PRESS,t),n._pos.press=!0,n.__clearPress()},r.pressDelay)}},{key:"__clearPress",value:function(){window.clearTimeout(this.pressIntrvalId),this.pressIntrvalId=null}},{key:"__setDb",value:function(t){var n=this,r=this.config;if(this.dbIntrvalId){this.__clearDb(),this.trigger(Hr.DOUBlE_CLICK,t);return}this.dbIntrvalId=setTimeout(function(){n.__clearDb(),!n._pos.start&&!n._pos.press&&!n._pos.moving&&n.trigger(Hr.CLICK,t)},r.dbClickDelay)}},{key:"__clearDb",value:function(){clearTimeout(this.dbIntrvalId),this.dbIntrvalId=null}},{key:"on",value:function(t,n){this.__handlers[t]||(this.__handlers[t]=[]),this.__handlers[t].push(n)}},{key:"off",value:function(t,n){if(this.__handlers[t]){for(var r=this.__handlers[t],s=-1,o=0;o<r.length;o++)if(r[o]===n){s=o;break}s>=0&&this.__handlers[t].splice(s,1)}}},{key:"trigger",value:function(t,n){this.__handlers[t]&&this.__handlers[t].map(function(r){try{r(n)}catch(s){console.error("trigger>>:".concat(t),s)}})}},{key:"onTouchStart",value:function(t){var n=this._pos,r=this.root,s=this.config;s.needPreventDefault&&Kx(t);var o=Yx(t.touches);n.x=o?parseInt(o.pageX,10):t.pageX,n.y=o?parseInt(o.pageX,10):t.pageX,n.start=!0,this.__setPress(t),r.addEventListener(this.events.end,this.onTouchEnd),r.addEventListener(this.events.cancel,this.onTouchCancel),r.addEventListener(this.events.move,this.onTouchMove),this.trigger(Hr.TOUCH_START,t)}},{key:"onTouchCancel",value:function(t){this.onTouchEnd(t)}},{key:"onTouchEnd",value:function(t){var n=this._pos,r=this.root,s=this.config;s.needPreventDefault&&Kx(t),this.__clearPress(),r.removeEventListener(this.events.cancel,this.onTouchCancel),r.removeEventListener(this.events.end,this.onTouchEnd),r.removeEventListener(this.events.move,this.onTouchMove),t.moving=n.moving,t.press=n.press,n.press&&this.trigger(Hr.PRESS_END,t),this.trigger(Hr.TOUCH_END,t),!n.press&&!n.moving&&this.__setDb(t),n.press=!1,n.start=!1,n.moving=!1}},{key:"onTouchMove",value:function(t){var n=this._pos,r=this.config,s=Yx(t.touches),o=s?parseInt(s.pageX,10):t.pageX,a=s?parseInt(s.pageY,10):t.pageX,l=o-n.x,u=a-n.y;Math.abs(u)<r.miniStep&&Math.abs(l)<r.miniStep||(this.__clearPress(),n.press&&this.trigger(Hr.PRESS_END,t),n.press=!1,n.moving=!0,this.trigger(Hr.TOUCH_MOVE,t))}},{key:"destroy",value:function(){var t=this,n={touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};Object.keys(n).map(function(r){t.root.removeEventListener("touchend",t[n[r]])})}}]),i}();function WM(){return new DOMParser().parseFromString(`<svg width="20" height="9" viewBox="0 0 8 9" fill="none" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path opacity="0.54"
    d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z"
    fill="white" />
  <path transform="translate(5 0)" d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z" fill="white"/>
</svg>`,"image/svg+xml").firstChild}var Io={AUTO:"auto",SEEKING:"seeking",PLAYBACK:"playbackrate",LIGHT:""},qM=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),q(V(r),"onTouchStart",function(s){var o=V(r),a=o.player,l=o.config,u=o.pos,c=o.playerConfig,h=r.getTouche(s);if(h&&!l.disableGesture&&r.duration>0&&!a.ended){u.isStart=!0,k.checkIsFunction(c.disableSwipeHandler)&&c.disableSwipeHandler(),r.find(".xg-dur").innerHTML=k.format(r.duration);var f=r.root.getBoundingClientRect();a.rotateDeg===90?(u.top=f.left,u.left=f.top,u.width=f.height,u.height=f.width):(u.top=f.top,u.left=f.left,u.width=f.width,u.height=f.height);var d=parseInt(h.pageX-u.left,10),p=parseInt(h.pageY-u.top,10);u.x=a.rotateDeg===90?p:d,u.y=a.rotateDeg===90?d:p,u.scopeL=l.scopeL*u.width,u.scopeR=(1-l.scopeR)*u.width,u.scopeM1=u.width*(1-l.scopeM)/2,u.scopeM2=u.width-u.scopeM1}}),q(V(r),"onTouchMove",function(s){var o=r.getTouche(s),a=V(r),l=a.pos,u=a.config,c=a.player;if(!(!o||u.disableGesture||!r.duration||!l.isStart)){var h=u.miniMoveStep,f=u.hideControlsActive,d=parseInt(o.pageX-l.left,10),p=parseInt(o.pageY-l.top,10),g=c.rotateDeg===90?p:d,m=c.rotateDeg===90?d:p;if(Math.abs(g-l.x)>h||Math.abs(m-l.y)>h){var v=g-l.x,O=m-l.y,y=l.scope;if(y===-1&&(y=r.checkScope(g,m,v,O,l),y===0&&(f?c.blur():c.focus({autoHide:!1}),!l.time&&(l.time=parseInt(c.currentTime*1e3,10)+r.timeOffset*1e3)),l.scope=y),y===-1||y>0&&!u.gestureY||y===0&&!u.gestureX)return;s.cancelable&&s.preventDefault(),r.executeMove(v,O,y,l.width,l.height),l.x=g,l.y=m}}}),q(V(r),"onTouchEnd",function(s){var o=V(r),a=o.player,l=o.pos,u=o.playerConfig;if(l.isStart){l.scope>-1&&s.cancelable&&s.preventDefault();var c=r.config,h=c.disableGesture,f=c.gestureX;!h&&f?(r.endLastMove(l.scope),setTimeout(function(){a.getPlugin("progress")&&a.getPlugin("progress").resetSeekState()},10)):l.time=0,l.scope=-1,r.resetPos(),k.checkIsFunction(u.enableSwipeHandler)&&u.enableSwipeHandler(),r.changeAction(Io.AUTO)}}),q(V(r),"onRootTouchMove",function(s){r.config.disableGesture||!r.config.gestureX||r.checkIsRootTarget(s)&&(s.stopPropagation(),r.pos.isStart?r.onTouchMove(s):r.onTouchStart(s))}),q(V(r),"onRootTouchEnd",function(s){r.pos.isStart&&r.checkIsRootTarget(s)&&(s.stopPropagation(),r.onTouchEnd(s))}),r.pos={isStart:!1,x:0,y:0,time:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1},r.timer=null,r}return me(t,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"registerIcons",value:function(){return{seekTipIcon:{icon:WM,class:"xg-seek-pre"}}}},{key:"afterCreate",value:function(){var r=this,s=this.playerConfig,o=this.config,a=this.player;s.closeVideoDblclick===!0&&(o.closedbClick=!0),this.resetPos(),k.isUndefined(s.disableGesture)||(o.disableGesture=!!s.disableGesture),this.appendChild(".xg-seek-icon",this.icons.seekTipIcon),this.xgMask=k.createDom("xg-mask","",{},"xgmask"),a.root.appendChild(this.xgMask),this.initCustomStyle(),this.registerThumbnail();var l=this.domEventType;this.touch=new zM(this.root,{eventType:l,needPreventDefault:!this.config.disableGesture}),this.root.addEventListener("contextmenu",function(h){h.preventDefault()}),a.root.addEventListener("touchmove",this.onRootTouchMove,!0),a.root.addEventListener("touchend",this.onRootTouchEnd,!0),this.on(Is,function(){var h=r.player,f=r.config;h.duration*1e3<f.moveDuration&&(f.moveDuration=h.duration*1e3)}),this.on([Dn,Ls],function(){var h=r.pos,f=h.time,d=h.isStart;!d&&f>0&&(r.pos.time=0)});var u={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",press:"onPress",pressend:"onPressEnd",click:"onClick",doubleclick:"onDbClick"};if(Object.keys(u).map(function(h){r.touch.on(h,function(f){r[u[h]](f)})}),!o.disableActive){var c=a.plugins.progress;c&&(c.addCallBack("dragmove",function(h){r.activeSeekNote(h.currentTime,h.forward)}),c.addCallBack("dragend",function(){r.changeAction(Io.AUTO)}))}}},{key:"registerThumbnail",value:function(){var r=this.player,s=r.plugins.thumbnail;if(s&&s.usable){this.thumbnail=s.createThumbnail(null,"mobile-thumbnail");var o=this.find(".time-preview");o.insertBefore(this.thumbnail,o.children[0])}}},{key:"initCustomStyle",value:function(){var r=this.playerConfig||{},s=r.commonStyle,o=s.playedColor,a=s.progressColor;o&&(this.find(".xg-curbar").style.backgroundColor=o,this.find(".xg-cur").style.color=o),a&&(this.find(".xg-bar").style.backgroundColor=a,this.find(".time-preview").style.color=a),this.config.disableTimeProgress&&k.addClass(this.find(".xg-timebar"),"hide")}},{key:"resetPos",value:function(){var r=this;this.pos?(this.pos.isStart=!1,this.pos.scope=-1,["x","y","width","height","scopeL","scopeR","scopeM1","scopeM2"].map(function(s){r.pos[s]=0})):this.pos={isStart:!1,x:0,y:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1,time:0}}},{key:"changeAction",value:function(r){var s=this.player,o=this.root;o.setAttribute("data-xg-action",r);var a=s.plugins.start;a&&a.recover()}},{key:"getTouche",value:function(r){var s=this.player.rotateDeg,o=r.touches&&r.touches.length>0?r.touches[r.touches.length-1]:r;return s===0?{pageX:o.pageX,pageY:o.pageY}:{pageX:o.pageX,pageY:o.pageY}}},{key:"checkScope",value:function(r,s,o,a,l){var u=l.width,c=-1;if(r<0||r>u)return c;var h=Math.abs(a===0?o:o/a);return Math.abs(o)>0&&h>=1.73&&r>l.scopeM1&&r<l.scopeM2?c=0:(Math.abs(o)===0||h<=.57)&&(c=r<l.scopeL?1:r>l.scopeR?2:3),c}},{key:"executeMove",value:function(r,s,o,a,l){switch(o){case 0:this.updateTime(r/a*this.config.scopeM);break;case 1:this.updateBrightness(s/l);break;case 2:Le.os.isIos||this.updateVolume(s/l);break}}},{key:"endLastMove",value:function(r){var s=this,o=this.pos,a=this.player,l=this.config,u=(o.time-this.timeOffset)/1e3;switch(r){case 0:a.seek(Number(u).toFixed(1)),l.hideControlsEnd?a.blur():a.focus(),this.timer=setTimeout(function(){s.pos.time=0},500);break}this.changeAction(Io.AUTO)}},{key:"checkIsRootTarget",value:function(r){var s=this.player.plugins||{};return s.progress&&s.progress.root.contains(r.target)?!1:s.start&&s.start.root.contains(r.target)||s.controls&&s.controls.root.contains(r.target)}},{key:"sendUseAction",value:function(r){var s=this.player.paused;this.emitUserAction(r,"switch_play_pause",{prop:"paused",from:s,to:!s})}},{key:"onClick",value:function(r){var s=this.player,o=this.config,a=this.playerConfig;if(s.state<Ge.RUNNING){a.closeVideoClick||(this.sendUseAction(k.createEvent("click")),s.play());return}!o.closedbClick||a.closeVideoClick?s.isActive?s.blur():s.focus():a.closeVideoClick||((s.isActive||o.focusVideoClick)&&(this.emitUserAction("click","switch_play_pause"),this.switchPlayPause()),s.focus())}},{key:"onDbClick",value:function(r){var s=this.config,o=this.player;!s.closedbClick&&o.state>=Ge.RUNNING&&(this.sendUseAction(k.createEvent("dblclick")),this.switchPlayPause())}},{key:"onPress",value:function(r){var s=this.pos,o=this.config,a=this.player;o.disablePress||(s.rate=this.player.playbackRate,this.emitUserAction("press","change_rate",{prop:"playbackRate",from:a.playbackRate,to:o.pressRate}),a.playbackRate=o.pressRate,this.changeAction(Io.PLAYBACK))}},{key:"onPressEnd",value:function(r){var s=this.pos,o=this.config,a=this.player;o.disablePress||(this.emitUserAction("pressend","change_rate",{prop:"playbackRate",from:a.playbackRate,to:s.rate}),a.playbackRate=s.rate,s.rate=1,this.changeAction(Io.AUTO))}},{key:"updateTime",value:function(r){var s=this.player,o=this.config,a=this.player.duration;r=Number(r.toFixed(4));var l=parseInt(r*o.moveDuration,10)+this.timeOffset;l+=this.pos.time,l=l<0?0:l>a*1e3?a*1e3-200:l,s.getPlugin("time")&&s.getPlugin("time").updateTime(l/1e3),s.getPlugin("progress")&&s.getPlugin("progress").updatePercent(l/1e3/this.duration,!0),this.activeSeekNote(l/1e3,r>0),o.isTouchingSeek&&s.seek(Number((l-this.timeOffset)/1e3).toFixed(1)),this.pos.time=l}},{key:"updateVolume",value:function(r){this.player.rotateDeg&&(r=-r);var s=this.player,o=this.pos;if(r=parseInt(r*100,10),o.volume+=r,!(Math.abs(o.volume)<10)){var a=parseInt(s.volume*10,10)-parseInt(o.volume/10,10);a=a>10?10:a<1?0:a,s.volume=a/10,o.volume=0}}},{key:"updateBrightness",value:function(r){this.player.rotateDeg&&(r=-r);var s=this.pos,o=this.config,a=this.xgMask,l=s.light+.8*r;l=l>o.maxDarkness?o.maxDarkness:l<0?0:l,a&&(a.style.backgroundColor="rgba(0,0,0,".concat(l,")")),s.light=l}},{key:"activeSeekNote",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=this.player,a=this.config,l=!(this.duration!==1/0&&this.duration>0);if(!(!r||typeof r!="number"||l||a.disableActive)){r<0?r=0:r>o.duration&&(r=o.duration-.2),this.changeAction(Io.SEEKING);var u=o.plugins.start;u&&u.focusHide(),this.find(".xg-dur").innerHTML=k.format(this.duration),this.find(".xg-cur").innerHTML=k.format(r),this.find(".xg-curbar").style.width="".concat(r/this.duration*100,"%"),s?k.removeClass(this.find(".xg-seek-show"),"xg-back"):k.addClass(this.find(".xg-seek-show"),"xg-back"),this.updateThumbnails(r)}}},{key:"updateThumbnails",value:function(r){var s=this.player,o=s.plugins.thumbnail;o&&o.usable&&this.thumbnail&&o.update(this.thumbnail,r,160,90)}},{key:"switchPlayPause",value:function(){var r=this.player;if(r.state<Ge.ATTACHED)return!1;r.ended||(r.paused?r.play():r.pause())}},{key:"disableGesture",value:function(){this.config.disableGesture=!1}},{key:"enableGesture",value:function(){this.config.disableGesture=!0}},{key:"destroy",value:function(){var r=this.player;this.timer&&clearTimeout(this.timer),this.thumbnail=null,r.root.removeChild(this.xgMask),this.xgMask=null,this.touch&&this.touch.destroy(),this.touch=null,r.root.removeEventListener("touchmove",this.onRootTouchMove,!0),r.root.removeEventListener("touchend",this.onRootTouchEnd,!0)}},{key:"render",value:function(){var r=this.config.gradient!=="normal"?"gradient ".concat(this.config.gradient):"gradient";return`
     <xg-trigger class="trigger">
     <div class="`.concat(r,`"></div>
        <div class="time-preview">
            <div class="xg-seek-show `).concat(this.config.disableSeekIcon?" hide-seek-icon":"",`">
              <i class="xg-seek-icon"></i>
              <span class="xg-cur">00:00</span>
              <span>/</span>
              <span class="xg-dur">00:00</span>
            </div>
              <div class="xg-bar xg-timebar">
                <div class="xg-curbar"></div>
              </div>
        </div>
        <div class="xg-playbackrate xg-top-note">
            <span><i>`).concat(this.config.pressRate,"X</i>").concat(this.i18n.FORWARD,`</span>
        </div>
     </xg-trigger>
    `)}}],[{key:"pluginName",get:function(){return"mobile"}},{key:"defaultConfig",get:function(){return{index:0,disableGesture:!1,gestureX:!0,gestureY:!0,gradient:"normal",isTouchingSeek:!1,miniMoveStep:5,miniYPer:5,scopeL:.25,scopeR:.25,scopeM:.9,pressRate:2,darkness:!0,maxDarkness:.8,disableActive:!1,disableTimeProgress:!1,hideControlsActive:!1,hideControlsEnd:!1,moveDuration:60*6*1e3,closedbClick:!1,disablePress:!0,disableSeekIcon:!1,focusVideoClick:!1}}}]),t}(Re);function Jx(i){i.preventDefault(),i.returnValue=!1}function YM(i){var e=i.tagName;return!!(e==="INPUT"||e==="TEXTAREA"||i.isContentEditable)}var eS=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"onBodyKeyDown",function(a){var l=a||window.event;if(!(!n.player||!n.player.isUserActive&&!n.config.isIgnoreUserActive)&&!(n.config.disable||n.config.disableBodyTrigger||!n.checkIsVisible()||l.metaKey||l.altKey||l.ctrlKey)){var u=l.keyCode;return(l.target===document.body||n.config.isGlobalTrigger&&!YM(l.target))&&n.checkCode(u,!0)&&(Jx(l),n.handleKeyCode(u,a)),!1}}),q(V(n),"onKeydown",function(a){var l=a||window.event;if(!(n.config.disable||n.config.disableRootTrigger||l.metaKey||l.altKey||l.ctrlKey)&&!(!n.player.isUserActive&&!n.config.isIgnoreUserActive)&&!(!n.player.isUserActive&&!n.config.isIgnoreUserActive)){if(l&&(l.keyCode===37||n.checkCode(l.keyCode))&&(l.target===n.player.root||l.target===n.player.video||l.target===n.player.controls.el))Jx(l);else return!0;n.handleKeyCode(l.keyCode,a)}}),n}return me(t,[{key:"mergekeyCodeMap",value:function(){var r=this,s=this.config.keyCodeMap;s&&Object.keys(s).map(function(o){r.keyCodeMap[o]?["keyCode","action","disable","isBodyTarget"].map(function(a){s[o][a]&&(r.keyCodeMap[o][a]=s[o][a])}):r.keyCodeMap[o]=s[o]})}},{key:"afterCreate",value:function(){this.config.disable=!this.playerConfig.keyShortcut;var r=typeof this.config.seekStep=="function"?this.config.seekStep(this.player):this.config.seekStep;!r||typeof r!="number"||(this.seekStep=r),this.keyCodeMap={space:{keyCode:32,action:"playPause",disable:!1,noBodyTarget:!1},up:{keyCode:38,action:"upVolume",disable:!1,noBodyTarget:!0},down:{keyCode:40,action:"downVolume",disable:!1,noBodyTarget:!0},left:{keyCode:37,action:"seekBack",disable:!1},right:{keyCode:39,action:"seek",disable:!1},esc:{keyCode:27,action:"exitFullscreen",disable:!1}},this.mergekeyCodeMap(),this.player.root.addEventListener("keydown",this.onKeydown),document.addEventListener("keydown",this.onBodyKeyDown)}},{key:"checkIsVisible",value:function(){if(!this.config.checkVisible)return!0;var r=this.player.root.getBoundingClientRect(),s=r.height,o=r.top,a=r.bottom,l=window.innerHeight;return!(o<0&&o<0-s*.9||a>0&&a-l>s*.9)}},{key:"checkCode",value:function(r,s){var o=this,a=!1;return Object.keys(this.keyCodeMap).map(function(l){o.keyCodeMap[l]&&r===o.keyCodeMap[l].keyCode&&!o.keyCodeMap[l].disable&&(a=!s||s&&!o.keyCodeMap[l].noBodyTarget)}),a}},{key:"downVolume",value:function(r){var s=this.player,o=parseFloat((s.volume-.1).toFixed(1)),a={volume:{from:s.volume,to:o}};this.emitUserAction(r,"change_volume",{props:a}),o>=0?s.volume=o:s.volume=0}},{key:"upVolume",value:function(r){var s=this.player,o=parseFloat((s.volume+.1).toFixed(1)),a={volume:{from:s.volume,to:o}};this.emitUserAction(r,"change_volume",{props:a}),o<=1?s.volume=o:s.volume=1}},{key:"seek",value:function(r){var s=this.player,o=s.currentTime,a=s.duration,l=o;o+this.seekStep<=a?l=o+this.seekStep:l=a-1;var u={currentTime:{from:o,to:l}};this.emitUserAction(r,"seek",{props:u}),this.player.currentTime=l}},{key:"seekBack",value:function(r){var s=this.player.currentTime,o=0;s-this.seekStep>=0&&(o=s-this.seekStep);var a={currentTime:{from:s,to:o}};this.emitUserAction(r,"seek",{props:a}),this.player.currentTime=o}},{key:"playPause",value:function(r){var s=this.player;s&&(this.emitUserAction(r,"switch_play_pause"),s.paused?s.play():s.pause())}},{key:"exitFullscreen",value:function(r){var s=this.player,o=s.fullscreen,a=s.cssfullscreen;o&&(this.emitUserAction("keyup","switch_fullscreen",{prop:"fullscreen",from:o,to:!o}),s.exitFullscreen()),a&&(this.emitUserAction("keyup","switch_css_fullscreen",{prop:"cssfullscreen",from:a,to:!a}),s.exitCssFullscreen())}},{key:"handleKeyCode",value:function(r,s){var o=this;Object.keys(this.keyCodeMap).map(function(a){var l=o.keyCodeMap[a],u=l.action,c=l.keyCode,h=l.disable;c===r&&!h&&(typeof u=="function"?u(s,o.player):typeof u=="string"&&typeof o[u]=="function"&&o[u](s,o.player),o.emit(tA,St({key:a,target:s.target},o.keyCodeMap[a])))})}},{key:"destroy",value:function(){this.player.root.removeEventListener("keydown",this.onKeydown),document.removeEventListener("keydown",this.onBodyKeyDown)}},{key:"disable",value:function(){this.config.disable=!0}},{key:"enable",value:function(){this.config.disable=!1}}],[{key:"pluginName",get:function(){return"keyboard"}},{key:"defaultConfig",get:function(){return{seekStep:10,checkVisible:!0,disableBodyTrigger:!1,disableRootTrigger:!1,isGlobalTrigger:!1,keyCodeMap:{},disable:!1,isIgnoreUserActive:!1}}}]),t}(Ts);function KM(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-5 -5 110 110">
  <path d="M100,50A50,50,0,1,1,50,0" stroke-width="5" stroke="#ddd" stroke-dasharray="236" fill="none"></path>
</svg>
`,"image/svg+xml").firstChild}var JM=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"registerIcons",value:function(){return{loadingIcon:KM}}},{key:"afterCreate",value:function(){this.appendChild("xg-loading-inner",this.icons.loadingIcon)}},{key:"render",value:function(){return`
    <xg-loading class="xgplayer-loading">
      <xg-loading-inner></xg-loading-inner>
    </xg-loading>`}}],[{key:"pluginName",get:function(){return"loading"}},{key:"defaultConfig",get:function(){return{position:ht.ROOT}}}]),t}(Re),e4=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],t4=function(){function i(e){ge(this,i),this.fragments=e.fragments||[],this.fragments.length===0&&this.fragments.push({percent:1}),this._callBack=e.actionCallback,this.fragConfig={fragFocusClass:e.fragFocusClass||"inner-focus-point",fragAutoFocus:!!e.fragAutoFocus,fragClass:e.fragClass||""},this.style=e.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0,this.focusIndex=-1}return me(i,[{key:"updateDuration",value:function(t){var n=this;this.duration=t;var r=0,s=this.fragments;this.fragments=s.map(function(o){return o.start=parseInt(r,10),o.end=parseInt(r+o.percent*n.duration,10),o.duration=parseInt(o.percent*n.duration,10),r+=o.percent*n.duration,o})}},{key:"updateProgress",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"played",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},r=this.progressList,s=this.fragments;if(!(r.length<1)){var o=n.newIndex,a=n.curIndex,l=n.millisecond;o!==a&&r.map(function(h,f){f<o?h[t].style.width="100%":f>o&&(h[t].style.width=0)});var u=s[o],c=l===0?0:(l-u.start)/u.duration;r[o][t].style.width=c<0?0:"".concat(c*100,"%")}}},{key:"updateFocus",value:function(t){if(!(!this.fragConfig.fragAutoFocus||this.fragments.length<2)){if(!t){if(this.focusIndex>-1){this.unHightLight(this.focusIndex);var n={index:-1,preIndex:this.focusIndex,fragment:null};this._callBack&&this._callBack(n),this.focusIndex=-1}return}var r=this.findIndex(t.currentTime*1e3,this.focusIndex);if(r>=0&&r!==this.focusIndex){this.focusIndex>-1&&this.unHightLight(this.focusIndex),this.setHightLight(r);var s={index:r,preIndex:this.focusIndex,fragment:this.fragments[this.focusIndex]};this.focusIndex=r,this._callBack&&this._callBack(s)}}}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},n=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(n*1e3,10)!==this.duration){if(!n&&n!==0)return;this.updateDuration(parseInt(n*1e3,10))}var r=this.playedIndex,s=this.cachedIndex;if(k.typeOf(t.played)!=="Undefined"){var o=this.findIndex(t.played*1e3,r);if(o<0)return;this.updateProgress("played",{newIndex:o,curIndex:r,millisecond:parseInt(t.played*1e3,10)}),this.playedIndex=o}if(k.typeOf(t.cached)!=="Undefined"){var a=this.findIndex(t.cached*1e3,s);if(a<0)return;this.updateProgress("cached",{newIndex:a,curIndex:s,millisecond:parseInt(t.cached*1e3,10)}),this.cachedIndex=a}}},{key:"findIndex",value:function(t,n){var r=this.fragments;if(!r||r.length===0)return-1;if(r.length===1)return 0;if(n>-1&&n<r.length&&t>r[n].start&&t<r[n].end)return n;if(t>r[r.length-1].start)return r.length-1;for(var s=0;s<r.length;s++)if(t>r[s].start&&t<=r[s].end){n=s;break}return n}},{key:"findHightLight",value:function(){for(var t=this.root.children,n=0;n<t.length;n++)if(k.hasClass(t[n],this.fragConfig.fragFocusClass))return{dom:t[n],pos:t[n].getBoundingClientRect()}}},{key:"findFragment",value:function(t){var n=this.root.children;return t<0||t>=n.length?null:{dom:n[t],pos:n[t].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var t=this.root.children,n=0;n<t.length;n++)k.removeClass(t[n],this.fragConfig.fragFocusClass)}},{key:"setHightLight",value:function(t){var n=this.root.children;if(t<n.length)return k.addClass(n[t],this.fragConfig.fragFocusClass),{dom:n[t],pos:n[t].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"reset",value:function(t){var n=this;if(Object.keys(this.fragConfig).forEach(function(s){t[s]!==void 0&&(n.fragConfig[s]=t[s])}),t.fragments){if(this.fragments=t.fragments.length===0?[{percent:1}]:t.fragments,this.updateDuration(this.duration),this.playedIndex=0,this.cachedIndex=0,this.root)for(var r=this.root.children;r.length>0;)this.root.removeChild(r[0]);this.render()}}},{key:"render",value:function(){var t=this,n=this.style.progressColor;if(this.root||(this.root=k.createDom("xg-inners","",{},"progress-list")),this.fragments){var r=this.fragConfig,s=r.fragClass,o=r.fragFocusClass;this.progressList=this.fragments.map(function(a){var l=k.createDom("xg-inner","",{style:n?"background:".concat(n,"; flex: ").concat(a.percent):"flex: ".concat(a.percent)},"".concat(a.isFocus?o:""," xgplayer-progress-inner ").concat(s));return t.root.appendChild(l),e4.forEach(function(u){l.appendChild(k.createDom(u.tag,"",{style:u.styleKey?"background: ".concat(t.style[u.styleKey],"; width:0;"):"width:0;"},u.className))}),{cached:l.children[0],played:l.children[1]}})}return this.root}}]),i}(),tS={POINT:"inner-focus-point",HIGHLIGHT:"inner-focus-highlight"},i4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),q(V(r),"onMoveOnly",function(s,o){var a=V(r),l=a.pos,u=a.config,c=a.player,h=o;if(s){k.event(s);var f=k.getEventPos(s,c.zoom),d=c.rotateDeg===90?f.clientY:f.clientX;if(l.moving&&Math.abs(l.x-d)<u.miniMoveStep)return;l.moving=!0,l.x=d,h=r.computeTime(s,d)}r.triggerCallbacks("dragmove",h,s),r._updateInnerFocus(h)}),q(V(r),"onBodyClick",function(s){r.pos.isLocked&&(r.pos.isLocked=!1,s.preventDefault(),s.stopPropagation())}),q(V(r),"_mouseDownHandler",function(s,o){r._state.time=o.currentTime,r.updateWidth(o.currentTime,o.percent,0),r._updateInnerFocus(o)}),q(V(r),"_mouseUpHandler",function(s,o){var a=V(r),l=a.pos;l.moving&&r.updateWidth(o.currentTime,o.percent,2)}),q(V(r),"_mouseMoveHandler",function(s,o){var a=V(r),l=a._state,u=a.pos,c=a.config,h=a.player;l.time<o.currentTime?o.forward=!0:o.forward=!1,l.time=o.currentTime,u.isDown&&!u.moving&&(u.moving=!0,c.isPauseMoving&&h.pause(),r.triggerCallbacks("dragstart",o,s),r.emitUserAction("drag","dragstart",o)),r.updateWidth(o.currentTime,o.percent,1),r.triggerCallbacks("dragmove",o,s),r._updateInnerFocus(o)}),q(V(r),"onMouseDown",function(s){var o=V(r),a=o._state,l=o.player,u=o.pos,c=o.config,h=o.playerConfig,f=k.getEventPos(s,l.zoom),d=l.rotateDeg===90?f.clientY:f.clientX;if(!(l.isMini||c.closeMoveSeek||!h.allowSeekAfterEnded&&l.ended)){s.stopPropagation(),r.focus(),k.checkIsFunction(h.disableSwipeHandler)&&h.disableSwipeHandler(),k.checkIsFunction(c.onMoveStart)&&c.onMoveStart(),k.event(s),u.x=d,u.isDown=!0,u.moving=!1,a.prePlayTime=l.currentTime,l.focus({autoHide:!1}),r.isProgressMoving=!0,k.addClass(r.progressBtn,"active");var p=r.computeTime(s,d);p.prePlayTime=a.prePlayTime,r._mouseDownHandlerHook(s,p);var g=s.type;return g==="touchstart"?(r.root.addEventListener("touchmove",r.onMouseMove),r.root.addEventListener("touchend",r.onMouseUp)):(r.unbind("mousemove",r.onMoveOnly),document.addEventListener("mousemove",r.onMouseMove,!1),document.addEventListener("mouseup",r.onMouseUp,!1)),!0}}),q(V(r),"onMouseUp",function(s){var o=V(r),a=o.player,l=o.config,u=o.pos,c=o.playerConfig,h=o._state;s.stopPropagation(),s.preventDefault(),k.checkIsFunction(c.enableSwipeHandler)&&c.enableSwipeHandler(),k.checkIsFunction(l.onMoveEnd)&&l.onMoveEnd(),k.event(s),k.removeClass(r.progressBtn,"active");var f=r.computeTime(s,u.x);f.prePlayTime=h.prePlayTime,u.moving?(r.triggerCallbacks("dragend",f,s),r.emitUserAction("drag","dragend",f)):(r.triggerCallbacks("click",f,s),r.emitUserAction("click","click",f)),r._mouseUpHandlerHook(s,f),u.moving=!1,u.isDown=!1,u.x=0,u.y=0,u.isLocked=!0,h.prePlayTime=0,h.time=0;var d=s.type;d==="touchend"?(r.root.removeEventListener("touchmove",r.onMouseMove),r.root.removeEventListener("touchend",r.onMouseUp),r.blur()):(document.removeEventListener("mousemove",r.onMouseMove,!1),document.removeEventListener("mouseup",r.onMouseUp,!1),u.isEnter?c.isMobileSimulateMode!=="mobile"&&r.bind("mousemove",r.onMoveOnly):r.onMouseLeave(s)),k.setTimeout(V(r),function(){r.resetSeekState()},10),a.focus()}),q(V(r),"onMouseMove",function(s){var o=V(r),a=o._state,l=o.pos,u=o.player,c=o.config;k.checkTouchSupport()&&s.preventDefault(),k.event(s);var h=k.getEventPos(s,u.zoom),f=u.rotateDeg===90?h.clientY:h.clientX,d=Math.abs(l.x-f);if(!(l.moving&&d<c.miniMoveStep||!l.moving&&d<c.miniStartStep)){l.x=f;var p=r.computeTime(s,f);p.prePlayTime=a.prePlayTime,r._mouseMoveHandlerHook(s,p)}}),q(V(r),"onMouseOut",function(s){r.triggerCallbacks("mouseout",null,s)}),q(V(r),"onMouseOver",function(s){r.triggerCallbacks("mouseover",null,s)}),q(V(r),"onMouseEnter",function(s){var o=V(r),a=o.player,l=o.pos;if(!(l.isDown||l.isEnter||a.isMini||!a.config.allowSeekAfterEnded&&a.ended)){l.isEnter=!0,r.bind("mousemove",r.onMoveOnly),r.bind("mouseleave",r.onMouseLeave),k.event(s);var u=k.getEventPos(s,a.zoom),c=a.rotateDeg===90?u.clientY:u.clientX,h=r.computeTime(s,c);r.triggerCallbacks("mouseenter",h,s),r.focus()}}),q(V(r),"onMouseLeave",function(s){r.triggerCallbacks("mouseleave",null,s),r.unlock(),r._updateInnerFocus(null)}),q(V(r),"onVideoResize",function(){var s=r.pos,o=s.x,a=s.isDown,l=s.isEnter;if(l&&!a){var u=r.computeTime(null,o);r.onMoveOnly(null,u)}}),r.useable=!1,r.isProgressMoving=!1,r.__dragCallBacks=[],r._state={now:-1,direc:0,time:0,prePlayTime:-1},r._disableBlur=!1,r}return me(t,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"changeState",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.useable=r}},{key:"_initInner",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(!s||s.length===0)&&(s=[{percent:1}]);var a=St(St({fragments:s},o),{},{actionCallback:function(u){r.emitUserAction("fragment_focus","fragment_focus",u)}});this.innerList?this.innerList.reset(a):(this.innerList=new t4(a),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(function(l){r[l]=r.innerList[l].bind(r.innerList)}))}},{key:"_updateInnerFocus",value:function(r){this.innerList&&this.innerList.updateFocus(r)}},{key:"afterCreate",value:function(){var r=this;if(!(this.config.disable||this.playerConfig.isLive)){this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1,isLocked:!1},this.outer=this.find("xg-outer");var s=this.config,o=s.fragFocusClass,a=s.fragAutoFocus,l=s.fragClass;this._initInner(this.config.fragments,{fragFocusClass:o,fragAutoFocus:a,fragClass:l,style:this.playerConfig.commonStyle||{}}),Le.device==="mobile"&&(this.config.isDragingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.on(Is,function(){r.onMouseLeave()}),this.on(cn,function(){r.onTimeupdate()}),this.on(Su,function(){r.onTimeupdate(),r.onCacheUpdate()}),this.on(W2,function(){r.onCacheUpdate()}),this.on(Ls,function(){r.onCacheUpdate(!0),r.onTimeupdate(!0),r._state.now=0}),this.on(rc,function(){r.onReset()}),this.on(Pa,function(){r.onVideoResize()}),this.bindDomEvents(),this.initCustomStyle()}}},{key:"setConfig",value:function(r){var s=this,o=null;Object.keys(r).forEach(function(a){s.config[a]=r[a],a==="fragments"&&(o=r[a])}),o&&this._initInner(o,r)}},{key:"initCustomStyle",value:function(){var r=this.playerConfig||{},s=r.commonStyle,o=s.sliderBtnStyle,a=this.progressBtn;o&&(typeof o=="string"?a.style.boxShadow=o:vi(o)==="object"&&Object.keys(o).map(function(l){a.style[l]=o[l]}))}},{key:"triggerCallbacks",value:function(r,s,o){this.__dragCallBacks.length>0&&this.__dragCallBacks.map(function(a){if(a&&a.handler&&a.type===r)try{a.handler(s,o)}catch(l){console.error("[XGPLAYER][triggerCallbacks] ".concat(a," error"),l)}})}},{key:"addCallBack",value:function(r,s){s&&typeof s=="function"&&this.__dragCallBacks.push({type:r,handler:s})}},{key:"removeCallBack",value:function(r,s){var o=this.__dragCallBacks,a=-1;o.map(function(l,u){l&&l.type===r&&l.handler===s&&(a=u)}),a>-1&&o.splice(a,1)}},{key:"unlock",value:function(){var r=this.player,s=this.pos;if(s.isEnter=!1,!r.isMini){if(this.unbind("mousemove",this.onMoveOnly),s.isDown){this.unbind("mouseleave",this.onMouseLeave);return}this.blur()}}},{key:"bindDomEvents",value:function(){var r=this.player,s=r.controls,o=r.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),(this.domEventType==="touch"||this.domEventType==="compatible")&&(this.root.addEventListener("touchstart",this.onMouseDown),s&&(s.root&&s.root.addEventListener("touchmove",k.stopPropagation),s.center&&s.center.addEventListener("touchend",k.stopPropagation))),(this.domEventType==="mouse"||this.domEventType==="compatible")&&(this.bind("mousedown",this.onMouseDown),o.isMobileSimulateMode!=="mobile"&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut),this.player.root.addEventListener("click",this.onBodyClick,!0))}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),k.addClass(this.root,"active")}},{key:"blur",value:function(){this._disableBlur||(this.player.controls.recoverAutoHide(),k.removeClass(this.root,"active"))}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(r,s,o){var a=this.config,l=this.player;if(!(a.isCloseClickSeek&&o===0)){var u=r>=l.duration?l.duration-a.endedDiff:Number(r).toFixed(1);this.updatePercent(s),this.updateTime(r),!(o===1&&(!a.isDragingSeek||l.config.mediaType==="audio"))&&(this._state.now=u,this._state.direc=u>l.currentTime?0:1,l.seek(u))}}},{key:"computeTime",value:function(r,s){var o=this.player,a=this.root.getBoundingClientRect(),l=a.width,u=a.height,c=a.top,h=a.left,f,d,p=s;o.rotateDeg===90?(f=u,d=c):(f=l,d=h);var g=p-d;g=g>f?f:g<0?0:g;var m=g/f;m=m<0?0:m>1?1:m;var v=parseInt(m*this.duration*1e3,10)/1e3;return{percent:m,currentTime:v,offset:g,width:f,left:d,e:r}}},{key:"updateTime",value:function(r){var s=this.player,o=this.duration;r>o?r=o:r<0&&(r=0);var a=s.plugins.time;a&&a.updateTime(r)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var r=this.player.plugins.time;r&&r.resetActive()}},{key:"updatePercent",value:function(r,s){if(this.isProgressMoving=!0,!this.config.disable){r=r>1?1:r<0?0:r,this.progressBtn.style.left="".concat(r*100,"%"),this.innerList.update({played:r*this.duration},this.duration);var o=this.player.plugins.miniprogress;o&&o.update({played:r*this.duration},this.duration)}}},{key:"onTimeupdate",value:function(r){var s=this.player,o=this._state,a=this.duration;if(!(s.isSeeking||this.isProgressMoving)){if(o.now>-1){var l=parseInt(o.now*1e3,10)-parseInt(s.currentTime*1e3,10);if(o.direc===0&&l>300||o.direc===1&&l>-300){o.now=-1;return}else o.now=-1}var u=this.timeOffset+s.currentTime;u=k.adjustTimeByDuration(u,a,r),this.innerList.update({played:u},a),this.progressBtn.style.left="".concat(u/a*100,"%");var c=this.player.plugins.miniprogress;c&&c.update({played:u},a)}}},{key:"onCacheUpdate",value:function(r){var s=this.player,o=this.duration;if(s){var a=s.bufferedPoint.end;a=k.adjustTimeByDuration(a,o,r),this.innerList.update({cached:a},o);var l=this.player.plugins.miniprogress;l&&l.update({cached:a},o)}}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0);var r=this.player.plugins.miniprogress;r&&r.update({cached:0,played:0},0)}},{key:"destroy",value:function(){var r=this.player,s=r.controls;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null;var o=this.domEventType;(o==="touch"||o==="compatible")&&(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),s&&(s.root&&s.root.removeEventListener("touchmove",k.stopPropagation),s.center&&s.center.removeEventListener("touchend",k.stopPropagation))),(o==="mouse"||o==="compatible")&&(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),r.root.removeEventListener("click",this.onBodyClick,!0))}},{key:"render",value:function(){if(!(this.config.disable||this.playerConfig.isLive)){var r=this.player.controls?this.player.controls.config.mode:"",s=r==="bottom"?"xgplayer-progress-bottom":"";return`
    <xg-progress class="xgplayer-progress `.concat(s,`">
      <xg-outer class="xgplayer-progress-outer">
        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
      </xg-outer>
    </xg-progress>
    `)}}}],[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],fragFocusClass:tS.POINT,fragClass:"",fragAutoFocus:!1,miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){},endedDiff:.2}}},{key:"FRAGMENT_FOCUS_CLASS",get:function(){return tS}}]),t}(Re),xo=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"_onMouseenter",function(a){n.emit("icon_mouseenter",{pluginName:n.pluginName})}),q(V(n),"_onMouseLeave",function(a){n.emit("icon_mouseleave",{pluginName:n.pluginName})}),n}return me(t,[{key:"afterCreate",value:function(){this.bind("mouseenter",this._onMouseenter),this.bind("mouseleave",this._onMouseLeave)}},{key:"destroy",value:function(){this.unbind("mouseenter",this._onMouseenter),this.unbind("mouseleave",this._onMouseLeave)}}]),t}(Re),n4=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"afterCreate",value:function(){var r=this;Ee(ke(t.prototype),"afterCreate",this).call(this);var s=this.player,o=this.config;o.disable||(this.initIcons(),this.btnClick=this.btnClick.bind(this),this.bind(["touchend","click"],this.btnClick),this.on([nl,ic],function(){r.animate(s.paused)}),this.on(dn,function(){r.animate(s.paused)}),this.animate(!0))}},{key:"registerIcons",value:function(){return{play:{icon:ay,class:"xg-icon-play"},pause:{icon:ly,class:"xg-icon-pause"}}}},{key:"btnClick",value:function(r){r.preventDefault(),r.stopPropagation();var s=this.player;return this.emitUserAction(r,"switch_play_pause",{prop:"paused",from:s.paused,to:!s.paused}),s.ended?s.replay():s.paused?(s.play(),this.animate(!1)):(s.pause(),this.animate(!0)),!1}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".xgplayer-icon",r.play),this.appendChild(".xgplayer-icon",r.pause)}},{key:"animate",value:function(r){var s=this.i18nKeys,o=this.find(".xg-tips");r?(this.setAttr("data-state","pause"),o&&this.changeLangTextKey(o,s.PLAY_TIPS)):(this.setAttr("data-state","play"),o&&this.changeLangTextKey(o,s.PAUSE_TIPS))}},{key:"destroy",value:function(){Ee(ke(t.prototype),"destroy",this).call(this),this.unbind(["touchend","click"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-play">
    <div class="xgplayer-icon">
    </div>
    `.concat(Ds(this,"PLAY_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"play"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_LEFT,index:0,disable:!1}}}]),t}(xo);function r4(){return new DOMParser().parseFromString(`<svg width="32px" height="40px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M11.2374369,14 L17.6187184,7.61871843 C17.9604272,7.27700968 17.9604272,6.72299032 17.6187184,6.38128157 C17.2770097,6.03957281 16.7229903,6.03957281 16.3812816,6.38128157 L9.38128157,13.3812816 C9.03957281,13.7229903 9.03957281,14.2770097 9.38128157,14.6187184 L16.3812816,21.6187184 C16.7229903,21.9604272 17.2770097,21.9604272 17.6187184,21.6187184 C17.9604272,21.2770097 17.9604272,20.7229903 17.6187184,20.3812816 L11.2374369,14 L11.2374369,14 Z" fill="#FFFFFF"></path>
    </g>
</svg>`,"image/svg+xml").firstChild}var s4=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"afterCreate",value:function(){var r=this;this.initIcons(),this.onClick=function(s){s.preventDefault(),s.stopPropagation(),r.config.onClick(s)},this.bind(["click","touchend"],this.onClick)}},{key:"registerIcons",value:function(){return{screenBack:{icon:r4,class:"xg-fullscreen-back"}}}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(this.root,r.screenBack)}},{key:"show",value:function(){k.addClass(this.root,"show")}},{key:"hide",value:function(){k.removeClass(this.root,"show")}},{key:"render",value:function(){return`<xg-icon class="xgplayer-back">
    </xg-icon>`}}],[{key:"pluginName",get:function(){return"topbackicon"}},{key:"defaultConfig",get:function(){return{position:ht.ROOT_TOP,index:0}}}]),t}(Re);function o4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>
</svg>
`,"image/svg+xml").firstChild}function a4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>
</svg>
`,"image/svg+xml").firstChild}var l4=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"_onOrientationChange",function(a){n.player.fullscreen&&n.config.rotateFullscreen&&(window.orientation===90||window.orientation===-90?n.player.setRotateDeg(0):n.player.setRotateDeg(90))}),n}return me(t,[{key:"afterCreate",value:function(){var r=this;Ee(ke(t.prototype),"afterCreate",this).call(this);var s=this.config,o=this.playerConfig;if(!s.disable){s.target&&(this.playerConfig.fullscreenTarget=this.config.target);var a=k.getFullScreenEl();o.fullscreenTarget===a&&this.player.getFullscreen().catch(function(l){}),this.initIcons(),this.handleFullscreen=this.hook("fullscreenChange",this.toggleFullScreen,{pre:function(u){var c=r.player.fullscreen;r.emitUserAction(u,"switch_fullscreen",{prop:"fullscreen",from:c,to:!c})}}),this.bind(".xgplayer-fullscreen",["touchend","click"],this.handleFullscreen),this.on(is,function(l){var u=r.find(".xg-tips");u&&r.changeLangTextKey(u,l?r.i18nKeys.EXITFULLSCREEN_TIPS:r.i18nKeys.FULLSCREEN_TIPS),r.animate(l)}),this.config.needBackIcon&&(this.topBackIcon=this.player.registerPlugin({plugin:s4,options:{config:{onClick:function(u){r.handleFullscreen(u)}}}})),Le.device==="mobile"&&window.addEventListener("orientationchange",this._onOrientationChange)}}},{key:"registerIcons",value:function(){return{fullscreen:{icon:o4,class:"xg-get-fullscreen"},exitFullscreen:{icon:a4,class:"xg-exit-fullscreen"}}}},{key:"destroy",value:function(){Ee(ke(t.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",Le.device==="mobile"?"touchend":"click",this.handleFullscreen),Le.device==="mobile"&&window.removeEventListener("orientationchange",this._onOrientationChange)}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".xgplayer-icon",r.fullscreen),this.appendChild(".xgplayer-icon",r.exitFullscreen)}},{key:"toggleFullScreen",value:function(r){r&&(r.preventDefault(),r.stopPropagation());var s=this.player,o=this.config,a=o.useCssFullscreen===!0||typeof o.useCssFullscreen=="function"&&o.useCssFullscreen();a?(s.fullscreen?s.exitCssFullscreen():s.getCssFullscreen(),this.animate(s.fullscreen)):o.rotateFullscreen?(s.fullscreen?s.exitRotateFullscreen():s.getRotateFullscreen(),this.animate(s.fullscreen)):o.switchCallback&&typeof o.switchCallback=="function"?o.switchCallback(s.fullscreen):s.fullscreen?s.exitFullscreen():s.getFullscreen().catch(function(l){})}},{key:"animate",value:function(r){r?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.topBackIcon&&(r?(this.topBackIcon.show(),this.hide()):(this.topBackIcon.hide(),this.show()))}},{key:"show",value:function(){Ee(ke(t.prototype),"show",this).call(this)}},{key:"hide",value:function(){Ee(ke(t.prototype),"hide",this).call(this)}},{key:"render",value:function(){if(!this.config.disable){var r="FULLSCREEN_TIPS";return`<xg-icon class="xgplayer-fullscreen">
    <div class="xgplayer-icon">
    </div>
    `.concat(Ds(this,r,this.playerConfig.isHideTips),`
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"fullscreen"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:0,useCssFullscreen:!1,rotateFullscreen:!1,switchCallback:null,target:null,disable:!1,needBackIcon:!1}}}]),t}(xo),u4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),r.isActiving=!1,r}return me(t,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"currentTime",get:function(){return this.player.currentTime||0}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"afterCreate",value:function(){var r=this,s=this.player.controls.config.mode;this.mode=s==="flex"?"flex":"normal",!this.config.disable&&(this.mode==="flex"&&(this.createCenterTime(),this.hide()),this.durationDom=this.find(".time-duration"),this.timeDom=this.find(".time-current"),this.on(Is,function(){r.onTimeUpdate()}),this.on(cn,function(){r.onTimeUpdate()}),this.on(Ls,function(){r.onTimeUpdate(!0)}),this.on(rc,function(){r.onReset()}))}},{key:"show",value:function(){this.mode!=="flex"&&Ee(ke(t.prototype),"show",this).call(this)}},{key:"onTimeUpdate",value:function(r){var s=this.player,o=this.config,a=this.duration;if(!(o.disable||this.isActiving||!s.hasStart)){var l=s.currentTime+this.timeOffset;l=k.adjustTimeByDuration(l,a,r),this.mode==="flex"?(this.centerCurDom.innerHTML=k.format(l),a!==1/0&&a>0&&(this.centerDurDom.innerHTML=k.format(a))):(this.timeDom.innerHTML=k.format(l),a!==1/0&&a>0&&(this.durationDom.innerHTML=k.format(a)))}}},{key:"onReset",value:function(){this.mode==="flex"?(this.centerCurDom.innerHTML=k.format(0),this.centerDurDom.innerHTML=k.format(0)):(this.timeDom.innerHTML=k.format(0),this.durationDom.innerHTML=k.format(0))}},{key:"createCenterTime",value:function(){var r=this.player;if(!(!r.controls||!r.controls.center)){var s=r.controls.center;this.centerCurDom=k.createDom("xg-icon","00:00",{},"xgplayer-time left"),this.centerDurDom=k.createDom("xg-icon","00:00",{},"xgplayer-time right"),s.children.length>0?s.insertBefore(this.centerCurDom,s.children[0]):s.appendChild(this.centerCurDom),s.appendChild(this.centerDurDom)}}},{key:"afterPlayerInit",value:function(){var r=this.config;if(this.duration===1/0||this.playerConfig.isLive?(k.hide(this.durationDom),k.hide(this.timeDom),k.hide(this.find(".time-separator")),k.show(this.find(".time-live-tag"))):k.hide(this.find(".time-live-tag")),r.hide){this.hide();return}this.show()}},{key:"changeLiveState",value:function(r){r?(k.hide(this.durationDom),k.hide(this.timeDom),k.hide(this.find(".time-separator")),k.show(this.find(".time-live-tag"))):(k.hide(this.find(".time-live-tag")),k.show(this.find(".time-separator")),k.show(this.durationDom),k.show(this.timeDom))}},{key:"updateTime",value:function(r){if(this.isActiving=!0,!(!r&&r!==0||r>this.duration)){if(this.mode==="flex"){this.centerCurDom.innerHTML=k.format(r);return}this.timeDom.innerHTML=k.format(r)}}},{key:"resetActive",value:function(){var r=this,s=this.player,o=function(){r.isActiving=!1};this.off(Su,o),s.isSeeking?this.once(Su,o):this.isActiving=!1}},{key:"destroy",value:function(){var r=this.player.controls.center;this.centerCurDom&&r.removeChild(this.centerCurDom),this.centerCurDom=null,this.centerDurDom&&r.removeChild(this.centerDurDom),this.centerDurDom=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-time">
    <span class="time-current">00:00</span>
    <span class="time-separator">/</span>
    <span class="time-duration">00:00</span>
    <span class="time-live-tag">`.concat(this.i18n.LIVE_TIP,`</span>
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"time"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_LEFT,index:2,disable:!1}}}]),t}(Re);function c4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function h4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function f4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`,"image/svg+xml").firstChild}var d4=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"onBarMousedown",function(a){var l=V(n),u=l.player,c=n.find(".xgplayer-bar");k.event(a);var h=c.getBoundingClientRect(),f=k.getEventPos(a,u.zoom),d=h.height-(f.clientY-h.top);if(f.h=d,f.barH=h.height,n.pos=f,!(d<-2))return n.updateVolumePos(d,a),document.addEventListener("mouseup",n.onBarMouseUp),n._d.isStart=!0,!1}),q(V(n),"onBarMouseMove",function(a){var l=V(n),u=l._d;if(u.isStart){var c=V(n),h=c.pos,f=c.player;a.preventDefault(),a.stopPropagation(),k.event(a);var d=k.getEventPos(a,f.zoom);u.isMoving=!0;var p=h.h-d.clientY+h.clientY;p>h.barH||n.updateVolumePos(p,a)}}),q(V(n),"onBarMouseUp",function(a){k.event(a),document.removeEventListener("mouseup",n.onBarMouseUp);var l=V(n),u=l._d;u.isStart=!1,u.isMoving=!1}),q(V(n),"onMouseenter",function(a){n._d.isActive=!0,n.focus(),n.emit("icon_mouseenter",{pluginName:n.pluginName})}),q(V(n),"onMouseleave",function(a){n._d.isActive=!1,n.unFocus(100,!1,a),n.emit("icon_mouseleave",{pluginName:n.pluginName})}),q(V(n),"onVolumeChange",function(a){if(n.player){var l=n.player,u=l.muted,c=l.volume;n._d.isMoving||(n.find(".xgplayer-drag").style.height=u||c===0?"4px":"".concat(c*100,"%"),n.config.showValueLabel&&n.updateVolumeValue()),n.animate(u,c)}}),n}return me(t,[{key:"registerIcons",value:function(){return{volumeSmall:{icon:h4,class:"xg-volume-small"},volumeLarge:{icon:c4,class:"xg-volume"},volumeMuted:{icon:f4,class:"xg-volume-mute"}}}},{key:"afterCreate",value:function(){var r=this;if(this._timerId=null,this._d={isStart:!1,isMoving:!1,isActive:!1},!this.config.disable){this.initIcons();var s=this.playerConfig,o=s.commonStyle,a=s.volume;o.volumeColor&&(this.find(".xgplayer-drag").style.backgroundColor=o.volumeColor),this.changeMutedHandler=this.hook("mutedChange",function(l){r.changeMuted(l)},{pre:function(u){u.preventDefault(),u.stopPropagation()}}),this._onMouseenterHandler=this.hook("mouseenter",this.onMouseenter),this._onMouseleaveHandler=this.hook("mouseleave",this.onMouseleave),Le.device!=="mobile"&&this.playerConfig.isMobileSimulateMode!=="mobile"&&(this.bind("mouseenter",this._onMouseenterHandler),this.bind(["blur","mouseleave"],this._onMouseleaveHandler),this.bind(".xgplayer-slider","mousedown",this.onBarMousedown),this.bind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.bind(".xgplayer-slider","mouseup",this.onBarMouseUp)),this.bind(".xgplayer-icon",["touchend","click"],this.changeMutedHandler),this.on(X2,this.onVolumeChange),this.once(co,this.onVolumeChange),k.typeOf(a)!=="Number"&&(this.player.volume=this.config.default),this.onVolumeChange()}}},{key:"updateVolumePos",value:function(r,s){var o=this.player,a=this.find(".xgplayer-drag"),l=this.find(".xgplayer-bar");if(!(!l||!a)){var u=parseInt(r/l.getBoundingClientRect().height*1e3,10);a.style.height="".concat(r,"px");var c=Math.max(Math.min(u/1e3,1),0),h={volume:{from:o.volume,to:c}};o.muted&&(h.muted={from:!0,to:!1}),this.emitUserAction(s,"change_volume",{muted:o.muted,volume:o.volume,props:h}),o.volume=Math.max(Math.min(u/1e3,1),0),o.muted&&(o.muted=!1),this.config.showValueLabel&&this.updateVolumeValue()}}},{key:"updateVolumeValue",value:function(){var r=this.player,s=r.volume,o=r.muted,a=this.find(".xgplayer-value-label"),l=Math.max(Math.min(s,1),0);a.innerText=o?0:Math.ceil(l*100)}},{key:"focus",value:function(){var r=this.player;r.focus({autoHide:!1}),this._timerId&&(k.clearTimeout(this,this._timerId),this._timerId=null),k.addClass(this.root,"slide-show")}},{key:"unFocus",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2?arguments[2]:void 0,l=this._d,u=this.player;l.isActive||(this._timerId&&(k.clearTimeout(this,this._timerId),this._timerId=null),this._timerId=k.setTimeout(this,function(){l.isActive||(o?u.blur():u.focus(),k.removeClass(r.root,"slide-show"),l.isStart&&r.onBarMouseUp(a)),r._timerId=null},s))}},{key:"changeMuted",value:function(r){r&&r.stopPropagation();var s=this.player,o=this._d;o.isStart&&this.onBarMouseUp(r),this.emitUserAction(r,"change_muted",{muted:s.muted,volume:s.volume,props:{muted:{from:s.muted,to:!s.muted}}}),s.volume>0&&(s.muted=!s.muted),s.volume<.01&&(s.volume=this.config.miniVolume)}},{key:"animate",value:function(r,s){r||s===0?this.setAttr("data-state","mute"):s<.5&&this.icons.volumeSmall?this.setAttr("data-state","small"):this.setAttr("data-state","normal")}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".xgplayer-icon",r.volumeSmall),this.appendChild(".xgplayer-icon",r.volumeLarge),this.appendChild(".xgplayer-icon",r.volumeMuted)}},{key:"destroy",value:function(){this._timerId&&(k.clearTimeout(this,this._timerId),this._timerId=null),this.unbind("mouseenter",this.onMouseenter),this.unbind(["blur","mouseleave"],this.onMouseleave),this.unbind(".xgplayer-slider","mousedown",this.onBarMousedown),this.unbind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.unbind(".xgplayer-slider","mouseup",this.onBarMouseUp),document.removeEventListener("mouseup",this.onBarMouseUp),this.unbind(".xgplayer-icon",Le.device==="mobile"?"touchend":"click",this.changeMutedHandler)}},{key:"render",value:function(){if(!this.config.disable){var r=this.config.default||this.player.volume,s=this.config.showValueLabel;return`
    <xg-icon class="xgplayer-volume" data-state="normal">
      <div class="xgplayer-icon">
      </div>
      <xg-slider class="xgplayer-slider">
        `.concat(s?'<div class="xgplayer-value-label">'.concat(r*100,"</div>"):"",`
        <div class="xgplayer-bar">
          <xg-drag class="xgplayer-drag" style="height: `).concat(r*100,`%"></xg-drag>
        </div>
      </xg-slider>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"volume"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:1,disable:!1,showValueLabel:!1,default:.6,miniVolume:.2}}}]),t}(Re);function p4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="-4 -6 40 40" fill="none">
  <g clip-path="url(#clip0)">
    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>
    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>
  </g>
  <defs>
    <clipPath id="clip0">
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>
`,"image/svg+xml").firstChild}var g4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),r.rotateDeg=r.config.rotateDeg||0,r}return me(t,[{key:"afterCreate",value:function(){var r=this;this.config.disable||(Ee(ke(t.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.rotate),this.onBtnClick=this.onBtnClick.bind(this),this.bind(".xgplayer-icon",["click","touchend"],this.onBtnClick),this.on(Pa,function(){r.rotateDeg&&k.setTimeout(r,function(){r.updateRotateDeg(r.rotateDeg,r.config.innerRotate)},100)}),this.rotateDeg&&this.updateRotateDeg(this.rotateDeg,this.config.innerRotate))}},{key:"destroy",value:function(){Ee(ke(t.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",["click","touchend"],this.onBtnClick)}},{key:"onBtnClick",value:function(r){r.preventDefault(),r.stopPropagation(),this.emitUserAction(r,"rotate"),this.rotate(this.config.clockwise,this.config.innerRotate,1)}},{key:"updateRotateDeg",value:function(r,s){var o=this.player;r||(r=0);var a=this.player,l=a.root,u=a.innerContainer,c=this.player.media,h=l.offsetWidth,f=u&&s?u.offsetHeight:l.offsetHeight,d="100%",p="100%",g=0,m=0;(r===.75||r===.25)&&(d="".concat(f,"px"),p="".concat(h,"px"),g=-(f-h)/2,m=-(h-f)/2);var v="translate(".concat(g,"px,").concat(m,"px) rotate(").concat(r,"turn)"),O={transformOrigin:"center center",transform:v,webKitTransform:v,height:p,width:d},y=s?c:l,x=s?o.getPlugin("poster"):null;Object.keys(O).map(function(b){y.style[b]=O[b],x&&x.root&&(x.root.style[b]=O[b])})}},{key:"rotate",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=this.player;this.rotateDeg||(this.rotateDeg=0);var l=r?1:-1;this.rotateDeg=(this.rotateDeg+1+l*.25*o)%1,this.updateRotateDeg(this.rotateDeg,s),a.emit(J2,this.rotateDeg*360)}},{key:"registerIcons",value:function(){return{rotate:p4}}},{key:"render",value:function(){if(!this.config.disable)return`
    <xg-icon class="xgplayer-rotate">
      <div class="xgplayer-icon">
      </div>
      `.concat(Ds(this,"ROTATE_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"rotate"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:6,innerRotate:!0,clockwise:!1,rotateDeg:0,disable:!1}}}]),t}(xo);function m4(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}function v4(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M9.4998 7.7C9.77595 7.7 9.9998 7.47614 9.9998 7.2V6.5C9.9998 6.22386 9.77595 6 9.4998 6H5.5402L5.52754 6.00016H5.5C5.22386 6.00016 5 6.22401 5 6.50016V10.4598C5 10.7359 5.22386 10.9598 5.5 10.9598H6.2C6.47614 10.9598 6.7 10.7359 6.7 10.4598V8.83005L8.76983 10.9386C8.96327 11.1357 9.27984 11.1386 9.47691 10.9451L9.97645 10.4548C10.1735 10.2613 10.1764 9.94476 9.983 9.7477L7.97289 7.7H9.4998Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}var Do={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"},O4=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"switchPIP",function(a){if(!n.isPIPAvailable())return!1;a.stopPropagation(),n.isPip?(n.exitPIP(),n.emitUserAction(a,"change_pip",{props:"pip",from:!0,to:!1}),n.setAttr("data-state","normal")):n.player.media.readyState===4&&(n.requestPIP(),n.emitUserAction(a,"change_pip",{props:"pip",from:!1,to:!0}),n.setAttr("data-state","pip"))}),n}return me(t,[{key:"beforeCreate",value:function(r){typeof r.player.config.pip=="boolean"&&(r.config.showIcon=r.player.config.pip)}},{key:"afterCreate",value:function(){var r=this;this.isPIPAvailable()&&(Ee(ke(t.prototype),"afterCreate",this).call(this),this.pMode=Do.INLINE,this.initPipEvents(),this.config.showIcon&&this.initIcons(),this.once(lp,function(){r.config.showIcon&&(k.removeClass(r.find(".xgplayer-icon"),"xg-icon-disable"),r.bind("click",r.switchPIP))}))}},{key:"registerIcons",value:function(){return{pipIcon:{icon:m4,class:"xg-get-pip"},pipIconExit:{icon:v4,class:"xg-exit-pip"}}}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".xgplayer-icon",r.pipIcon),this.appendChild(".xgplayer-icon",r.pipIconExit)}},{key:"initPipEvents",value:function(){var r=this,s=this.player;this.leavePIPCallback=function(){var o=s.paused;k.setTimeout(r,function(){!o&&s.mediaPlay()},0),!o&&s.mediaPlay(),r.setAttr("data-state","normal"),s.emit(Fm,!1)},this.enterPIPCallback=function(o){s.emit(Fm,!0),r.pipWindow=o.pictureInPictureWindow,r.setAttr("data-state","pip")},this.onWebkitpresentationmodechanged=function(o){var a=s.media.webkitPresentationMode;r.pMode===Do.FULLSCREEN&&a!==Do.FULLSCREEN&&s.onFullscreenChange(null,!1),r.pMode=a,a===Do.PIP?r.enterPIPCallback(o):a===Do.INLINE&&r.leavePIPCallback(o)},s.media&&(s.media.addEventListener("enterpictureinpicture",this.enterPIPCallback),s.media.addEventListener("leavepictureinpicture",this.leavePIPCallback),t.checkWebkitSetPresentationMode(s.media)&&s.media.addEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged))}},{key:"requestPIP",value:function(){var r=this.player,s=this.playerConfig;if(!(!this.isPIPAvailable()||this.isPip))try{var o=s.poster;return o&&(r.media.poster=k.typeOf(o)==="String"?o:o.poster),t.checkWebkitSetPresentationMode(r.media)?r.media.webkitSetPresentationMode("picture-in-picture"):r.media.requestPictureInPicture(),!0}catch(a){return console.error("requestPiP",a),!1}}},{key:"exitPIP",value:function(){var r=this.player;try{return this.isPIPAvailable()&&this.isPip&&(t.checkWebkitSetPresentationMode(r.media)?r.media.webkitSetPresentationMode("inline"):document.exitPictureInPicture()),!0}catch(s){return console.error("exitPIP",s),!1}}},{key:"isPip",get:function(){var r=this.player;return document.pictureInPictureElement&&document.pictureInPictureElement===r.media||r.media.webkitPresentationMode===Do.PIP}},{key:"isPIPAvailable",value:function(){var r=this.player.media,s=k.typeOf(document.pictureInPictureEnabled)==="Boolean"?document.pictureInPictureEnabled:!0;return s&&(k.typeOf(r.disablePictureInPicture)==="Boolean"&&!r.disablePictureInPicture||r.webkitSupportsPresentationMode&&k.typeOf(r.webkitSetPresentationMode)==="Function")}},{key:"destroy",value:function(){Ee(ke(t.prototype),"destroy",this).call(this);var r=this.player;r.media.removeEventListener("enterpictureinpicture",this.enterPIPCallback),r.media.removeEventListener("leavepictureinpicture",this.leavePIPCallback),t.checkWebkitSetPresentationMode(r.media)&&r.media.removeEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged),this.exitPIP(),this.unbind("click",this.btnClick)}},{key:"render",value:function(){if(!(!this.config.showIcon||!this.isPIPAvailable()))return`<xg-icon class="xgplayer-pip">
      <div class="xgplayer-icon xg-icon-disable">
      </div>
      `.concat(Ds(this,"PIP",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"pip"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:6,showIcon:!1}}},{key:"checkWebkitSetPresentationMode",value:function(r){return typeof r.webkitSetPresentationMode=="function"}}]),t}(xo);function y4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`,"image/svg+xml").firstChild}var b4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),q(V(r),"playNext",function(s){var o=V(r),a=o.player;s.preventDefault(),s.stopPropagation(),r.idx+1<r.config.urlList.length?(r.idx++,r.nextHandler(r.config.urlList[r.idx],r.idx),a.emit(Gf,r.idx+1)):(r.nextHandler(),a.emit(Gf))}),r.idx=-1,r}return me(t,[{key:"afterCreate",value:function(){!this.config.urlList||this.config.urlList.length===0||(this.appendChild(".xgplayer-icon",this.icons.playNext),this.initEvents())}},{key:"registerIcons",value:function(){return{playNext:y4}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("nextClick",this.changeSrc);var r=Le.device==="mobile"?"touchend":"click";this.bind(r,this.playNext),this.show()}},{key:"changeSrc",value:function(r){var s=this.player;r&&(s.pause(),s.currentTime=0,s.switchURL?s.switchURL(r):s.src=r,s.config.url=r,s.play())}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(!(!this.config.urlList||this.config.urlList.length===0))return`
     <xg-icon class="xgplayer-playnext">
      <div class="xgplayer-icon">
      </div>
      `.concat(Ds(this,"PLAYNEXT_TIPS",this.playerConfig.isHideTips),`
     </xg-icon>
    `)}}],[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}]),t}(Re),cA={exports:{}};(function(i,e){(function(t,n){i.exports=n()})(Vl,function(){return function t(n,r,s){var o=window,a="application/octet-stream",l=s||a,u=n,c=!r&&!s&&u,h=document.createElement("a"),f=function(T){return String(T)},d=o.Blob||o.MozBlob||o.WebKitBlob||f,p=r||"download",g,m;if(d=d.call?d.bind(o):Blob,String(this)==="true"&&(u=[u,l],l=u[0],u=u[1]),c&&c.length<2048&&(p=c.split("/").pop().split("?")[0],h.href=c,h.href.indexOf(c)!==-1)){var v=new XMLHttpRequest;return v.open("GET",c,!0),v.responseType="blob",v.onload=function(T){t(T.target.response,p,a)},setTimeout(function(){v.send()},0),v}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(u))if(u.length>1024*1024*1.999&&d!==f)u=b(u),l=u.type||a;else return navigator.msSaveBlob?navigator.msSaveBlob(b(u),p):E(u);else if(/([\x80-\xff])/.test(u)){var O=0,y=new Uint8Array(u.length),x=y.length;for(O;O<x;++O)y[O]=u.charCodeAt(O);u=new d([y],{type:l})}g=u instanceof d?u:new d([u],{type:l});function b(T){var _=T.split(/[:;,]/),D=_[1],A=_[2]=="base64"?atob:decodeURIComponent,I=A(_.pop()),L=I.length,$=0,B=new Uint8Array(L);for($;$<L;++$)B[$]=I.charCodeAt($);return new d([B],{type:D})}function E(T,_){if("download"in h)return h.href=T,h.setAttribute("download",p),h.className="download-js-link",h.innerHTML="downloading...",h.style.display="none",document.body.appendChild(h),setTimeout(function(){h.click(),document.body.removeChild(h),_===!0&&setTimeout(function(){o.URL.revokeObjectURL(h.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(T)&&(T="data:"+T.replace(/^data:([\w\/\-\+]+)/,a)),window.open(T)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=T),!0;var D=document.createElement("iframe");document.body.appendChild(D),!_&&/^data:/.test(T)&&(T="data:"+T.replace(/^data:([\w\/\-\+]+)/,a)),D.src=T,setTimeout(function(){document.body.removeChild(D)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(g,p);if(o.URL)E(o.URL.createObjectURL(g),!0);else{if(typeof g=="string"||g.constructor===f)try{return E("data:"+l+";base64,"+o.btoa(g))}catch{return E("data:"+l+","+encodeURIComponent(g))}m=new FileReader,m.onload=function(T){E(this.result)},m.readAsDataURL(g)}return!0}})})(cA);var x4=cA.exports;const S4=op(x4);function k4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`,"image/svg+xml").firstChild}var T4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),q(V(r),"download",function(s){if(!r.isLock){r.emitUserAction(s,"download");var o=r.getAbsoluteURL(r.player.src);S4(o),r.isLock=!0,r.timer=window.setTimeout(function(){r.isLock=!1,window.clearTimeout(r.timer),r.timer=null},300)}}),r.timer=null,r.isLock=!1,r}return me(t,[{key:"afterCreate",value:function(){Ee(ke(t.prototype),"afterCreate",this).call(this),!this.config.disable&&(this.appendChild(".xgplayer-icon",this.icons.download),this.bind(["click","touchend"],this.download))}},{key:"registerIcons",value:function(){return{download:k4}}},{key:"getAbsoluteURL",value:function(r){if(!r.match(/^https?:\/\//)){var s=document.createElement("div");s.innerHTML='<a href="'.concat(r,'">x</a>'),r=s.firstChild.href}return r}},{key:"destroy",value:function(){Ee(ke(t.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.download),window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-download">
   <div class="xgplayer-icon">
   </div>
   `.concat(Ds(this,"DOWNLOAD_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:3,disable:!0}}}]),t}(xo),E4=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"beforeCreate",value:function(r){typeof r.player.config.screenShot=="boolean"&&(r.config.disable=!r.player.config.screenShot)}},{key:"afterCreate",value:function(){Ee(ke(t.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.screenshotIcon);var r=this.config;this.initSize=function(s){r.fitVideo&&(r.width=s.vWidth,r.height=s.vHeight)},this.once(Pa,this.initSize)}},{key:"onPluginsReady",value:function(){this.show(),this.onClickBtn=this.onClickBtn.bind(this),this.bind(["click","touchend"],this.onClickBtn)}},{key:"saveScreenShot",value:function(r,s){var o=document.createElement("a");o.href=r,o.download=s;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(a)}},{key:"createCanvans",value:function(r,s){var o=document.createElement("canvas");this.canvasCtx=o.getContext("2d"),this.canvas=o,o.width=r||this.config.width,o.height=s||this.config.height}},{key:"onClickBtn",value:function(r){var s=this;r.preventDefault(),r.stopPropagation(),this.emitUserAction(r,"shot"),this.shot().then(function(o){s.emit(eA,o),s.saveScreenShot(o,s.config.name+s.config.format)})}},{key:"shot",value:function(r,s){var o=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{quality:.92,type:"image/png"},l=this.config,u=this.player,c=a.quality||l.quality,h=a.type||l.type;return new Promise(function(f,d){var p=null;u.media.canvas?p=u.media.canvas:(o.canvas?(o.canvas.width=r||l.width,o.canvas.height=s||l.height):o.createCanvans(r,s),o.canvasCtx.drawImage(u.media,0,0,r||l.width,s||l.height),p=o.canvas);var g=p.toDataURL(h,c).replace(h,"image/octet-stream");g=g.replace(/^data:image\/[^;]+/,"data:application/octet-stream"),f(g)})}},{key:"registerIcons",value:function(){return{screenshotIcon:null}}},{key:"destroy",value:function(){Ee(ke(t.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.onClickBtn),this.off(Pa,this.initSize)}},{key:"render",value:function(){if(!this.config.disable){var r=this.icons.screenshotIcon?"xgplayer-icon":"xgplayer-icon btn-text",s="SCREENSHOT";return`
      <xg-icon class="xgplayer-shot">
      <div class="`.concat(r,`">
      `).concat(this.icons.screenshotIcon?"":'<span lang-key="'.concat(this.i18nKeys[s],'">').concat(this.i18n[s],"</span>"),` 
      </div>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"screenShot"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:5,quality:.92,type:"image/png",format:".png",width:600,height:337,fitVideo:!0,disable:!1,name:"screenshot"}}}]),t}(xo),w4=function(){function i(e){ge(this,i),this.config=e.config,this.parent=e.root,this.root=k.createDom("ul","",{},"xg-options-list ".concat(this.config.className)),e.root.appendChild(this.root),this.onItemClick=this.onItemClick.bind(this),this.renderItemList();var t=Le.device==="mobile"?"touchend":"click";this._delegates=Re.delegate.call(this,this.root,"li",t,this.onItemClick)}return me(i,[{key:"renderItemList",value:function(t){var n=this,r=this.config,s=this.root;t?r.data=t:t=r.data,r.style&&Object.keys(r.style).map(function(o){s.style[o]=r[o]}),t.length>0&&(this.attrKeys=Object.keys(t[0])),this.root.innerHTML="",t.map(function(o,a){var l=o.selected?"option-item selected":"option-item";o["data-index"]=a,n.root.appendChild(k.createDom("li","<span>".concat(o.showText,"</span>"),o,l))})}},{key:"onItemClick",value:function(t){t.delegateTarget||(t.delegateTarget=t.target);var n=t.delegateTarget;if(n&&k.hasClass(n,"selected"))return!1;var r=typeof this.config.onItemClick=="function"?this.config.onItemClick:null,s=this.root.querySelector(".selected");k.addClass(n,"selected"),s&&k.removeClass(s,"selected"),r(t,{from:s?this.getAttrObj(s,this.attrKeys):null,to:this.getAttrObj(n,this.attrKeys)})}},{key:"getAttrObj",value:function(t,n){if(!t||!n)return{};var r={};n.map(function(o){r[o]=t.getAttribute(o)});var s=t.getAttribute("data-index");return s&&(r.index=Number(s)),r}},{key:"show",value:function(){k.removeClass(this.root,"hide"),k.addClass(this.root,"active")}},{key:"hide",value:function(){k.removeClass(this.root,"active"),k.addClass(this.root,"hide")}},{key:"destroy",value:function(){this._delegates&&(this._delegates.map(function(t){t.destroy&&t.destroy()}),this._delegates=null),this.root.innerHTML=null,this.parent.removeChild(this.root),this.root=null}}]),i}(),xl={RIGHT_SIDE:"rightSide",MIDDLE:"middle"},Uc=Le.device==="mobile",qf=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),q(V(r),"onEnter",function(s){s.preventDefault(),s.stopPropagation(),r.emit("icon_mouseenter",{pluginName:r.pluginName}),r.toggle(!0)}),q(V(r),"onLeave",function(s){s.preventDefault(),s.stopPropagation(),r.emit("icon_mouseleave",{pluginName:r.pluginName}),r.config.listType!==xl.RIGHT_SIDE&&r.isActive&&r.toggle(!1)}),q(V(r),"onListEnter",function(s){console.log("onListEnter"),r.enterType=2}),q(V(r),"onListLeave",function(s){console.log("onListLeave",s.target),r.enterType=0,r.isActive&&r.toggle(!1)}),r.isIcons=!1,r.isActive=!1,r.curValue=null,r.curIndex=0,r}return me(t,[{key:"updateLang",value:function(r){this.renderItemList(this.config.list,this.curIndex)}},{key:"afterCreate",value:function(){var r=this,s=this.config;this.initIcons(),Uc&&s.listType!==xl.MIDDLE&&(s.listType="rightSide"),s.hidePortrait&&k.addClass(this.root,"portrait"),this.once(Dn,function(){s.list&&s.list.length>0&&(r.renderItemList(s.list),r.show())}),Uc&&this.on(KO,function(){r.isActive&&(r.optionsList&&r.optionsList.hide(),r.isActive=!1)}),this.activeEvent=Uc?"touchend":"mouseenter",this.bind(this.activeEvent,this.onEnter),this.bind("mouseleave",this.onLeave),this.isIcons&&this.bind("click",this.onIconClick)}},{key:"initIcons",value:function(){var r=this,s=this.icons,o=Object.keys(s),a=!1;o.length>0&&(o.forEach(function(l){r.appendChild(".xgplayer-icon",s[l]),!a&&(a=s[l])}),this.isIcons=a),!a&&(this.appendChild(".xgplayer-icon",k.createDom("span","",{},"icon-text")),k.addClass(this.find(".xgplayer-icon"),"btn-text"))}},{key:"show",value:function(){!this.config.list||this.config.list.length<2||k.addClass(this.root,"show")}},{key:"hide",value:function(){k.removeClass(this.root,"show")}},{key:"getTextByLang",value:function(r,s,o){if(r===void 0)return"";var a=this.config.list;!o&&(o=this.player.lang),s=!s||k.isUndefined(r[s])?"text":s,typeof r=="number"&&(r=a[r]);try{return vi(r[s])==="object"?r[s][o]||r[s].zh:r[s]}catch(l){return console.warn(l),""}}},{key:"toggle",value:function(r){if(r!==this.isActive){var s=this.player.controls,o=this.config.listType;r?(o==="rightSide"?s.blur():s.focus(),this.optionsList&&this.optionsList.show()):(o==="rightSide"?s.focus():s.focusAwhile(),this.optionsList&&this.optionsList.hide()),this.isActive=r}}},{key:"onItemClick",value:function(r,s){r.preventDefault(),r.stopPropagation();var o=this.config,a=o.listType,l=o.list;this.curIndex=s.to.index,this.curItem=l[this.curIndex],this.changeCurrentText();var u=this.config.isItemClickHide;(u||Uc||a===xl.RIGHT_SIDE)&&this.toggle(!1)}},{key:"onIconClick",value:function(r){}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var r=this.config.list,s=this.curIndex<r.length?this.curIndex:0,o=r[s];o&&(this.find(".icon-text").innerHTML=this.getTextByLang(o,"iconText"))}}},{key:"renderItemList",value:function(r,s){var o=this,a=this.config,l=this.optionsList,u=this.player;if(typeof s=="number"&&(this.curIndex=s,this.curItem=a.list[s]),l){l.renderItemList(r),this.changeCurrentText();return}var c={config:{data:r||[],className:a.listType===xl.RIGHT_SIDE?"right-side":"",onItemClick:function(f,d){o.onItemClick(f,d)}},root:a.listType===xl.RIGHT_SIDE?u.root:this.root};this.config.isShowIcon&&(this.optionsList=new w4(c),this.changeCurrentText(),this.show())}},{key:"destroy",value:function(){this.unbind(this.activeEvent,this.onEnter),this.unbind("mouseleave",this.onLeave),this.optionsList&&(this.optionsList.destroy(),this.optionsList=null)}},{key:"render",value:function(){if(this.config.isShowIcon)return'<xg-icon class="xg-options-icon '.concat(this.config.className||"",`">
    <div class="xgplayer-icon">
    </div>
   </xg-icon>`)}}],[{key:"pluginName",get:function(){return"optionsIcon"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:100,list:[],listType:"middle",listStyle:{},hidePortrait:!0,isShowIcon:!1,isItemClickHide:!0}}}]),t}(Re),_4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),r.curTime=0,r.isPaused=!0,r}return me(t,[{key:"beforeCreate",value:function(r){var s=r.config.list;Array.isArray(s)&&s.length>0&&(r.config.list=s.map(function(o){return!o.text&&o.name&&(o.text=o.name),o.text||(o.text=o.definition),o}))}},{key:"afterCreate",value:function(){var r=this;Ee(ke(t.prototype),"afterCreate",this).call(this),this.on("resourceReady",function(s){r.changeDefinitionList(s)}),this.on(ny,function(s){r.renderItemList(r.config.list,s.to)}),this.player.definitionList.length<2&&this.hide()}},{key:"show",value:function(){!this.config.list||this.config.list.length<2||k.addClass(this.root,"show")}},{key:"initDefinition",value:function(){var r=this.config,s=r.list,o=r.defaultDefinition;if(s.length>0){var a=null;s.map(function(l){l.definition===o&&(a=l)}),a||(a=s[0]),this.changeDefinition(a)}}},{key:"renderItemList",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.list||[],o=arguments.length>1?arguments[1]:void 0,a=o&&o.definition?o.definition:this.config.defaultDefinition;o&&s.forEach(function(c){c.selected=!1});var l=0,u=s.map(function(c,h){var f=St(St({},c),{},{showText:r.getTextByLang(c)||c.definition,selected:!1});return(c.selected||c.definition&&c.definition==a)&&(f.selected=!0,l=h),f});Ee(ke(t.prototype),"renderItemList",this).call(this,u,l)}},{key:"changeDefinitionList",value:function(r){Array.isArray(r)&&(this.config.list=r.map(function(s){return!s.text&&s.name&&(s.text=s.name),s.text||(s.text=s.definition),s}),this.renderItemList(),this.config.list.length<2?this.hide():this.show())}},{key:"changeDefinition",value:function(r,s){this.player.changeDefinition(r,s)}},{key:"onItemClick",value:function(r,s){var o=this.player.definitionList;Ee(ke(t.prototype),"onItemClick",this).apply(this,arguments),this.emitUserAction(r,"change_definition",{from:s.from,to:s.to});for(var a=0;a<o.length;a++)s.to&&o[a].definition===s.to.definition&&(s.to.url=o[a].url),s.from&&o[a].definition===s.from.definition&&(s.from.url=o[a].url);this.player.changeDefinition(s.to,s.from)}}],[{key:"pluginName",get:function(){return"definition"}},{key:"defaultConfig",get:function(){return St(St({},qf.defaultConfig),{},{position:ht.CONTROLS_RIGHT,index:3,list:[],defaultDefinition:"",disable:!1,hidePortrait:!1,className:"xgplayer-definition",isShowIcon:!0})}}]),t}(qf),C4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),r.curRate=1,r}return me(t,[{key:"beforeCreate",value:function(r){var s=r.player.config.playbackRate,o=s?Array.isArray(s)?s:r.config.list:[];Array.isArray(o)&&(r.config.list=o.map(function(a){return typeof a=="number"?a={rate:a,text:"".concat(a,"x")}:!a.text&&a.rate&&(a.text="".concat(a.rate,"x")),a}))}},{key:"afterCreate",value:function(){var r=this;Ee(ke(t.prototype),"afterCreate",this).call(this),this.on(z2,function(){r.curValue!==r.player.playbackRate&&r.renderItemList()}),this.renderItemList()}},{key:"show",value:function(){!this.config.list||this.config.list.length===0||Ee(ke(t.prototype),"show",this).call(this)}},{key:"onItemClick",value:function(r,s){Ee(ke(t.prototype),"onItemClick",this).apply(this,arguments);var o=r.delegateTarget,a=Number(o.getAttribute("rate"));if(!a||a===this.curValue)return!1;var l={playbackRate:{from:this.player.playbackRate,to:a}};this.emitUserAction(r,"change_rate",{props:l}),this.curValue=a,this.player.playbackRate=a}},{key:"renderItemList",value:function(){var r=this,s=this.player.playbackRate||1;this.curValue=s;var o=-1,a=this.config.list.map(function(l,u){var c={rate:l.rate};return c.rate===s&&(c.selected=!0,o=u),c.showText=r.getTextByLang(l),c});Ee(ke(t.prototype),"renderItemList",this).call(this,a,o)}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var r=this.config.list,s=this.curIndex<r.length?this.curIndex:0,o=r[s],a="";!o||this.curIndex<0?a="".concat(this.player.playbackRate,"x"):a=this.getTextByLang(o,"iconText"),this.find(".icon-text").innerHTML=a}}},{key:"destroy",value:function(){Ee(ke(t.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"playbackRate"}},{key:"defaultConfig",get:function(){return St(St({},qf.defaultConfig),{},{position:ht.CONTROLS_RIGHT,index:4,list:[2,1.5,1,.75,.5],className:"xgplayer-playbackrate",isShowIcon:!0,hidePortrait:!1})}}]),t}(qf);function A4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">
  <path fill="#fff" transform="scale(1.3, 1.3)" class='path_full' d="M9,10v1a.9.9,0,0,1-1,1,.9.9,0,0,1-1-1V9A.9.9,0,0,1,8,8h2a.9.9,0,0,1,1,1,.9.9,0,0,1-1,1Zm6,4V13a1,1,0,0,1,2,0v2a.9.9,0,0,1-1,1H14a1,1,0,0,1,0-2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>
</svg>
`,"image/svg+xml").firstChild}function P4(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">
  <path fill="#fff" transform="scale(1.3, 1.3)" d="M9,10V9a.9.9,0,0,1,1-1,.9.9,0,0,1,1,1v2a.9.9,0,0,1-1,1H8a.9.9,0,0,1-1-1,.9.9,0,0,1,1-1Zm6,4v1a1,1,0,0,1-2,0V13a.9.9,0,0,1,1-1h2a1,1,0,0,1,0,2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>
</svg>
`,"image/svg+xml").firstChild}var iS=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"beforeCreate",value:function(r){typeof r.player.config.cssFullscreen=="boolean"&&(r.config.disable=!r.player.config.cssFullscreen)}},{key:"afterCreate",value:function(){var r=this;Ee(ke(t.prototype),"afterCreate",this).call(this),!this.config.disable&&(this.config.target&&(this.playerConfig.fullscreenTarget=this.config.target),this.initIcons(),this.on(Zf,function(s){r.animate(s)}),this.btnClick=this.btnClick.bind(this),this.handleCssFullscreen=this.hook("cssFullscreen_change",this.btnClick,{pre:function(o){o.preventDefault(),o.stopPropagation()}}),this.bind(["click","touchend"],this.handleCssFullscreen))}},{key:"initIcons",value:function(){var r=this.icons,s=this.find(".xgplayer-icon");s.appendChild(r.cssFullscreen),s.appendChild(r.exitCssFullscreen)}},{key:"btnClick",value:function(r){r.preventDefault(),r.stopPropagation();var s=this.player.isCssfullScreen;this.emitUserAction(r,"switch_cssfullscreen",{cssfullscreen:s}),s?this.player.exitCssFullscreen():this.player.getCssFullscreen()}},{key:"animate",value:function(r){this.root&&(r?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.switchTips(r))}},{key:"switchTips",value:function(r){var s=this.i18nKeys,o=this.find(".xg-tips");o&&this.changeLangTextKey(o,r?s.EXITCSSFULLSCREEN_TIPS:s.CSSFULLSCREEN_TIPS)}},{key:"registerIcons",value:function(){return{cssFullscreen:{icon:A4,class:"xg-get-cssfull"},exitCssFullscreen:{icon:P4,class:"xg-exit-cssfull"}}}},{key:"destroy",value:function(){Ee(ke(t.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class='xgplayer-cssfullscreen'>
    <div class="xgplayer-icon">
    </div>
    `.concat(Ds(this,"CSSFULLSCREEN_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"cssFullscreen"}},{key:"defaultConfig",get:function(){return{position:ht.CONTROLS_RIGHT,index:1,disable:!1,target:null}}}]),t}(xo),R4=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"afterCreate",value:function(){var r=this;this.clickHandler=this.hook("errorRetry",this.errorRetry,{pre:function(o){o.preventDefault(),o.stopPropagation()}}),this.onError=this.hook("showError",this.handleError),this.bind(".xgplayer-error-refresh","click",this.clickHandler),this.on(ic,function(s){r.onError(s)})}},{key:"errorRetry",value:function(r){this.emitUserAction(r,"error_retry",{}),this.player.retry()}},{key:"handleError",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=this.player,o=r.errorType,a=s.errorNote?this.i18n[s.errorNote]:"";if(!a)switch(o){case"decoder":a=this.i18n.MEDIA_ERR_DECODE;break;case"network":a=this.i18n.MEDIA_ERR_NETWORK;break;default:a=this.i18n.MEDIA_ERR_SRC_NOT_SUPPORTED}this.find(".xgplayer-error-text").innerHTML=a,this.find(".xgplayer-error-tips").innerHTML="".concat(this.i18n.REFRESH_TIPS,'<span class="xgplayer-error-refresh">').concat(this.i18n.REFRESH,"</span>")}},{key:"destroy",value:function(){this.unbind(".xgplayer-error-refresh","click",this.clickHandler)}},{key:"render",value:function(){return`<xg-error class="xgplayer-error">
      <div class="xgplayer-errornote">
       <span class="xgplayer-error-text"></span>
       <span class="xgplayer-error-tips"><em class="xgplayer-error-refresh"></em></span>
      </div>
    </xg-error>`}}],[{key:"pluginName",get:function(){return"error"}}]),t}(Re),L4=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"afterCreate",value:function(){var r=this;this.intervalId=0,this.customConfig=null,this.bind(".highlight",["click","touchend"],function(s){(r.config.onClick||r.customOnClick)&&(s.preventDefault(),s.stopPropagation(),r.customOnClick?r.customOnClick(s):r.config.onClick(s))}),this.player.showPrompt=function(){r.show.apply(r,arguments)},this.player.hidePrompt=function(){r.hide()}}},{key:"setStyle",value:function(r){var s=this;Object.keys(r).map(function(o){s.root.style[o]=r[o]})}},{key:"show",value:function(r){var s=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(r){this.customOnClick=a;var l=this.config.interval;this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null),k.addClass(this.root,"show"),o.mode==="arrow"&&k.addClass(this.root,"arrow"),typeof r=="string"?this.find(".xgplayer-prompt-detail").innerHTML=r:this.find(".xgplayer-prompt-detail").innerHTML="".concat(r.text||"")+"".concat(r.highlight?'<i class="highlight">'.concat(r.highlight,"</i>"):""),o.style&&this.setStyle(o.style);var u=typeof o.autoHide=="boolean"?o.autoHide:this.config.autoHide;if(u){var c=o.interval||l;this.intervalId=setTimeout(function(){s.hide()},c)}}}},{key:"hide",value:function(){k.removeClass(this.root,"show"),k.removeClass(this.root,"arrow"),this.root.removeAttribute("style"),this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat(K.CONTROLS_FOLLOW,`">
    <span class="xgplayer-prompt-detail"></span>
    </xg-prompt>`)}}],[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:!0,detail:{text:"",highlight:""},onClick:function(){}}}}]),t}(Re),nS={time:0,text:"",id:1,duration:1,color:"#fff",style:{},width:6,height:6};function hA(i){Object.keys(nS).map(function(e){i[e]===void 0&&(i[e]=nS[e])})}var rS={_updateDotDom:function(e,t){if(t){var n=this.calcuPosition(e.time,e.duration),r=e.style||{};r.left="".concat(n.left,"%"),r.width="".concat(n.width,"%"),t.setAttribute("data-text",e.text),t.setAttribute("data-time",e.time),n.isMini?k.addClass(t,"mini"):k.removeClass(t,"mini"),Object.keys(r).map(function(s){t.style[s]=r[s]})}},initDots:function(){var e=this;this._ispots.map(function(t){e.createDot(t,!1)}),this.ispotsInit=!0},createDot:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this.player.plugins.progress;if(n&&(t&&(hA(e),this._ispots.push(e)),!(!this.ispotsInit&&t))){var r=this.calcuPosition(e.time,e.duration),s=e.style||{};s.left="".concat(r.left,"%"),s.width="".concat(r.width,"%");var o="xgspot_".concat(e.id," xgplayer-spot");r.isMini&&(o+=" mini");var a=k.createDom("xg-spot",e.template||"",{"data-text":e.text,"data-time":e.time,"data-id":e.id},o);Object.keys(s).map(function(l){a.style[l]=s[l]}),n.outer&&n.outer.appendChild(a)}},findDot:function(e){if(this.player.plugins.progress){var t=this._ispots.filter(function(n,r){return n.id===e});return t.length>0?t[0]:null}},updateDot:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.player.plugins.progress;if(n){var r=this.findDot(e.id);if(r&&Object.keys(e).map(function(o){r[o]=e[o]}),!!this.ispotsInit){var s=n.find('xg-spot[data-id="'.concat(e.id,'"]'));s&&(this._updateDotDom(e,s),t&&this.showDot(e.id))}}},deleteDot:function(e){var t=this._ispots,n=this.player.plugins.progress;if(n){for(var r=[],s=0;s<t.length;s++)t[s].id===e&&r.push(s);for(var o=r.length,a=o-1;a>=0;a--)if(t.splice(r[a],1),this.ispotsInit){var l=n.find('xg-spot[data-id="'.concat(e,'"]'));l&&l.parentElement.removeChild(l)}}},deleteAllDots:function(){var e=this.player.plugins.progress;if(e){if(!this.ispotsInit){this._ispots=[];return}for(var t=e.root.getElementsByTagName("xg-spot"),n=t.length-1;n>=0;n--)e.outer.removeChild(t[n]);this._ispots=[]}},updateAllDots:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=this.player.plugins.progress;if(n){if(!this.ispotsInit){this._ispots=t;return}this._ispots=[];var r=n.root.getElementsByTagName("xg-spot"),s=r.length;if(s>t.length)for(var o=s-1;o>t.length-1;o--)n.outer.removeChild(r[o]);t.forEach(function(a,l){l<s?(r[l].setAttribute("data-id","".concat(a.id)),e._ispots.push(a),e.updateDot(a)):e.createDot(a)})}},updateDuration:function(){var e=this,t=this.player.plugins.progress;if(t){var n=this._ispots;n.forEach(function(r){var s=t.find('xg-spot[data-id="'.concat(r.id,'"]'));e._updateDotDom(r,s)})}},getAllDotsDom:function(){var e=this.player.plugins.progress;if(!e)return[];var t=e.root.getElementsByTagName("xg-spot");return t},getDotDom:function(e){var t=this.player.plugins.progress;if(t)return t.find('xg-spot[data-id="'.concat(e,'"]'))}};function I4(i){var e=i.config,t=i.player;Object.keys(rS).map(function(r){i[r]=rS[r].bind(i)});var n=t.config.progressDot||e.ispots||[];i._ispots=n.map(function(r){return hA(r),r}),i.ispotsInit=!1,i.on(Is,function(){i.ispotsInit?i.updateDuration():i.initDots()})}var $o={dragmove:"onProgressMove",dragstart:"onProgressDragStart",dragend:"onProgressDragEnd",click:"onProgressClick",mouseover:"onProgressMouseOver",mouseenter:"onProgressMove"},D4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),q(V(r),"onMousemove",function(s){if(!r.config.disable){if(k.hasClass(s.target,"xg-spot-content")&&r.config.isHideThumbnailHover){r.player.plugins.progress.onMouseLeave(s);return}(r._state.f||k.hasClass(s.target,"xg-spot-content"))&&(k.event(s),s.stopPropagation())}}),q(V(r),"onMousedown",function(s){r.config.disable||(r._state.f||k.hasClass(s.target,"xg-spot-content"))&&(k.event(s),s.stopPropagation())}),q(V(r),"onMouseup",function(s){if(r.isDrag){var o=r.player.plugins.progress;o&&o.pos&&(o.onMouseUp(s),!o.pos.isEnter&&o.onMouseLeave(s))}}),q(V(r),"onDotMouseLeave",function(s){if(!r.config.disable){r._curDot.removeEventListener("mouseleave",r.onDotMouseLeave),r.blurDot(s.target),r._curDot=null;var o=r.player.plugins.progress;o&&o.enableBlur(),r.show()}}),q(V(r),"onProgressMouseOver",function(s,o){if(!r.config.disable&&k.hasClass(o.target,"xgplayer-spot")&&!r._curDot){r._curDot=o.target,r.focusDot(o.target),r._curDot.children.length>0&&r.hide();var a=r.player.plugins.progress;a&&a.disableBlur(),r._curDot.addEventListener("mouseleave",r.onDotMouseLeave)}}),r._ispots=[],r.videoPreview=null,r.videothumbnail=null,r.thumbnail=null,r.timeStr="",r._state={now:0,f:!1},r}return me(t,[{key:"beforeCreate",value:function(r){var s=r.player.plugins.progress;s&&(r.root=s.root)}},{key:"afterCreate",value:function(){var r=this;this._curDot=null,this.handlerSpotClick=this.hook("spotClick",function(s,o){o.currentTime&&r.player.seek(o.currentTime)}),this.transformTimeHook=this.hook("transformTime",function(s){r.setTimeContent(k.format(s))}),I4(this),this.on(Is,function(){r.show()}),this.config.disable&&this.disable(),this.extTextRoot=this.find(".xg-spot-ext-text")}},{key:"setConfig",value:function(r){var s=this;r&&Object.keys(r).map(function(o){s.config[o]=r[o]})}},{key:"onPluginsReady",value:function(){var r=this.player;r.plugins.progress&&(this.previewLine=this.find(".xg-spot-line"),this.timePoint=this.find(".xgplayer-progress-point"),this.timeText=this.find(".xg-spot-time"),this.tipText=this.find(".spot-inner-text"),this._hasThumnail=!1,this.registerThumbnail(),this.bindEvents())}},{key:"bindEvents",value:function(){var r=this,s=this.player.plugins.progress;if(s&&(Object.keys($o).map(function(a){r[$o[a]]=r[$o[a]].bind(r),s.addCallBack(a,r[$o[a]])}),Le.device!=="mobile")){this.bind(".xg-spot-info","mousemove",this.onMousemove),this.bind(".xg-spot-info","mousedown",this.onMousedown),this.bind(".xg-spot-info","mouseup",this.onMouseup);var o=this.hook("previewClick",function(){});this.handlerPreviewClick=function(a){a.stopPropagation(),o(parseInt(r._state.now*1e3,10)/1e3,a)},this.bind(".xg-spot-content","mouseup",this.handlerPreviewClick)}}},{key:"onProgressMove",value:function(r,s){this.config.disable||!this.player.duration||this.updatePosition(r.offset,r.width,r.currentTime,r.e)}},{key:"onProgressDragStart",value:function(r){this.config.disable||!this.player.duration||(this.isDrag=!0,this.videoPreview&&k.addClass(this.videoPreview,"show"))}},{key:"onProgressDragEnd",value:function(r){this.config.disable||!this.player.duration||(this.isDrag=!1,this.videoPreview&&k.removeClass(this.videoPreview,"show"))}},{key:"onProgressClick",value:function(r,s){this.config.disable||k.hasClass(s.target,"xgplayer-spot")&&(s.stopPropagation(),s.preventDefault(),["time","id","text"].map(function(o){r[o]=s.target.getAttribute("data-".concat(o))}),r.time&&(r.time=Number(r.time)),this.handlerSpotClick(s,r))}},{key:"updateLinePos",value:function(r,s){var o=this.root,a=this.previewLine,l=this.timePoint,u=this.player,c=this.config,h=u.controls.mode,f=h==="flex",d=o.getBoundingClientRect().width;if(d){var p=l.getBoundingClientRect().width;d=this._hasThumnail&&d<c.width?c.width:d;var g=r-d/2,m,v;g<0&&!f?(g=0,m=r-d/2,!this.thumbnail&&(v=r-d/2-p/2)):g>s-d&&!f?(m=g-(s-d),!this.thumbnail&&(v=g-(s-d)-p/2),g=s-d):(m=0,!this.thumbnail&&(v=-p/2)),m!==void 0&&(a.style.transform="translateX(".concat(m.toFixed(2),"px)")),v!==void 0&&(l.style.transform="translateX(".concat(v.toFixed(2),"px)")),o.style.transform="translateX(".concat(g.toFixed(2),"px) translateZ(0)")}}},{key:"updateTimeText",value:function(r){var s=this.timeText,o=this.timePoint;s.textContent=r,!this.thumbnail&&(o.textContent=r)}},{key:"updatePosition",value:function(r,s,o,a){var l=this.root,u=this.config,c=this._state;if(l){this.updateLinePos(r,s),c.now=o,this.transformTimeHook(o);var h=this.timeStr;a&&a.target&&k.hasClass(a.target,"xgplayer-spot")?(this.showTips(a.target.getAttribute("data-text"),!1,h),this.focusDot(a.target),c.f=!0,u.isFocusDots&&c.f&&(c.now=parseInt(a.target.getAttribute("data-time"),10))):u.defaultText?(c.f=!1,this.showTips(u.defaultText,!0,h)):(c.f=!1,this.hideTips("")),this.updateTimeText(h),this.updateThumbnails(c.now)}}},{key:"setTimeContent",value:function(r){this.timeStr=r}},{key:"updateThumbnails",value:function(r){var s=this.player,o=this.videoPreview,a=this.config,l=s.plugins.thumbnail;if(l&&l.usable){this.thumbnail&&l.update(this.thumbnail,r,a.width,a.height);var u=o&&o.getBoundingClientRect();this.videothumbnail&&l.update(this.videothumbnail,r,u.width,u.height)}}},{key:"registerThumbnail",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Le.device!=="mobile"){var s=this.player,o=this.config,a=s.getPlugin("thumbnail");if(a&&a.setConfig(r),!a||!a.usable||!o.isShowThumbnail){k.addClass(this.root,"short-line no-thumbnail");return}else k.removeClass(this.root,"short-line no-thumbnail");o.mode==="short"&&k.addClass(this.root,"short-line"),this._hasThumnail=!0;var l=this.find(".xg-spot-thumbnail");this.thumbnail=a.createThumbnail(l,"progress-thumbnail"),o.isShowCoverPreview&&(this.videoPreview=k.createDom("xg-video-preview","",{},"xgvideo-preview"),s.root.appendChild(this.videoPreview),this.videothumbnail=a.createThumbnail(this.videoPreview,"xgvideo-thumbnail")),this.updateThumbnails(0)}}},{key:"calcuPosition",value:function(r,s){var o=this.player.plugins.progress,a=this.player,l=o.root.getBoundingClientRect().width,u=a.duration/l*6;return r+s>a.duration&&(s=a.duration-r),r/a.duration*100,s/a.duration,{left:r/a.duration*100,width:s/a.duration*100,isMini:s<u}}},{key:"showDot",value:function(r){var s=this.findDot(r);if(s){var o=this.root.getBoundingClientRect(),a=o.width,l=s.time/this.player.duration*a;this.updatePosition(l,a,s.time)}}},{key:"focusDot",value:function(r,s){r&&(s||(s=r.getAttribute("data-id")),k.addClass(r,"active"),this._activeDotId=s)}},{key:"blurDot",value:function(r){if(!r){var s=this._activeDotId;r=this.getDotDom(s)}r&&(k.removeClass(r,"active"),this._activeDotId=null)}},{key:"showTips",value:function(r,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";k.addClass(this.root,"no-timepoint"),r&&(k.addClass(this.find(".xg-spot-content"),"show-text"),s&&this.config.mode==="production"?(k.addClass(this.root,"product"),this.tipText.textContent=r):(k.removeClass(this.root,"product"),this.tipText.textContent=this._hasThumnail?r:"".concat(o," ").concat(r)))}},{key:"hideTips",value:function(){k.removeClass(this.root,"no-timepoint"),this.tipText.textContent="",k.removeClass(this.find(".xg-spot-content"),"show-text"),k.removeClass(this.root,"product")}},{key:"hide",value:function(){k.addClass(this.root,"hide")}},{key:"show",value:function(){k.removeClass(this.root,"hide")}},{key:"enable",value:function(){var r=this.config,s=this.playerConfig;this.config.disable=!1,this.show(),!this.thumbnail&&r.isShowThumbnail&&this.registerThumbnail(s.thumbnail||{})}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){var r=this,s=this.player.plugins.progress;s&&Object.keys($o).map(function(o){s.removeCallBack(o,r[$o[o]])}),this.videothumbnail=null,this.thumbnail=null,this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.unbind(".xg-spot-info","mousemove",this.onMousemove),this.unbind(".xg-spot-info","mousedown",this.onMousedown),this.unbind(".xg-spot-info","mouseup",this.onMouseup),this.unbind(".xg-spot-content","mouseup",this.handlerPreviewClick)}},{key:"render",value:function(){return Le.device==="mobile"||this.playerConfig.isMobileSimulateMode==="mobile"?"":'<div class="xg-spot-info hide '.concat(this.config.mode==="short"?"short-line":"",`">
      <div class="xg-spot-content">
        <div class="xg-spot-thumbnail">
          <span class="xg-spot-time"></span>
        </div>
        <div class="xg-spot-text"><span class="spot-inner-text"></span></div>
      </div>
      <div class="xgplayer-progress-point">00:00</div>
      <div class="xg-spot-ext-text"></div>
      <div class="xg-spot-line"></div>
    </div>`)}}],[{key:"pluginName",get:function(){return"progresspreview"}},{key:"defaultConfig",get:function(){return{index:1,miniWidth:6,ispots:[],defaultText:"",isFocusDots:!0,isHideThumbnailHover:!0,isShowThumbnail:!0,isShowCoverPreview:!1,mode:"",disable:!1,width:160,height:90}}}]),t}(Re),$4=function(i){Ce(t,i);var e=Ae(t);function t(n){var r;return ge(this,t),r=e.call(this,n),r.ratio=1,r.interval=null,r._preloadMark={},r}return me(t,[{key:"afterCreate",value:function(){var r=this;this.usable&&this.initThumbnail(),this.on([Is],function(){var s=r.config,o=s.pic_num,a=s.interval;r.usable&&(r.interval=a>0?a:Math.round(r.player.duration*1e3/o)/1e3)})}},{key:"setConfig",value:function(r){var s=this;if(r){var o=Object.keys(r);o.length<1||(o.forEach(function(a){s.config[a]=r[a]}),this.usable&&this.initThumbnail())}}},{key:"usable",get:function(){var r=this.config,s=r.urls,o=r.pic_num;return s&&s.length>0&&o>0}},{key:"initThumbnail",value:function(){var r=this.config,s=r.width,o=r.height,a=r.pic_num,l=r.interval;this.ratio=s/o*100,this.interval=l||Math.round(this.player.duration/a),this._preloadMark={}}},{key:"getUrlByIndex",value:function(r){return r>=0&&r<this.config.urls.length?this.config.urls[r]:""}},{key:"preload",value:function(r){var s=this;if(!this._preloadMark[r]){var o=this.config.urls,a=o.length,l=[];r>0&&l.push(r-1),l.push(r),r>0&&r<a-1&&l.push(r+1),l.map(function(u){!s._preloadMark[u]&&u>=0&&u<a&&(s._preloadMark[u]=1,k.preloadImg(o[u],function(){s._preloadMark[u]=2}))})}}},{key:"getPosition",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=this.config,l=a.pic_num,u=a.row,c=a.col,h=a.width,f=a.height;this.interval=Math.round(this.player.duration/l);var d=Math.ceil(r/this.interval);d=d>l?l:d;var p=d<u*c?0:Math.ceil(d/(u*c))-1,g=d-p*(c*u),m=g>0?Math.ceil(g/c)-1:0,v=g>0?g-m*c-1:0,O=0,y=0;if(s&&o){var x=s/o;x<h/f?(y=o,O=y*(h/f)):(O=s,y=O/(h/f))}else o?s||(y=o||f,O=y*(h/f)):(O=s||h,y=O/(h/f));var b=this.getUrlByIndex(p);return{urlIndex:p,rowIndex:m,colIndex:v,url:b,height:y,width:O,style:{backgroundImage:"url(".concat(b,")"),backgroundSize:"".concat(O*c,"px auto"),backgroundPosition:"-".concat(v*O,"px -").concat(m*y,"px"),width:"".concat(O,"px"),height:"".concat(y,"px")}}}},{key:"update",value:function(r,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",u=this.config,c=u.pic_num,h=u.urls;if(!(c<=0||!h||h.length===0)){var f=this.getPosition(s,o,a);this.preload(f.urlIndex),Object.keys(f.style).map(function(d){r.style[d]=f.style[d]}),Object.keys(l).map(function(d){r.style[d]=l[d]})}}},{key:"changeConfig",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.setConfig(r)}},{key:"createThumbnail",value:function(r,s){var o=k.createDom("xg-thumbnail","",{},"thumbnail ".concat(s));return r&&r.appendChild(o),o}}],[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:!1,urls:[],pic_num:0,col:0,row:0,height:90,width:160,scale:1,className:"",hidePortrait:!1}}}]),t}(Re),M4=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"afterCreate",value:function(){}},{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},s=arguments.length>1?arguments[1]:void 0;!s||!this.root||(r.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(r.cached/s*100,"%")),r.played&&(this.find("xg-mini-progress-played").style.width="".concat(r.played/s*100,"%")))}},{key:"render",value:function(){if(!(!this.playerConfig.progress||!this.playerConfig.miniprogress))return`<xg-mini-progress class="xg-mini-progress">
    <xg-mini-progress-cache class="xg-mini-progress-cache"></xg-mini-progress-cache>
    <xg-mini-progress-played class="xg-mini-progress-played"></xg-mini-progress-played>
    </xg-mini-progress>`}}],[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{}}}]),t}(Re),Sl={REAL_TIME:"realtime",FIRST_FRAME:"firstframe",FRAME_RATE:"framerate",POSTER:"poster"};function F4(){try{return parseInt(window.performance.now(),10)}catch{return new Date().getTime()}}function N4(){try{var i=document.createElement("canvas").getContext;return!!i}catch{return!1}}var Vc=null,Q4=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"onLoadedData",function(a){n.player&&(n._frameCount=n.config.startFrameCount,n.renderOnTimeupdate(a),n.off(cn,n.renderOnTimeupdate),n.on(cn,n.renderOnTimeupdate))}),q(V(n),"renderOnTimeupdate",function(a){n._frameCount>0?(n.renderOnce(),n._frameCount--):(n._isLoaded=!0,n.off(cn,n.renderOnTimeupdate),!n.player.paused&&n._checkIfCanStart()&&n.start())}),q(V(n),"start",function(){var a=n.player.media,l=F4(),u=n.checkVideoIsSupport(a);!u||!n.canvasCtx||(n.stop(),a.videoWidth&&a.videoHeight&&(n.videoPI=a.videoHeight>0?parseInt(a.videoWidth/a.videoHeight*100,10):0,(n.config.mode===Sl.REAL_TIME||l-n.preTime>=n.interval)&&(a&&a.videoWidth&&n.update(u,n.videoPI),n.preTime=l)),n.frameId=k.requestAnimationFrame(n.start))}),q(V(n),"stop",function(){n.frameId&&(k.cancelAnimationFrame(n.frameId),n.frameId=null)}),n}return me(t,[{key:"afterCreate",value:function(){var r=this;this.playerConfig.dynamicBg===!0&&(this.config.disable=!1),t.isSupport||(this.config.disable=!0);var s=this.config,o=s.disable,a=s.mode,l=s.frameRate;o||(this._pos={width:0,height:0,rwidth:0,rheight:0,x:0,y:0,pi:0},this.isStart=!1,this._isLoaded=!1,this.videoPI=0,this.preTime=0,this.interval=parseInt(1e3/l,10),this.canvas=null,this.canvasCtx=null,this._frameCount=0,this.once(lp,function(){r.player&&(r.init(),r.player.paused||r.start())}),a!==Sl.POSTER&&(a!==Sl.FIRST_FRAME&&(this.on(rc,function(){r.stop()}),this.on(dn,function(){r._checkIfCanStart()&&r.start()}),this.on(nl,function(){r.stop()})),this.on(co,this.onLoadedData),this.on(YO,function(){r._isLoaded=!1,r.stop()})))}},{key:"init",value:function(){var r=this.player,s=this.config;this.canvasFilter=t.supportCanvasFilter();try{var o=this.config.isInnerRender&&r.innerContainer||r.root;o.insertAdjacentHTML("afterbegin",`<div class="xgplayer-dynamic-bg"><canvas>
        </canvas><xgmask></xgmask></div>`),this.root=o.children[0],this.canvas=this.find("canvas"),this.canvasFilter||(this.canvas.style.filter=s.filter,this.canvas.style.webkitFilter=s.filter),this.mask=this.find("xgmask"),s.addMask&&(this.mask.style.background=s.maskBg),this.canvasCtx=this.canvas.getContext("2d"),this.renderByPoster()}catch(a){Qe.logError("plugin:DynamicBg",a)}}},{key:"checkVideoIsSupport",value:function(r){if(!r)return null;var s=r&&r instanceof window.HTMLVideoElement?r:r.canvas?r.canvas:r.flyVideo?r.flyVideo:null;if(s&&!(Le.browser==="safari"&&(/^blob/.test(s.currentSrc)||/^blob/.test(s.src))))return s;var o=s?s.tagName.toLowerCase():"";return o==="canvas"||o==="img"?s:null}},{key:"renderByPoster",value:function(){var r=this.playerConfig.poster;if(r){var s=k.typeOf(r)==="String"?r:k.typeOf(r.poster)==="String"?r.poster:null;this.updateImg(s)}}},{key:"_checkIfCanStart",value:function(){var r=this.config.mode;return this._isLoaded&&r!==Sl.FIRST_FRAME&&r!==Sl.POSTER}},{key:"renderOnce",value:function(){var r=this.player.media;if(!(!r.videoWidth||!r.videoHeight)){this.videoPI=parseInt(r.videoWidth/r.videoHeight*100,10);var s=this.checkVideoIsSupport(r);s&&r.videoWidth&&this.update(s,this.videoPI)}}},{key:"updateImg",value:function(r){var s=this;if(r){var o=this.canvas.getBoundingClientRect(),a=o.width,l=o.height,u=new window.Image;u.onload=function(){if(!(!s.canvas||s.frameId||s.isStart)){s.canvas.height=l,s.canvas.width=a;var c=parseInt(a/l*100,10);s.update(u,c),u=null}},u.src=r}}},{key:"update",value:function(r,s){if(!(!this.canvas||!this.canvasCtx||!s))try{var o=this._pos,a=this.config,l=this.canvas.getBoundingClientRect(),u=l.width,c=l.height;if(u!==o.width||c!==o.height||o.pi!==s){var h=parseInt(u/c*100,10);o.pi=s,o.width=this.canvas.width=u,o.height=this.canvas.height=c;var f=c,d=u;h<s?d=parseInt(c*s/100,10):h>s&&(f=parseInt(u*100/s,10)),o.rwidth=d*a.multiple,o.rheight=f*a.multiple,o.x=(u-o.rwidth)/2,o.y=(c-o.rheight)/2}this.canvasFilter&&(this.canvasCtx.filter=a.filter),this.canvasCtx.drawImage(r,o.x,o.y,o.rwidth,o.rheight)}catch(p){Qe.logError("plugin:DynamicBg",p)}}},{key:"destroy",value:function(){this.stop(),this.canvasCtx=null,this.canvas=null}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"dynamicBg"}},{key:"defaultConfig",get:function(){return{isInnerRender:!1,disable:!0,mode:"framerate",frameRate:10,filter:"blur(50px)",startFrameCount:2,addMask:!0,multiple:1.2,maskBg:"rgba(0,0,0,0.7)"}}},{key:"isSupport",get:function(){return typeof Vc=="boolean"||(Vc=N4()),Vc}},{key:"supportCanvasFilter",value:function(){return!(Le.browser==="safari"||Le.browser==="firefox")}}]),t}(Re),B4={LANG:"zh-cn",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}},kl="info",ig=rA,U4=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"_recordUserActions",function(a){var l=n._getTime(),u=Object.assign({},a,{msg:a.msg||a.action});n._stats[kl].push(St(St({type:"userAction"},l),{},{payload:u}))}),q(V(n),"_onReset",function(){n.reset()}),q(V(n),"_recordInfo",function(a){n.info(a)}),q(V(n),"_downloadStats",function(){var a=n.getStats(),l=new Blob([JSON.stringify(a)],{type:"application/json"}),u=window.URL.createObjectURL(l),c=document.createElement("a");c.style.display="none",c.href=u,c.download="player.txt",c.disabled=!1,c.click()}),n}return me(t,[{key:"_getTime",value:function(){return{timestamp:Date.now(),timeFormat:new Date().toISOString()}}},{key:"afterCreate",value:function(){this.reset(),this.on(Hf,this._recordUserActions),this.on(ig.STATS_INFO,this._recordInfo),this.on(ig.STATS_DOWNLOAD,this._downloadStats),this.on(ig.STATS_RESET,this._onReset)}},{key:"destroy",value:function(){this.offAll()}},{key:"downloadStats",value:function(){this._downloadStats()}},{key:"info",value:function(r){r.profile?this._infoProfile(r):this._info(r)}},{key:"_info",value:function(r){var s=this._getTime();this._stats[kl].push(St(St({},s),{},{payload:r}))}},{key:"_infoProfile",value:function(r){if(r&&r.startMs){var s=Date.now(),o=s-r.startMs,a=St({cat:"function",dur:o,name:r.name||r.msg,ph:"X",pid:0,tid:0,ts:r.startMs,profile:!0},r);this._info(a)}else console.warn("infoProfile need object data, include startMs")}},{key:"reset",value:function(){var r;this._stats=(r={},q(r,kl,[]),q(r,"media",{}),r)}},{key:"getStats",value:function(){for(var r=this.player,s=r.media,o=[],a=0;a<s.buffered.length;a++)o.push({start:s.buffered.start(a),end:s.buffered.end(a)});var l={currentTime:s.currentTime,readyState:s.readyState,buffered:o,paused:s.paused,ended:s.ended};return this._stats.media=l,{raw:this._stats,timestat:this._getTimeStats(),profile:this._getProfile()}}},{key:"_getTimeStats",value:function(){var r=this._stats[kl],s=r.map(function(o){var a=o.payload.data,l="";try{a instanceof Error?l=a.msg:a!==void 0&&(l=JSON.stringify(a))}catch(u){console.log("err",u)}return"[".concat(o.timeFormat,"] : ").concat(o.payload.msg," ").concat(l," ")});return s}},{key:"_getProfile",value:function(){var r={traceEvents:[]},s=this._stats[kl];return s.forEach(function(o){o.payload.profile&&r.traceEvents.push(o.payload)}),r}}],[{key:"pluginName",get:function(){return"stats"}},{key:"defaultConfig",get:function(){return{}}}]),t}(Ts),fA=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"onGapJump",function(){var a=V(n),l=a.player,u=a.config;if(l.media.readyState!==HTMLMediaElement.HAVE_NOTHING){if(l.media.seeking){if(!n.seekingEventReceived)return}else n.seekingEventReceived=!1;if(!(l.media.paused&&l.media.currentTime!==0&&n.hasPlayed)){var c=l.media.buffered,h=u.smallGapLimit||.5,f=u.gapDetectionThreshold||.3,d=l.media.currentTime,p=n._getIndex(c,d,f);if(!(p===null||p===0)){console.log("GapJump  bufferRange ",c.start(p),c.end(p));var g=c.start(p)+.1,m=l.media.duration;if(!(g>m)){var v=g-d,O=v<=h;v<t.BROWSER_GAP_TOLERANCE||O&&(u.useGapJump!==!1&&(l.media.currentTime=n.isSafari?g+.1:g),n.player&&n.player.emit("detectGap"),console.log("gapJump gapIndex",p," isGapSamll:",O," currentTime:",l.media.currentTime," jumpSize:",d-l.media.currentTime),g!==.08&&l&&l.emit("log",{type:"oneevent",end_type:"gap",vid:l.config.vid,ext:{video_postion:Math.floor(g*1e3)}}))}}}}}),n}return me(t,[{key:"afterCreate",value:function(){var r=this,s=this.config.useGapJump;s!==!1&&(this.hasPlayed=!1,this.seekingEventReceived=!1,this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),this.on(nc,this.onGapJump),this.on(dn,function(){r.hasPlayed=!0}),this.on(qO,function(){r.seekingEventReceived=!0}))}},{key:"_getIndex",value:function(r,s,o){if(!r||!r.length||r.length===1&&r.end(0)-r.start(0)<1e-6)return null;for(var a=this._getBuffered(r),l=null,u=0;u<a.length;u++){var c=a[u];if(c.start>s&&(u===0||a[u-1].end-s<=o)){l=u;break}}return l}},{key:"_getBuffered",value:function(r){if(!r)return[];for(var s=[],o=0;o<r.length;o++)s.push({start:r.start(o),end:r.end(o)});return s}}],[{key:"pluginName",get:function(){return"gapJump"}},{key:"defaultConfig",get:function(){return{useGapJump:!1,smallGapLimit:.5,gapDetectionThreshold:.3}}}]),t}(Re);fA.BROWSER_GAP_TOLERANCE=.001;var V4=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"onWaiting",function(){var a=V(n),l=a.config;n.jumpCnt>l.jumpCntMax||n.timer||l.useWaitingTimeoutJump===!1||(n.timer=setTimeout(n.onJump,l.waitingTime*1e3))}),q(V(n),"onJump",function(){var a=V(n),l=a.player,u=a.config;if(clearTimeout(n.timer),n.timer=null,!(n.jumpCnt>u.jumpCntMax||u.useWaitingTimeoutJump===!1)&&!(l.media.paused&&l.media.currentTime!==0&&n.hasPlayed)){n.jumpSize=u.jumpSize*(n.jumpCnt+1),n.jumpCnt===u.jumpSize&&n.jumpSize<6&&(n.jumpSize=6);var c=l.currentTime+n.jumpSize,h=l.media.duration;c>h||(console.log("waitintTimeout, currentTime:",l.currentTime,", jumpTo:",c),n.jumpCnt++,l.currentTime=c)}}),n}return me(t,[{key:"afterCreate",value:function(){var r=this,s=this.config,o=s.useWaitingTimeoutJump,a=s.jumpSize;o!==!1&&(this.hasPlayed=!1,this.jumpCnt=0,this.timer=null,this.jumpSize=a,this.on(nc,this.onWaiting),this.on([WO,Dn],function(){clearTimeout(r.timer),r.timer=null,r.jumpSize=r.config.jumpSize}),this.on(dn,function(){r.hasPlayed=!0}))}}],[{key:"pluginName",get:function(){return"waitingTimeoutJump"}},{key:"defaultConfig",get:function(){return{useWaitingTimeoutJump:!1,waitingTime:15,jumpSize:2,jumpCntMax:4}}}]),t}(Re),Z4=function(i){Ce(t,i);var e=Ae(t);function t(){var n;ge(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),q(V(n),"getSpeed",function(a){if(n.speedListCache.length<=0)return 0;var l=0;return n.speedListCache.map(function(u){l+=u}),Math.floor(l/n.speedListCache.length)}),q(V(n),"_onRealSpeedChange",function(a){a.speed&&n.appendList(a.speed)}),q(V(n),"testSpeed",function(){if(clearTimeout(n.timer),n.timer=null,!(!n.player||!n.config.openSpeed)){var a=n.config,l=a.url,u=a.loadSize,c=a.testCnt,h=a.testTimeStep,f=l+(l.indexOf("?")<0?"?testst=":"&testst=")+Date.now();if(!(n.cnt>=c)){n.cnt++;try{var d=new Date().getTime(),p=null,g=new XMLHttpRequest;n.xhr=g,g.open("GET",f);var m={},v=Math.floor(Math.random()*10);m.Range="bytes="+v+"-"+(u+v),m&&Object.keys(m).forEach(function(O){g.setRequestHeader(O,m[O])}),g.onreadystatechange=function(){if(g.readyState===4){n.xhr=null,p=new Date().getTime();var O=g.getResponseHeader("Content-Length")/1024*8,y=Math.round(O*1e3/(p-d));n.appendList(y),n.timer=setTimeout(n.testSpeed,h)}},g.send()}catch(O){console.error(O)}}}}),q(V(n),"appendList",function(a){var l=n.config.saveSpeedMax;n.speedListCache.length>=l&&n.speedListCache.shift(),n.speedListCache.push(a),n.player&&(n.player.realTimeSpeed=a),n.updateSpeed()}),q(V(n),"updateSpeed",function(){var a=n.getSpeed(),l=V(n),u=l.player;u&&(!u.avgSpeed||a!==u.avgSpeed)&&(u.avgSpeed=a,u.emit(K2,{speed:a,realTimeSpeed:u.realTimeSpeed}))}),n}return me(t,[{key:"afterCreate",value:function(){var r=this;this.speedListCache=[];var s=this.config,o=s.openSpeed,a=s.testTimeStep;this.timer=null,this.cnt=0,this.xhr=null,o&&(this.on("real_time_speed",this._onRealSpeedChange),this.on([co,ty],function(){k.isMSE(r.player.video)||(r.speedListCache=[],r.cnt=0,r.timer=setTimeout(r.testSpeed,a))}))}},{key:"openSpeed",get:function(){return this.config.openSpeed},set:function(r){if(this.config.openSpeed=r,!r&&this.timer){clearTimeout(this.timer),this.timer=null;return}if(this.config.openSpeed){if(this.timer)return;this.timer=setTimeout(this.testSpeed,this.config.testTimeStep)}}},{key:"destroy",value:function(){clearTimeout(this.timer),this.timer=null,this.xhr&&this.xhr.readyState!==4&&(this.xhr.cancel(),this.xhr=null)}}],[{key:"pluginName",get:function(){return"testspeed"}},{key:"defaultConfig",get:function(){return{openSpeed:!1,testCnt:3,loadSize:200*1024,testTimeStep:3e3,url:"",saveSpeedMax:5}}}]),t}(Re),j4=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t,[{key:"afterCreate",value:function(){var r=this,s=this.player,o=this.config;if(this.timer=null,this._lastDecodedFrames=0,this._currentStuckCount=0,this._lastCheckPoint=null,!o.disabled){var a=s.media.getVideoPlaybackQuality;a&&(this.on(dn,function(){r._startTick()}),this.on(nl,function(){r._stopTick()}),this.on(Ls,function(){r._stopTick()}),this.on(rc,function(){r._stopTick()}))}}},{key:"_startTick",value:function(){var r=this;this._stopTick(),this._timer=setTimeout(function(){r._checkDecodeFPS(),r._startTick()},this.config.tick)}},{key:"_stopTick",value:function(){clearTimeout(this._timer),this._timer=null}},{key:"_checkStuck",value:function(r){var s=this.player.media,o=document.hidden,a=s.paused;if(typeof o=="boolean"&&!o&&!a){for(var l=s.currentTime,u=s.buffered,c=!1,h=0;h<u.length;h++){var f=u.start(h),d=u.end(h);if(f<=l&&l<=d-1){c=!0;break}}s.readyState===4&&c&&(this._currentStuckCount>this.config.stuckCount?(this.emit(sA),this._currentStuckCount=0):r<=this.config.reportFrame?this._currentStuckCount++:this._currentStuckCount++)}}},{key:"_checkDecodeFPS",value:function(){if(this.player.media){var r=this.player.media.getVideoPlaybackQuality(),s=r.totalVideoFrames,o=performance.now();if(s&&this._lastCheckPoint){var a=s-this._lastDecodedFrames;this._checkStuck(a)}this._lastDecodedFrames=s,this._lastCheckPoint=o}}},{key:"destroy",value:function(){this._stopTick()}}],[{key:"pluginName",get:function(){return"FpsDetect"}},{key:"defaultConfig",get:function(){return{disabled:!1,tick:1e3,stuckCount:3,reportFrame:0}}}]),t}(Re);aa.use(B4);var G4=me(function i(e,t){var n,r,s;ge(this,i);var o=t&&t.isMobileSimulateMode==="mobile",a=t.isLive,l=a?[]:[i4,M4,D4,u4],u=[].concat(l,[n4,l4,g4,b4,_4,C4,T4,E4,d4,O4]),c=[$M,MM,QM,JM,BM,R4,L4,$4,jM];this.plugins=[U4,IM].concat(ys(u),c,[fA,V4]);var h=o?"mobile":Le.device;switch(h){case"pc":(n=this.plugins).push.apply(n,[eS,tg,iS,Z4,j4]);break;case"mobile":(r=this.plugins).push.apply(r,[qM]);break;default:(s=this.plugins).push.apply(s,[eS,tg,iS])}(Le.os.isIpad||h==="pc")&&this.plugins.push(Q4),Le.os.isIpad&&this.plugins.push(tg),this.ignores=[],this.i18n=[]}),yr=function(i){Ce(t,i);var e=Ae(t);function t(){return ge(this,t),e.apply(this,arguments)}return me(t)}(oy);q(yr,"defaultPreset",G4);q(yr,"Util",k);q(yr,"Sniffer",Le);q(yr,"Errors",zO);q(yr,"Events",lM);q(yr,"Plugin",Re);q(yr,"BasePlugin",Ts);q(yr,"I18N",aa);q(yr,"STATE_CLASS",K);var Tl=function(i){return i&&i.Math===Math&&i},rt=Tl(typeof globalThis=="object"&&globalThis)||Tl(typeof window=="object"&&window)||Tl(typeof self=="object"&&self)||Tl(typeof Vl=="object"&&Vl)||Tl(typeof Vl=="object"&&Vl)||function(){return this}()||Function("return this")(),dA={exports:{}},H4=!1,sS=rt,X4=Object.defineProperty,cy=function(i,e){try{X4(sS,i,{value:e,configurable:!0,writable:!0})}catch{sS[i]=e}return e},z4=rt,W4=cy,oS="__core-js_shared__",aS=dA.exports=z4[oS]||W4(oS,{});(aS.versions||(aS.versions=[])).push({version:"3.41.0",mode:"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var hy=dA.exports,lS=hy,fy=function(i,e){return lS[i]||(lS[i]=e||{})},dt=function(i){try{return!!i()}catch{return!0}},q4=dt,cp=!q4(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")}),pA=cp,gA=Function.prototype,Nm=gA.call,Y4=pA&&gA.bind.bind(Nm,Nm),st=pA?Y4:function(i){return function(){return Nm.apply(i,arguments)}},rl=function(i){return i==null},K4=rl,J4=TypeError,sl=function(i){if(K4(i))throw new J4("Can't call method on "+i);return i},e8=sl,t8=Object,Br=function(i){return t8(e8(i))},i8=st,n8=Br,r8=i8({}.hasOwnProperty),Ci=Object.hasOwn||function(e,t){return r8(n8(e),t)},s8=st,o8=0,a8=Math.random(),l8=s8(1 .toString),mA=function(i){return"Symbol("+(i===void 0?"":i)+")_"+l8(++o8+a8,36)},u8=rt,uS=u8.navigator,cS=uS&&uS.userAgent,sc=cS?String(cS):"",vA=rt,ng=sc,hS=vA.process,fS=vA.Deno,dS=hS&&hS.versions||fS&&fS.version,pS=dS&&dS.v8,$n,Yf;pS&&($n=pS.split("."),Yf=$n[0]>0&&$n[0]<4?1:+($n[0]+$n[1]));!Yf&&ng&&($n=ng.match(/Edge\/(\d+)/),(!$n||$n[1]>=74)&&($n=ng.match(/Chrome\/(\d+)/),$n&&(Yf=+$n[1])));var hp=Yf,gS=hp,c8=dt,h8=rt,f8=h8.String,OA=!!Object.getOwnPropertySymbols&&!c8(function(){var i=Symbol("symbol detection");return!f8(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&gS&&gS<41}),d8=OA,yA=d8&&!Symbol.sham&&typeof Symbol.iterator=="symbol",p8=rt,g8=fy,mS=Ci,m8=mA,v8=OA,O8=yA,la=p8.Symbol,rg=g8("wks"),y8=O8?la.for||la:la&&la.withoutSetter||m8,yt=function(i){return mS(rg,i)||(rg[i]=v8&&mS(la,i)?la[i]:y8("Symbol."+i)),rg[i]},b8=yt,x8=b8("toStringTag"),bA={};bA[x8]="z";var dy=String(bA)==="[object z]",sg=typeof document=="object"&&document.all,gt=typeof sg>"u"&&sg!==void 0?function(i){return typeof i=="function"||i===sg}:function(i){return typeof i=="function"},Zn={},S8=dt,Rt=!S8(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),k8=gt,Oi=function(i){return typeof i=="object"?i!==null:k8(i)},T8=rt,vS=Oi,Qm=T8.document,E8=vS(Qm)&&vS(Qm.createElement),fp=function(i){return E8?Qm.createElement(i):{}},w8=Rt,_8=dt,C8=fp,xA=!w8&&!_8(function(){return Object.defineProperty(C8("div"),"a",{get:function(){return 7}}).a!==7}),A8=Rt,P8=dt,SA=A8&&P8(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),R8=Oi,L8=String,I8=TypeError,Kt=function(i){if(R8(i))return i;throw new I8(L8(i)+" is not an object")},D8=cp,Zc=Function.prototype.call,Lt=D8?Zc.bind(Zc):function(){return Zc.apply(Zc,arguments)},og=rt,$8=gt,M8=function(i){return $8(i)?i:void 0},$s=function(i,e){return arguments.length<2?M8(og[i]):og[i]&&og[i][e]},F8=st,oc=F8({}.isPrototypeOf),N8=$s,Q8=gt,B8=oc,U8=yA,V8=Object,kA=U8?function(i){return typeof i=="symbol"}:function(i){var e=N8("Symbol");return Q8(e)&&B8(e.prototype,V8(i))},Z8=String,ac=function(i){try{return Z8(i)}catch{return"Object"}},j8=gt,G8=ac,H8=TypeError,Ms=function(i){if(j8(i))return i;throw new H8(G8(i)+" is not a function")},X8=Ms,z8=rl,lc=function(i,e){var t=i[e];return z8(t)?void 0:X8(t)},ag=Lt,lg=gt,ug=Oi,W8=TypeError,q8=function(i,e){var t,n;if(e==="string"&&lg(t=i.toString)&&!ug(n=ag(t,i))||lg(t=i.valueOf)&&!ug(n=ag(t,i))||e!=="string"&&lg(t=i.toString)&&!ug(n=ag(t,i)))return n;throw new W8("Can't convert object to primitive value")},Y8=Lt,OS=Oi,yS=kA,K8=lc,J8=q8,eF=yt,tF=TypeError,iF=eF("toPrimitive"),nF=function(i,e){if(!OS(i)||yS(i))return i;var t=K8(i,iF),n;if(t){if(e===void 0&&(e="default"),n=Y8(t,i,e),!OS(n)||yS(n))return n;throw new tF("Can't convert object to primitive value")}return e===void 0&&(e="number"),J8(i,e)},rF=nF,sF=kA,TA=function(i){var e=rF(i,"string");return sF(e)?e:e+""},oF=Rt,aF=xA,lF=SA,jc=Kt,bS=TA,uF=TypeError,cg=Object.defineProperty,cF=Object.getOwnPropertyDescriptor,hg="enumerable",fg="configurable",dg="writable";Zn.f=oF?lF?function(e,t,n){if(jc(e),t=bS(t),jc(n),typeof e=="function"&&t==="prototype"&&"value"in n&&dg in n&&!n[dg]){var r=cF(e,t);r&&r[dg]&&(e[t]=n.value,n={configurable:fg in n?n[fg]:r[fg],enumerable:hg in n?n[hg]:r[hg],writable:!1})}return cg(e,t,n)}:cg:function(e,t,n){if(jc(e),t=bS(t),jc(n),aF)try{return cg(e,t,n)}catch{}if("get"in n||"set"in n)throw new uF("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var EA={exports:{}},Bm=Rt,hF=Ci,wA=Function.prototype,fF=Bm&&Object.getOwnPropertyDescriptor,py=hF(wA,"name"),dF=py&&(function(){}).name==="something",pF=py&&(!Bm||Bm&&fF(wA,"name").configurable),dp={EXISTS:py,PROPER:dF,CONFIGURABLE:pF},gF=st,mF=gt,Um=hy,vF=gF(Function.toString);mF(Um.inspectSource)||(Um.inspectSource=function(i){return vF(i)});var gy=Um.inspectSource,OF=rt,yF=gt,xS=OF.WeakMap,bF=yF(xS)&&/native code/.test(String(xS)),uc=function(i,e){return{enumerable:!(i&1),configurable:!(i&2),writable:!(i&4),value:e}},xF=Rt,SF=Zn,kF=uc,So=xF?function(i,e,t){return SF.f(i,e,kF(1,t))}:function(i,e,t){return i[e]=t,i},TF=fy,EF=mA,SS=TF("keys"),my=function(i){return SS[i]||(SS[i]=EF(i))},vy={},wF=bF,_A=rt,_F=Oi,CF=So,pg=Ci,gg=hy,AF=my,PF=vy,kS="Object already initialized",Vm=_A.TypeError,RF=_A.WeakMap,Kf,Tu,Jf,LF=function(i){return Jf(i)?Tu(i):Kf(i,{})},IF=function(i){return function(e){var t;if(!_F(e)||(t=Tu(e)).type!==i)throw new Vm("Incompatible receiver, "+i+" required");return t}};if(wF||gg.state){var zn=gg.state||(gg.state=new RF);zn.get=zn.get,zn.has=zn.has,zn.set=zn.set,Kf=function(i,e){if(zn.has(i))throw new Vm(kS);return e.facade=i,zn.set(i,e),e},Tu=function(i){return zn.get(i)||{}},Jf=function(i){return zn.has(i)}}else{var Mo=AF("state");PF[Mo]=!0,Kf=function(i,e){if(pg(i,Mo))throw new Vm(kS);return e.facade=i,CF(i,Mo,e),e},Tu=function(i){return pg(i,Mo)?i[Mo]:{}},Jf=function(i){return pg(i,Mo)}}var Ur={set:Kf,get:Tu,has:Jf,enforce:LF,getterFor:IF},Oy=st,DF=dt,$F=gt,Gc=Ci,Zm=Rt,MF=dp.CONFIGURABLE,FF=gy,CA=Ur,NF=CA.enforce,QF=CA.get,TS=String,rf=Object.defineProperty,BF=Oy("".slice),UF=Oy("".replace),VF=Oy([].join),ZF=Zm&&!DF(function(){return rf(function(){},"length",{value:8}).length!==8}),jF=String(String).split("String"),GF=EA.exports=function(i,e,t){BF(TS(e),0,7)==="Symbol("&&(e="["+UF(TS(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!Gc(i,"name")||MF&&i.name!==e)&&(Zm?rf(i,"name",{value:e,configurable:!0}):i.name=e),ZF&&t&&Gc(t,"arity")&&i.length!==t.arity&&rf(i,"length",{value:t.arity});try{t&&Gc(t,"constructor")&&t.constructor?Zm&&rf(i,"prototype",{writable:!1}):i.prototype&&(i.prototype=void 0)}catch{}var n=NF(i);return Gc(n,"source")||(n.source=VF(jF,typeof e=="string"?e:"")),i};Function.prototype.toString=GF(function(){return $F(this)&&QF(this).source||FF(this)},"toString");var AA=EA.exports,HF=gt,XF=Zn,zF=AA,WF=cy,vn=function(i,e,t,n){n||(n={});var r=n.enumerable,s=n.name!==void 0?n.name:e;if(HF(t)&&zF(t,s,n),n.global)r?i[e]=t:WF(e,t);else{try{n.unsafe?i[e]&&(r=!0):delete i[e]}catch{}r?i[e]=t:XF.f(i,e,{value:t,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return i},PA=st,qF=PA({}.toString),YF=PA("".slice),Fs=function(i){return YF(qF(i),8,-1)},KF=dy,JF=gt,sf=Fs,eN=yt,tN=eN("toStringTag"),iN=Object,nN=sf(function(){return arguments}())==="Arguments",rN=function(i,e){try{return i[e]}catch{}},cc=KF?sf:function(i){var e,t,n;return i===void 0?"Undefined":i===null?"Null":typeof(t=rN(e=iN(i),tN))=="string"?t:nN?sf(e):(n=sf(e))==="Object"&&JF(e.callee)?"Arguments":n},sN=dy,oN=cc,aN=sN?{}.toString:function(){return"[object "+oN(this)+"]"},lN=dy,uN=vn,cN=aN;lN||uN(Object.prototype,"toString",cN,{unsafe:!0});var RA={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},hN=fp,mg=hN("span").classList,ES=mg&&mg.constructor&&mg.constructor.prototype,LA=ES===Object.prototype?void 0:ES,fN=Fs,dN=st,pN=function(i){if(fN(i)==="Function")return dN(i)},wS=pN,gN=Ms,mN=cp,vN=wS(wS.bind),ko=function(i,e){return gN(i),e===void 0?i:mN?vN(i,e):function(){return i.apply(e,arguments)}},ON=st,yN=dt,bN=Fs,vg=Object,xN=ON("".split),pp=yN(function(){return!vg("z").propertyIsEnumerable(0)})?function(i){return bN(i)==="String"?xN(i,""):vg(i)}:vg,SN=Math.ceil,kN=Math.floor,TN=Math.trunc||function(e){var t=+e;return(t>0?kN:SN)(t)},EN=TN,hc=function(i){var e=+i;return e!==e||e===0?0:EN(e)},wN=hc,_N=Math.min,yy=function(i){var e=wN(i);return e>0?_N(e,9007199254740991):0},CN=yy,ol=function(i){return CN(i.length)},AN=Fs,by=Array.isArray||function(e){return AN(e)==="Array"},PN=st,RN=dt,IA=gt,LN=cc,IN=$s,DN=gy,DA=function(){},$A=IN("Reflect","construct"),xy=/^\s*(?:class|function)\b/,$N=PN(xy.exec),MN=!xy.test(DA),El=function(e){if(!IA(e))return!1;try{return $A(DA,[],e),!0}catch{return!1}},MA=function(e){if(!IA(e))return!1;switch(LN(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return MN||!!$N(xy,DN(e))}catch{return!0}};MA.sham=!0;var Sy=!$A||RN(function(){var i;return El(El.call)||!El(Object)||!El(function(){i=!0})||i})?MA:El,_S=by,FN=Sy,NN=Oi,QN=yt,BN=QN("species"),CS=Array,UN=function(i){var e;return _S(i)&&(e=i.constructor,FN(e)&&(e===CS||_S(e.prototype))?e=void 0:NN(e)&&(e=e[BN],e===null&&(e=void 0))),e===void 0?CS:e},VN=UN,ky=function(i,e){return new(VN(i))(e===0?0:e)},ZN=ko,jN=st,GN=pp,HN=Br,XN=ol,zN=ky,AS=jN([].push),Xr=function(i){var e=i===1,t=i===2,n=i===3,r=i===4,s=i===6,o=i===7,a=i===5||s;return function(l,u,c,h){for(var f=HN(l),d=GN(f),p=XN(d),g=ZN(u,c),m=0,v=h||zN,O=e?v(l,p):t||o?v(l,0):void 0,y,x;p>m;m++)if((a||m in d)&&(y=d[m],x=g(y,m,f),i))if(e)O[m]=x;else if(x)switch(i){case 3:return!0;case 5:return y;case 6:return m;case 2:AS(O,y)}else switch(i){case 4:return!1;case 7:AS(O,y)}return s?-1:n||r?r:O}},gp={forEach:Xr(0),map:Xr(1),filter:Xr(2),some:Xr(3),every:Xr(4),find:Xr(5),findIndex:Xr(6),filterReject:Xr(7)},WN=dt,FA=function(i,e){var t=[][i];return!!t&&WN(function(){t.call(null,e||function(){return 1},1)})},qN=gp.forEach,YN=FA,KN=YN("forEach"),JN=KN?[].forEach:function(e){return qN(this,e,arguments.length>1?arguments[1]:void 0)},PS=rt,RS=RA,eQ=LA,Og=JN,tQ=So,NA=function(i){if(i&&i.forEach!==Og)try{tQ(i,"forEach",Og)}catch{i.forEach=Og}};for(var yg in RS)RS[yg]&&NA(PS[yg]&&PS[yg].prototype);NA(eQ);var Ty={},Ey={},QA={}.propertyIsEnumerable,BA=Object.getOwnPropertyDescriptor,iQ=BA&&!QA.call({1:2},1);Ey.f=iQ?function(e){var t=BA(this,e);return!!t&&t.enumerable}:QA;var nQ=pp,rQ=sl,al=function(i){return nQ(rQ(i))},sQ=Rt,oQ=Lt,aQ=Ey,lQ=uc,uQ=al,cQ=TA,hQ=Ci,fQ=xA,LS=Object.getOwnPropertyDescriptor;Ty.f=sQ?LS:function(e,t){if(e=uQ(e),t=cQ(t),fQ)try{return LS(e,t)}catch{}if(hQ(e,t))return lQ(!oQ(aQ.f,e,t),e[t])};var wy={},dQ=hc,pQ=Math.max,gQ=Math.min,_y=function(i,e){var t=dQ(i);return t<0?pQ(t+e,0):gQ(t,e)},mQ=al,vQ=_y,OQ=ol,IS=function(i){return function(e,t,n){var r=mQ(e),s=OQ(r);if(s===0)return!i&&-1;var o=vQ(n,s),a;if(i&&t!==t){for(;s>o;)if(a=r[o++],a!==a)return!0}else for(;s>o;o++)if((i||o in r)&&r[o]===t)return i||o||0;return!i&&-1}},yQ={includes:IS(!0),indexOf:IS(!1)},bQ=st,bg=Ci,xQ=al,SQ=yQ.indexOf,kQ=vy,DS=bQ([].push),UA=function(i,e){var t=xQ(i),n=0,r=[],s;for(s in t)!bg(kQ,s)&&bg(t,s)&&DS(r,s);for(;e.length>n;)bg(t,s=e[n++])&&(~SQ(r,s)||DS(r,s));return r},Cy=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],TQ=UA,EQ=Cy,wQ=EQ.concat("length","prototype");wy.f=Object.getOwnPropertyNames||function(e){return TQ(e,wQ)};var Ay={};Ay.f=Object.getOwnPropertySymbols;var _Q=$s,CQ=st,AQ=wy,PQ=Ay,RQ=Kt,LQ=CQ([].concat),IQ=_Q("Reflect","ownKeys")||function(e){var t=AQ.f(RQ(e)),n=PQ.f;return n?LQ(t,n(e)):t},$S=Ci,DQ=IQ,$Q=Ty,MQ=Zn,FQ=function(i,e,t){for(var n=DQ(e),r=MQ.f,s=$Q.f,o=0;o<n.length;o++){var a=n[o];!$S(i,a)&&!(t&&$S(t,a))&&r(i,a,s(e,a))}},NQ=dt,QQ=gt,BQ=/#|\.prototype\./,fc=function(i,e){var t=VQ[UQ(i)];return t===jQ?!0:t===ZQ?!1:QQ(e)?NQ(e):!!e},UQ=fc.normalize=function(i){return String(i).replace(BQ,".").toLowerCase()},VQ=fc.data={},ZQ=fc.NATIVE="N",jQ=fc.POLYFILL="P",Py=fc,Hc=rt,GQ=Ty.f,HQ=So,XQ=vn,zQ=cy,WQ=FQ,qQ=Py,Ft=function(i,e){var t=i.target,n=i.global,r=i.stat,s,o,a,l,u,c;if(n?o=Hc:r?o=Hc[t]||zQ(t,{}):o=Hc[t]&&Hc[t].prototype,o)for(a in e){if(u=e[a],i.dontCallGetSet?(c=GQ(o,a),l=c&&c.value):l=o[a],s=qQ(n?a:t+(r?".":"#")+a,i.forced),!s&&l!==void 0){if(typeof u==typeof l)continue;WQ(u,l)}(i.sham||l&&l.sham)&&HQ(u,"sham",!0),XQ(o,a,u,i)}},YQ=dt,KQ=yt,JQ=hp,eB=KQ("species"),mp=function(i){return JQ>=51||!YQ(function(){var e=[],t=e.constructor={};return t[eB]=function(){return{foo:1}},e[i](Boolean).foo!==1})},tB=Ft,iB=gp.map,nB=mp,rB=nB("map");tB({target:"Array",proto:!0,forced:!rB},{map:function(e){return iB(this,e,arguments.length>1?arguments[1]:void 0)}});var sB=UA,oB=Cy,Ry=Object.keys||function(e){return sB(e,oB)},aB=Ft,lB=Br,VA=Ry,uB=dt,cB=uB(function(){VA(1)});aB({target:"Object",stat:!0,forced:cB},{keys:function(e){return VA(lB(e))}});var wl=rt,hB=sc,fB=Fs,Xc=function(i){return hB.slice(0,i.length)===i},ZA=function(){return Xc("Bun/")?"BUN":Xc("Cloudflare-Workers")?"CLOUDFLARE":Xc("Deno/")?"DENO":Xc("Node.js/")?"NODE":wl.Bun&&typeof Bun.version=="string"?"BUN":wl.Deno&&typeof Deno.version=="object"?"DENO":fB(wl.process)==="process"?"NODE":wl.window&&wl.document?"BROWSER":"REST"}(),dB=ZA,Ly=dB==="NODE",pB=st,gB=Ms,mB=function(i,e,t){try{return pB(gB(Object.getOwnPropertyDescriptor(i,e)[t]))}catch{}},vB=Oi,OB=function(i){return vB(i)||i===null},yB=OB,bB=String,xB=TypeError,SB=function(i){if(yB(i))return i;throw new xB("Can't set "+bB(i)+" as a prototype")},kB=mB,TB=Oi,EB=sl,wB=SB,Iy=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,e={},t;try{t=kB(Object.prototype,"__proto__","set"),t(e,[]),i=e instanceof Array}catch{}return function(r,s){return EB(r),wB(s),TB(r)&&(i?t(r,s):r.__proto__=s),r}}():void 0),_B=Zn.f,CB=Ci,AB=yt,MS=AB("toStringTag"),ll=function(i,e,t){i&&!t&&(i=i.prototype),i&&!CB(i,MS)&&_B(i,MS,{configurable:!0,value:e})},FS=AA,PB=Zn,dc=function(i,e,t){return t.get&&FS(t.get,e,{getter:!0}),t.set&&FS(t.set,e,{setter:!0}),PB.f(i,e,t)},RB=$s,LB=dc,IB=yt,DB=Rt,NS=IB("species"),jA=function(i){var e=RB(i);DB&&e&&!e[NS]&&LB(e,NS,{configurable:!0,get:function(){return this}})},$B=oc,MB=TypeError,Dy=function(i,e){if($B(e,i))return i;throw new MB("Incorrect invocation")},FB=Sy,NB=ac,QB=TypeError,BB=function(i){if(FB(i))return i;throw new QB(NB(i)+" is not a constructor")},QS=Kt,UB=BB,VB=rl,ZB=yt,jB=ZB("species"),GB=function(i,e){var t=QS(i).constructor,n;return t===void 0||VB(n=QS(t)[jB])?e:UB(n)},HB=cp,GA=Function.prototype,BS=GA.apply,US=GA.call,HA=typeof Reflect=="object"&&Reflect.apply||(HB?US.bind(BS):function(){return US.apply(BS,arguments)}),XB=$s,XA=XB("document","documentElement"),zB=st,$y=zB([].slice),WB=TypeError,My=function(i,e){if(i<e)throw new WB("Not enough arguments");return i},qB=sc,zA=/(?:ipad|iphone|ipod).*applewebkit/i.test(qB),Vi=rt,YB=HA,KB=ko,VS=gt,JB=Ci,WA=dt,ZS=XA,e9=$y,jS=fp,t9=My,i9=zA,n9=Ly,jm=Vi.setImmediate,Gm=Vi.clearImmediate,r9=Vi.process,xg=Vi.Dispatch,s9=Vi.Function,GS=Vi.MessageChannel,o9=Vi.String,Sg=0,ru={},HS="onreadystatechange",Eu,Qs,kg,Tg;WA(function(){Eu=Vi.location});var Fy=function(i){if(JB(ru,i)){var e=ru[i];delete ru[i],e()}},Eg=function(i){return function(){Fy(i)}},XS=function(i){Fy(i.data)},zS=function(i){Vi.postMessage(o9(i),Eu.protocol+"//"+Eu.host)};(!jm||!Gm)&&(jm=function(e){t9(arguments.length,1);var t=VS(e)?e:s9(e),n=e9(arguments,1);return ru[++Sg]=function(){YB(t,void 0,n)},Qs(Sg),Sg},Gm=function(e){delete ru[e]},n9?Qs=function(i){r9.nextTick(Eg(i))}:xg&&xg.now?Qs=function(i){xg.now(Eg(i))}:GS&&!i9?(kg=new GS,Tg=kg.port2,kg.port1.onmessage=XS,Qs=KB(Tg.postMessage,Tg)):Vi.addEventListener&&VS(Vi.postMessage)&&!Vi.importScripts&&Eu&&Eu.protocol!=="file:"&&!WA(zS)?(Qs=zS,Vi.addEventListener("message",XS,!1)):HS in jS("script")?Qs=function(i){ZS.appendChild(jS("script"))[HS]=function(){ZS.removeChild(this),Fy(i)}}:Qs=function(i){setTimeout(Eg(i),0)});var qA={set:jm,clear:Gm},WS=rt,a9=Rt,l9=Object.getOwnPropertyDescriptor,YA=function(i){if(!a9)return WS[i];var e=l9(WS,i);return e&&e.value},KA=function(){this.head=null,this.tail=null};KA.prototype={add:function(i){var e={item:i,next:null},t=this.tail;t?t.next=e:this.head=e,this.tail=e},get:function(){var i=this.head;if(i){var e=this.head=i.next;return e===null&&(this.tail=null),i.item}}};var JA=KA,u9=sc,c9=/ipad|iphone|ipod/i.test(u9)&&typeof Pebble<"u",h9=sc,f9=/web0s(?!.*chrome)/i.test(h9),Ra=rt,d9=YA,qS=ko,wg=qA.set,p9=JA,g9=zA,m9=c9,v9=f9,_g=Ly,YS=Ra.MutationObserver||Ra.WebKitMutationObserver,KS=Ra.document,JS=Ra.process,zc=Ra.Promise,Hm=d9("queueMicrotask"),Fo,Cg,Ag,Wc,ek;if(!Hm){var qc=new p9,Yc=function(){var i,e;for(_g&&(i=JS.domain)&&i.exit();e=qc.get();)try{e()}catch(t){throw qc.head&&Fo(),t}i&&i.enter()};!g9&&!_g&&!v9&&YS&&KS?(Cg=!0,Ag=KS.createTextNode(""),new YS(Yc).observe(Ag,{characterData:!0}),Fo=function(){Ag.data=Cg=!Cg}):!m9&&zc&&zc.resolve?(Wc=zc.resolve(void 0),Wc.constructor=zc,ek=qS(Wc.then,Wc),Fo=function(){ek(Yc)}):_g?Fo=function(){JS.nextTick(Yc)}:(wg=qS(wg,Ra),Fo=function(){wg(Yc)}),Hm=function(i){qc.head||Fo(),qc.add(i)}}var O9=Hm,y9=function(i,e){try{arguments.length===1?console.error(i):console.error(i,e)}catch{}},Ny=function(i){try{return{error:!1,value:i()}}catch(e){return{error:!0,value:e}}},b9=rt,vp=b9.Promise,x9=rt,su=vp,S9=gt,k9=Py,T9=gy,E9=yt,tk=ZA,Pg=hp;su&&su.prototype;var w9=E9("species"),Xm=!1,eP=S9(x9.PromiseRejectionEvent),_9=k9("Promise",function(){var i=T9(su),e=i!==String(su);if(!e&&Pg===66)return!0;if(!Pg||Pg<51||!/native code/.test(i)){var t=new su(function(s){s(1)}),n=function(s){s(function(){},function(){})},r=t.constructor={};if(r[w9]=n,Xm=t.then(function(){})instanceof n,!Xm)return!0}return!e&&(tk==="BROWSER"||tk==="DENO")&&!eP}),pc={CONSTRUCTOR:_9,REJECTION_EVENT:eP,SUBCLASSING:Xm},ul={},ik=Ms,C9=TypeError,A9=function(i){var e,t;this.promise=new i(function(n,r){if(e!==void 0||t!==void 0)throw new C9("Bad Promise constructor");e=n,t=r}),this.resolve=ik(e),this.reject=ik(t)};ul.f=function(i){return new A9(i)};var P9=Ft,ed=Ly,Es=rt,La=Lt,nk=vn,rk=Iy,R9=ll,L9=jA,I9=Ms,of=gt,D9=Oi,$9=Dy,M9=GB,tP=qA.set,Qy=O9,F9=y9,N9=Ny,Q9=JA,iP=Ur,td=vp,By=pc,nP=ul,Op="Promise",rP=By.CONSTRUCTOR,B9=By.REJECTION_EVENT,U9=By.SUBCLASSING,Rg=iP.getterFor(Op),V9=iP.set,Jo=td&&td.prototype,qs=td,Kc=Jo,sP=Es.TypeError,zm=Es.document,Uy=Es.process,Wm=nP.f,Z9=Wm,j9=!!(zm&&zm.createEvent&&Es.dispatchEvent),oP="unhandledrejection",G9="rejectionhandled",sk=0,aP=1,H9=2,Vy=1,lP=2,Jc,ok,X9,ak,uP=function(i){var e;return D9(i)&&of(e=i.then)?e:!1},cP=function(i,e){var t=e.value,n=e.state===aP,r=n?i.ok:i.fail,s=i.resolve,o=i.reject,a=i.domain,l,u,c;try{r?(n||(e.rejection===lP&&W9(e),e.rejection=Vy),r===!0?l=t:(a&&a.enter(),l=r(t),a&&(a.exit(),c=!0)),l===i.promise?o(new sP("Promise-chain cycle")):(u=uP(l))?La(u,l,s,o):s(l)):o(t)}catch(h){a&&!c&&a.exit(),o(h)}},hP=function(i,e){i.notified||(i.notified=!0,Qy(function(){for(var t=i.reactions,n;n=t.get();)cP(n,i);i.notified=!1,e&&!i.rejection&&z9(i)}))},fP=function(i,e,t){var n,r;j9?(n=zm.createEvent("Event"),n.promise=e,n.reason=t,n.initEvent(i,!1,!0),Es.dispatchEvent(n)):n={promise:e,reason:t},!B9&&(r=Es["on"+i])?r(n):i===oP&&F9("Unhandled promise rejection",t)},z9=function(i){La(tP,Es,function(){var e=i.facade,t=i.value,n=lk(i),r;if(n&&(r=N9(function(){ed?Uy.emit("unhandledRejection",t,e):fP(oP,e,t)}),i.rejection=ed||lk(i)?lP:Vy,r.error))throw r.value})},lk=function(i){return i.rejection!==Vy&&!i.parent},W9=function(i){La(tP,Es,function(){var e=i.facade;ed?Uy.emit("rejectionHandled",e):fP(G9,e,i.value)})},ua=function(i,e,t){return function(n){i(e,n,t)}},ma=function(i,e,t){i.done||(i.done=!0,t&&(i=t),i.value=e,i.state=H9,hP(i,!0))},qm=function(i,e,t){if(!i.done){i.done=!0,t&&(i=t);try{if(i.facade===e)throw new sP("Promise can't be resolved itself");var n=uP(e);n?Qy(function(){var r={done:!1};try{La(n,e,ua(qm,r,i),ua(ma,r,i))}catch(s){ma(r,s,i)}}):(i.value=e,i.state=aP,hP(i,!1))}catch(r){ma({done:!1},r,i)}}};if(rP&&(qs=function(e){$9(this,Kc),I9(e),La(Jc,this);var t=Rg(this);try{e(ua(qm,t),ua(ma,t))}catch(n){ma(t,n)}},Kc=qs.prototype,Jc=function(e){V9(this,{type:Op,done:!1,notified:!1,parent:!1,reactions:new Q9,rejection:!1,state:sk,value:null})},Jc.prototype=nk(Kc,"then",function(e,t){var n=Rg(this),r=Wm(M9(this,qs));return n.parent=!0,r.ok=of(e)?e:!0,r.fail=of(t)&&t,r.domain=ed?Uy.domain:void 0,n.state===sk?n.reactions.add(r):Qy(function(){cP(r,n)}),r.promise}),ok=function(){var i=new Jc,e=Rg(i);this.promise=i,this.resolve=ua(qm,e),this.reject=ua(ma,e)},nP.f=Wm=function(i){return i===qs||i===X9?new ok(i):Z9(i)},of(td)&&Jo!==Object.prototype)){ak=Jo.then,U9||nk(Jo,"then",function(e,t){var n=this;return new qs(function(r,s){La(ak,n,r,s)}).then(e,t)},{unsafe:!0});try{delete Jo.constructor}catch{}rk&&rk(Jo,Kc)}P9({global:!0,constructor:!0,wrap:!0,forced:rP},{Promise:qs});R9(qs,Op,!1);L9(Op);var gc={},q9=yt,Y9=gc,K9=q9("iterator"),J9=Array.prototype,dP=function(i){return i!==void 0&&(Y9.Array===i||J9[K9]===i)},e7=cc,uk=lc,t7=rl,i7=gc,n7=yt,r7=n7("iterator"),yp=function(i){if(!t7(i))return uk(i,r7)||uk(i,"@@iterator")||i7[e7(i)]},s7=Lt,o7=Ms,a7=Kt,l7=ac,u7=yp,c7=TypeError,Zy=function(i,e){var t=arguments.length<2?u7(i):e;if(o7(t))return a7(s7(t,i));throw new c7(l7(i)+" is not iterable")},h7=Lt,ck=Kt,f7=lc,pP=function(i,e,t){var n,r;ck(i);try{if(n=f7(i,"return"),!n){if(e==="throw")throw t;return t}n=h7(n,i)}catch(s){r=!0,n=s}if(e==="throw")throw t;if(r)throw n;return ck(n),t},d7=ko,p7=Lt,g7=Kt,m7=ac,v7=dP,O7=ol,hk=oc,y7=Zy,b7=yp,fk=pP,x7=TypeError,af=function(i,e){this.stopped=i,this.result=e},dk=af.prototype,gP=function(i,e,t){var n=t&&t.that,r=!!(t&&t.AS_ENTRIES),s=!!(t&&t.IS_RECORD),o=!!(t&&t.IS_ITERATOR),a=!!(t&&t.INTERRUPTED),l=d7(e,n),u,c,h,f,d,p,g,m=function(O){return u&&fk(u,"normal",O),new af(!0,O)},v=function(O){return r?(g7(O),a?l(O[0],O[1],m):l(O[0],O[1])):a?l(O,m):l(O)};if(s)u=i.iterator;else if(o)u=i;else{if(c=b7(i),!c)throw new x7(m7(i)+" is not iterable");if(v7(c)){for(h=0,f=O7(i);f>h;h++)if(d=v(i[h]),d&&hk(dk,d))return d;return new af(!1)}u=y7(i,c)}for(p=s?i.next:u.next;!(g=p7(p,u)).done;){try{d=v(g.value)}catch(O){fk(u,"throw",O)}if(typeof d=="object"&&d&&hk(dk,d))return d}return new af(!1)},S7=yt,mP=S7("iterator"),vP=!1;try{var k7=0,pk={next:function(){return{done:!!k7++}},return:function(){vP=!0}};pk[mP]=function(){return this},Array.from(pk,function(){throw 2})}catch{}var T7=function(i,e){try{if(!e&&!vP)return!1}catch{return!1}var t=!1;try{var n={};n[mP]=function(){return{next:function(){return{done:t=!0}}}},i(n)}catch{}return t},E7=vp,w7=T7,_7=pc.CONSTRUCTOR,OP=_7||!w7(function(i){E7.all(i).then(void 0,function(){})}),C7=Ft,A7=Lt,P7=Ms,R7=ul,L7=Ny,I7=gP,D7=OP;C7({target:"Promise",stat:!0,forced:D7},{all:function(e){var t=this,n=R7.f(t),r=n.resolve,s=n.reject,o=L7(function(){var a=P7(t.resolve),l=[],u=0,c=1;I7(e,function(h){var f=u++,d=!1;c++,A7(a,t,h).then(function(p){d||(d=!0,l[f]=p,--c||r(l))},s)}),--c||r(l)});return o.error&&s(o.value),n.promise}});var $7=Ft,M7=pc.CONSTRUCTOR,Ym=vp,F7=$s,N7=gt,Q7=vn,gk=Ym&&Ym.prototype;$7({target:"Promise",proto:!0,forced:M7,real:!0},{catch:function(i){return this.then(void 0,i)}});if(N7(Ym)){var mk=F7("Promise").prototype.catch;gk.catch!==mk&&Q7(gk,"catch",mk,{unsafe:!0})}var B7=Ft,U7=Lt,V7=Ms,Z7=ul,j7=Ny,G7=gP,H7=OP;B7({target:"Promise",stat:!0,forced:H7},{race:function(e){var t=this,n=Z7.f(t),r=n.reject,s=j7(function(){var o=V7(t.resolve);G7(e,function(a){U7(o,t,a).then(n.resolve,r)})});return s.error&&r(s.value),n.promise}});var X7=Ft,z7=ul,W7=pc.CONSTRUCTOR;X7({target:"Promise",stat:!0,forced:W7},{reject:function(e){var t=z7.f(this),n=t.reject;return n(e),t.promise}});var q7=Kt,Y7=Oi,K7=ul,J7=function(i,e){if(q7(i),Y7(e)&&e.constructor===i)return e;var t=K7.f(i),n=t.resolve;return n(e),t.promise},eU=Ft,tU=$s,iU=pc.CONSTRUCTOR,nU=J7;tU("Promise");eU({target:"Promise",stat:!0,forced:iU},{resolve:function(e){return nU(this,e)}});var rU=TypeError,sU=9007199254740991,yP=function(i){if(i>sU)throw rU("Maximum allowed index exceeded");return i},oU=Rt,aU=Zn,lU=uc,jy=function(i,e,t){oU?aU.f(i,e,lU(0,t)):i[e]=t},uU=Ft,cU=dt,hU=by,fU=Oi,dU=Br,pU=ol,vk=yP,Ok=jy,gU=ky,mU=mp,vU=yt,OU=hp,bP=vU("isConcatSpreadable"),yU=OU>=51||!cU(function(){var i=[];return i[bP]=!1,i.concat()[0]!==i}),bU=function(i){if(!fU(i))return!1;var e=i[bP];return e!==void 0?!!e:hU(i)},xU=!yU||!mU("concat");uU({target:"Array",proto:!0,arity:1,forced:xU},{concat:function(e){var t=dU(this),n=gU(t,0),r=0,s,o,a,l,u;for(s=-1,a=arguments.length;s<a;s++)if(u=s===-1?t:arguments[s],bU(u))for(l=pU(u),vk(r+l),o=0;o<l;o++,r++)o in u&&Ok(n,r,u[o]);else vk(r+1),Ok(n,r++,u);return n.length=r,n}});var SU=Rt,kU=by,TU=TypeError,EU=Object.getOwnPropertyDescriptor,wU=SU&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(i){return i instanceof TypeError}}(),_U=wU?function(i,e){if(kU(i)&&!EU(i,"length").writable)throw new TU("Cannot set read only .length");return i.length=e}:function(i,e){return i.length=e},yk=ac,CU=TypeError,AU=function(i,e){if(!delete i[e])throw new CU("Cannot delete property "+yk(e)+" of "+yk(i))},PU=Ft,RU=Br,LU=_y,IU=hc,DU=ol,$U=_U,MU=yP,FU=ky,NU=jy,Lg=AU,QU=mp,BU=QU("splice"),UU=Math.max,VU=Math.min;PU({target:"Array",proto:!0,forced:!BU},{splice:function(e,t){var n=RU(this),r=DU(n),s=LU(e,r),o=arguments.length,a,l,u,c,h,f;for(o===0?a=l=0:o===1?(a=0,l=r-s):(a=o-2,l=VU(UU(IU(t),0),r-s)),MU(r+a-l),u=FU(n,l),c=0;c<l;c++)h=s+c,h in n&&NU(u,c,n[h]);if(u.length=l,a<l){for(c=s;c<r-l;c++)h=c+l,f=c+a,h in n?n[f]=n[h]:Lg(n,f);for(c=r;c>r-l+a;c--)Lg(n,c-1)}else if(a>l)for(c=r-l;c>s;c--)h=c+l-1,f=c+a-1,h in n?n[f]=n[h]:Lg(n,f);for(c=0;c<a;c++)n[c+s]=arguments[c+2];return $U(n,r-l+a),u}});var xP={},ZU=Rt,jU=SA,GU=Zn,HU=Kt,XU=al,zU=Ry;xP.f=ZU&&!jU?Object.defineProperties:function(e,t){HU(e);for(var n=XU(t),r=zU(t),s=r.length,o=0,a;s>o;)GU.f(e,a=r[o++],n[a]);return e};var WU=Kt,qU=xP,bk=Cy,YU=vy,KU=XA,JU=fp,eV=my,xk=">",Sk="<",Km="prototype",Jm="script",SP=eV("IE_PROTO"),Ig=function(){},kP=function(i){return Sk+Jm+xk+i+Sk+"/"+Jm+xk},kk=function(i){i.write(kP("")),i.close();var e=i.parentWindow.Object;return i=null,e},tV=function(){var i=JU("iframe"),e="java"+Jm+":",t;return i.style.display="none",KU.appendChild(i),i.src=String(e),t=i.contentWindow.document,t.open(),t.write(kP("document.F=Object")),t.close(),t.F},eh,lf=function(){try{eh=new ActiveXObject("htmlfile")}catch{}lf=typeof document<"u"?document.domain&&eh?kk(eh):tV():kk(eh);for(var i=bk.length;i--;)delete lf[Km][bk[i]];return lf()};YU[SP]=!0;var mc=Object.create||function(e,t){var n;return e!==null?(Ig[Km]=WU(e),n=new Ig,Ig[Km]=null,n[SP]=e):n=lf(),t===void 0?n:qU.f(n,t)},iV=yt,nV=mc,rV=Zn.f,ev=iV("unscopables"),tv=Array.prototype;tv[ev]===void 0&&rV(tv,ev,{configurable:!0,value:nV(null)});var TP=function(i){tv[ev][i]=!0},sV=Oi,oV=Fs,aV=yt,lV=aV("match"),uV=function(i){var e;return sV(i)&&((e=i[lV])!==void 0?!!e:oV(i)==="RegExp")},cV=cc,hV=String,br=function(i){if(cV(i)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return hV(i)},fV=Rt,dV=dp.EXISTS,EP=st,pV=dc,wP=Function.prototype,gV=EP(wP.toString),_P=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,mV=EP(_P.exec),vV="name";fV&&!dV&&pV(wP,vV,{configurable:!0,get:function(){try{return mV(_P,gV(this))[1]}catch{return""}}});var OV=gt,yV=Oi,Tk=Iy,bV=function(i,e,t){var n,r;return Tk&&OV(n=e.constructor)&&n!==t&&yV(r=n.prototype)&&r!==t.prototype&&Tk(i,r),i},xV=Kt,CP=function(){var i=xV(this),e="";return i.hasIndices&&(e+="d"),i.global&&(e+="g"),i.ignoreCase&&(e+="i"),i.multiline&&(e+="m"),i.dotAll&&(e+="s"),i.unicode&&(e+="u"),i.unicodeSets&&(e+="v"),i.sticky&&(e+="y"),e},Gy=dt,SV=rt,Hy=SV.RegExp,Xy=Gy(function(){var i=Hy("a","y");return i.lastIndex=2,i.exec("abcd")!==null}),kV=Xy||Gy(function(){return!Hy("a","y").sticky}),TV=Xy||Gy(function(){var i=Hy("^r","gy");return i.lastIndex=2,i.exec("str")!==null}),zy={BROKEN_CARET:TV,MISSED_STICKY:kV,UNSUPPORTED_Y:Xy},EV=dt,wV=rt,_V=wV.RegExp,AP=EV(function(){var i=_V(".","s");return!(i.dotAll&&i.test(`
`)&&i.flags==="s")}),CV=dt,AV=rt,PV=AV.RegExp,PP=CV(function(){var i=PV("(?<a>b)","g");return i.exec("b").groups.a!=="b"||"b".replace(i,"$<a>c")!=="bc"}),ca=Lt,bp=st,RV=br,LV=CP,IV=zy,DV=fy,$V=mc,MV=Ur.get,FV=AP,NV=PP,QV=DV("native-string-replace",String.prototype.replace),id=RegExp.prototype.exec,iv=id,BV=bp("".charAt),UV=bp("".indexOf),VV=bp("".replace),Dg=bp("".slice),nv=function(){var i=/a/,e=/b*/g;return ca(id,i,"a"),ca(id,e,"a"),i.lastIndex!==0||e.lastIndex!==0}(),RP=IV.BROKEN_CARET,rv=/()??/.exec("")[1]!==void 0,ZV=nv||rv||RP||FV||NV;ZV&&(iv=function(e){var t=this,n=MV(t),r=RV(e),s=n.raw,o,a,l,u,c,h,f;if(s)return s.lastIndex=t.lastIndex,o=ca(iv,s,r),t.lastIndex=s.lastIndex,o;var d=n.groups,p=RP&&t.sticky,g=ca(LV,t),m=t.source,v=0,O=r;if(p&&(g=VV(g,"y",""),UV(g,"g")===-1&&(g+="g"),O=Dg(r,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&BV(r,t.lastIndex-1)!==`
`)&&(m="(?: "+m+")",O=" "+O,v++),a=new RegExp("^(?:"+m+")",g)),rv&&(a=new RegExp("^"+m+"$(?!\\s)",g)),nv&&(l=t.lastIndex),u=ca(id,p?a:t,O),p?u?(u.input=Dg(u.input,v),u[0]=Dg(u[0],v),u.index=t.lastIndex,t.lastIndex+=u[0].length):t.lastIndex=0:nv&&u&&(t.lastIndex=t.global?u.index+u[0].length:l),rv&&u&&u.length>1&&ca(QV,u[0],a,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&d)for(u.groups=h=$V(null),c=0;c<d.length;c++)f=d[c],h[f[0]]=u[f[1]];return u});var Wy=iv,jV=Ft,Ek=Wy;jV({target:"RegExp",proto:!0,forced:/./.exec!==Ek},{exec:Ek});var wk=Lt,_k=vn,GV=Wy,Ck=dt,LP=yt,HV=So,XV=LP("species"),$g=RegExp.prototype,IP=function(i,e,t,n){var r=LP(i),s=!Ck(function(){var u={};return u[r]=function(){return 7},""[i](u)!==7}),o=s&&!Ck(function(){var u=!1,c=/a/;return i==="split"&&(c={},c.constructor={},c.constructor[XV]=function(){return c},c.flags="",c[r]=/./[r]),c.exec=function(){return u=!0,null},c[r](""),!u});if(!s||!o||t){var a=/./[r],l=e(r,""[i],function(u,c,h,f,d){var p=c.exec;return p===GV||p===$g.exec?s&&!d?{done:!0,value:wk(a,c,h,f)}:{done:!0,value:wk(u,h,c,f)}:{done:!1}});_k(String.prototype,i,l[0]),_k($g,r,l[1])}n&&HV($g[r],"sham",!0)},qy=st,zV=hc,WV=br,qV=sl,YV=qy("".charAt),Ak=qy("".charCodeAt),KV=qy("".slice),Pk=function(i){return function(e,t){var n=WV(qV(e)),r=zV(t),s=n.length,o,a;return r<0||r>=s?i?"":void 0:(o=Ak(n,r),o<55296||o>56319||r+1===s||(a=Ak(n,r+1))<56320||a>57343?i?YV(n,r):o:i?KV(n,r,r+2):(o-55296<<10)+(a-56320)+65536)}},Yy={codeAt:Pk(!1),charAt:Pk(!0)},JV=Yy.charAt,DP=function(i,e,t){return e+(t?JV(i,e).length:1)},Rk=Lt,eZ=Kt,tZ=gt,iZ=Fs,nZ=Wy,rZ=TypeError,$P=function(i,e){var t=i.exec;if(tZ(t)){var n=Rk(t,i,e);return n!==null&&eZ(n),n}if(iZ(i)==="RegExp")return Rk(nZ,i,e);throw new rZ("RegExp#exec called on incompatible receiver")},sZ=Lt,oZ=IP,aZ=Kt,lZ=rl,uZ=yy,Mg=br,cZ=sl,hZ=lc,fZ=DP,Lk=$P;oZ("match",function(i,e,t){return[function(r){var s=cZ(this),o=lZ(r)?void 0:hZ(r,i);return o?sZ(o,r,s):new RegExp(r)[i](Mg(s))},function(n){var r=aZ(this),s=Mg(n),o=t(e,r,s);if(o.done)return o.value;if(!r.global)return Lk(r,s);var a=r.unicode;r.lastIndex=0;for(var l=[],u=0,c;(c=Lk(r,s))!==null;){var h=Mg(c[0]);l[u]=h,h===""&&(r.lastIndex=fZ(s,uZ(r.lastIndex),a)),u++}return u===0?null:l}]});var dZ=Lt,pZ=Ci,gZ=oc,mZ=CP,Ik=RegExp.prototype,MP=function(i){var e=i.flags;return e===void 0&&!("flags"in Ik)&&!pZ(i,"flags")&&gZ(Ik,i)?dZ(mZ,i):e},vZ=Zn.f,OZ=function(i,e,t){t in i||vZ(i,t,{configurable:!0,get:function(){return e[t]},set:function(n){e[t]=n}})},yZ=Rt,Ky=rt,vc=st,bZ=Py,xZ=bV,SZ=So,kZ=mc,TZ=wy.f,Dk=oc,EZ=uV,$k=br,wZ=MP,FP=zy,_Z=OZ,CZ=vn,AZ=dt,PZ=Ci,RZ=Ur.enforce,LZ=jA,IZ=yt,NP=AP,QP=PP,DZ=IZ("match"),bs=Ky.RegExp,ea=bs.prototype,$Z=Ky.SyntaxError,MZ=vc(ea.exec),nd=vc("".charAt),Mk=vc("".replace),Fk=vc("".indexOf),Nk=vc("".slice),FZ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,oo=/a/g,Fg=/a/g,NZ=new bs(oo)!==oo,BP=FP.MISSED_STICKY,QZ=FP.UNSUPPORTED_Y,BZ=yZ&&(!NZ||BP||NP||QP||AZ(function(){return Fg[DZ]=!1,bs(oo)!==oo||bs(Fg)===Fg||String(bs(oo,"i"))!=="/a/i"})),UZ=function(i){for(var e=i.length,t=0,n="",r=!1,s;t<=e;t++){if(s=nd(i,t),s==="\\"){n+=s+nd(i,++t);continue}!r&&s==="."?n+="[\\s\\S]":(s==="["?r=!0:s==="]"&&(r=!1),n+=s)}return n},VZ=function(i){for(var e=i.length,t=0,n="",r=[],s=kZ(null),o=!1,a=!1,l=0,u="",c;t<=e;t++){if(c=nd(i,t),c==="\\")c+=nd(i,++t);else if(c==="]")o=!1;else if(!o)switch(!0){case c==="[":o=!0;break;case c==="(":if(n+=c,Nk(i,t+1,t+3)==="?:")continue;MZ(FZ,Nk(i,t+1))&&(t+=2,a=!0),l++;continue;case(c===">"&&a):if(u===""||PZ(s,u))throw new $Z("Invalid capture group name");s[u]=!0,r[r.length]=[u,l],a=!1,u="";continue}a?u+=c:n+=c}return[n,r]};if(bZ("RegExp",BZ)){for(var Bs=function(e,t){var n=Dk(ea,this),r=EZ(e),s=t===void 0,o=[],a=e,l,u,c,h,f,d;if(!n&&r&&s&&e.constructor===Bs)return e;if((r||Dk(ea,e))&&(e=e.source,s&&(t=wZ(a))),e=e===void 0?"":$k(e),t=t===void 0?"":$k(t),a=e,NP&&"dotAll"in oo&&(u=!!t&&Fk(t,"s")>-1,u&&(t=Mk(t,/s/g,""))),l=t,BP&&"sticky"in oo&&(c=!!t&&Fk(t,"y")>-1,c&&QZ&&(t=Mk(t,/y/g,""))),QP&&(h=VZ(e),e=h[0],o=h[1]),f=xZ(bs(e,t),n?this:ea,Bs),(u||c||o.length)&&(d=RZ(f),u&&(d.dotAll=!0,d.raw=Bs(UZ(e),l)),c&&(d.sticky=!0),o.length&&(d.groups=o)),e!==a)try{SZ(f,"source",a===""?"(?:)":a)}catch{}return f},Qk=TZ(bs),Bk=0;Qk.length>Bk;)_Z(Bs,bs,Qk[Bk++]);ea.constructor=Bs,Bs.prototype=ea,CZ(Ky,"RegExp",Bs,{constructor:!0})}LZ("RegExp");var ZZ=Rt,jZ=zy.MISSED_STICKY,GZ=Fs,HZ=dc,XZ=Ur.get,Uk=RegExp.prototype,zZ=TypeError;ZZ&&jZ&&HZ(Uk,"sticky",{configurable:!0,get:function(){if(this!==Uk){if(GZ(this)==="RegExp")return!!XZ(this).sticky;throw new zZ("Incompatible receiver, RegExp required")}}});var WZ=dp.PROPER,qZ=vn,YZ=Kt,Vk=br,KZ=dt,JZ=MP,Jy="toString",UP=RegExp.prototype,VP=UP[Jy],ej=KZ(function(){return VP.call({source:"a",flags:"b"})!=="/a/b"}),tj=WZ&&VP.name!==Jy;(ej||tj)&&qZ(UP,Jy,function(){var e=YZ(this),t=Vk(e.source),n=Vk(JZ(e));return"/"+t+"/"+n},{unsafe:!0});var e1=st,ij=Br,nj=Math.floor,Ng=e1("".charAt),rj=e1("".replace),Qg=e1("".slice),sj=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,oj=/\$([$&'`]|\d{1,2})/g,aj=function(i,e,t,n,r,s){var o=t+i.length,a=n.length,l=oj;return r!==void 0&&(r=ij(r),l=sj),rj(s,l,function(u,c){var h;switch(Ng(c,0)){case"$":return"$";case"&":return i;case"`":return Qg(e,0,t);case"'":return Qg(e,o);case"<":h=r[Qg(c,1,-1)];break;default:var f=+c;if(f===0)return u;if(f>a){var d=nj(f/10);return d===0?u:d<=a?n[d-1]===void 0?Ng(c,1):n[d-1]+Ng(c,1):u}h=n[f-1]}return h===void 0?"":h})},lj=HA,Zk=Lt,xp=st,uj=IP,cj=dt,hj=Kt,fj=gt,dj=rl,pj=hc,gj=yy,No=br,mj=sl,vj=DP,Oj=lc,yj=aj,bj=$P,xj=yt,sv=xj("replace"),Sj=Math.max,kj=Math.min,Tj=xp([].concat),Bg=xp([].push),jk=xp("".indexOf),Gk=xp("".slice),Ej=function(i){return i===void 0?i:String(i)},wj=function(){return"a".replace(/./,"$0")==="$0"}(),Hk=function(){return/./[sv]?/./[sv]("a","$0")==="":!1}(),_j=!cj(function(){var i=/./;return i.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(i,"$<a>")!=="7"});uj("replace",function(i,e,t){var n=Hk?"$":"$0";return[function(s,o){var a=mj(this),l=dj(s)?void 0:Oj(s,sv);return l?Zk(l,s,a,o):Zk(e,No(a),s,o)},function(r,s){var o=hj(this),a=No(r);if(typeof s=="string"&&jk(s,n)===-1&&jk(s,"$<")===-1){var l=t(e,o,a,s);if(l.done)return l.value}var u=fj(s);u||(s=No(s));var c=o.global,h;c&&(h=o.unicode,o.lastIndex=0);for(var f=[],d;d=bj(o,a),!(d===null||(Bg(f,d),!c));){var p=No(d[0]);p===""&&(o.lastIndex=vj(a,gj(o.lastIndex),h))}for(var g="",m=0,v=0;v<f.length;v++){d=f[v];for(var O=No(d[0]),y=Sj(kj(pj(d.index),a.length),0),x=[],b,E=1;E<d.length;E++)Bg(x,Ej(d[E]));var T=d.groups;if(u){var _=Tj([O],x,y,a);T!==void 0&&Bg(_,T),b=No(lj(s,void 0,_))}else b=yj(O,a,y,x,T,s);y>=m&&(g+=Gk(a,m,y)+b,m=y+O.length)}return g+Gk(a,m)}]},!_j||!wj||Hk);var Cj=Ft,Xk=Lt,Aj=gt,zk=Kt,Pj=br,Rj=function(){var i=!1,e=/[ac]/;return e.exec=function(){return i=!0,/./.exec.apply(this,arguments)},e.test("abc")===!0&&i}(),Lj=/./.test;Cj({target:"RegExp",proto:!0,forced:!Rj},{test:function(i){var e=zk(this),t=Pj(i),n=e.exec;if(!Aj(n))return Xk(Lj,e,t);var r=Xk(n,e,t);return r===null?!1:(zk(r),!0)}});var Ij=Ft,Dj=st,$j=pp,Mj=al,Fj=FA,Nj=Dj([].join),Qj=$j!==Object,Bj=Qj||!Fj("join",",");Ij({target:"Array",proto:!0,forced:Bj},{join:function(e){return Nj(Mj(this),e===void 0?",":e)}});function Wk(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function rd(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wk(Object(t),!0).forEach(function(n){xs(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Wk(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function jn(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function qk(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function Gn(i,e,t){return e&&qk(i.prototype,e),t&&qk(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function xs(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function To(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&ov(i,e)}function sd(i){return sd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sd(i)}function ov(i,e){return ov=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ov(i,e)}function Uj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zi(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Vj(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zi(i)}function Eo(i){var e=Uj();return function(){var n=sd(i),r;if(e){var s=sd(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return Vj(this,r)}}var Zj=dt,jj=!Zj(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype}),Gj=Ci,Hj=gt,Xj=Br,zj=my,Wj=jj,Yk=zj("IE_PROTO"),av=Object,qj=av.prototype,ZP=Wj?av.getPrototypeOf:function(i){var e=Xj(i);if(Gj(e,Yk))return e[Yk];var t=e.constructor;return Hj(t)&&e instanceof t?t.prototype:e instanceof av?qj:null},Yj=dt,Kj=gt,Jj=Oi,Kk=ZP,eG=vn,tG=yt,lv=tG("iterator"),jP=!1,ho,Ug,Vg;[].keys&&(Vg=[].keys(),"next"in Vg?(Ug=Kk(Kk(Vg)),Ug!==Object.prototype&&(ho=Ug)):jP=!0);var iG=!Jj(ho)||Yj(function(){var i={};return ho[lv].call(i)!==i});iG&&(ho={});Kj(ho[lv])||eG(ho,lv,function(){return this});var GP={IteratorPrototype:ho,BUGGY_SAFARI_ITERATORS:jP},nG=GP.IteratorPrototype,rG=mc,sG=uc,oG=ll,aG=gc,lG=function(){return this},HP=function(i,e,t,n){var r=e+" Iterator";return i.prototype=rG(nG,{next:sG(+!n,t)}),oG(i,r,!1),aG[r]=lG,i},uG=Ft,cG=Lt,XP=dp,hG=gt,fG=HP,Jk=ZP,eT=Iy,dG=ll,pG=So,Zg=vn,gG=yt,mG=gc,zP=GP,vG=XP.PROPER,OG=XP.CONFIGURABLE,tT=zP.IteratorPrototype,th=zP.BUGGY_SAFARI_ITERATORS,_l=gG("iterator"),iT="keys",Cl="values",nT="entries",yG=function(){return this},WP=function(i,e,t,n,r,s,o){fG(t,e,n);var a=function(v){if(v===r&&f)return f;if(!th&&v&&v in c)return c[v];switch(v){case iT:return function(){return new t(this,v)};case Cl:return function(){return new t(this,v)};case nT:return function(){return new t(this,v)}}return function(){return new t(this)}},l=e+" Iterator",u=!1,c=i.prototype,h=c[_l]||c["@@iterator"]||r&&c[r],f=!th&&h||a(r),d=e==="Array"&&c.entries||h,p,g,m;if(d&&(p=Jk(d.call(new i)),p!==Object.prototype&&p.next&&(Jk(p)!==tT&&(eT?eT(p,tT):hG(p[_l])||Zg(p,_l,yG)),dG(p,l,!0))),vG&&r===Cl&&h&&h.name!==Cl&&(OG?pG(c,"name",Cl):(u=!0,f=function(){return cG(h,this)})),r)if(g={values:a(Cl),keys:s?f:a(iT),entries:a(nT)},o)for(m in g)(th||u||!(m in c))&&Zg(c,m,g[m]);else uG({target:e,proto:!0,forced:th||u},g);return c[_l]!==f&&Zg(c,_l,f,{name:r}),mG[e]=f,g},t1=function(i,e){return{value:i,done:e}},bG=al,i1=TP,rT=gc,qP=Ur,xG=Zn.f,SG=WP,ih=t1,kG=Rt,YP="Array Iterator",TG=qP.set,EG=qP.getterFor(YP),wG=SG(Array,"Array",function(i,e){TG(this,{type:YP,target:bG(i),index:0,kind:e})},function(){var i=EG(this),e=i.target,t=i.index++;if(!e||t>=e.length)return i.target=null,ih(void 0,!0);switch(i.kind){case"keys":return ih(t,!1);case"values":return ih(e[t],!1)}return ih([t,e[t]],!1)},"values"),sT=rT.Arguments=rT.Array;i1("keys");i1("values");i1("entries");if(kG&&sT.name!=="values")try{xG(sT,"name",{value:"values"})}catch{}var _G=Yy.charAt,CG=br,KP=Ur,AG=WP,oT=t1,JP="String Iterator",PG=KP.set,RG=KP.getterFor(JP);AG(String,"String",function(i){PG(this,{type:JP,string:CG(i),index:0})},function(){var e=RG(this),t=e.string,n=e.index,r;return n>=t.length?oT(void 0,!0):(r=_G(t,n),e.index+=r.length,oT(r,!1))});var aT=rt,eR=RA,LG=LA,Gl=wG,lT=So,IG=ll,DG=yt,jg=DG("iterator"),Gg=Gl.values,tR=function(i,e){if(i){if(i[jg]!==Gg)try{lT(i,jg,Gg)}catch{i[jg]=Gg}if(IG(i,e,!0),eR[e]){for(var t in Gl)if(i[t]!==Gl[t])try{lT(i,t,Gl[t])}catch{i[t]=Gl[t]}}}};for(var Hg in eR)tR(aT[Hg]&&aT[Hg].prototype,Hg);tR(LG,"DOMTokenList");var $G=dt,MG=yt,FG=Rt,uT=H4,NG=MG("iterator"),iR=!$G(function(){var i=new URL("b?a=1&b=2&c=3","https://a"),e=i.searchParams,t=new URLSearchParams("a=1&a=2&b=3"),n="";return i.pathname="c%20d",e.forEach(function(r,s){e.delete("b"),n+=s+r}),t.delete("a",2),t.delete("b",void 0),uT&&(!i.toJSON||!t.has("a",1)||t.has("a",2)||!t.has("a",void 0)||t.has("b"))||!e.size&&(uT||!FG)||!e.sort||i.href!=="https://a/c%20d?a=1&c=3"||e.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!e[NG]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||n!=="a1c3"||new URL("https://x",void 0).host!=="x"}),cT=Rt,QG=st,BG=Lt,UG=dt,Xg=Ry,VG=Ay,ZG=Ey,jG=Br,GG=pp,Qo=Object.assign,hT=Object.defineProperty,HG=QG([].concat),XG=!Qo||UG(function(){if(cT&&Qo({b:1},Qo(hT({},"a",{enumerable:!0,get:function(){hT(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var i={},e={},t=Symbol("assign detection"),n="abcdefghijklmnopqrst";return i[t]=7,n.split("").forEach(function(r){e[r]=r}),Qo({},i)[t]!==7||Xg(Qo({},e)).join("")!==n})?function(e,t){for(var n=jG(e),r=arguments.length,s=1,o=VG.f,a=ZG.f;r>s;)for(var l=GG(arguments[s++]),u=o?HG(Xg(l),o(l)):Xg(l),c=u.length,h=0,f;c>h;)f=u[h++],(!cT||BG(a,l,f))&&(n[f]=l[f]);return n}:Qo,zG=Kt,WG=pP,qG=function(i,e,t,n){try{return n?e(zG(t)[0],t[1]):e(t)}catch(r){WG(i,"throw",r)}},YG=ko,KG=Lt,JG=Br,eH=qG,tH=dP,iH=Sy,nH=ol,fT=jy,rH=Zy,sH=yp,dT=Array,oH=function(e){var t=JG(e),n=iH(this),r=arguments.length,s=r>1?arguments[1]:void 0,o=s!==void 0;o&&(s=YG(s,r>2?arguments[2]:void 0));var a=sH(t),l=0,u,c,h,f,d,p;if(a&&!(this===dT&&tH(a)))for(c=n?new this:[],f=rH(t,a),d=f.next;!(h=KG(d,f)).done;l++)p=o?eH(f,s,[h.value,l],!0):h.value,fT(c,l,p);else for(u=nH(t),c=n?new this(u):dT(u);u>l;l++)p=o?s(t[l],l):t[l],fT(c,l,p);return c.length=l,c},wo=st,zg=2147483647,ou=36,nR=1,uv=26,aH=38,lH=700,uH=72,cH=128,hH="-",fH=/[^\0-\u007E]/,rR=/[.\u3002\uFF0E\uFF61]/g,pT="Overflow: input needs wider integers to process",Wg=ou-nR,gT=RangeError,dH=wo(rR.exec),ha=Math.floor,qg=String.fromCharCode,mT=wo("".charCodeAt),sR=wo([].join),fs=wo([].push),pH=wo("".replace),gH=wo("".split),mH=wo("".toLowerCase),vH=function(i){for(var e=[],t=0,n=i.length;t<n;){var r=mT(i,t++);if(r>=55296&&r<=56319&&t<n){var s=mT(i,t++);(s&64512)===56320?fs(e,((r&1023)<<10)+(s&1023)+65536):(fs(e,r),t--)}else fs(e,r)}return e},vT=function(i){return i+22+75*(i<26)},OH=function(i,e,t){var n=0;for(i=t?ha(i/lH):i>>1,i+=ha(i/e);i>Wg*uv>>1;)i=ha(i/Wg),n+=ou;return ha(n+(Wg+1)*i/(i+aH))},yH=function(i){var e=[];i=vH(i);var t=i.length,n=cH,r=0,s=uH,o,a;for(o=0;o<i.length;o++)a=i[o],a<128&&fs(e,qg(a));var l=e.length,u=l;for(l&&fs(e,hH);u<t;){var c=zg;for(o=0;o<i.length;o++)a=i[o],a>=n&&a<c&&(c=a);var h=u+1;if(c-n>ha((zg-r)/h))throw new gT(pT);for(r+=(c-n)*h,n=c,o=0;o<i.length;o++){if(a=i[o],a<n&&++r>zg)throw new gT(pT);if(a===n){for(var f=r,d=ou;;){var p=d<=s?nR:d>=s+uv?uv:d-s;if(f<p)break;var g=f-p,m=ou-p;fs(e,qg(vT(p+g%m))),f=ha(g/m),d+=ou}fs(e,qg(vT(f))),s=OH(r,h,u===l),r=0,u++}}r++,n++}return sR(e,"")},bH=function(i){var e=[],t=gH(pH(mH(i),rR,"."),"."),n,r;for(n=0;n<t.length;n++)r=t[n],fs(e,dH(fH,r)?"xn--"+yH(r):r);return sR(e,".")},xH=Ft,SH=st,kH=_y,TH=RangeError,OT=String.fromCharCode,yT=String.fromCodePoint,EH=SH([].join),wH=!!yT&&yT.length!==1;xH({target:"String",stat:!0,arity:1,forced:wH},{fromCodePoint:function(e){for(var t=[],n=arguments.length,r=0,s;n>r;){if(s=+arguments[r++],kH(s,1114111)!==s)throw new TH(s+" is not a valid code point");t[r]=s<65536?OT(s):OT(((s-=65536)>>10)+55296,s%1024+56320)}return EH(t,"")}});var _H=vn,CH=function(i,e,t){for(var n in e)_H(i,n,e[n],t);return i},bT=$y,AH=Math.floor,cv=function(i,e){var t=i.length;if(t<8)for(var n=1,r,s;n<t;){for(s=n,r=i[n];s&&e(i[s-1],r)>0;)i[s]=i[--s];s!==n++&&(i[s]=r)}else for(var o=AH(t/2),a=cv(bT(i,0,o),e),l=cv(bT(i,o),e),u=a.length,c=l.length,h=0,f=0;h<u||f<c;)i[h+f]=h<u&&f<c?e(a[h],l[f])<=0?a[h++]:l[f++]:h<u?a[h++]:l[f++];return i},PH=cv,hv=Ft,oR=rt,n1=YA,RH=$s,nh=Lt,Bn=st,au=Rt,aR=iR,lR=vn,LH=dc,IH=CH,DH=ll,$H=HP,r1=Ur,uR=Dy,Yg=gt,MH=Ci,FH=ko,NH=cc,QH=Kt,cR=Oi,hi=br,BH=mc,xT=uc,ST=Zy,UH=yp,rh=t1,Bo=My,VH=yt,ZH=PH,jH=VH("iterator"),cl="URLSearchParams",hR=cl+"Iterator",fR=r1.set,en=r1.getterFor(cl),GH=r1.getterFor(hR),kT=n1("fetch"),od=n1("Request"),lu=n1("Headers"),Kg=od&&od.prototype,TT=lu&&lu.prototype,HH=oR.TypeError,XH=oR.encodeURIComponent,zH=String.fromCharCode,WH=RH("String","fromCodePoint"),qH=parseInt,uf=Bn("".charAt),ET=Bn([].join),ds=Bn([].push),dR=Bn("".replace),YH=Bn([].shift),wT=Bn([].splice),_T=Bn("".split),pR=Bn("".slice),KH=Bn(/./.exec),JH=/\+/g,Jg="",eX=/^[0-9a-f]+$/i,CT=function(i,e){var t=pR(i,e,e+2);return KH(eX,t)?qH(t,16):NaN},tX=function(i){for(var e=0,t=128;t>0&&i&t;t>>=1)e++;return e},iX=function(i){var e=null;switch(i.length){case 1:e=i[0];break;case 2:e=(i[0]&31)<<6|i[1]&63;break;case 3:e=(i[0]&15)<<12|(i[1]&63)<<6|i[2]&63;break;case 4:e=(i[0]&7)<<18|(i[1]&63)<<12|(i[2]&63)<<6|i[3]&63;break}return e>1114111?null:e},AT=function(i){i=dR(i,JH," ");for(var e=i.length,t="",n=0;n<e;){var r=uf(i,n);if(r==="%"){if(uf(i,n+1)==="%"||n+3>e){t+="%",n++;continue}var s=CT(i,n+1);if(s!==s){t+=r,n++;continue}n+=2;var o=tX(s);if(o===0)r=zH(s);else{if(o===1||o>4){t+=Jg,n++;continue}for(var a=[s],l=1;l<o&&(n++,!(n+3>e||uf(i,n)!=="%"));){var u=CT(i,n+1);if(u!==u){n+=3;break}if(u>191||u<128)break;ds(a,u),n+=2,l++}if(a.length!==o){t+=Jg;continue}var c=iX(a);c===null?t+=Jg:r=WH(c)}}t+=r,n++}return t},nX=/[!'()~]|%20/g,rX={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},sX=function(i){return rX[i]},PT=function(i){return dR(XH(i),nX,sX)},e0=$H(function(e,t){fR(this,{type:hR,target:en(e).entries,index:0,kind:t})},cl,function(){var e=GH(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,rh(void 0,!0);var r=t[n];switch(e.kind){case"keys":return rh(r.key,!1);case"values":return rh(r.value,!1)}return rh([r.key,r.value],!1)},!0),gR=function(i){this.entries=[],this.url=null,i!==void 0&&(cR(i)?this.parseObject(i):this.parseQuery(typeof i=="string"?uf(i,0)==="?"?pR(i,1):i:hi(i)))};gR.prototype={type:cl,bindURL:function(i){this.url=i,this.update()},parseObject:function(i){var e=this.entries,t=UH(i),n,r,s,o,a,l,u;if(t)for(n=ST(i,t),r=n.next;!(s=nh(r,n)).done;){if(o=ST(QH(s.value)),a=o.next,(l=nh(a,o)).done||(u=nh(a,o)).done||!nh(a,o).done)throw new HH("Expected sequence with length 2");ds(e,{key:hi(l.value),value:hi(u.value)})}else for(var c in i)MH(i,c)&&ds(e,{key:c,value:hi(i[c])})},parseQuery:function(i){if(i)for(var e=this.entries,t=_T(i,"&"),n=0,r,s;n<t.length;)r=t[n++],r.length&&(s=_T(r,"="),ds(e,{key:AT(YH(s)),value:AT(ET(s,"="))}))},serialize:function(){for(var i=this.entries,e=[],t=0,n;t<i.length;)n=i[t++],ds(e,PT(n.key)+"="+PT(n.value));return ET(e,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Sp=function(){uR(this,Ia);var e=arguments.length>0?arguments[0]:void 0,t=fR(this,new gR(e));au||(this.size=t.entries.length)},Ia=Sp.prototype;IH(Ia,{append:function(e,t){var n=en(this);Bo(arguments.length,2),ds(n.entries,{key:hi(e),value:hi(t)}),au||this.length++,n.updateURL()},delete:function(i){for(var e=en(this),t=Bo(arguments.length,1),n=e.entries,r=hi(i),s=t<2?void 0:arguments[1],o=s===void 0?s:hi(s),a=0;a<n.length;){var l=n[a];if(l.key===r&&(o===void 0||l.value===o)){if(wT(n,a,1),o!==void 0)break}else a++}au||(this.size=n.length),e.updateURL()},get:function(e){var t=en(this).entries;Bo(arguments.length,1);for(var n=hi(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){var t=en(this).entries;Bo(arguments.length,1);for(var n=hi(e),r=[],s=0;s<t.length;s++)t[s].key===n&&ds(r,t[s].value);return r},has:function(e){for(var t=en(this).entries,n=Bo(arguments.length,1),r=hi(e),s=n<2?void 0:arguments[1],o=s===void 0?s:hi(s),a=0;a<t.length;){var l=t[a++];if(l.key===r&&(o===void 0||l.value===o))return!0}return!1},set:function(e,t){var n=en(this);Bo(arguments.length,1);for(var r=n.entries,s=!1,o=hi(e),a=hi(t),l=0,u;l<r.length;l++)u=r[l],u.key===o&&(s?wT(r,l--,1):(s=!0,u.value=a));s||ds(r,{key:o,value:a}),au||(this.size=r.length),n.updateURL()},sort:function(){var e=en(this);ZH(e.entries,function(t,n){return t.key>n.key?1:-1}),e.updateURL()},forEach:function(e){for(var t=en(this).entries,n=FH(e,arguments.length>1?arguments[1]:void 0),r=0,s;r<t.length;)s=t[r++],n(s.value,s.key,this)},keys:function(){return new e0(this,"keys")},values:function(){return new e0(this,"values")},entries:function(){return new e0(this,"entries")}},{enumerable:!0});lR(Ia,jH,Ia.entries,{name:"entries"});lR(Ia,"toString",function(){return en(this).serialize()},{enumerable:!0});au&&LH(Ia,"size",{get:function(){return en(this).entries.length},configurable:!0,enumerable:!0});DH(Sp,cl);hv({global:!0,constructor:!0,forced:!aR},{URLSearchParams:Sp});if(!aR&&Yg(lu)){var oX=Bn(TT.has),aX=Bn(TT.set),RT=function(i){if(cR(i)){var e=i.body,t;if(NH(e)===cl)return t=i.headers?new lu(i.headers):new lu,oX(t,"content-type")||aX(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),BH(i,{body:xT(0,hi(e)),headers:xT(0,t)})}return i};if(Yg(kT)&&hv({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return kT(e,arguments.length>1?RT(arguments[1]):{})}}),Yg(od)){var t0=function(e){return uR(this,Kg),new od(e,arguments.length>1?RT(arguments[1]):{})};Kg.constructor=t0,t0.prototype=Kg,hv({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:t0})}}var lX={URLSearchParams:Sp,getState:en},uX=Ft,s1=Rt,cX=iR,o1=rt,LT=ko,On=st,ad=vn,Wi=dc,hX=Dy,fv=Ci,a1=XG,Uo=oH,kn=$y,fX=Yy.codeAt,dX=bH,Cr=br,pX=ll,gX=My,mR=lX,vR=Ur,mX=vR.set,ld=vR.getterFor("URL"),vX=mR.URLSearchParams,OX=mR.getState,Al=o1.URL,dv=o1.TypeError,ud=o1.parseInt,yX=Math.floor,IT=Math.pow,rn=On("".charAt),Fn=On(/./.exec),Hl=On([].join),bX=On(1 .toString),xX=On([].pop),ta=On([].push),i0=On("".replace),SX=On([].shift),kX=On("".split),uu=On("".slice),cd=On("".toLowerCase),TX=On([].unshift),EX="Invalid authority",n0="Invalid scheme",Us="Invalid host",DT="Invalid port",OR=/[a-z]/i,wX=/[\d+-.a-z]/i,pv=/\d/,_X=/^0x/i,CX=/^[0-7]+$/,AX=/^\d+$/,yR=/^[\da-f]+$/i,PX=/[\0\t\n\r #%/:<>?@[\\\]^|]/,RX=/[\0\t\n\r #/:<>?@[\\\]^|]/,LX=/^[\u0000-\u0020]+/,IX=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,DX=/[\t\n\r]/g,qi,$X=function(i){var e=kX(i,"."),t,n,r,s,o,a,l;if(e.length&&e[e.length-1]===""&&e.length--,t=e.length,t>4)return i;for(n=[],r=0;r<t;r++){if(s=e[r],s==="")return i;if(o=10,s.length>1&&rn(s,0)==="0"&&(o=Fn(_X,s)?16:8,s=uu(s,o===8?1:2)),s==="")a=0;else{if(!Fn(o===10?AX:o===8?CX:yR,s))return i;a=ud(s,o)}ta(n,a)}for(r=0;r<t;r++)if(a=n[r],r===t-1){if(a>=IT(256,5-t))return null}else if(a>255)return null;for(l=xX(n),r=0;r<n.length;r++)l+=n[r]*IT(256,3-r);return l},MX=function(i){var e=[0,0,0,0,0,0,0,0],t=0,n=null,r=0,s,o,a,l,u,c,h,f=function(){return rn(i,r)};if(f()===":"){if(rn(i,1)!==":")return;r+=2,t++,n=t}for(;f();){if(t===8)return;if(f()===":"){if(n!==null)return;r++,t++,n=t;continue}for(s=o=0;o<4&&Fn(yR,f());)s=s*16+ud(f(),16),r++,o++;if(f()==="."){if(o===0||(r-=o,t>6))return;for(a=0;f();){if(l=null,a>0)if(f()==="."&&a<4)r++;else return;if(!Fn(pv,f()))return;for(;Fn(pv,f());){if(u=ud(f(),10),l===null)l=u;else{if(l===0)return;l=l*10+u}if(l>255)return;r++}e[t]=e[t]*256+l,a++,(a===2||a===4)&&t++}if(a!==4)return;break}else if(f()===":"){if(r++,!f())return}else if(f())return;e[t++]=s}if(n!==null)for(c=t-n,t=7;t!==0&&c>0;)h=e[t],e[t--]=e[n+c-1],e[n+--c]=h;else if(t!==8)return;return e},FX=function(i){for(var e=null,t=1,n=null,r=0,s=0;s<8;s++)i[s]!==0?(r>t&&(e=n,t=r),n=null,r=0):(n===null&&(n=s),++r);return r>t?n:e},Pl=function(i){var e,t,n,r;if(typeof i=="number"){for(e=[],t=0;t<4;t++)TX(e,i%256),i=yX(i/256);return Hl(e,".")}if(typeof i=="object"){for(e="",n=FX(i),t=0;t<8;t++)r&&i[t]===0||(r&&(r=!1),n===t?(e+=t?":":"::",r=!0):(e+=bX(i[t],16),t<7&&(e+=":")));return"["+e+"]"}return i},cf={},bR=a1({},cf,{" ":1,'"':1,"<":1,">":1,"`":1}),xR=a1({},bR,{"#":1,"?":1,"{":1,"}":1}),r0=a1({},xR,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),zr=function(i,e){var t=fX(i,0);return t>32&&t<127&&!fv(e,i)?i:encodeURIComponent(i)},sh={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Xl=function(i,e){var t;return i.length===2&&Fn(OR,rn(i,0))&&((t=rn(i,1))===":"||!e&&t==="|")},$T=function(i){var e;return i.length>1&&Xl(uu(i,0,2))&&(i.length===2||(e=rn(i,2))==="/"||e==="\\"||e==="?"||e==="#")},NX=function(i){return i==="."||cd(i)==="%2e"},QX=function(i){return i=cd(i),i===".."||i==="%2e."||i===".%2e"||i==="%2e%2e"},s0={},MT={},o0={},FT={},NT={},a0={},QT={},BT={},oh={},ah={},l0={},u0={},c0={},h0={},UT={},f0={},Vo={},Wn={},VT={},Vs={},Tr={},l1=function(i,e,t){var n=Cr(i),r,s,o;if(e){if(s=this.parse(n),s)throw new dv(s);this.searchParams=null}else{if(t!==void 0&&(r=new l1(t,!0)),s=this.parse(n,null,r),s)throw new dv(s);o=OX(new vX),o.bindURL(this),this.searchParams=o}};l1.prototype={type:"URL",parse:function(i,e,t){var n=this,r=e||s0,s=0,o="",a=!1,l=!1,u=!1,c,h,f,d;for(i=Cr(i),e||(n.scheme="",n.username="",n.password="",n.host=null,n.port=null,n.path=[],n.query=null,n.fragment=null,n.cannotBeABaseURL=!1,i=i0(i,LX,""),i=i0(i,IX,"$1")),i=i0(i,DX,""),c=Uo(i);s<=c.length;){switch(h=c[s],r){case s0:if(h&&Fn(OR,h))o+=cd(h),r=MT;else{if(e)return n0;r=o0;continue}break;case MT:if(h&&(Fn(wX,h)||h==="+"||h==="-"||h==="."))o+=cd(h);else if(h===":"){if(e&&(n.isSpecial()!==fv(sh,o)||o==="file"&&(n.includesCredentials()||n.port!==null)||n.scheme==="file"&&!n.host))return;if(n.scheme=o,e){n.isSpecial()&&sh[n.scheme]===n.port&&(n.port=null);return}o="",n.scheme==="file"?r=h0:n.isSpecial()&&t&&t.scheme===n.scheme?r=FT:n.isSpecial()?r=BT:c[s+1]==="/"?(r=NT,s++):(n.cannotBeABaseURL=!0,ta(n.path,""),r=VT)}else{if(e)return n0;o="",r=o0,s=0;continue}break;case o0:if(!t||t.cannotBeABaseURL&&h!=="#")return n0;if(t.cannotBeABaseURL&&h==="#"){n.scheme=t.scheme,n.path=kn(t.path),n.query=t.query,n.fragment="",n.cannotBeABaseURL=!0,r=Tr;break}r=t.scheme==="file"?h0:a0;continue;case FT:if(h==="/"&&c[s+1]==="/")r=oh,s++;else{r=a0;continue}break;case NT:if(h==="/"){r=ah;break}else{r=Wn;continue}case a0:if(n.scheme=t.scheme,h===qi)n.username=t.username,n.password=t.password,n.host=t.host,n.port=t.port,n.path=kn(t.path),n.query=t.query;else if(h==="/"||h==="\\"&&n.isSpecial())r=QT;else if(h==="?")n.username=t.username,n.password=t.password,n.host=t.host,n.port=t.port,n.path=kn(t.path),n.query="",r=Vs;else if(h==="#")n.username=t.username,n.password=t.password,n.host=t.host,n.port=t.port,n.path=kn(t.path),n.query=t.query,n.fragment="",r=Tr;else{n.username=t.username,n.password=t.password,n.host=t.host,n.port=t.port,n.path=kn(t.path),n.path.length--,r=Wn;continue}break;case QT:if(n.isSpecial()&&(h==="/"||h==="\\"))r=oh;else if(h==="/")r=ah;else{n.username=t.username,n.password=t.password,n.host=t.host,n.port=t.port,r=Wn;continue}break;case BT:if(r=oh,h!=="/"||rn(o,s+1)!=="/")continue;s++;break;case oh:if(h!=="/"&&h!=="\\"){r=ah;continue}break;case ah:if(h==="@"){a&&(o="%40"+o),a=!0,f=Uo(o);for(var p=0;p<f.length;p++){var g=f[p];if(g===":"&&!u){u=!0;continue}var m=zr(g,r0);u?n.password+=m:n.username+=m}o=""}else if(h===qi||h==="/"||h==="?"||h==="#"||h==="\\"&&n.isSpecial()){if(a&&o==="")return EX;s-=Uo(o).length+1,o="",r=l0}else o+=h;break;case l0:case u0:if(e&&n.scheme==="file"){r=f0;continue}else if(h===":"&&!l){if(o==="")return Us;if(d=n.parseHost(o),d)return d;if(o="",r=c0,e===u0)return}else if(h===qi||h==="/"||h==="?"||h==="#"||h==="\\"&&n.isSpecial()){if(n.isSpecial()&&o==="")return Us;if(e&&o===""&&(n.includesCredentials()||n.port!==null))return;if(d=n.parseHost(o),d)return d;if(o="",r=Vo,e)return;continue}else h==="["?l=!0:h==="]"&&(l=!1),o+=h;break;case c0:if(Fn(pv,h))o+=h;else if(h===qi||h==="/"||h==="?"||h==="#"||h==="\\"&&n.isSpecial()||e){if(o!==""){var v=ud(o,10);if(v>65535)return DT;n.port=n.isSpecial()&&v===sh[n.scheme]?null:v,o=""}if(e)return;r=Vo;continue}else return DT;break;case h0:if(n.scheme="file",h==="/"||h==="\\")r=UT;else if(t&&t.scheme==="file")switch(h){case qi:n.host=t.host,n.path=kn(t.path),n.query=t.query;break;case"?":n.host=t.host,n.path=kn(t.path),n.query="",r=Vs;break;case"#":n.host=t.host,n.path=kn(t.path),n.query=t.query,n.fragment="",r=Tr;break;default:$T(Hl(kn(c,s),""))||(n.host=t.host,n.path=kn(t.path),n.shortenPath()),r=Wn;continue}else{r=Wn;continue}break;case UT:if(h==="/"||h==="\\"){r=f0;break}t&&t.scheme==="file"&&!$T(Hl(kn(c,s),""))&&(Xl(t.path[0],!0)?ta(n.path,t.path[0]):n.host=t.host),r=Wn;continue;case f0:if(h===qi||h==="/"||h==="\\"||h==="?"||h==="#"){if(!e&&Xl(o))r=Wn;else if(o===""){if(n.host="",e)return;r=Vo}else{if(d=n.parseHost(o),d)return d;if(n.host==="localhost"&&(n.host=""),e)return;o="",r=Vo}continue}else o+=h;break;case Vo:if(n.isSpecial()){if(r=Wn,h!=="/"&&h!=="\\")continue}else if(!e&&h==="?")n.query="",r=Vs;else if(!e&&h==="#")n.fragment="",r=Tr;else if(h!==qi&&(r=Wn,h!=="/"))continue;break;case Wn:if(h===qi||h==="/"||h==="\\"&&n.isSpecial()||!e&&(h==="?"||h==="#")){if(QX(o)?(n.shortenPath(),h!=="/"&&!(h==="\\"&&n.isSpecial())&&ta(n.path,"")):NX(o)?h!=="/"&&!(h==="\\"&&n.isSpecial())&&ta(n.path,""):(n.scheme==="file"&&!n.path.length&&Xl(o)&&(n.host&&(n.host=""),o=rn(o,0)+":"),ta(n.path,o)),o="",n.scheme==="file"&&(h===qi||h==="?"||h==="#"))for(;n.path.length>1&&n.path[0]==="";)SX(n.path);h==="?"?(n.query="",r=Vs):h==="#"&&(n.fragment="",r=Tr)}else o+=zr(h,xR);break;case VT:h==="?"?(n.query="",r=Vs):h==="#"?(n.fragment="",r=Tr):h!==qi&&(n.path[0]+=zr(h,cf));break;case Vs:!e&&h==="#"?(n.fragment="",r=Tr):h!==qi&&(h==="'"&&n.isSpecial()?n.query+="%27":h==="#"?n.query+="%23":n.query+=zr(h,cf));break;case Tr:h!==qi&&(n.fragment+=zr(h,bR));break}s++}},parseHost:function(i){var e,t,n;if(rn(i,0)==="["){if(rn(i,i.length-1)!=="]"||(e=MX(uu(i,1,-1)),!e))return Us;this.host=e}else if(this.isSpecial()){if(i=dX(i),Fn(PX,i)||(e=$X(i),e===null))return Us;this.host=e}else{if(Fn(RX,i))return Us;for(e="",t=Uo(i),n=0;n<t.length;n++)e+=zr(t[n],cf);this.host=e}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return fv(sh,this.scheme)},shortenPath:function(){var i=this.path,e=i.length;e&&(this.scheme!=="file"||e!==1||!Xl(i[0],!0))&&i.length--},serialize:function(){var i=this,e=i.scheme,t=i.username,n=i.password,r=i.host,s=i.port,o=i.path,a=i.query,l=i.fragment,u=e+":";return r!==null?(u+="//",i.includesCredentials()&&(u+=t+(n?":"+n:"")+"@"),u+=Pl(r),s!==null&&(u+=":"+s)):e==="file"&&(u+="//"),u+=i.cannotBeABaseURL?o[0]:o.length?"/"+Hl(o,"/"):"",a!==null&&(u+="?"+a),l!==null&&(u+="#"+l),u},setHref:function(i){var e=this.parse(i);if(e)throw new dv(e);this.searchParams.update()},getOrigin:function(){var i=this.scheme,e=this.port;if(i==="blob")try{return new Da(i.path[0]).origin}catch{return"null"}return i==="file"||!this.isSpecial()?"null":i+"://"+Pl(this.host)+(e!==null?":"+e:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(i){this.parse(Cr(i)+":",s0)},getUsername:function(){return this.username},setUsername:function(i){var e=Uo(Cr(i));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var t=0;t<e.length;t++)this.username+=zr(e[t],r0)}},getPassword:function(){return this.password},setPassword:function(i){var e=Uo(Cr(i));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var t=0;t<e.length;t++)this.password+=zr(e[t],r0)}},getHost:function(){var i=this.host,e=this.port;return i===null?"":e===null?Pl(i):Pl(i)+":"+e},setHost:function(i){this.cannotBeABaseURL||this.parse(i,l0)},getHostname:function(){var i=this.host;return i===null?"":Pl(i)},setHostname:function(i){this.cannotBeABaseURL||this.parse(i,u0)},getPort:function(){var i=this.port;return i===null?"":Cr(i)},setPort:function(i){this.cannotHaveUsernamePasswordPort()||(i=Cr(i),i===""?this.port=null:this.parse(i,c0))},getPathname:function(){var i=this.path;return this.cannotBeABaseURL?i[0]:i.length?"/"+Hl(i,"/"):""},setPathname:function(i){this.cannotBeABaseURL||(this.path=[],this.parse(i,Vo))},getSearch:function(){var i=this.query;return i?"?"+i:""},setSearch:function(i){i=Cr(i),i===""?this.query=null:(rn(i,0)==="?"&&(i=uu(i,1)),this.query="",this.parse(i,Vs)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var i=this.fragment;return i?"#"+i:""},setHash:function(i){if(i=Cr(i),i===""){this.fragment=null;return}rn(i,0)==="#"&&(i=uu(i,1)),this.fragment="",this.parse(i,Tr)},update:function(){this.query=this.searchParams.serialize()||null}};var Da=function(e){var t=hX(this,li),n=gX(arguments.length,1)>1?arguments[1]:void 0,r=mX(t,new l1(e,!1,n));s1||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},li=Da.prototype,Yi=function(i,e){return{get:function(){return ld(this)[i]()},set:e&&function(t){return ld(this)[e](t)},configurable:!0,enumerable:!0}};s1&&(Wi(li,"href",Yi("serialize","setHref")),Wi(li,"origin",Yi("getOrigin")),Wi(li,"protocol",Yi("getProtocol","setProtocol")),Wi(li,"username",Yi("getUsername","setUsername")),Wi(li,"password",Yi("getPassword","setPassword")),Wi(li,"host",Yi("getHost","setHost")),Wi(li,"hostname",Yi("getHostname","setHostname")),Wi(li,"port",Yi("getPort","setPort")),Wi(li,"pathname",Yi("getPathname","setPathname")),Wi(li,"search",Yi("getSearch","setSearch")),Wi(li,"searchParams",Yi("getSearchParams")),Wi(li,"hash",Yi("getHash","setHash")));ad(li,"toJSON",function(){return ld(this).serialize()},{enumerable:!0});ad(li,"toString",function(){return ld(this).serialize()},{enumerable:!0});if(Al){var ZT=Al.createObjectURL,jT=Al.revokeObjectURL;ZT&&ad(Da,"createObjectURL",LT(ZT,Al)),jT&&ad(Da,"revokeObjectURL",LT(jT,Al))}pX(Da,"URL");uX({global:!0,constructor:!0,forced:!cX,sham:!s1},{URL:Da});var BX=function(){function i(e,t){jn(this,i),this.url=e;var n=new window.XMLHttpRequest;n.target=this,n.responseType="arraybuffer",n.open("get",e),n.onload=function(){(n.status===200||n.status===206)&&t&&t instanceof Function&&t(n.response)},n.onerror=function(r){},this.xhr=n,this.run()}return Gn(i,[{key:"cancel",value:function(){this.xhr.abort()}},{key:"run",value:function(){this.xhr.readyState===1&&this.xhr.send()}}]),i}(),Pi={ORDER:"order",SLOOP:"sloop",LOOP:"loop",RANDOM:"random"},GT="xgplayer-music";function hf(i,e,t){var n=Math.floor(Math.random()*(e-i)+i);return n===t?(n>e/2?e=e/2:i=e/2,e-i>2?hf(i,e,t):n):n}var UX=function(i){To(t,i);var e=Eo(t);function t(){var n;jn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),xs(Zi(n),"_onEnded",function(){if(n.mode==="order"&&n.index+1>=n.list.length){n.player.pause(),n.player.currentTime=0;return}switch(n.mode){case Pi.SLOOP:n.change();break;case Pi.ORDER:case Pi.LOOP:default:n.next();break}}),xs(Zi(n),"_onDurationChange",function(){var a=n.config.abCycle;n._initABCycle(a,n.player)}),xs(Zi(n),"_onTimeUpdate",function(){var a=Zi(n),l=a.config,u=a.player;if(!n.halfPass&&u.currentTime>u.duration/2&&n.confirmOrder(),l.abCycle){var c=l.abCycle,h=c.end>u.duration?u.duration:c.end;u.currentTime>=h?(c.loop||(u.pause(),n.emit("abCycle_ended")),u.currentTime=c.start||0):u.currentTime<c.start&&(u.currentTime=c.start||0)}}),n}return Gn(t,[{key:"afterCreate",value:function(){var r=this.player,s=this.playerConfig;k.addClass(r.root,GT),this.halfPass=!1,this.list=this.config.list||[],this.nextIndex=-1,this.prevIndex=-1,this.history=[],this.disable=!(this.list.length>0),this.list.length!==0&&(!s.url&&this.list.length>0&&(s.url=this.list[0].src),s.poster||(s.poster=this.list[0].poster),s.title||(s.title=this.list[0].title||""),s.vid||(s.vid=this.list[0].vid||""),this._curInfo={src:s.url,poster:s.poster,title:s.title,vid:s.vid},this.index=0,this.on(cn,this._onTimeUpdate),this.on(Ls,this._onEnded),this.on(Is,this._onDurationChange),this.config.offline&&this.checkOffline(this._curInfo.src,this._curInfo.vid).then(function(o){o.code===0&&(s.url=o.url,r.state>=4&&(r.src=o.url))}).catch(function(o){}))}},{key:"destroy",value:function(){k.removeClass(this.player.root,GT)}},{key:"_nextCompute",value:function(){if(!this.disable)switch(this.mode){case Pi.SLOOP:case Pi.ORDER:case Pi.LOOP:this.index+1<this.list.length?this.nextIndex=this.index+1:this.nextIndex=0;break;default:this.nextIndex=hf(0,this.list.length,this.index);break}}},{key:"_prevCompute",value:function(){if(!this.disable)switch(this.mode){case Pi.SLOOP:case Pi.ORDER:case Pi.LOOP:this.index-1>=0?this.prevIndex=this.index-1:this.prevIndex=this.list.length-1;break;default:this.prevIndex=hf(0,this.list.length,this.index);break}}},{key:"_emitChange",value:function(){this.emit("change",this._curInfo)}},{key:"_initABCycle",value:function(r,s){var o=s.plugins.progresspreview;if(r&&s){var a=r.end>this.player.duration?this.player.duration:r.end,l=r.start>this.player.duration?0:r.start,u={id:s.playerId,time:r.start,duration:a-l,text:r.text,color:r.color};o.findDot(u.id)?o.updateDot(u):o.createDot(u)}else o.findDot(s.playerId)&&o.deleteDot(s.playerId)}},{key:"random",value:function(){if(this.list.length<0)return null;var r=hf(0,this.list.length,this.index);return this.list[r]}},{key:"next",value:function(){this.disable||(this.halfPass||(this.halfPass=!0,this._nextCompute()),this.index=this.nextIndex,this.change())}},{key:"prev",value:function(){this.disable||(this.halfPass||(this.halfPass=!0,this._prevCompute()),this.index=this.prevIndex,this.change())}},{key:"forward",value:function(){var r=this.player,s=this.config.timeScale;r.currentTime=r.currentTime+s<r.duration?r.currentTime+s:r.duration-.1}},{key:"backward",value:function(){var r=this.player,s=this.config.timeScale;r.currentTime=r.currentTime-s>0?r.currentTime-s:0}},{key:"add",value:function(r){this.list.push({src:r.src,title:r.title,vid:r.vid,poster:r.poster})}},{key:"remove",value:function(r){var s=-1;this.list.every(function(o,a){return o.vid===r?(s=a,!1):!0}),s>-1&&this.list.splice(s,1)}},{key:"setAbCycle",value:function(r,s,o){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};r&&k.typeof(r)==="Object"?this.config.abCycle=rd({},r):this.config.abCycle=rd({start:r||0,end:s||this.player.duration,loop:o},a),this._initABCycle(this.config.abCycle,this.player)}},{key:"removeAbCycle",value:function(){this.config.abCycle=null,this._initABCycle(null,this.player)}},{key:"updateList",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.removeAbCycle(),this.player.pause(),this.player.currentTime=0,this.list=r,this.nextIndex=0,this.index=0,this.change()}},{key:"setIndex",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;r<0||r>=this.list.length||(this.nextIndex=r,this.index=r,this.change())}},{key:"change",value:function(){var r=this;if(!this.disable){var s=this.player,o=this.list,a=this.index,l=o[a].vid;this.halfPass=!1,this.checkOffline(o[a].src,l).then(function(u){r._curInfo={title:r.list[r.index].title||"",vid:r.list[r.index].vid,poster:r.list[r.index].poster||"",src:u.url},s.playNext({url:u.url,vid:r.list[r.index].vid||0,poster:r.list[r.index].poster||"",autoplay:!0}),s.off("timeupdate",r._emitChange),s.once("timeupdate",r._emitChange),s.play()})}}},{key:"checkOffline",value:function(r,s){var o=this;return new Promise(function(a,l){(!o.config.offline||o.disable)&&a({url:r,code:-1,vid:s});var u=o.player.database;u.openDB(function(){u.getDataByKey(u.myDB.ojstore.name,s,function(c){setTimeout(function(){u.closeDB()},5e3),a(c?{url:URL.createObjectURL(c.blob),code:0,vid:c.vid}:{url:r,code:-2,vid:s})})})})}},{key:"confirmOrder",value:function(){this.halfPass=!0,this._nextCompute(),this._prevCompute(),this.config.preloadNext&&this.preload(this.nextIndex)}},{key:"preload",value:function(r){if(!(r<0||r>=this.list.length)){var s=this.list[r],o=this.player;this.checkOffline(s.src,s.vid).then(function(a){if(a.code===-2){var l=s.vid;new BX(s.src,function(u){o.database.openDB(function(){o.database.addData(o.database.myDB.ojstore.name,[{vid:l,blob:new Blob([u],{type:'audio/mp4; codecs="mp4a.40.5"'})}]),setTimeout(function(){o.database.closeDB()},5e3)})})}})}}},{key:"timeScale",get:function(){return this.config.timeScale||15},set:function(r){this.config.timeScale=r}},{key:"mode",get:function(){return this.config.mode||Pi.RANDOM},set:function(r){this.config.mode=r}}],[{key:"pluginName",get:function(){return"music"}},{key:"defaultConfig",get:function(){return{offline:!1,preloadNext:!0,abCycle:null,timeScale:15,mode:Pi.ORDER,list:[]}}},{key:"ModeType",get:function(){return Object.keys(Pi).map(function(r){return Pi[r]})}}]),t}(Ts),VX=Ft,ZX=gp.find,jX=TP,gv="find",SR=!0;gv in[]&&Array(1)[gv](function(){SR=!1});VX({target:"Array",proto:!0,forced:SR},{find:function(e){return ZX(this,e,arguments.length>1?arguments[1]:void 0)}});jX(gv);var GX=function(i){To(t,i);var e=Eo(t);function t(){return jn(this,t),e.apply(this,arguments)}return Gn(t,[{key:"afterCreate",value:function(){var r=this;if(this.on("change",function(o){if(o&&o.poster){if(r.find("img"))r.find("img").src=o.poster;else{var a=new Image;a.src=o.poster,r.appendChild(a)}r.find("img").src=o.poster,r.show()}else r.hide()}),this.playerConfig.poster){var s=new Image;s.src=this.playerConfig.poster,this.appendChild(s)}}},{key:"render",value:function(){return'<xg-icon class="xgplayer-cover"></xg-icon>'}}],[{key:"pluginName",get:function(){return"musiccover"}},{key:"defaultConfig",get:function(){return{index:6,position:Re.POSITIONS.CONTROLS_LEFT}}}]),t}(Re),HX=function(i){To(t,i);var e=Eo(t);function t(){var n;jn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),xs(Zi(n),"onClick",function(a){var l=Zi(n),u=l.player;a.preventDefault(),a.stopPropagation(),u.plugins.music.backward()}),n}return Gn(t,[{key:"afterCreate",value:function(){var r=this;this.initIcons();var s=["click","touchstart"];s.forEach(function(o){r.bind(o,r.onClick)})}},{key:"registerIcons",value:function(){return{musicBackward:{icon:`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-2 0 21 15">
      <path d="m 14,2.99996 0,10 -7,-5 7,-5 z m -7,5 0,5 -7,-5 7,-5 0,5 z m -7,0 0,0 z"></path>
  </svg>`,class:"xg-icon-mbackward"}}}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".xgplayer-icon",r.musicBackward)}},{key:"destroy",value:function(){var r=this,s=["click","touchstart"];s.forEach(function(o){r.unbind(o,r.onClick)})}},{key:"render",value:function(){return`<xg-icon class="xgplayer-backward">
            <div class="xgplayer-icon">
            </div>
          </xg-icon>`}}],[{key:"pluginName",get:function(){return"musicbackword"}},{key:"defaultConfig",get:function(){return{index:1,position:Re.POSITIONS.CONTROLS_LEFT}}}]),t}(Re),XX=function(i){To(t,i);var e=Eo(t);function t(){var n;jn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),xs(Zi(n),"onClick",function(a){var l=Zi(n),u=l.player;a.preventDefault(),a.stopPropagation(),u.plugins.music.prev()}),n}return Gn(t,[{key:"afterCreate",value:function(){var r=this;this.initIcons();var s=["click","touchstart"];s.forEach(function(o){r.bind(o,r.onClick)})}},{key:"registerIcons",value:function(){return{musicPrev:{icon:` <svg xmlns="http://www.w3.org/2000/svg" width="40" height="32" viewBox="300 200 1024 1024">
        <path d="M600 1140v-768h128v352l320-320v704l-320-320v352zz"></path>
    </svg>`,class:"xg-icon-mprev"}}}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".xgplayer-icon",r.musicPrev)}},{key:"destroy",value:function(){var r=this,s=["click","touchstart"];s.forEach(function(o){r.unbind(o,r.onClick)})}},{key:"render",value:function(){return`<xg-icon class="xgplayer-next">
            <div class="xgplayer-icon">
            </div>
          </xg-icon>`}}],[{key:"pluginName",get:function(){return"musicprev"}},{key:"defaultConfig",get:function(){return{index:2,position:Re.POSITIONS.CONTROLS_LEFT}}}]),t}(Re),zX=function(i){To(t,i);var e=Eo(t);function t(){var n;jn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),xs(Zi(n),"onClick",function(a){var l=Zi(n),u=l.player;a.preventDefault(),a.stopPropagation(),u.plugins.music.forward()}),n}return Gn(t,[{key:"afterCreate",value:function(){var r=this;this.initIcons();var s=["click","touchstart"];s.forEach(function(o){r.bind(o,r.onClick)})}},{key:"registerIcons",value:function(){return{musicForward:{icon:`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-2 0 21 15">
        <path d="m 2,2.99996 0,10 7,-5 -7,-5 z m 7,5 0,5 7,-5 -7,-5 0,5 z m 7,0 0,0 z"></path>
      </svg>`,class:"xg-icon-mforward"}}}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".xgplayer-icon",r.musicForward)}},{key:"destroy",value:function(){var r=this,s=["click","touchstart"];s.forEach(function(o){r.unbind(o,r.onClick)})}},{key:"render",value:function(){return`<xg-icon class="xgplayer-forward">
            <div class="xgplayer-icon">
            </div>
          </xg-icon>`}}],[{key:"pluginName",get:function(){return"musicforward"}},{key:"defaultConfig",get:function(){return{index:5,position:Re.POSITIONS.CONTROLS_LEFT}}}]),t}(Re),WX=function(i){To(t,i);var e=Eo(t);function t(){var n;jn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=e.call.apply(e,[this].concat(s)),xs(Zi(n),"onClick",function(a){var l=Zi(n),u=l.player;a.preventDefault(),a.stopPropagation(),u.plugins.music.next()}),n}return Gn(t,[{key:"afterCreate",value:function(){var r=this;this.initIcons();var s=["click","touchstart"];s.forEach(function(o){r.bind(o,r.onClick)})}},{key:"registerIcons",value:function(){return{musicNext:{icon:` <svg xmlns="http://www.w3.org/2000/svg" width="40" height="32" viewBox="100 200 1024 1024">
        <path d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z">
      </svg>`,class:"xg-icon-mnext"}}}},{key:"initIcons",value:function(){var r=this.icons;this.appendChild(".xgplayer-icon",r.musicNext)}},{key:"destroy",value:function(){var r=this,s=["click","touchstart"];s.forEach(function(o){r.unbind(o,r.onClick)})}},{key:"render",value:function(){return`<xg-icon class="xgplayer-next">
            <div class="xgplayer-icon">
            </div>
          </xg-icon>`}}],[{key:"pluginName",get:function(){return"musicnext"}},{key:"defaultConfig",get:function(){return{index:4,position:Re.POSITIONS.CONTROLS_LEFT}}}]),t}(Re),qX=function(i){To(t,i);var e=Eo(t);function t(){return jn(this,t),e.apply(this,arguments)}return Gn(t,[{key:"beforeCreate",value:function(r){var s=r.player.plugins.progress;s&&(r.root=s.root)}},{key:"afterCreate",value:function(){var r=this;this.on("change",function(s){s&&s.title?r.root.innerHTML="".concat(s.title):r.root.innerHTML=""})}},{key:"render",value:function(){var r=this.playerConfig;return`<xg-title class="xgplayer-name">
          `.concat(r.title||"",`
       </xg-title>`)}}],[{key:"pluginName",get:function(){return"musicmeta"}},{key:"defaultConfig",get:function(){return{index:0}}}]),t}(Re);function YX(i){if(k.typeOf(i.controls)!=="Object")i.controls={mode:"flex",initShow:!0};else{var e=i.controls;i.controls=rd({mode:"flex",initShow:!0},e)}var t=i.play||{};i.play=rd({index:3},t),i.marginControls=!0,i.mediaType="audio"}var KX=Gn(function i(e,t){jn(this,i),console.log("config",e,t),console.log("playerConfig",k.typeOf(t.controls)!=="Object"),YX(t),this.plugins=[UX,HX,XX,zX,WX,GX,qX],this.ignores=["start","cssFullScreen","fullscreen","pip","enter","replay","pc","loading","poster"]}),JX=Ft,ez=gp.filter,tz=mp,iz=tz("filter");JX({target:"Array",proto:!0,forced:!iz},{filter:function(e){return ez(this,e,arguments.length>1?arguments[1]:void 0)}});var nz=Gn(function i(e){jn(this,i),this.regRule=/(\d{2}(?=:)):(\d{2}(?=\.))\.(\d{2,3})/g,this.regRule.test(e)?this.time=RegExp.$1*60+RegExp.$2*1+("0."+RegExp.$3)*1:this.time=-1}),rz=function(){function i(e,t){var n=this;jn(this,i),this.rawTxts=e,this.txts=e.map(function(r){return r.replace(/^[\r\n]|[\r\n]$/g,"").match(/(\[.*\])[^[]+/g)}),this.isDynamics=e.map(function(r,s){return[].concat(r.match(/\[\d{2}:\d{2}\.\d{2,3}\]/g)).length===n.txts[s].length&&n.txts[s].length===n.txts[0].length&&n.txts[s].length>1}),this.isDynamic=this.isDynamics.some(function(r){return r}),this.__ainimateInterval__=0,this.__offset__=0,this.__offsetScale__=.5,this.dom=t,this.lists=[],this.isDynamics.map(function(r,s){r&&n.lists.push(n.txts[s].map(function(o,a){var l=/(\[[\d:\S]+\])([^[]+)/g.test(o),u=RegExp.$1,c=RegExp.$2;return{time:l?new nz(u).time:-1,lyric:c,idx:a}}))}),this.list=this.lists.reduce(function(r,s){return r.map(function(o,a){return{time:o.time,lyric:o.lyric===`
`?"".concat(o.lyric).concat(s[a].lyric):"".concat(o.lyric,"<br/>").concat(s[a].lyric),idx:a}})}),this.line=0}return Gn(i,[{key:"interval",get:function(){return this.__ainimateInterval__},set:function(t){this.__ainimateInterval__=t}},{key:"offset",get:function(){return this.__offset__},set:function(t){this.__offset__=t}},{key:"offsetScale",get:function(){return this.__offsetScale__},set:function(t){this.__offsetScale__=t}},{key:"adjust",value:function(){for(var t=this.list,n=0,r,s,o=t.length;n<o;n++){for(r=n+1;r<o&&!(t[r].time>t[n].time);r++);if(r<o){var a=(t[r].time-t[n].time)/(r-n);for(s=n+1;s<r;s++)t[s].time=t[s-1].time+a}}}},{key:"find",value:function(t){var n=this.list,r=this.__ainimateInterval__,s=this.__offset__;return t=t+s>0?t+s:0,n.filter(function(o,a){var l=o.time,u=a+1;return t>=l&&(n[u]&&t*1+r*1<=n[u].time||u>=n.length)})}},{key:"bind",value:function(t){var n=this,r=this;return this.__player__=t,r.isDynamic?(r.__handle__=(function(){var s=n.find(t.currentTime)[0];s&&s.idx!==n.line&&(n.line=s.idx,t.emit("lyricUpdate",s))}).bind(r,t),t.on("timeupdate",r.__handle__),r.__startHandle__=(function(){t.emit("lyricUpdate",r.list[0])}).bind(r,t),t.once("playing",r.__startHandle__),!0):!1}},{key:"unbind",value:function(t){delete this.__player__,this.__handle__&&(t.off("lyricUpdate",this.__handle__),delete this.__handle__)}},{key:"show",value:function(){var t=this,n=this.dom,r=[],s=this,o=["click","touchstart"];if(n&&n.nodeType===1){var a=k.createDom("div","<div></div>",{},"xgplayer-lrcWrap");n.appendChild(a),this.list.forEach(function(c){r.push('<xg-lyric-item class="xgplayer-lyric-item" data-idx="'.concat(c.idx,'">').concat(c.lyric.replace(/[\r\n]/g,""),"</xg-lyric-item>"))}),a.innerHTML=r.join("");var l=k.createDom("xg-lrcForward","<div></div>",{},"xgplayer-lrcForward");n.appendChild(l),o.forEach(function(c){l.addEventListener(c,function(h){h.preventDefault(),h.stopPropagation(),s.offset-=s.offsetScale,console.log("lyric go forward ".concat(s.offsetScale,"s"))},!1)});var u=k.createDom("xg-lrcBack","<div></div>",{},"xgplayer-lrcBack");n.appendChild(u),o.forEach(function(c){u.addEventListener(c,function(h){h.preventDefault(),h.stopPropagation(),s.offset+=s.offsetScale,console.log("lyric go back ".concat(s.offsetScale,"s"))},!1)}),this.__updateHandle__=function(c){var h=t.dom.querySelector(".xgplayer-lrcWrap"),f=h.querySelector(".xgplayer-lyric-item-active"),d=h.offsetHeight,p;f&&(f.className="xgplayer-lyric-item"),f=h.querySelector('.xgplayer-lyric-item[data-idx="'.concat(c.idx,'"]')),f&&(f.className="xgplayer-lyric-item xgplayer-lyric-item-active",p=f.getBoundingClientRect().top-h.getBoundingClientRect().top+h.scrollTop-d/2,p&&(h.scrollTop=p))},this.__player__.on("lyricUpdate",this.__updateHandle__)}else this.__player__.emit("error","lyric container can not be empty")}},{key:"hide",value:function(){this.__updateHandle__.off("lyricUpdate",this.__updateHandle__)}}]),i}();const sz="/assets/music-bg-DnHHlmmQ.png",oz={ref:"analyze",class:"w-full absolute top-[280px] left-0 z-0"},az={id:"mse",ref:"player"},HT=10,lz=Ze({__name:"audio-viewer",setup(i){const{file:e,data:t}=mi(Or()),n=nf("player"),r=nf("lyric"),s=nf("analyze");let o;return pe([e,n,t],async()=>{if(!t.value||!e.value||!n.value||!r.value||!s.value)return;const a=URL.createObjectURL(t.value);if(o=new yr({el:n.value,url:a,controls:{mode:"flex",initShow:!0},marginControls:!0,mediaType:"audio",preset:[KX],width:"100%",height:"60px"}),e.value.lyricPath.length){const l=await x5(e.value.lyricPath),u=new rz([l],r.value);u.bind(o),u.show();const c=l.split(`
`);o.on("seeked",f=>{var g,m;let d=null;for(let v=0;v<c.length;v++){const O=c[v],y=+O.slice(1,3),x=+O.slice(4,6),b=+O.slice(7,9),E=y*60+x*1+b*.1;if(d?Math.abs(E-f.currentTime)<Math.abs(d.seekTime-f.currentTime)&&(d={seekTime:E,i:v}):d={seekTime:E,i:v},E>f.currentTime)break}const p=(d.i+1)/h;(m=r.value)==null||m.scrollTo({top:p*((g=r.value)==null?void 0:g.scrollHeight)-180,behavior:"smooth"})});const h=l.split(`
`).length+HT;o.on("lyricUpdate",f=>{var p,g;const d=(f.idx+1)/h;(g=r.value)==null||g.scrollTo({top:d*((p=r.value)==null?void 0:p.scrollHeight)-180,behavior:"smooth"})})}}),Rs(()=>{o==null||o.destroy()}),(a,l)=>{var u;return Ei(),$r("div",{class:"w-full h-[600px] relative",style:d5({backgroundImage:`url(${ze(sz)})`,backgroundSize:"cover"})},[Ko("div",null,[Ko("canvas",oz,null,512)]),(Ei(),$r("div",{ref:"lyric",key:(u=ze(e))==null?void 0:u.lyricPath,id:"gc",class:"flex flex-col items-center w-full h-[540px] overflow-auto"},[(Ei(),$r(bo,null,N2(HT,c=>Ko("div",{class:"order-1 text-[white]",key:c},l[0]||(l[0]=[Ko("br",null,null,-1)]))),64))])),Ko("div",az,null,512)],4)}}}),uz=ap(lz,[["__scopeId","data-v-640f1cdf"]]);function cz(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var kR={exports:{}};(function(i,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,u,c){if(c=c||{},l=l.trim(),u=u.trim(),!u){if(!c.alwaysNormalize)return l;var h=a.parseURL(l);if(!h)throw new Error("Error trying to parse base URL.");return h.path=a.normalizePath(h.path),a.buildURLFromParts(h)}var f=a.parseURL(u);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return c.alwaysNormalize?(f.path=a.normalizePath(f.path),a.buildURLFromParts(f)):u;var d=a.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");if(!d.netLoc&&d.path&&d.path[0]!=="/"){var p=r.exec(d.path);d.netLoc=p[1],d.path=p[2]}d.netLoc&&!d.path&&(d.path="/");var g={scheme:d.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(g.netLoc=d.netLoc,f.path[0]!=="/"))if(!f.path)g.path=d.path,f.params||(g.params=d.params,f.query||(g.query=d.query));else{var m=d.path,v=m.substring(0,m.lastIndexOf("/")+1)+f.path;g.path=a.normalizePath(v)}return g.path===null&&(g.path=c.alwaysNormalize?a.normalizePath(f.path):f.path),a.buildURLFromParts(g)},parseURL:function(l){var u=n.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};i.exports=a})()})(kR);var u1=kR.exports;function XT(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Gt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?XT(Object(t),!0).forEach(function(n){dz(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):XT(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function hz(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function fz(i){var e=hz(i,"string");return typeof e=="symbol"?e:String(e)}function dz(i,e,t){return e=fz(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function At(){return At=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},At.apply(this,arguments)}const ae=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},pz=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=gz},gz=Number.MAX_SAFE_INTEGER||9007199254740991;let S=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i}({}),be=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),Q=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.UNKNOWN="unknown",i}({});const Xs=function(){},mv={trace:Xs,debug:Xs,log:Xs,warn:Xs,info:Xs,error:Xs};let cu=mv;function mz(i){const e=self.console[i];return e?e.bind(self.console,`[${i}] >`):Xs}function vz(i,...e){e.forEach(function(t){cu[t]=i[t]?i[t].bind(i):mz(t)})}function Oz(i,e){if(typeof console=="object"&&i===!0||typeof i=="object"){vz(i,"debug","log","info","warn","error");try{cu.log(`Debug logs enabled for "${e}" in hls.js version 1.5.20`)}catch{cu=mv}}else cu=mv}const M=cu,yz=/^(\d+)x(\d+)$/,zT=/(.+?)=(".*?"|.*?)(?:,|$)/g;class vt{constructor(e){typeof e=="string"&&(e=vt.parseAttrList(e)),At(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=yz.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},r='"';for(zT.lastIndex=0;(t=zT.exec(e))!==null;){let s=t[2];s.indexOf(r)===0&&s.lastIndexOf(r)===s.length-1&&(s=s.slice(1,-1));const o=t[1].trim();n[o]=s}return n}}function bz(i){return i!=="ID"&&i!=="CLASS"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function xz(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"}class TR{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const r in n)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==n[r]){M.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=r;break}e=At(new vt({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);ae(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(ae(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&ae(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class kp{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var We={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class ER{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[We.AUDIO]:null,[We.VIDEO]:null,[We.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let r;n.length===1?r=(t==null?void 0:t.byteRangeEndOffset)||0:r=parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=u1.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class d0 extends ER{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new kp,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!ae(this.programDateTime))return null;const e=ae(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,s,o=!1){const{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:s,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,r),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[We.AUDIO]=null,e[We.VIDEO]=null,e[We.AUDIOVIDEO]=null}}class Sz extends ER{constructor(e,t,n,r,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new kp,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const kz=10;class Tz{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?ae(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||kz}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function c1(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function Ez(i){const e=vv(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function wz(i){const e=function(n,r,s){const o=n[r];n[r]=n[s],n[s]=o};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function _z(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),r=n[n.length-1].split(",");if(r.length===2){const s=r[0]==="base64",o=r[1];s?(n.splice(-1,1),t=c1(o)):t=Ez(o)}}return t}function vv(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}const $a=typeof self<"u"?self:void 0;var Xe={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},xi={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function p0(i){switch(i){case xi.FAIRPLAY:return Xe.FAIRPLAY;case xi.PLAYREADY:return Xe.PLAYREADY;case xi.WIDEVINE:return Xe.WIDEVINE;case xi.CLEARKEY:return Xe.CLEARKEY}}var lh={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function g0(i){if(i===lh.WIDEVINE)return Xe.WIDEVINE;if(i===lh.PLAYREADY)return Xe.PLAYREADY;if(i===lh.CENC||i===lh.CLEARKEY)return Xe.CLEARKEY}function m0(i){switch(i){case Xe.FAIRPLAY:return xi.FAIRPLAY;case Xe.PLAYREADY:return xi.PLAYREADY;case Xe.WIDEVINE:return xi.WIDEVINE;case Xe.CLEARKEY:return xi.CLEARKEY}}function uh(i){const{drmSystems:e,widevineLicenseUrl:t}=i,n=e?[Xe.FAIRPLAY,Xe.WIDEVINE,Xe.PLAYREADY,Xe.CLEARKEY].filter(r=>!!e[r]):[];return!n[Xe.WIDEVINE]&&t&&n.push(Xe.WIDEVINE),n}const wR=function(i){return $a!=null&&(i=$a.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Cz(i,e,t,n){let r;switch(i){case Xe.FAIRPLAY:r=["cenc","sinf"];break;case Xe.WIDEVINE:case Xe.PLAYREADY:r=["cenc"];break;case Xe.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return Az(r,e,t,n)}function Az(i,e,t,n){return[{initDataTypes:i,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function _R(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(o){const a=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(a){const l=c1(a).subarray(0,16);return wz(l),l}}return null}function ao(i,e,t){return Uint8Array.prototype.slice?i.slice(e,t):new Uint8Array(Array.prototype.slice.call(i,e,t))}const h1=(i,e)=>e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,CR=(i,e)=>e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,wu=(i,e)=>{const t=e;let n=0;for(;h1(i,e);){n+=10;const r=Tp(i,e+6);n+=r,CR(i,e+10)&&(n+=10),e+=n}if(n>0)return i.subarray(t,t+n)},Tp=(i,e)=>{let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t},Pz=(i,e)=>h1(i,e)&&Tp(i,e+6)+10<=i.length-e,f1=i=>{const e=PR(i);for(let t=0;t<e.length;t++){const n=e[t];if(AR(n))return Mz(n)}},AR=i=>i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp",Rz=i=>{const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=Tp(i,4),n=10;return{type:e,size:t,data:i.subarray(n,n+t)}},PR=i=>{let e=0;const t=[];for(;h1(i,e);){const n=Tp(i,e+6);e+=10;const r=e+n;for(;e+8<r;){const s=Rz(i.subarray(e)),o=Lz(s);o&&t.push(o),e+=s.size+10}CR(i,e)&&(e+=10)}return t},Lz=i=>i.type==="PRIV"?Iz(i):i.type[0]==="W"?$z(i):Dz(i),Iz=i=>{if(i.size<2)return;const e=pr(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}},Dz=i=>{if(i.size<2)return;if(i.type==="TXXX"){let t=1;const n=pr(i.data.subarray(t),!0);t+=n.length+1;const r=pr(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=pr(i.data.subarray(1));return{key:i.type,data:e}},$z=i=>{if(i.type==="WXXX"){if(i.size<2)return;let t=1;const n=pr(i.data.subarray(t),!0);t+=n.length+1;const r=pr(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=pr(i.data);return{key:i.type,data:e}},Mz=i=>{if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},pr=(i,e=!1)=>{const t=Fz();if(t){const u=t.decode(i);if(e){const c=u.indexOf("\0");return c!==-1?u.substring(0,c):u}return u.replace(/\0/g,"")}const n=i.length;let r,s,o,a="",l=0;for(;l<n;){if(r=i[l++],r===0&&e)return a;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:s=i[l++],a+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=i[l++],o=i[l++],a+=String.fromCharCode((r&15)<<12|(s&63)<<6|(o&63)<<0);break}}return a};let v0;function Fz(){if(!navigator.userAgent.includes("PlayStation 4"))return!v0&&typeof self.TextDecoder<"u"&&(v0=new self.TextDecoder("utf-8")),v0}const ir={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let n=i[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},hd=Math.pow(2,32)-1,Nz=[].push,RR={video:1,audio:2,id3:3,text:4};function $t(i){return String.fromCharCode.apply(null,i)}function LR(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function ve(i,e){const t=IR(i,e);return t<0?4294967296+t:t}function WT(i,e){let t=ve(i,e);return t*=Math.pow(2,32),t+=ve(i,e+4),t}function IR(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function O0(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function Qz(i){const e=i.byteLength;for(let t=0;t<e;){const n=ve(i,t);if(n>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=n>1?t+n:e}return!1}function Pe(i,e){const t=[];if(!e.length)return t;const n=i.byteLength;for(let r=0;r<n;){const s=ve(i,r),o=$t(i.subarray(r+4,r+8)),a=s>1?r+s:n;if(o===e[0])if(e.length===1)t.push(i.subarray(r+8,a));else{const l=Pe(i.subarray(r+8,a),e.slice(1));l.length&&Nz.apply(t,l)}r=a}return t}function Bz(i){const e=[],t=i[0];let n=8;const r=ve(i,n);n+=4;let s=0,o=0;t===0?(s=ve(i,n),o=ve(i,n+4),n+=8):(s=WT(i,n),o=WT(i,n+8),n+=16),n+=2;let a=i.length+o;const l=LR(i,n);n+=2;for(let u=0;u<l;u++){let c=n;const h=ve(i,c);c+=4;const f=h&2147483647;if((h&2147483648)>>>31===1)return M.warn("SIDX has hierarchical references (not supported)"),null;const p=ve(i,c);c+=4,e.push({referenceSize:f,subsegmentDuration:p,info:{duration:p/r,start:a,end:a+f-1}}),a+=f,c+=4,n=c}return{earliestPresentationTime:s,timescale:r,version:t,referencesCount:l,references:e}}function DR(i){const e=[],t=Pe(i,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],o=Pe(s,["tkhd"])[0];if(o){let a=o[0];const l=ve(o,a===0?12:20),u=Pe(s,["mdia","mdhd"])[0];if(u){a=u[0];const c=ve(u,a===0?12:20),h=Pe(s,["mdia","hdlr"])[0];if(h){const f=$t(h.subarray(8,12)),d={soun:We.AUDIO,vide:We.VIDEO}[f];if(d){const p=Pe(s,["mdia","minf","stbl","stsd"])[0],g=Uz(p);e[l]={timescale:c,type:d},e[d]=Gt({timescale:c,id:l},g)}}}}}return Pe(i,["moov","mvex","trex"]).forEach(r=>{const s=ve(r,4),o=e[s];o&&(o.default={duration:ve(r,12),flags:ve(r,20)})}),e}function Uz(i){const e=i.subarray(8),t=e.subarray(86),n=$t(e.subarray(4,8));let r=n;const s=n==="enca"||n==="encv";if(s){const a=Pe(e,[n])[0].subarray(n==="enca"?28:78);Pe(a,["sinf"]).forEach(u=>{const c=Pe(u,["schm"])[0];if(c){const h=$t(c.subarray(4,8));if(h==="cbcs"||h==="cenc"){const f=Pe(u,["frma"])[0];f&&(r=$t(f))}}})}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const o=Pe(t,["avcC"])[0];r+="."+ch(o[1])+ch(o[2])+ch(o[3]);break}case"mp4a":{const o=Pe(e,[n])[0],a=Pe(o.subarray(28),["esds"])[0];if(a&&a.length>12){let l=4;if(a[l++]!==3)break;l=y0(a,l),l+=2;const u=a[l++];if(u&128&&(l+=2),u&64&&(l+=a[l++]),a[l++]!==4)break;l=y0(a,l);const c=a[l++];if(c===64)r+="."+ch(c);else break;if(l+=12,a[l++]!==5)break;l=y0(a,l);const h=a[l++];let f=(h&248)>>3;f===31&&(f+=1+((h&7)<<3)+((a[l]&224)>>5)),r+="."+f}break}case"hvc1":case"hev1":{const o=Pe(t,["hvcC"])[0],a=o[1],l=["","A","B","C"][a>>6],u=a&31,c=ve(o,2),h=(a&32)>>5?"H":"L",f=o[12],d=o.subarray(6,12);r+="."+l+u,r+="."+c.toString(16).toUpperCase(),r+="."+h+f;let p="";for(let g=d.length;g--;){const m=d[g];(m||p)&&(p="."+m.toString(16).toUpperCase()+p)}r+=p;break}case"dvh1":case"dvhe":{const o=Pe(t,["dvcC"])[0],a=o[2]>>1&127,l=o[2]<<5&32|o[3]>>3&31;r+="."+qn(a)+"."+qn(l);break}case"vp09":{const o=Pe(t,["vpcC"])[0],a=o[4],l=o[5],u=o[6]>>4&15;r+="."+qn(a)+"."+qn(l)+"."+qn(u);break}case"av01":{const o=Pe(t,["av1C"])[0],a=o[1]>>>5,l=o[1]&31,u=o[2]>>>7?"H":"M",c=(o[2]&64)>>6,h=(o[2]&32)>>5,f=a===2&&c?h?12:10:c?10:8,d=(o[2]&16)>>4,p=(o[2]&8)>>3,g=(o[2]&4)>>2,m=o[2]&3;r+="."+a+"."+qn(l)+u+"."+qn(f)+"."+d+"."+p+g+m+"."+qn(1)+"."+qn(1)+"."+qn(1)+"."+0;break}}return{codec:r,encrypted:s}}function y0(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function ch(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function qn(i){return(i<10?"0":"")+i}function Vz(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&Pe(i,["moov","trak"]).forEach(r=>{const o=Pe(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=Pe(o,["enca"]);const l=a.length>0;l||(a=Pe(o,["encv"])),a.forEach(u=>{const c=l?u.subarray(28):u.subarray(78);Pe(c,["sinf"]).forEach(f=>{const d=$R(f);if(d){const p=d.subarray(8,24);p.some(g=>g!==0)||(M.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${ir.hexDump(p)} -> ${ir.hexDump(t)}`),d.set(t,8))}})})}),i}function $R(i){const e=Pe(i,["schm"])[0];if(e){const t=$t(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Pe(i,["schi","tenc"])[0]}return null}function Zz(i,e){return Pe(e,["moof","traf"]).reduce((t,n)=>{const r=Pe(n,["tfdt"])[0],s=r[0],o=Pe(n,["tfhd"]).reduce((a,l)=>{const u=ve(l,4),c=i[u];if(c){let h=ve(r,4);if(s===1){if(h===hd)return M.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),a;h*=hd+1,h+=ve(r,8)}const f=c.timescale||9e4,d=h/f;if(ae(d)&&(a===null||d<a))return d}return a},null);return o!==null&&ae(o)&&(t===null||o<t)?o:t},null)}function jz(i,e){let t=0,n=0,r=0;const s=Pe(i,["moof","traf"]);for(let o=0;o<s.length;o++){const a=s[o],l=Pe(a,["tfhd"])[0],u=ve(l,4),c=e[u];if(!c)continue;const h=c.default,f=ve(l,0)|(h==null?void 0:h.flags);let d=h==null?void 0:h.duration;f&8&&(f&2?d=ve(l,12):d=ve(l,8));const p=c.timescale||9e4,g=Pe(a,["trun"]);for(let m=0;m<g.length;m++){if(t=Gz(g[m]),!t&&d){const v=ve(g[m],4);t=d*v}c.type===We.VIDEO?n+=t/p:c.type===We.AUDIO&&(r+=t/p)}}if(n===0&&r===0){let o=1/0,a=0,l=0;const u=Pe(i,["sidx"]);for(let c=0;c<u.length;c++){const h=Bz(u[c]);if(h!=null&&h.references){o=Math.min(o,h.earliestPresentationTime/h.timescale);const f=h.references.reduce((d,p)=>d+p.info.duration||0,0);a=Math.max(a,f+h.earliestPresentationTime/h.timescale),l=a-o}}if(l&&ae(l))return l}return n||r}function Gz(i){const e=ve(i,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const r=ve(i,4);for(let s=0;s<r;s++){if(e&256){const o=ve(i,t);n+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function Hz(i,e,t){Pe(e,["moof","traf"]).forEach(n=>{Pe(n,["tfhd"]).forEach(r=>{const s=ve(r,4),o=i[s];if(!o)return;const a=o.timescale||9e4;Pe(n,["tfdt"]).forEach(l=>{const u=l[0],c=t*a;if(c){let h=ve(l,4);if(u===0)h-=c,h=Math.max(h,0),O0(l,4,h);else{h*=Math.pow(2,32),h+=ve(l,8),h-=c,h=Math.max(h,0);const f=Math.floor(h/(hd+1)),d=Math.floor(h%(hd+1));O0(l,4,f),O0(l,8,d)}}})})})}function Xz(i){const e={valid:null,remainder:null},t=Pe(i,["moof"]);if(t.length<2)return e.remainder=i,e;const n=t[t.length-1];return e.valid=ao(i,0,n.byteOffset-8),e.remainder=ao(i,n.byteOffset-8),e}function pn(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function qT(i,e){const t=[],n=e.samples,r=e.timescale,s=e.id;let o=!1;return Pe(n,["moof"]).map(l=>{const u=l.byteOffset-8;Pe(l,["traf"]).map(h=>{const f=Pe(h,["tfdt"]).map(d=>{const p=d[0];let g=ve(d,4);return p===1&&(g*=Math.pow(2,32),g+=ve(d,8)),g/r})[0];return f!==void 0&&(i=f),Pe(h,["tfhd"]).map(d=>{const p=ve(d,4),g=ve(d,0)&16777215,m=(g&1)!==0,v=(g&2)!==0,O=(g&8)!==0;let y=0;const x=(g&16)!==0;let b=0;const E=(g&32)!==0;let T=8;p===s&&(m&&(T+=8),v&&(T+=4),O&&(y=ve(d,T),T+=4),x&&(b=ve(d,T),T+=4),E&&(T+=4),e.type==="video"&&(o=zz(e.codec)),Pe(h,["trun"]).map(_=>{const D=_[0],A=ve(_,0)&16777215,I=(A&1)!==0;let L=0;const $=(A&4)!==0,B=(A&256)!==0;let Z=0;const j=(A&512)!==0;let ie=0;const ne=(A&1024)!==0,z=(A&2048)!==0;let W=0;const he=ve(_,4);let se=8;I&&(L=ve(_,se),se+=4),$&&(se+=4);let oe=L+u;for(let Se=0;Se<he;Se++){if(B?(Z=ve(_,se),se+=4):Z=y,j?(ie=ve(_,se),se+=4):ie=b,ne&&(se+=4),z&&(D===0?W=ve(_,se):W=IR(_,se),se+=4),e.type===We.VIDEO){let $e=0;for(;$e<ie;){const Ke=ve(n,oe);if(oe+=4,Wz(o,n[oe])){const kt=n.subarray(oe,oe+Ke);MR(kt,o?2:1,i+W/r,t)}oe+=Ke,$e+=Ke+4}}i+=Z/r}}))})})}),t}function zz(i){if(!i)return!1;const e=i.indexOf("."),t=e<0?i:i.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function Wz(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function MR(i,e,t,n){const r=FR(i);let s=0;s+=e;let o=0,a=0,l=0;for(;s<r.length;){o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(l===255);a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(l===255);const u=r.length-s;let c=s;if(a<u)s+=a;else if(a>u){M.error(`Malformed SEI payload. ${a} is too small, only ${u} bytes left to parse.`);break}if(o===4){if(r[c++]===181){const f=LR(r,c);if(c+=2,f===49){const d=ve(r,c);if(c+=4,d===1195456820){const p=r[c++];if(p===3){const g=r[c++],m=31&g,v=64&g,O=v?2+m*3:0,y=new Uint8Array(O);if(v){y[0]=g;for(let x=1;x<O;x++)y[x]=r[c++]}n.push({type:p,payloadType:o,pts:t,bytes:y})}}}}}else if(o===5&&a>16){const h=[];for(let p=0;p<16;p++){const g=r[c++].toString(16);h.push(g.length==1?"0"+g:g),(p===3||p===5||p===7||p===9)&&h.push("-")}const f=a-16,d=new Uint8Array(f);for(let p=0;p<f;p++)d[p]=r[c++];n.push({payloadType:o,pts:t,uuid:h.join(""),userData:pr(d),userDataBytes:d})}}}function FR(i){const e=i.byteLength,t=[];let n=1;for(;n<e-2;)i[n]===0&&i[n+1]===0&&i[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return i;const r=e-t.length,s=new Uint8Array(r);let o=0;for(n=0;n<r;o++,n++)o===t[0]&&(o++,t.shift()),s[n]=i[o];return s}function qz(i){const e=i[0];let t="",n="",r=0,s=0,o=0,a=0,l=0,u=0;if(e===0){for(;$t(i.subarray(u,u+1))!=="\0";)t+=$t(i.subarray(u,u+1)),u+=1;for(t+=$t(i.subarray(u,u+1)),u+=1;$t(i.subarray(u,u+1))!=="\0";)n+=$t(i.subarray(u,u+1)),u+=1;n+=$t(i.subarray(u,u+1)),u+=1,r=ve(i,12),s=ve(i,16),a=ve(i,20),l=ve(i,24),u=28}else if(e===1){u+=4,r=ve(i,u),u+=4;const h=ve(i,u);u+=4;const f=ve(i,u);for(u+=4,o=2**32*h+f,pz(o)||(o=Number.MAX_SAFE_INTEGER,M.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=ve(i,u),u+=4,l=ve(i,u),u+=4;$t(i.subarray(u,u+1))!=="\0";)t+=$t(i.subarray(u,u+1)),u+=1;for(t+=$t(i.subarray(u,u+1)),u+=1;$t(i.subarray(u,u+1))!=="\0";)n+=$t(i.subarray(u,u+1)),u+=1;n+=$t(i.subarray(u,u+1)),u+=1}const c=i.subarray(u,i.byteLength);return{schemeIdUri:t,value:n,timeScale:r,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:l,payload:c}}function Yz(i,...e){const t=e.length;let n=8,r=t;for(;r--;)n+=e[r].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(i,4),r=0,n=8;r<t;r++)s.set(e[r],n),n+=e[r].byteLength;return s}function Kz(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let n,r;n=0,r=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),Yz([112,115,115,104],new Uint8Array([n,0,0,0]),i,s,r,o,t||new Uint8Array)}function Jz(i){const e=[];if(i instanceof ArrayBuffer){const t=i.byteLength;let n=0;for(;n+32<t;){const r=new DataView(i,n),s=eW(r);e.push(s),n+=s.size}}return e}function eW(i){const e=i.getUint32(0),t=i.byteOffset,n=i.byteLength;if(n<e)return{offset:t,size:n};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};const s=i.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};const o=i.buffer,a=ir.hexDump(new Uint8Array(o,t+12,16)),l=i.getUint32(28);let u=null,c=null;if(s===0){if(e-32<l||l<22)return{offset:t,size:e};c=new Uint8Array(o,t+32,l)}else if(s===1){if(!l||n<t+32+l*16+16)return{offset:t,size:e};u=[];for(let h=0;h<l;h++)u.push(new Uint8Array(o,t+32+h*16,16))}return{version:s,systemId:a,kids:u,data:c,offset:t,size:e}}let hh={};class _u{static clearKeyUriToKeyIdMap(){hh={}}constructor(e,t,n,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case xi.FAIRPLAY:case xi.WIDEVINE:case xi.PLAYREADY:case xi.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&M.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=tW(e);return new _u(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=_z(this.uri);if(t)switch(this.keyFormat){case xi.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case xi.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Kz(n,null,t),this.keyId=_R(t);break}default:{let n=t.subarray(0,16);if(n.length!==16){const r=new Uint8Array(16);r.set(n,16-n.length),n=r}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=hh[this.uri];if(!n){const r=Object.keys(hh).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,r),hh[this.uri]=n}this.keyId=n}return this}}function tW(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const NR=/\{\$([a-zA-Z0-9-_]+)\}/g;function YT(i){return NR.test(i)}function yi(i,e,t){if(i.variableList!==null||i.hasVariableRefs)for(let n=t.length;n--;){const r=t[n],s=e[r];s&&(e[r]=Ov(i,s))}}function Ov(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(NR,n=>{const r=n.substring(2,n.length-1),s=t==null?void 0:t[r];return s===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):s})}return e}function KT(i,e,t){let n=i.variableList;n||(i.variableList=n={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(r))s=o.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(o){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else r=e.NAME,s=e.VALUE;r in n?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=s||""}function iW(i,e,t){const n=e.IMPORT;if(t&&n in t){let r=i.variableList;r||(i.variableList=r={}),r[n]=t[n]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function fo(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function nW(i){return typeof self<"u"&&i===self.ManagedMediaSource}const fd={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function rW(i,e){const t=fd[e];return!!t&&!!t[i.slice(0,4)]}function b0(i,e,t=!0){return!i.split(",").some(n=>!QR(n,e,t))}function QR(i,e,t=!0){var n;const r=fo(t);return(n=r==null?void 0:r.isTypeSupported(Cu(i,e)))!=null?n:!1}function Cu(i,e){return`${e}/mp4;codecs="${i}"`}function JT(i){if(i){const e=i.substring(0,4);return fd.video[e]}return 2}function dd(i){return i.split(",").reduce((e,t)=>{const n=fd.video[t];return n?(n*2+e)/(e?3:2):(fd.audio[t]+e)/(e?2:1)},0)}const x0={};function sW(i,e=!0){if(x0[i])return x0[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[i];for(let n=0;n<t.length;n++)if(QR(t[n],"audio",e))return x0[i]=t[n],t[n];return i}const oW=/flac|opus/i;function pd(i,e=!0){return i.replace(oW,t=>sW(t.toLowerCase(),e))}function eE(i,e){return i&&i!=="mp4a"?i:e&&e.split(",")[0]}function aW(i){const e=i.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");if(n.length>2){let r=n.shift()+".";r+=parseInt(n.shift()).toString(16),r+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=r}}return e.join(",")}const tE=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,iE=/#EXT-X-MEDIA:(.*)/g,lW=/^#EXT(?:INF|-X-TARGETDURATION):/m,nE=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),uW=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ar{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static resolve(e,t){return u1.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return lW.test(e)}static parseMasterPlaylist(e,t){const n=YT(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];tE.lastIndex=0;let o;for(;(o=tE.exec(e))!=null;)if(o[1]){var a;const u=new vt(o[1]);yi(r,u,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const c=Ov(r,o[2]),h={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:ar.resolve(c,t)},f=u.decimalResolution("RESOLUTION");f&&(h.width=f.width,h.height=f.height),cW(u.CODECS,h),(a=h.unknownCodecs)!=null&&a.length||s.push(h),r.levels.push(h)}else if(o[3]){const u=o[3],c=o[4];switch(u){case"SESSION-DATA":{const h=new vt(c);yi(r,h,["DATA-ID","LANGUAGE","VALUE","URI"]);const f=h["DATA-ID"];f&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[f]=h);break}case"SESSION-KEY":{const h=rE(c,t,r);h.encrypted&&h.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(h)):M.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);break}case"DEFINE":{{const h=new vt(c);yi(r,h,["NAME","VALUE","QUERYPARAM"]),KT(r,h,t)}break}case"CONTENT-STEERING":{const h=new vt(c);yi(r,h,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:ar.resolve(h["SERVER-URI"],t),pathwayId:h["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=sE(c);break}}}const l=s.length>0&&s.length<r.levels.length;return r.levels=l?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const s={},o=n.levels,a={AUDIO:o.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:o.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(iE.lastIndex=0;(r=iE.exec(e))!==null;){const u=new vt(r[1]),c=u.TYPE;if(c){const h=a[c],f=s[c]||[];s[c]=f,yi(n,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const d=u.LANGUAGE,p=u["ASSOC-LANGUAGE"],g=u.CHANNELS,m=u.CHARACTERISTICS,v=u["INSTREAM-ID"],O={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||d||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:d,url:u.URI?ar.resolve(u.URI,t):""};if(p&&(O.assocLang=p),g&&(O.channels=g),m&&(O.characteristics=m),v&&(O.instreamId=v),h!=null&&h.length){const y=ar.findGroup(h,O.groupId)||h[0];oE(O,y,"audioCodec"),oE(O,y,"textCodec")}f.push(O)}}return s}static parseLevelPlaylist(e,t,n,r,s,o){const a=new Tz(t),l=a.fragments;let u=null,c=0,h=0,f=0,d=0,p=null,g=new d0(r,t),m,v,O,y=-1,x=!1,b=null;for(nE.lastIndex=0,a.m3u8=e,a.hasVariableRefs=YT(e);(m=nE.exec(e))!==null;){x&&(x=!1,g=new d0(r,t),g.start=f,g.sn=c,g.cc=d,g.level=n,u&&(g.initSegment=u,g.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null,b&&(g.setByteRange(b),b=null)));const D=m[1];if(D){g.duration=parseFloat(D);const A=(" "+m[2]).slice(1);g.title=A||null,g.tagList.push(A?["INF",D,A]:["INF",D])}else if(m[3]){if(ae(g.duration)){g.start=f,O&&uE(g,O,a),g.sn=c,g.level=n,g.cc=d,l.push(g);const A=(" "+m[3]).slice(1);g.relurl=Ov(a,A),aE(g,p),p=g,f+=g.duration,c++,h=0,x=!0}}else if(m[4]){const A=(" "+m[4]).slice(1);p?g.setByteRange(A,p):g.setByteRange(A)}else if(m[5])g.rawProgramDateTime=(" "+m[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),y===-1&&(y=l.length);else{if(m=m[0].match(uW),!m){M.warn("No matches on slow regex match for level playlist!");continue}for(v=1;v<m.length&&!(typeof m[v]<"u");v++);const A=(" "+m[v]).slice(1),I=(" "+m[v+1]).slice(1),L=m[v+2]?(" "+m[v+2]).slice(1):"";switch(A){case"PLAYLIST-TYPE":a.type=I.toUpperCase();break;case"MEDIA-SEQUENCE":c=a.startSN=parseInt(I);break;case"SKIP":{const $=new vt(I);yi(a,$,["RECENTLY-REMOVED-DATERANGES"]);const B=$.decimalInteger("SKIPPED-SEGMENTS");if(ae(B)){a.skippedSegments=B;for(let j=B;j--;)l.unshift(null);c+=B}const Z=$.enumeratedString("RECENTLY-REMOVED-DATERANGES");Z&&(a.recentlyRemovedDateranges=Z.split("	"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(I),1);break;case"VERSION":a.version=parseInt(I);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(I||L)&&g.tagList.push(L?[I,L]:[I]);break;case"DISCONTINUITY":d++,g.tagList.push(["DIS"]);break;case"GAP":g.gap=!0,g.tagList.push([A]);break;case"BITRATE":g.tagList.push([A,I]);break;case"DATERANGE":{const $=new vt(I);yi(a,$,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),yi(a,$,$.clientAttrs);const B=new TR($,a.dateRanges[$.ID]);B.isValid||a.skippedSegments?a.dateRanges[B.id]=B:M.warn(`Ignoring invalid DATERANGE tag: "${I}"`),g.tagList.push(["EXT-X-DATERANGE",I]);break}case"DEFINE":{{const $=new vt(I);yi(a,$,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in $?iW(a,$,o):KT(a,$,t)}break}case"DISCONTINUITY-SEQUENCE":d=parseInt(I);break;case"KEY":{const $=rE(I,t,a);if($.isSupported()){if($.method==="NONE"){O=void 0;break}O||(O={}),O[$.keyFormat]&&(O=At({},O)),O[$.keyFormat]=$}else M.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${I}"`);break}case"START":a.startTimeOffset=sE(I);break;case"MAP":{const $=new vt(I);if(yi(a,$,["BYTERANGE","URI"]),g.duration){const B=new d0(r,t);lE(B,$,n,O),u=B,g.initSegment=u,u.rawProgramDateTime&&!g.rawProgramDateTime&&(g.rawProgramDateTime=u.rawProgramDateTime)}else{const B=g.byteRangeEndOffset;if(B){const Z=g.byteRangeStartOffset;b=`${B-Z}@${Z}`}else b=null;lE(g,$,n,O),u=g,x=!0}break}case"SERVER-CONTROL":{const $=new vt(I);a.canBlockReload=$.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=$.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&$.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=$.optionalFloat("PART-HOLD-BACK",0),a.holdBack=$.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const $=new vt(I);a.partTarget=$.decimalFloatingPoint("PART-TARGET");break}case"PART":{let $=a.partList;$||($=a.partList=[]);const B=h>0?$[$.length-1]:void 0,Z=h++,j=new vt(I);yi(a,j,["BYTERANGE","URI"]);const ie=new Sz(j,g,t,Z,B);$.push(ie),g.duration+=ie.duration;break}case"PRELOAD-HINT":{const $=new vt(I);yi(a,$,["URI"]),a.preloadHint=$;break}case"RENDITION-REPORT":{const $=new vt(I);yi(a,$,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push($);break}default:M.warn(`line parsed but not handled: ${m}`);break}}}p&&!p.relurl?(l.pop(),f-=p.duration,a.partList&&(a.fragmentHint=p)):a.partList&&(aE(g,p),g.cc=d,a.fragmentHint=g,O&&uE(g,O,a));const E=l.length,T=l[0],_=l[E-1];if(f+=a.skippedSegments*a.targetduration,f>0&&E&&_){a.averagetargetduration=f/E;const D=_.sn;a.endSN=D!=="initSegment"?D:0,a.live||(_.endList=!0),T&&(a.startCC=T.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(f+=a.fragmentHint.duration),a.totalduration=f,a.endCC=d,y>0&&hW(l,y),a}}function rE(i,e,t){var n,r;const s=new vt(i);yi(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=(n=s.METHOD)!=null?n:"",a=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,c=(r=s.KEYFORMAT)!=null?r:"identity";a&&s.IV&&!l&&M.error(`Invalid IV: ${s.IV}`);const h=a?ar.resolve(a,e):"",f=(u||"1").split("/").map(Number).filter(Number.isFinite);return new _u(o,h,c,f,l)}function sE(i){const t=new vt(i).decimalFloatingPoint("TIME-OFFSET");return ae(t)?t:null}function cW(i,e){let t=(i||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const r=t.filter(s=>rW(s,n));r.length&&(e[`${n}Codec`]=r.join(","),t=t.filter(s=>r.indexOf(s)===-1))}),e.unknownCodecs=t}function oE(i,e,t){const n=e[t];n&&(i[t]=n)}function hW(i,e){let t=i[e];for(let n=e;n--;){const r=i[n];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function aE(i,e){i.rawProgramDateTime?i.programDateTime=Date.parse(i.rawProgramDateTime):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime),ae(i.programDateTime)||(i.programDateTime=null,i.rawProgramDateTime=null)}function lE(i,e,t,n){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",n&&(i.levelkeys=n),i.initSegment=null}function uE(i,e,t){i.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(i)}var Fe={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Oe={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function cE(i){const{type:e}=i;switch(e){case Fe.AUDIO_TRACK:return Oe.AUDIO;case Fe.SUBTITLE_TRACK:return Oe.SUBTITLE;default:return Oe.MAIN}}function S0(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class fW{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.LEVEL_LOADING,this.onLevelLoading,this),e.on(S.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(S.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.LEVEL_LOADING,this.onLevelLoading,this),e.off(S.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(S.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,s=n||r,o=new s(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Fe.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:r,pathwayId:s,url:o,deliveryDirectives:a}=t;this.load({id:n,level:r,pathwayId:s,responseType:"text",type:Fe.LEVEL,url:o,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:Fe.AUDIO_TRACK,url:s,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:Fe.SUBTITLE_TRACK,url:s,deliveryDirectives:o})}load(e){var t;const n=this.hls.config;let r=this.getInternalLoader(e);if(r){const u=r.context;if(u&&u.url===e.url&&u.level===e.level){M.trace("[playlist-loader]: playlist request ongoing");return}M.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===Fe.MANIFEST?s=n.manifestLoadPolicy.default:s=At({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),ae((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===Fe.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===Fe.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===Fe.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const c=u.partTarget,h=u.targetduration;if(c&&h){const f=Math.max(c*3,h*.8)*1e3;s=At({},s,{maxTimeToFirstByteMs:Math.min(f,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(u,c,h,f)=>{const d=this.getInternalLoader(h);this.resetInternalLoader(h.type);const p=u.data;if(p.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,h,new Error("no EXTM3U delimiter"),f||null,c);return}c.parsing.start=performance.now(),ar.isMediaPlaylist(p)?this.handleTrackOrLevelPlaylist(u,c,h,f||null,d):this.handleMasterPlaylist(u,c,h,f)},onError:(u,c,h,f)=>{this.handleNetworkError(c,h,!1,u,f)},onTimeout:(u,c,h)=>{this.handleNetworkError(c,h,!0,void 0,u)}};r.load(e,a,l)}handleMasterPlaylist(e,t,n,r){const s=this.hls,o=e.data,a=S0(e,n),l=ar.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,r,t);return}const{contentSteering:u,levels:c,sessionData:h,sessionKeys:f,startTimeOffset:d,variableList:p}=l;this.variableList=p;const{AUDIO:g=[],SUBTITLES:m,"CLOSED-CAPTIONS":v}=ar.parseMasterPlaylistMedia(o,a,l);g.length&&!g.some(y=>!y.url)&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(M.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new vt({}),bitrate:0,url:""})),s.trigger(S.MANIFEST_LOADED,{levels:c,audioTracks:g,subtitles:m,captions:v,contentSteering:u,url:a,stats:t,networkDetails:r,sessionData:h,sessionKeys:f,startTimeOffset:d,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,r,s){const o=this.hls,{id:a,level:l,type:u}=n,c=S0(e,n),h=0,f=ae(l)?l:ae(a)?a:0,d=cE(n),p=ar.parseLevelPlaylist(e.data,c,f,d,h,this.variableList);if(u===Fe.MANIFEST){const g={attrs:new vt({}),bitrate:0,details:p,name:"",url:c};o.trigger(S.MANIFEST_LOADED,{levels:[g],audioTracks:[],url:c,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=p,this.handlePlaylistLoaded(p,e,t,n,r,s)}handleManifestParsingError(e,t,n,r,s){this.hls.trigger(S.ERROR,{type:be.NETWORK_ERROR,details:Q.MANIFEST_PARSING_ERROR,fatal:t.type===Fe.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,n=!1,r,s){let o=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===Fe.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===Fe.AUDIO_TRACK||e.type===Fe.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);M.warn(`[playlist-loader]: ${o}`);let l=Q.UNKNOWN,u=!1;const c=this.getInternalLoader(e);switch(e.type){case Fe.MANIFEST:l=n?Q.MANIFEST_LOAD_TIMEOUT:Q.MANIFEST_LOAD_ERROR,u=!0;break;case Fe.LEVEL:l=n?Q.LEVEL_LOAD_TIMEOUT:Q.LEVEL_LOAD_ERROR,u=!1;break;case Fe.AUDIO_TRACK:l=n?Q.AUDIO_TRACK_LOAD_TIMEOUT:Q.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case Fe.SUBTITLE_TRACK:l=n?Q.SUBTITLE_TRACK_LOAD_TIMEOUT:Q.SUBTITLE_LOAD_ERROR,u=!1;break}c&&this.resetInternalLoader(e.type);const h={type:be.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:a,networkDetails:t,stats:s};if(r){const f=(t==null?void 0:t.url)||e.url;h.response=Gt({url:f,data:void 0},r)}this.hls.trigger(S.ERROR,h)}handlePlaylistLoaded(e,t,n,r,s,o){const a=this.hls,{type:l,level:u,id:c,groupId:h,deliveryDirectives:f}=r,d=S0(t,r),p=cE(r),g=typeof r.level=="number"&&p===Oe.MAIN?u:void 0;if(!e.fragments.length){const v=new Error("No Segments found in Playlist");a.trigger(S.ERROR,{type:be.NETWORK_ERROR,details:Q.LEVEL_EMPTY_ERROR,fatal:!1,url:d,error:v,reason:v.message,response:t,context:r,level:g,parent:p,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const m=e.playlistParsingError;if(m){a.trigger(S.ERROR,{type:be.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:d,error:m,reason:m.message,response:t,context:r,level:g,parent:p,networkDetails:s,stats:n});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case Fe.MANIFEST:case Fe.LEVEL:a.trigger(S.LEVEL_LOADED,{details:e,level:g||0,id:c||0,stats:n,networkDetails:s,deliveryDirectives:f});break;case Fe.AUDIO_TRACK:a.trigger(S.AUDIO_TRACK_LOADED,{details:e,id:c||0,groupId:h||"",stats:n,networkDetails:s,deliveryDirectives:f});break;case Fe.SUBTITLE_TRACK:a.trigger(S.SUBTITLE_TRACK_LOADED,{details:e,id:c||0,groupId:h||"",stats:n,networkDetails:s,deliveryDirectives:f});break}}}function BR(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function UR(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){M.debug(`[texttrack-utils]: ${n}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,i.addCue(r)}catch(r){M.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(i.mode=t)}function fa(i){const e=i.mode;if(e==="disabled"&&(i.mode="hidden"),i.cues)for(let t=i.cues.length;t--;)i.removeCue(i.cues[t]);e==="disabled"&&(i.mode=e)}function yv(i,e,t,n){const r=i.mode;if(r==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const s=pW(i.cues,e,t);for(let o=0;o<s.length;o++)(!n||n(s[o]))&&i.removeCue(s[o])}r==="disabled"&&(i.mode=r)}function dW(i,e){if(e<i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let n=0,r=t;for(;n<=r;){const s=Math.floor((r+n)/2);if(e<i[s].startTime)r=s-1;else if(e>i[s].startTime&&n<t)n=s+1;else return s}return i[n].startTime-e<e-i[r].startTime?n:r}function pW(i,e,t){const n=[],r=dW(i,e);if(r>-1)for(let s=r,o=i.length;s<o;s++){const a=i[s];if(a.startTime>=e&&a.endTime<=t)n.push(a);else if(a.startTime>t)return n}return n}function ff(i){const e=[];for(let t=0;t<i.length;t++){const n=i[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(i[t])}return e}var Mn={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const gW=.25;function bv(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function hE(i,e,t,n,r){let s=new i(e,t,"");try{s.value=n,r&&(s.type=r)}catch{s=new i(e,t,JSON.stringify(r?Gt({type:r},n):n))}return s}const fh=(()=>{const i=bv();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function k0(i,e){return i.getTime()/1e3-e}function mW(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class vW{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(S.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(S.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(fa(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return BR(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:r}}}=this;if(!n&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=bv();if(o)for(let a=0;a<s.length;a++){const l=s[a].type;if(l===Mn.emsg&&!n||!r)continue;const u=PR(s[a].data);if(u){const c=s[a].pts;let h=c+s[a].duration;h>fh&&(h=fh),h-c<=0&&(h=c+gW);for(let d=0;d<u.length;d++){const p=u[d];if(!AR(p)){this.updateId3CueEnds(c,l);const g=hE(o,c,h,p,l);g&&this.id3Track.addCue(g)}}}}}updateId3CueEnds(e,t){var n;const r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let s=r.length;s--;){const o=r[s];o.type===t&&o.startTime<e&&o.endTime===fh&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(s&&(a||l)){let u;r==="audio"?u=c=>c.type===Mn.audioId3&&l:r==="video"?u=c=>c.type===Mn.emsg&&a:u=c=>c.type===Mn.audioId3&&l||c.type===Mn.emsg&&a,yv(s,t,n,u)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:r}=this,{dateRanges:s}=t,o=Object.keys(s);if(r){const c=Object.keys(n).filter(h=>!o.includes(h));for(let h=c.length;h--;){const f=c[h];Object.keys(n[f].cues).forEach(d=>{r.removeCue(n[f].cues[d])}),delete n[f]}}const a=t.fragments[t.fragments.length-1];if(o.length===0||!ae(a==null?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=a.programDateTime/1e3-a.start,u=bv();for(let c=0;c<o.length;c++){const h=o[c],f=s[h],d=k0(f.startDate,l),p=n[h],g=(p==null?void 0:p.cues)||{};let m=(p==null?void 0:p.durationKnown)||!1,v=fh;const O=f.endDate;if(O)v=k0(O,l),m=!0;else if(f.endOnNext&&!m){const x=o.reduce((b,E)=>{if(E!==f.id){const T=s[E];if(T.class===f.class&&T.startDate>f.startDate&&(!b||f.startDate<b.startDate))return T}return b},null);x&&(v=k0(x.startDate,l),m=!0)}const y=Object.keys(f.attr);for(let x=0;x<y.length;x++){const b=y[x];if(!bz(b))continue;const E=g[b];if(E)m&&!p.durationKnown&&(E.endTime=v);else if(u){let T=f.attr[b];xz(b)&&(T=mW(T));const _=hE(u,d,v,{key:b,data:T},Mn.dateRange);_&&(_.id=h,this.id3Track.addCue(_),g[b]=_)}}n[h]={cues:g,dateRange:f,durationKnown:m}}}}class OW{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let u=a&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:o*r);const c=r;return u+Math.min(this.stallCount*1,c)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const r=n.edge,s=e-t-this.edgeStalled,o=r-n.totalduration,a=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,s),a)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(S.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(S.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(S.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(S.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(S.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(S.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===Q.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&M.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:s}=this.config;if(!r||s===1||!t.live)return;const o=this.targetLatency;if(o===null)return;const a=n-o,l=Math.min(this.maxLatency,o+t.targetduration);if(a<l&&a>.05&&this.forwardBufferLength>1){const c=Math.min(2,Math.max(1,s)),h=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(c,Math.max(1,h))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const xv=["NONE","TYPE-0","TYPE-1",null];function yW(i){return xv.indexOf(i)>-1}const gd=["SDR","PQ","HLG"];function bW(i){return!!i&&gd.indexOf(i)>-1}var df={No:"",Yes:"YES",v2:"v2"};function fE(i){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=i,r=n<e/2;return e&&r?t?df.v2:df.Yes:df.No}class dE{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Ma{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return pE(this._audioGroups,e)}hasSubtitleGroup(e){return pE(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function pE(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function T0(i,e){const t=e.startPTS;if(ae(t)){let n=0,r;e.sn>i.sn?(n=t-i.start,r=i):(n=i.start-t,r=e),r.duration!==n&&(r.duration=n)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.start=i.start+(i.minEndPTS-i.start):e.start=i.start+i.duration:e.start=Math.max(i.start-e.duration,0)}function VR(i,e,t,n,r,s){n-t<=0&&(M.warn("Fragment should have a positive duration",e),n=t+e.duration,s=r+e.duration);let a=t,l=n;const u=e.startPTS,c=e.endPTS;if(ae(u)){const m=Math.abs(u-t);ae(e.deltaPTS)?e.deltaPTS=Math.max(m,e.deltaPTS):e.deltaPTS=m,a=Math.max(t,u),t=Math.min(t,u),r=Math.min(r,e.startDTS),l=Math.min(n,c),n=Math.max(n,c),s=Math.max(s,e.endDTS)}const h=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=a,e.startDTS=r,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;const f=e.sn;if(!i||f<i.startSN||f>i.endSN)return 0;let d;const p=f-i.startSN,g=i.fragments;for(g[p]=e,d=p;d>0;d--)T0(g[d],g[d-1]);for(d=p;d<g.length-1;d++)T0(g[d],g[d+1]);return i.fragmentHint&&T0(g[g.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,h}function xW(i,e){let t=null;const n=i.fragments;for(let a=n.length-1;a>=0;a--){const l=n[a].initSegment;if(l){t=l;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let r;TW(i,e,(a,l,u,c)=>{if(e.skippedSegments&&l.cc!==a.cc){const h=a.cc-l.cc;for(let f=u;f<c.length;f++)c[f].cc+=h}ae(a.startPTS)&&ae(a.endPTS)&&(l.start=l.startPTS=a.startPTS,l.startDTS=a.startDTS,l.maxStartPTS=a.maxStartPTS,l.endPTS=a.endPTS,l.endDTS=a.endDTS,l.minEndPTS=a.minEndPTS,l.duration=a.endPTS-a.startPTS,l.duration&&(r=l),e.PTSKnown=e.alignedSliding=!0),l.elementaryStreams=a.elementaryStreams,l.loader=a.loader,l.stats=a.stats,a.initSegment&&(l.initSegment=a.initSegment,t=a.initSegment)});const s=e.fragments;if(t&&(e.fragmentHint?s.concat(e.fragmentHint):s).forEach(l=>{var u;l&&(!l.initSegment||l.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(l.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=s.some(a=>!a),e.deltaUpdateFailed){M.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let a=e.skippedSegments;a--;)s.shift();e.startSN=s[0].sn}else e.canSkipDateRanges&&(e.dateRanges=SW(i.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));e.startCC=e.fragments[0].cc,e.endCC=s[s.length-1].cc}kW(i.partList,e.partList,(a,l)=>{l.elementaryStreams=a.elementaryStreams,l.stats=a.stats}),r?VR(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):ZR(i,e),s.length&&(e.totalduration=e.edge-s[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const a=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=a),e.driftEndTime=o,e.driftEnd=a}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime}function SW(i,e,t){const n=At({},i);return t&&t.forEach(r=>{delete n[r]}),Object.keys(e).forEach(r=>{const s=new TR(e[r].attr,n[r]);s.isValid?n[r]=s:M.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[r].attr)}"`)}),n}function kW(i,e,t){if(i&&e){let n=0;for(let r=0,s=i.length;r<=s;r++){const o=i[r],a=e[r+n];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):n--}}}function TW(i,e,t){const n=e.skippedSegments,r=Math.max(i.startSN,e.startSN)-e.startSN,s=(i.fragmentHint?1:0)+(n?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,o=e.startSN-i.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let u=r;u<=s;u++){const c=l[o+u];let h=a[u];n&&!h&&u<n&&(h=e.fragments[u]=c),c&&h&&t(c,h,u,a)}}function ZR(i,e){const t=e.startSN+e.skippedSegments-i.startSN,n=i.fragments;t<0||t>=n.length||Sv(e,n[t].start)}function Sv(i,e){if(e){const t=i.fragments;for(let n=i.skippedSegments;n<t.length;n++)t[n].start+=e;i.fragmentHint&&(i.fragmentHint.start+=e)}}function EW(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const n=i.fragments;if(n.length&&t*4>e){const s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function wW(i,e,t){if(!(i!=null&&i.details))return null;const n=i.details;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function gE(i,e,t){var n;return i!=null&&i.details?jR((n=i.details)==null?void 0:n.partList,e,t):null}function jR(i,e,t){if(i)for(let n=i.length;n--;){const r=i[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function GR(i){i.forEach((e,t)=>{const{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(r=>{r.level=t})})}function md(i){switch(i.details){case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_TIMEOUT:case Q.LEVEL_LOAD_TIMEOUT:case Q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function mE(i,e){const t=md(e);return i.default[`${t?"timeout":"error"}Retry`]}function d1(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function vE(i){return Gt(Gt({},i),{errorRetry:null,timeoutRetry:null})}function vd(i,e,t,n){if(!i)return!1;const r=n==null?void 0:n.code,s=e<i.maxNumRetry&&(_W(r)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,n,s):s}function _W(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}const HR={search:function(i,e){let t=0,n=i.length-1,r=null,s=null;for(;t<=n;){r=(t+n)/2|0,s=i[r];const o=e(s);if(o>0)t=r+1;else if(o<0)n=r-1;else return s}return null}};function CW(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!ae(e))return null;const n=i[0].programDateTime;if(e<(n||0))return null;const r=i[i.length-1].endProgramDateTime;if(e>=(r||0))return null;t=t||0;for(let s=0;s<i.length;++s){const o=i[s];if(PW(e,t,o))return o}return null}function Od(i,e,t=0,n=0,r=.005){let s=null;if(i){s=e[i.sn-e[0].sn+1]||null;const a=i.endDTS-t;a>0&&a<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!i||i.level===s.level)&&kv(t,n,s)===0||AW(s,i,Math.min(r,n))))return s;const o=HR.search(e,kv.bind(null,t,n));return o&&(o!==i||!s)?o:s}function AW(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((r,s)=>(s[0]==="INF"&&(r+=parseFloat(s[1])),r),t);return i.start<=n}return!1}function kv(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=i?1:t.start-n>i&&t.start?-1:0}function PW(i,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>i}function RW(i,e){return HR.search(i,t=>t.cc<e?1:t.cc>e?-1:0)}var Xt={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Tn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class LW{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=M.log.bind(M,"[info]:"),this.warn=M.warn.bind(M,"[warning]:"),this.error=M.error.bind(M,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(S.ERROR,this.onError,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(S.ERROR,this.onError,this),e.off(S.ERROR,this.onErrorOut,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Oe.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,r;if(t.fatal)return;const s=this.hls,o=t.context;switch(t.details){case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Q.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:Xt.DoNothing,flags:Tn.None};return}case Q.FRAG_GAP:case Q.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Xt.SendAlternateToPenaltyBox;return}case Q.LEVEL_EMPTY_ERROR:case Q.LEVEL_PARSING_ERROR:{var a,l;const u=t.parent===Oe.MAIN?t.level:s.loadLevel;t.details===Q.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(l=a.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:typeof(o==null?void 0:o.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.SUBTITLE_LOAD_ERROR:case Q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const u=s.levels[s.loadLevel];if(u&&(o.type===Fe.AUDIO_TRACK&&u.hasAudioGroup(o.groupId)||o.type===Fe.SUBTITLE_TRACK&&u.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=Xt.SendAlternateToPenaltyBox,t.errorAction.flags=Tn.MoveAllAlternatesMatchingHost;return}}return;case Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=s.levels[s.loadLevel],c=u==null?void 0:u.attrs["HDCP-LEVEL"];c?t.errorAction={action:Xt.SendAlternateToPenaltyBox,flags:Tn.MoveAllAlternatesMatchingHDCP,hdcpLevel:c}:this.keySystemError(t)}return;case Q.BUFFER_ADD_CODEC_ERROR:case Q.REMUX_ALLOC_ERROR:case Q.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)!=null?r:s.loadLevel);return;case Q.INTERNAL_EXCEPTION:case Q.BUFFER_APPENDING_ERROR:case Q.BUFFER_FULL_ERROR:case Q.LEVEL_SWITCH_ERROR:case Q.BUFFER_STALLED_ERROR:case Q.BUFFER_SEEK_OVER_HOLE:case Q.BUFFER_NUDGE_ON_STALL:t.errorAction={action:Xt.DoNothing,flags:Tn.None};return}t.type===be.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,r=mE(n.config.playlistLoadPolicy,e),s=this.playlistError++;if(vd(r,s,md(e),e.response))return{action:Xt.RetryRequest,flags:Tn.None,retryConfig:r,retryCount:s};const a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=s),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,a=mE(e.details.startsWith("key")?o:s,e),l=t.levels.reduce((c,h)=>c+h.fragmentError,0);if(r&&(e.details!==Q.FRAG_GAP&&r.fragmentError++,vd(a,l,md(e),e.response)))return{action:Xt.RetryRequest,flags:Tn.None,retryConfig:a,retryCount:l};const u=this.getLevelSwitchAction(e,n);return a&&(u.retryConfig=a,u.retryCount=l),u}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const r=this.hls.levels[t];if(r){var s,o;const u=e.details;r.loadError++,u===Q.BUFFER_APPEND_ERROR&&r.fragmentError++;let c=-1;const{levels:h,loadLevel:f,minAutoLevel:d,maxAutoLevel:p}=n;n.autoLevelEnabled||(n.loadLevel=-1);const g=(s=e.frag)==null?void 0:s.type,v=(g===Oe.AUDIO&&u===Q.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===Q.BUFFER_ADD_CODEC_ERROR||u===Q.BUFFER_APPEND_ERROR))&&h.some(({audioCodec:E})=>r.audioCodec!==E),y=e.sourceBufferName==="video"&&(u===Q.BUFFER_ADD_CODEC_ERROR||u===Q.BUFFER_APPEND_ERROR)&&h.some(({codecSet:E,audioCodec:T})=>r.codecSet!==E&&r.audioCodec===T),{type:x,groupId:b}=(o=e.context)!=null?o:{};for(let E=h.length;E--;){const T=(E+f)%h.length;if(T!==f&&T>=d&&T<=p&&h[T].loadError===0){var a,l;const _=h[T];if(u===Q.FRAG_GAP&&g===Oe.MAIN&&e.frag){const D=h[T].details;if(D){const A=Od(e.frag,D.fragments,e.frag.start);if(A!=null&&A.gap)continue}}else{if(x===Fe.AUDIO_TRACK&&_.hasAudioGroup(b)||x===Fe.SUBTITLE_TRACK&&_.hasSubtitleGroup(b))continue;if(g===Oe.AUDIO&&(a=r.audioGroups)!=null&&a.some(D=>_.hasAudioGroup(D))||g===Oe.SUBTITLE&&(l=r.subtitleGroups)!=null&&l.some(D=>_.hasSubtitleGroup(D))||v&&r.audioCodec===_.audioCodec||!v&&r.audioCodec!==_.audioCodec||y&&r.codecSet===_.codecSet)continue}c=T;break}}if(c>-1&&n.loadLevel!==c)return e.levelRetry=!0,this.playlistError=0,{action:Xt.SendAlternateToPenaltyBox,flags:Tn.None,nextAutoLevel:c}}return{action:Xt.SendAlternateToPenaltyBox,flags:Tn.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Xt.DoNothing:break;case Xt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Q.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r,hdcpLevel:s,nextAutoLevel:o}=n;switch(r){case Tn.None:this.switchLevel(e,o);break;case Tn.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=xv[xv.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class p1{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=M.log.bind(M,`${t}:`),this.warn=M.warn.bind(M,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const r=t==null?void 0:t.renditionReports;if(r){let s=-1;for(let o=0;o<r.length;o++){const a=r[o];let l;try{l=new self.URL(a.URI,t.url).href}catch(u){M.warn(`Could not construct new URL for Rendition Report: ${u}`),l=a.URI||""}if(l===e){s=o;break}else l===e.substring(0,l.length)&&(s=o)}if(s!==-1){const o=r[s],a=parseInt(o["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(o["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const c=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&c>t.partTarget&&(l+=1)}const u=n&&fE(n);return new dE(a,l>=0?l:void 0,u)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:r,stats:s}=t,o=self.performance.now(),a=s.loading.first?Math.max(0,o-s.loading.first):0;if(r.advancedDateTime=Date.now()-a,r.live||n!=null&&n.live){if(r.reloaded(n),n&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),n&&r.fragments.length>0&&xW(n,r),!this.canLoad||!r.live)return;let l,u,c;if(r.canBlockReload&&r.endSN&&r.advanced){const m=this.hls.config.lowLatencyMode,v=r.lastPartSn,O=r.endSN,y=r.lastPartIndex,x=y!==-1,b=v===O,E=m?0:y;x?(u=b?O+1:v,c=b?E:y+1):u=O+1;const T=r.age,_=T+r.ageHeader;let D=Math.min(_-r.partTarget,r.targetduration*1.5);if(D>0){if(n&&D>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${D} with playlist age: ${r.age}`),D=0;else{const A=Math.floor(D/r.targetduration);if(u+=A,c!==void 0){const I=Math.round(D%r.targetduration/r.partTarget);c+=I}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${T.toFixed(2)}s goal: ${D} skip sn ${A} to part ${c}`)}r.tuneInGoal=D}if(l=this.getDeliveryDirectives(r,t.deliveryDirectives,u,c),m||!b){this.loadPlaylist(l);return}}else(r.canBlockReload||r.canSkipUntil)&&(l=this.getDeliveryDirectives(r,t.deliveryDirectives,u,c));const h=this.hls.mainForwardBufferInfo,f=h?h.end-h.len:0,d=(r.edge-f)*1e3,p=EW(r,d);r.updated&&o>this.requestScheduled+p&&(this.requestScheduled=s.loading.start),u!==void 0&&r.canBlockReload?this.requestScheduled=s.loading.first+p-(r.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+p<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=p);let g=this.requestScheduled-o;g=Math.max(0,g),this.log(`reload live playlist ${e} in ${Math.round(g)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),g)}else this.clearTimer()}getDeliveryDirectives(e,t,n,r){let s=fE(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,s=df.No),new dE(n,r,s)}checkRetry(e){const t=e.details,n=md(e),r=e.errorAction,{action:s,retryCount:o=0,retryConfig:a}=r||{},l=!!r&&!!a&&(s===Xt.RetryRequest||!r.resolved&&s===Xt.SendAlternateToPenaltyBox);if(l){var u;if(this.requestScheduled=-1,o>=a.maxNumRetry)return!1;if(n&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const c=d1(a,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${c}ms`)}e.levelRetry=!0,r.resolved=!0}return l}}class Zo{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class IW{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Zo(e),this.fast_=new Zo(t),this.defaultTTFB_=r,this.ttfb_=new Zo(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new Zo(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new Zo(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Zo(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,r=e/1e3,s=n/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const XR={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},OE={};function DW(i,e,t,n,r,s){const o=i.audioCodec?i.audioGroups:null,a=s==null?void 0:s.audioCodec,l=s==null?void 0:s.channels,u=l?parseInt(l):a?1/0:2;let c=null;if(o!=null&&o.length)try{o.length===1&&o[0]?c=e.groups[o[0]].channels:c=o.reduce((h,f)=>{if(f){const d=e.groups[f];if(!d)throw new Error(`Audio track group ${f} not found`);Object.keys(d.channels).forEach(p=>{h[p]=(h[p]||0)+d.channels[p]})}return h},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(n,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(r,8e6))||!!c&&ae(u)&&Object.keys(c).some(h=>parseInt(h)>u)}function $W(i,e,t){const n=i.videoCodec,r=i.audioCodec;if(!n||!r||!t)return Promise.resolve(XR);const s={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},o=i.videoRange;o!=="SDR"&&(s.transferFunction=o.toLowerCase());const a=n.split(",").map(l=>({type:"media-source",video:Gt(Gt({},s),{},{contentType:Cu(l,"video")})}));return r&&i.audioGroups&&i.audioGroups.forEach(l=>{var u;l&&((u=e.groups[l])==null||u.tracks.forEach(c=>{if(c.groupId===l){const h=c.channels||"",f=parseFloat(h);ae(f)&&f>2&&a.push.apply(a,r.split(",").map(d=>({type:"media-source",audio:{contentType:Cu(d,"audio"),channels:""+f}})))}}))}),Promise.all(a.map(l=>{const u=MW(l);return OE[u]||(OE[u]=t.decodingInfo(l))})).then(l=>({supported:!l.some(u=>!u.supported),configurations:a,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:a,decodingInfoResults:[],error:l}))}function MW(i){const{audio:e,video:t}=i,n=t||e;if(n){const r=n.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${r}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${r}`}return""}function FW(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function NW(i,e){let t=!1,n=[];return i&&(t=i!=="SDR",n=[i]),e&&(n=e.allowedVideoRanges||gd.slice(0),t=e.preferHDR!==void 0?e.preferHDR:FW(),t?n=n.filter(r=>r!=="SDR"):n=["SDR"]),{preferHDR:t,allowedVideoRanges:n}}function QW(i,e,t,n,r){const s=Object.keys(i),o=n==null?void 0:n.channels,a=n==null?void 0:n.audioCodec,l=o&&parseInt(o)===2;let u=!0,c=!1,h=1/0,f=1/0,d=1/0,p=0,g=[];const{preferHDR:m,allowedVideoRanges:v}=NW(e,r);for(let b=s.length;b--;){const E=i[s[b]];u=E.channels[2]>0,h=Math.min(h,E.minHeight),f=Math.min(f,E.minFramerate),d=Math.min(d,E.minBitrate);const T=v.filter(_=>E.videoRanges[_]>0);T.length>0&&(c=!0,g=T)}h=ae(h)?h:0,f=ae(f)?f:0;const O=Math.max(1080,h),y=Math.max(30,f);return d=ae(d)?d:t,t=Math.max(d,t),c||(e=void 0,g=[]),{codecSet:s.reduce((b,E)=>{const T=i[E];if(E===b)return b;if(T.minBitrate>t)return Er(E,`min bitrate of ${T.minBitrate} > current estimate of ${t}`),b;if(!T.hasDefaultAudio)return Er(E,"no renditions with default or auto-select sound found"),b;if(a&&E.indexOf(a.substring(0,4))%5!==0)return Er(E,`audio codec preference "${a}" not found`),b;if(o&&!l){if(!T.channels[o])return Er(E,`no renditions with ${o} channel sound found (channels options: ${Object.keys(T.channels)})`),b}else if((!a||l)&&u&&T.channels[2]===0)return Er(E,"no renditions with stereo sound found"),b;return T.minHeight>O?(Er(E,`min resolution of ${T.minHeight} > maximum of ${O}`),b):T.minFramerate>y?(Er(E,`min framerate of ${T.minFramerate} > maximum of ${y}`),b):g.some(_=>T.videoRanges[_]>0)?T.maxScore<p?(Er(E,`max score of ${T.maxScore} < selected max of ${p}`),b):b&&(dd(E)>=dd(b)||T.fragmentError>i[b].fragmentError)?b:(p=T.maxScore,E):(Er(E,`no variants with VIDEO-RANGE of ${JSON.stringify(g)} found`),b)},void 0),videoRanges:g,preferHDR:m,minFramerate:f,minBitrate:d}}function Er(i,e){M.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function BW(i){return i.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function UW(i,e,t,n){return i.slice(t,n+1).reduce((r,s)=>{if(!s.codecSet)return r;const o=s.audioGroups;let a=r[s.codecSet];a||(r[s.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,s.bitrate);const l=Math.min(s.height,s.width);return a.minHeight=Math.min(a.minHeight,l),a.minFramerate=Math.min(a.minFramerate,s.frameRate),a.maxScore=Math.max(a.maxScore,s.score),a.fragmentError+=s.fragmentError,a.videoRanges[s.videoRange]=(a.videoRanges[s.videoRange]||0)+1,o&&o.forEach(u=>{if(!u)return;const c=e.groups[u];c&&(a.hasDefaultAudio=a.hasDefaultAudio||e.hasDefaultAudio?c.hasDefault:c.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(c.channels).forEach(h=>{a.channels[h]=(a.channels[h]||0)+c.channels[h]}))}),r},{})}function lr(i,e,t){if("attrs"in i){const n=e.indexOf(i);if(n!==-1)return n}for(let n=0;n<e.length;n++){const r=e[n];if(lo(i,r,t))return n}return-1}function lo(i,e,t){const{groupId:n,name:r,lang:s,assocLang:o,default:a}=i,l=i.forced;return(n===void 0||e.groupId===n)&&(r===void 0||e.name===r)&&(s===void 0||e.lang===s)&&(s===void 0||e.assocLang===o)&&(a===void 0||e.default===a)&&(l===void 0||e.forced===l)&&(!("characteristics"in i)||VW(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function VW(i,e=""){const t=i.split(","),n=e.split(",");return t.length===n.length&&!t.some(r=>n.indexOf(r)===-1)}function zs(i,e){const{audioCodec:t,channels:n}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function ZW(i,e,t,n,r){const s=e[n],a=e.reduce((f,d,p)=>{const g=d.uri;return(f[g]||(f[g]=[])).push(p),f},{})[s.uri];a.length>1&&(n=Math.max.apply(Math,a));const l=s.videoRange,u=s.frameRate,c=s.codecSet.substring(0,4),h=yE(e,n,f=>{if(f.videoRange!==l||f.frameRate!==u||f.codecSet.substring(0,4)!==c)return!1;const d=f.audioGroups,p=t.filter(g=>!d||d.indexOf(g.groupId)!==-1);return lr(i,p,r)>-1});return h>-1?h:yE(e,n,f=>{const d=f.audioGroups,p=t.filter(g=>!d||d.indexOf(g.groupId)!==-1);return lr(i,p,r)>-1})}function yE(i,e,t){for(let n=e;n>-1;n--)if(t(i[n]))return n;for(let n=e+1;n<i.length;n++)if(t(i[n]))return n;return-1}class jW{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:n,hls:r}=this,{autoLevelEnabled:s,media:o}=r;if(!t||!o)return;const a=performance.now(),l=n?n.stats:t.stats,u=n?n.duration:t.duration,c=a-l.loading.start,h=r.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||t.level<=h){this.clearTimer(),this._nextAutoLevel=-1;return}if(!s||o.paused||!o.playbackRate||!o.readyState)return;const f=r.mainForwardBufferInfo;if(f===null)return;const d=this.bwEstimator.getEstimateTTFB(),p=Math.abs(o.playbackRate);if(c<=Math.max(d,1e3*(u/(p*2))))return;const g=f.len/p,m=l.loading.first?l.loading.first-l.loading.start:-1,v=l.loaded&&m>-1,O=this.getBwEstimate(),y=r.levels,x=y[t.level],b=l.total||Math.max(l.loaded,Math.round(u*x.averageBitrate/8));let E=v?c-m:c;E<1&&v&&(E=Math.min(c,l.loaded*8/O));const T=v?l.loaded*1e3/E:0,_=T?(b-l.loaded)/T:b*8/O+d/1e3;if(_<=g)return;const D=T?T*8:O;let A=Number.POSITIVE_INFINITY,I;for(I=t.level-1;I>h;I--){const $=y[I].maxBitrate;if(A=this.getTimeToLoadFrag(d/1e3,D,u*$,!y[I].details),A<g)break}if(A>=_||A>u*10)return;r.nextLoadLevel=r.nextAutoLevel=I,v?this.bwEstimator.sample(c-Math.min(d,m),l.loaded):this.bwEstimator.sampleTTFB(c);const L=y[I].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>L&&this.resetEstimator(L),this.clearTimer(),M.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${g.toFixed(3)} s
      Estimated load time for current fragment: ${_.toFixed(3)} s
      Estimated load time for down switch fragment: ${A.toFixed(3)} s
      TTFB estimate: ${m|0} ms
      Current BW estimate: ${ae(O)?O|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${I} @ ${L|0} bps`),r.trigger(S.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(M.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new IW(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.FRAG_LOADING,this.onFragLoading,this),e.on(S.FRAG_LOADED,this.onFragLoaded,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this),e.on(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(S.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.FRAG_LOADING,this.onFragLoading,this),e.off(S.FRAG_LOADED,this.onFragLoaded,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this),e.off(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(S.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(S.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var r;this.fragCurrent=n,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Q.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:r,partCurrent:s}=this;if(n&&r&&n.sn===r.sn&&n.level===r.level){const o=performance.now(),a=s?s.stats:n.stats,l=o-a.loading.start,u=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&u>-1){const h=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(h,u),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,n,r){const s=e+n/t,o=r?this.lastLevelLoadSec:0;return s+o}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,s=r.end-r.start;ae(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===Oe.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=n?n.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+r.loaded,l=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){const s={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(S.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:r}=t,s=r!=null&&r.stats.loaded?r.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Oe.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,s=this.findBestLevel(n,t,e,0,r,1,1);if(s>-1)return s;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return M.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,s)&&o[e].loadError<=o[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:r,config:s,minAutoLevel:o}=n,a=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay();let c=s.abrBandWidthFactor,h=s.abrBandWidthUpFactor;if(u){const m=this.findBestLevel(l,o,r,u,0,c,h);if(m>=0)return m}let f=a?Math.min(a,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const m=this.bitrateTestDelay;m&&(f=(a?Math.min(a,s.maxLoadingDelay):s.maxLoadingDelay)-m,M.info(`[abr] bitrate test took ${Math.round(1e3*m)}ms, set first fragment max fetchDuration to ${Math.round(1e3*f)} ms`),c=h=1)}const d=this.findBestLevel(l,o,r,u,f,c,h);if(M.info(`[abr] ${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${d}`),d>-1)return d;const p=n.levels[o],g=n.levels[n.loadLevel];return(p==null?void 0:p.bitrate)<(g==null?void 0:g.bitrate)?o:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,s,o,a){var l;const u=r+s,c=this.lastLoadedFragLevel,h=c===-1?this.hls.firstLevel:c,{fragCurrent:f,partCurrent:d}=this,{levels:p,allAudioTracks:g,loadLevel:m,config:v}=this.hls;if(p.length===1)return 0;const O=p[h],y=!!(O!=null&&(l=O.details)!=null&&l.live),x=m===-1||c===-1;let b,E="SDR",T=(O==null?void 0:O.frameRate)||0;const{audioPreference:_,videoPreference:D}=v,A=this.audioTracksByGroup||(this.audioTracksByGroup=BW(g));if(x){if(this.firstSelection!==-1)return this.firstSelection;const Z=this.codecTiers||(this.codecTiers=UW(p,A,t,n)),j=QW(Z,E,e,_,D),{codecSet:ie,videoRanges:ne,minFramerate:z,minBitrate:W,preferHDR:he}=j;b=ie,E=he?ne[ne.length-1]:ne[0],T=z,e=Math.max(e,W),M.log(`[abr] picked start tier ${JSON.stringify(j)}`)}else b=O==null?void 0:O.codecSet,E=O==null?void 0:O.videoRange;const I=d?d.duration:f?f.duration:0,L=this.bwEstimator.getEstimateTTFB()/1e3,$=[];for(let Z=n;Z>=t;Z--){var B;const j=p[Z],ie=Z>h;if(!j)continue;if(v.useMediaCapabilities&&!j.supportedResult&&!j.supportedPromise){const Se=navigator.mediaCapabilities;typeof(Se==null?void 0:Se.decodingInfo)=="function"&&DW(j,A,E,T,e,_)?(j.supportedPromise=$W(j,A,Se),j.supportedPromise.then($e=>{if(!this.hls)return;j.supportedResult=$e;const Ke=this.hls.levels,kt=Ke.indexOf(j);$e.error?M.warn(`[abr] MediaCapabilities decodingInfo error: "${$e.error}" for level ${kt} ${JSON.stringify($e)}`):$e.supported||(M.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${kt} ${JSON.stringify($e)}`),kt>-1&&Ke.length>1&&(M.log(`[abr] Removing unsupported level ${kt}`),this.hls.removeLevel(kt)))})):j.supportedResult=XR}if(b&&j.codecSet!==b||E&&j.videoRange!==E||ie&&T>j.frameRate||!ie&&T>0&&T<j.frameRate||j.supportedResult&&!((B=j.supportedResult.decodingInfoResults)!=null&&B[0].smooth)){$.push(Z);continue}const ne=j.details,z=(d?ne==null?void 0:ne.partTarget:ne==null?void 0:ne.averagetargetduration)||I;let W;ie?W=a*e:W=o*e;const he=I&&r>=I*2&&s===0?p[Z].averageBitrate:p[Z].maxBitrate,se=this.getTimeToLoadFrag(L,W,he*z,ne===void 0);if(W>=he&&(Z===c||j.loadError===0&&j.fragmentError===0)&&(se<=L||!ae(se)||y&&!this.bitrateTestDelay||se<u)){const Se=this.forcedAutoLevel;return Z!==m&&(Se===-1||Se!==m)&&($.length&&M.trace(`[abr] Skipped level(s) ${$.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${p[$[0]].codecs}" ${p[$[0]].videoRange}; not compatible with "${O.codecs}" ${E}`),M.info(`[abr] switch candidate:${h}->${Z} adjustedbw(${Math.round(W)})-bitrate=${Math.round(W-he)} ttfb:${L.toFixed(1)} avgDuration:${z.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${se.toFixed(1)} firstSelection:${x} codecSet:${b} videoRange:${E} hls.loadLevel:${m}`)),x&&(this.firstSelection=Z),Z}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,r=Math.min(Math.max(e,n),t);this._nextAutoLevel!==r&&(this.nextAutoLevelKey="",this._nextAutoLevel=r)}}class GW{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Vt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class HW{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(S.BUFFER_APPENDED,this.onBufferAppended,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this),e.on(S.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(S.BUFFER_APPENDED,this.onBufferAppended,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this),e.off(S.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const s=n[r];if(!s)break;const o=s.end;if(s.start<=e&&o!==null&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,r=Object.keys(n);for(let s=r.length;s--;){const o=n[r[s]];if((o==null?void 0:o.body.type)===t&&o.buffered){const a=o.body;if(a.start<=e&&e<=a.end)return a}}return null}detectEvictedFragments(e,t,n,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a||s>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===n&&this.removeFragment(a.body);return}const l=a.range[e];l&&l.time.some(u=>{const c=!this.isTimeBuffered(u.startPTS,u.endPTS,t);return c&&this.removeFragment(a.body),c})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:r}=e;if(!t||n.sn==="initSegment")return;const s=jo(n),o=this.fragments[s];if(!o||o.buffered&&n.gap)return;const a=!n.relurl;Object.keys(t).forEach(l=>{const u=n.elementaryStreams[l];if(!u)return;const c=t[l],h=a||u.partial===!0;o.range[l]=this.getBufferedTimes(n,r,h,c)}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=n.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),dh(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(r=>r.fragment.sn>=e))}fragBuffered(e,t){const n=jo(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){const s={time:[],partial:n},o=e.start,a=e.end,l=e.minEndPTS||a,u=e.maxStartPTS||o;for(let c=0;c<r.length;c++){const h=r.start(c)-this.bufferPadding,f=r.end(c)+this.bufferPadding;if(u>=h&&l<=f){s.time.push({startPTS:Math.max(o,r.start(c)),endPTS:Math.min(a,r.end(c))});break}else if(o<f&&a>h){const d=Math.max(o,r.start(c)),p=Math.min(a,r.end(c));p>d&&(s.partial=!0,s.time.push({startPTS:d,endPTS:p}))}else if(a<=h)break}return s}getPartialFragment(e){let t=null,n,r,s,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(u=>{const c=l[u];c&&dh(c)&&(r=c.body.start-a,s=c.body.end+a,e>=r&&e<=s&&(n=Math.min(e-r,s-e),o<=n&&(t=c.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||dh(t))}getState(e){const t=jo(e),n=this.fragments[t];return n?n.buffered?dh(n)?Vt.PARTIAL:Vt.OK:Vt.APPENDING:Vt.NOT_LOADED}isTimeBuffered(e,t,n){let r,s;for(let o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,s=n.end(o)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:r}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const s=r?null:t,o=jo(n);this.fragments[o]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:s}=t;if(n.sn==="initSegment")return;const o=n.type;if(r){let a=this.activePartLists[o];a||(this.activePartLists[o]=a=[]),a.push(r)}this.timeRanges=s,Object.keys(s).forEach(a=>{const l=s[a];this.detectEvictedFragments(a,l,o,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=jo(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==n||r&&!l.gap||l.start<t&&l.end>e&&(a.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=jo(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const r=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function dh(i){var e,t,n;return i.buffered&&(i.body.gap||((e=i.range.video)==null?void 0:e.partial)||((t=i.range.audio)==null?void 0:t.partial)||((n=i.range.audiovideo)==null?void 0:n.partial))}function jo(i){return`${i.type}_${i.level}_${i.sn}`}const XW={length:0,start:()=>0,end:()=>0};class tt{static isBuffered(e,t){try{if(e){const n=tt.getBuffered(e);for(let r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const r=tt.getBuffered(e),s=[];let o;for(o=0;o<r.length;o++)s.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(s,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(u,c){const h=u.start-c.start;return h||c.end-u.end});let r=[];if(n)for(let u=0;u<e.length;u++){const c=r.length;if(c){const h=r[c-1].end;e[u].start-h<n?e[u].end>h&&(r[c-1].end=e[u].end):r.push(e[u])}else r.push(e[u])}else r=e;let s=0,o,a=t,l=t;for(let u=0;u<r.length;u++){const c=r[u].start,h=r[u].end;if(t+n>=c&&t<h)a=c,l=h,s=l-t;else if(t+n<c){o=c;break}}return{len:s,start:a||0,end:l||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return M.log("failed to get media.buffered",t),XW}}}class g1{constructor(e,t,n,r=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=ph(),this.buffering={audio:ph(),video:ph(),audiovideo:ph()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=s,this.partial=o}}function ph(){return{start:0,executeStart:0,executeEnd:0,end:0}}function pf(i,e){for(let n=0,r=i.length;n<r;n++){var t;if(((t=i[n])==null?void 0:t.cc)===e)return i[n]}return null}function zW(i,e,t){return!!(e&&(t.endCC>t.startCC||i&&i.cc<t.startCC))}function WW(i,e){const t=i.fragments,n=e.fragments;if(!n.length||!t.length){M.log("No fragments to align");return}const r=pf(t,n[0].cc);if(!r||r&&!r.startPTS){M.log("No frag in previous level to align on");return}return r}function bE(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function zR(i,e){const t=e.fragments;for(let n=0,r=t.length;n<r;n++)bE(t[n],i);e.fragmentHint&&bE(e.fragmentHint,i),e.alignedSliding=!0}function qW(i,e,t){e&&(YW(i,t,e),!t.alignedSliding&&e&&yd(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&ZR(e,t))}function YW(i,e,t){if(zW(i,t,e)){const n=WW(t,e);n&&ae(n.start)&&(M.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),zR(n.start,e))}}function yd(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,n=e.fragments;if(!t.length||!n.length)return;let r,s;const o=Math.min(e.endCC,i.endCC);e.startCC<o&&i.startCC<o&&(r=pf(n,o),s=pf(t,o)),(!r||!s)&&(r=n[Math.floor(n.length/2)],s=pf(t,r.cc)||t[Math.floor(t.length/2)]);const a=r.programDateTime,l=s.programDateTime;if(!a||!l)return;const u=(l-a)/1e3-(s.start-r.start);zR(u,i)}const xE=Math.pow(2,17);class KW{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Ar({type:be.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(d=>d[0]==="GAP")){l(kE(e));return}else e.gap=!1;const u=this.loader=e.loader=s?new s(r):new o(r),c=SE(e),h=vE(r.fragLoadPolicy.default),f={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:xE};e.stats=u.stats,u.load(c,f,{onSuccess:(d,p,g,m)=>{this.resetLoader(e,u);let v=d.data;g.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(v.slice(0,16)),v=v.slice(16)),a({frag:e,part:null,payload:v,networkDetails:m})},onError:(d,p,g,m)=>{this.resetLoader(e,u),l(new Ar({type:be.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Gt({url:n,data:void 0},d),error:new Error(`HTTP Error ${d.code} ${d.text}`),networkDetails:g,stats:m}))},onAbort:(d,p,g)=>{this.resetLoader(e,u),l(new Ar({type:be.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:g,stats:d}))},onTimeout:(d,p,g)=>{this.resetLoader(e,u),l(new Ar({type:be.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:g,stats:d}))},onProgress:(d,p,g,m)=>{t&&t({frag:e,part:null,payload:g,networkDetails:m})}})})}loadPart(e,t,n){this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(kE(e,t));return}const u=this.loader=e.loader=s?new s(r):new o(r),c=SE(e,t),h=vE(r.fragLoadPolicy.default),f={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:xE};t.stats=u.stats,u.load(c,f,{onSuccess:(d,p,g,m)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const v={frag:e,part:t,payload:d.data,networkDetails:m};n(v),a(v)},onError:(d,p,g,m)=>{this.resetLoader(e,u),l(new Ar({type:be.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Gt({url:c.url,data:void 0},d),error:new Error(`HTTP Error ${d.code} ${d.text}`),networkDetails:g,stats:m}))},onAbort:(d,p,g)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new Ar({type:be.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:g,stats:d}))},onTimeout:(d,p,g)=>{this.resetLoader(e,u),l(new Ar({type:be.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:g,stats:d}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,s=r.total;if(n.loaded+=r.loaded,s){const l=Math.round(e.duration/t.duration),u=Math.min(Math.round(n.loaded/s),l),h=(l-u)*Math.round(n.loaded/u);n.total=n.loaded+h}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=r.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function SE(i,e=null){const t=e||i,n={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(ae(r)&&ae(s)){var o;let a=r,l=s;if(i.sn==="initSegment"&&((o=i.decryptdata)==null?void 0:o.method)==="AES-128"){const u=s-r;u%16&&(l=s+(16-u%16)),r!==0&&(n.resetIV=!0,a=r-16)}n.rangeStart=a,n.rangeEnd=l}return n}function kE(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),n={type:be.MEDIA_ERROR,details:Q.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(n.part=e),(e||i).stats.aborted=!0,new Ar(n)}class Ar extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class JW{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class eq{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function tq(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?ao(i,0,e-t):i}class iq{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(r*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],s=n[1],o=n[2],a=n[3],l=this.invSubMix,u=l[0],c=l[1],h=l[2],f=l[3],d=new Uint32Array(256);let p=0,g=0,m=0;for(m=0;m<256;m++)m<128?d[m]=m<<1:d[m]=m<<1^283;for(m=0;m<256;m++){let v=g^g<<1^g<<2^g<<3^g<<4;v=v>>>8^v&255^99,e[p]=v,t[v]=p;const O=d[p],y=d[O],x=d[y];let b=d[v]*257^v*16843008;r[p]=b<<24|b>>>8,s[p]=b<<16|b>>>16,o[p]=b<<8|b>>>24,a[p]=b,b=x*16843009^y*65537^O*257^p*16843008,u[v]=b<<24|b>>>8,c[v]=b<<16|b>>>16,h[v]=b<<8|b>>>24,f[v]=b,p?(p=O^d[d[d[x^O]]],g^=d[d[g]]):p=g=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const o=this.ksRows=(s+6+1)*4;let a,l;const u=this.keySchedule=new Uint32Array(o),c=this.invKeySchedule=new Uint32Array(o),h=this.sBox,f=this.rcon,d=this.invSubMix,p=d[0],g=d[1],m=d[2],v=d[3];let O,y;for(a=0;a<o;a++){if(a<s){O=u[a]=t[a];continue}y=O,a%s===0?(y=y<<8|y>>>24,y=h[y>>>24]<<24|h[y>>>16&255]<<16|h[y>>>8&255]<<8|h[y&255],y^=f[a/s|0]<<24):s>6&&a%s===4&&(y=h[y>>>24]<<24|h[y>>>16&255]<<16|h[y>>>8&255]<<8|h[y&255]),u[a]=O=(u[a-s]^y)>>>0}for(l=0;l<o;l++)a=o-l,l&3?y=u[a]:y=u[a-4],l<4||a<=4?c[l]=y:c[l]=p[h[y>>>24]]^g[h[y>>>16&255]]^m[h[y>>>8&255]]^v[h[y&255]],c[l]=c[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],u=a[1],c=a[2],h=a[3],f=this.uint8ArrayToUint32Array_(n);let d=f[0],p=f[1],g=f[2],m=f[3];const v=new Int32Array(e),O=new Int32Array(v.length);let y,x,b,E,T,_,D,A,I,L,$,B,Z,j;const ie=this.networkToHostOrderSwap;for(;t<v.length;){for(I=ie(v[t]),L=ie(v[t+1]),$=ie(v[t+2]),B=ie(v[t+3]),T=I^s[0],_=B^s[1],D=$^s[2],A=L^s[3],Z=4,j=1;j<r;j++)y=l[T>>>24]^u[_>>16&255]^c[D>>8&255]^h[A&255]^s[Z],x=l[_>>>24]^u[D>>16&255]^c[A>>8&255]^h[T&255]^s[Z+1],b=l[D>>>24]^u[A>>16&255]^c[T>>8&255]^h[_&255]^s[Z+2],E=l[A>>>24]^u[T>>16&255]^c[_>>8&255]^h[D&255]^s[Z+3],T=y,_=x,D=b,A=E,Z=Z+4;y=o[T>>>24]<<24^o[_>>16&255]<<16^o[D>>8&255]<<8^o[A&255]^s[Z],x=o[_>>>24]<<24^o[D>>16&255]<<16^o[A>>8&255]<<8^o[T&255]^s[Z+1],b=o[D>>>24]<<24^o[A>>16&255]<<16^o[T>>8&255]<<8^o[_&255]^s[Z+2],E=o[A>>>24]<<24^o[T>>16&255]<<16^o[_>>8&255]<<8^o[D&255]^s[Z+3],O[t]=ie(y^d),O[t+1]=ie(E^p),O[t+2]=ie(b^g),O[t+3]=ie(x^m),d=I,p=L,g=$,m=B,t=t+4}return O.buffer}}const nq=16;class m1{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?tq(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((r,s)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:r,currentResult:s,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=pn(o,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;r&&(n=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new iq),l.expandKey(t);const u=s;return this.currentResult=l.decrypt(a.buffer,0,n),this.currentIV=ao(a,-16).buffer,u||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new eq(this.subtle,t)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new JW(this.subtle,new Uint8Array(n)).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(M.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%nq;return n!==e.length&&(t=ao(e,0,n),this.remainderData=ao(e,n)),t}logOnce(e){this.logEnabled&&(M.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const rq={toString:function(i){let e="";const t=i.length;for(let n=0;n<t;n++)e+=`[${i.start(n).toFixed(3)}-${i.end(n).toFixed(3)}]`;return e}},X={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class v1 extends GW{constructor(e,t,n,r,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=X.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=r,this.log=M.log.bind(M,`${r}:`),this.warn=M.warn.bind(M,`${r}:`),this.hls=e,this.fragmentLoader=new KW(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new m1(e.config),e.on(S.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=X.STOPPED}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const s=n[n.length-1];return tt.isBuffered(this.media,s.start+s.duration/2)}const r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&this.state===X.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:s}=this,o=n?n.currentTime:0,a=tt.bufferInfo(r||n,o,e.maxBufferHole);if(this.log(`media seeking to ${ae(o)?o.toFixed(3):o}, state: ${s}`),this.state===X.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,u=t.start-l,c=t.start+t.duration+l;if(!a.len||c<a.start||u>a.end){const h=o>c;(o<u||h)&&(h&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!a.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=X.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const r=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,r).then(s=>{if(!s)return;const o=this.state;if(this.fragContextChanged(e)){(o===X.FRAG_LOADING||!this.fragCurrent&&o===X.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=X.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(S.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===X.STOPPED||this.state===X.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Vt.APPENDING){const s=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,s),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(a,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Vt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(S.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:r}=this,{payload:s}=n,o=e.decryptdata;if(s&&s.byteLength>0&&o!=null&&o.key&&o.iv&&o.method==="AES-128"){const a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),o.key.buffer,o.iv.buffer).catch(l=>{throw r.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const u=self.performance.now();return r.trigger(S.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:a,tdecrypt:u}}),n.payload=l,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===X.STOPPED||this.state===X.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=X.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,r,s,o;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Oe.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((r=e.endPTS)!=null?r:NaN).toFixed(3)}] > buffer:${a?rq.toString(tt.getBuffered(a)):"(detached)"})`),e.sn!=="initSegment"){var l;if(e.type!==Oe.SUBTITLE){const c=e.elementaryStreams;if(!Object.keys(c).some(h=>!!c[h])){this.state=X.IDLE;return}}const u=(l=this.levels)==null?void 0:l[e.level];u!=null&&u.fragmentError&&(this.log(`Resetting level fragment error count of ${u.fragmentError} on frag buffered`),u.fragmentError=0)}this.state=X.IDLE,a&&(!this.loadedmetadata&&e.type==Oe.MAIN&&a.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((o=this.fragPrevious)==null?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:s}=e,o=!s||s.length===0||s.some(l=>!l),a=new g1(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var s;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=X.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(c=>{if(!this.fragContextChanged(c.frag))return this.hls.trigger(S.KEY_LOADED,c),this.state===X.KEY_LOADING&&(this.state=X.IDLE),c}),this.hls.trigger(S.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const c=o.partList;if(c&&r){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const h=this.getNextPart(c,e,n);if(h>-1){const f=c[h];this.log(`Loading part sn: ${e.sn} p: ${f.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${h}-${c.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=f.start+f.duration,this.state=X.FRAG_LOADING;let d;return a?d=a.then(p=>!p||this.fragContextChanged(p.frag)?null:this.doFragPartsLoad(e,f,t,r)).catch(p=>this.handleFragLoadError(p)):d=this.doFragPartsLoad(e,f,t,r).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(S.FRAG_LOADING,{frag:e,part:f,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):d}else if(!e.url||this.loadedEndOfParts(c,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),ae(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=X.FRAG_LOADING;const l=this.config.progressive;let u;return l&&a?u=a.then(c=>!c||this.fragContextChanged(c==null?void 0:c.frag)?null:this.fragmentLoader.load(e,r)).catch(c=>this.handleFragLoadError(c)):u=Promise.all([this.fragmentLoader.load(e,l?r:void 0),a]).then(([c])=>(!l&&c&&r&&r(c),c)).catch(c=>this.handleFragLoadError(c)),this.hls.trigger(S.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,n,r){return new Promise((s,o)=>{var a;const l=[],u=(a=n.details)==null?void 0:a.partList,c=h=>{this.fragmentLoader.loadPart(e,h,r).then(f=>{l[h.index]=f;const d=f.part;this.hls.trigger(S.FRAG_LOADED,f);const p=gE(n,e.sn,h.index+1)||jR(u,e.sn,h.index+1);if(p)c(p);else return s({frag:e,part:d,partsLoaded:l})}).catch(o)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Q.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(S.ERROR,t)}else this.hls.trigger(S.ERROR,{type:be.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==X.PARSING){!this.fragCurrent&&this.state!==X.STOPPED&&this.state!==X.ERROR&&(this.state=X.IDLE);return}const{frag:n,part:r,level:s}=t,o=self.performance.now();n.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(n,r,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:s,part:o}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${r}. The current chunk will not be buffered.`),null;const a=t[r],l=o>-1?gE(a,s,o):null,u=l?l.fragment:wW(a,s,n);return u?(n&&n!==u&&(u.stats=n.stats),{frag:u,part:l,level:a}):null}bufferFragmentData(e,t,n,r,s){var o;if(!e||this.state!==X.PARSING)return;const{data1:a,data2:l}=e;let u=a;if(a&&l&&(u=pn(a,l)),!((o=u)!=null&&o.length))return;const c={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:u};if(this.hls.trigger(S.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!tt.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,r=tt.bufferInfo(t,n,0),s=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),a=Math.max(Math.min(e.start-o,r.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return ae(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:r}}=this,s=tt.bufferInfo(e,t,r);if(s.len===0&&s.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&s.nextStart<o.end)return tt.bufferInfo(e,t,Math.max(s.nextStart,r))}return s}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,r=Math.max(Math.min(e-t,n.maxBufferLength),t),s=Math.max(e-t*3,n.maxMaxBufferLength/2,r);return s>=r?(n.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=Oe.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,Oe.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:s}=this,o=n[0].start;let a;if(t.live){const l=s.initialLiveManifestSize;if(r<l)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${l})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){const l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Vt.OK||n===Vt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,s){const o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(a===null)return a;if(e=a,o&&e&&!e.gap&&n.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r);if(l!==null&&n.len+l.len>=s)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,s=!1,o=!0;for(let a=0,l=e.length;a<l;a++){const u=e[a];if(o=o&&!u.independent,r>-1&&n<u.start)break;const c=u.loaded;c?r=-1:(s||u.independent||o)&&u.fragment===t&&(r=a),s=c}return r}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=CW(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];n.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=RW(t,n.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:s}=this,{fragments:o,endSN:a}=n;const{fragmentHint:l}=n,{maxFragLookUpTolerance:u}=r,c=n.partList,h=!!(r.lowLatencyMode&&c!=null&&c.length&&l);h&&l&&!this.bitrateTest&&(o=o.concat(l),a=l.sn);let f;if(e<t){const d=e>t-u?0:u;f=Od(s,o,e,d)}else f=o[o.length-1];if(f){const d=f.sn-n.startSN,p=this.fragmentTracker.getState(f);if((p===Vt.OK||p===Vt.PARTIAL&&f.gap)&&(s=f),s&&f.sn===s.sn&&(!h||c[0].fragment.sn>f.sn)&&s&&f.level===s.level){const m=o[d+1];f.sn<a&&this.fragmentTracker.getState(m)!==Vt.OK?f=m:f=null}}return f}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,s=n.currentTime,o=e.fragments[0].start,a=e.edge,l=s>=o-t.maxFragLookUpTolerance&&s<=a;if(r!==null&&n.duration>r&&(s<r||!l)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<a-u)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${r.toFixed(3)}`),n.currentTime=r))}}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragments[0].start,o=!t,a=e.alignedSliding&&ae(s);if(o||!a&&!s){const{fragPrevious:l}=this;qW(l,n,e);const u=e.fragments[0].start;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${l?l.sn:"na"} fragments: ${r}`),u}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const r=this.startTimeOffset!==null,s=r?this.startTimeOffset:e.startTimeOffset;s!==null&&ae(s)?(n=t+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${s} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==X.FRAG_LOADING_WAITING_RETRY)&&(this.state=X.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const c=this.getCurrentContext(t.chunkMeta);c&&(t.frag=c.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var r;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}const s=t.details===Q.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:a,retryCount:l=0,retryConfig:u}=o||{};if(o&&a===Xt.RetryRequest&&u){this.resetStartWhenNotLoaded(this.levelLastLoaded);const c=d1(u,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${u.maxNumRetry} in ${c}ms`),o.resolved=!0,this.retryDate=self.performance.now()+c,this.state=X.FRAG_LOADING_WAITING_RETRY}else if(u&&o)if(this.resetFragmentErrors(e),l<u.maxNumRetry)!s&&a!==Xt.RemoveAlternatePermanently&&(o.resolved=!0);else{M.warn(`${t.details} reached or exceeded max retry (${l})`);return}else(o==null?void 0:o.action)===Xt.SendAlternateToPenaltyBox?this.state=X.WAITING_LEVEL:this.state=X.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===X.PARSING||this.state===X.PARSED){const t=e.frag,n=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,n),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len,(t==null?void 0:t.duration)||10);const o=!s;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===Oe.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==X.STOPPED&&(this.state=X.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const r=tt.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===X.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=X.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){var s;const o=n.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,u)=>{const c=e.elementaryStreams[u];if(c){const h=c.endPTS-c.startPTS;if(h<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${h})`),l||!1;const f=r?0:VR(o,e,c.startPTS,c.endPTS,c.startDTS,c.endDTS);return this.hls.trigger(S.LEVEL_PTS_UPDATED,{details:o,level:n,drift:f,type:u,frag:e,start:c.startPTS,end:c.endPTS}),!0}return l},!1)&&((s=this.transmuxer)==null?void 0:s.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=X.PARSED,this.hls.trigger(S.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class WR{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=sq(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function sq(i,e){const t=new Uint8Array(e);let n=0;for(let r=0;r<i.length;r++){const s=i[r];t.set(s,n),n+=s.length}return t}function oq(){return typeof __HLS_WORKER_BUNDLE__=="function"}function aq(){const i=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(i);return{worker:new self.Worker(e),objectURL:e}}function lq(i){const e=new self.URL(i,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function nr(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class O1{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=pn(this.cachedData,e),this.cachedData=null);let n=wu(e,0),r=n?n.length:0,s;const o=this._audioTrack,a=this._id3Track,l=n?f1(n):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&ae(l))&&(this.basePTS=uq(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Mn.audioId3,duration:Number.POSITIVE_INFINITY});r<u;){if(this.canParse(e,r)){const c=this.appendFrame(o,e,r);c?(this.frameIndex++,this.lastPTS=c.sample.pts,r+=c.length,s=r):r=u}else Pz(e,r)?(n=wu(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Mn.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,s=r):r++;if(r===u&&s!==u){const c=ao(e,s);this.cachedData?this.cachedData=pn(this.cachedData,c):this.cachedData=c}}return{audioTrack:o,videoTrack:nr(),id3Track:a,textTrack:nr()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:nr(),id3Track:this._id3Track,textTrack:nr()}}destroy(){}}const uq=(i,e,t)=>{if(ae(i))return i*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function cq(i,e,t,n){let r,s,o,a;const l=navigator.userAgent.toLowerCase(),u=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=((e[t+2]&192)>>>6)+1;const h=(e[t+2]&60)>>>2;if(h>c.length-1){const f=new Error(`invalid ADTS sampling index:${h}`);i.emit(S.ERROR,S.ERROR,{type:be.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!0,error:f,reason:f.message});return}return o=(e[t+2]&1)<<2,o|=(e[t+3]&192)>>>6,M.log(`manifest codec:${n}, ADTS type:${r}, samplingIndex:${h}`),/firefox/i.test(l)?h>=6?(r=5,a=new Array(4),s=h-3):(r=2,a=new Array(2),s=h):l.indexOf("android")!==-1?(r=2,a=new Array(2),s=h):(r=5,a=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&h>=6?s=h-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(h>=6&&o===1||/vivaldi/i.test(l))||!n&&o===1)&&(r=2,a=new Array(2)),s=h)),a[0]=r<<3,a[0]|=(h&14)>>1,a[1]|=(h&1)<<7,a[1]|=o<<3,r===5&&(a[1]|=(s&14)>>1,a[2]=(s&1)<<7,a[2]|=8,a[3]=0),{config:a,samplerate:c[h],channelCount:o,codec:"mp4a.40."+r,manifestCodec:u}}function qR(i,e){return i[e]===255&&(i[e+1]&246)===240}function YR(i,e){return i[e+1]&1?7:9}function y1(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function hq(i,e){return e+5<i.length}function bd(i,e){return e+1<i.length&&qR(i,e)}function fq(i,e){return hq(i,e)&&qR(i,e)&&y1(i,e)<=i.length-e}function dq(i,e){if(bd(i,e)){const t=YR(i,e);if(e+t>=i.length)return!1;const n=y1(i,e);if(n<=t)return!1;const r=e+n;return r===i.length||bd(i,r)}return!1}function KR(i,e,t,n,r){if(!i.samplerate){const s=cq(e,t,n,r);if(!s)return;i.config=s.config,i.samplerate=s.samplerate,i.channelCount=s.channelCount,i.codec=s.codec,i.manifestCodec=s.manifestCodec,M.log(`parsed codec:${i.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function JR(i){return 1024*9e4/i}function pq(i,e){const t=YR(i,e);if(e+t<=i.length){const n=y1(i,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function eL(i,e,t,n,r){const s=JR(i.samplerate),o=n+r*s,a=pq(e,t);let l;if(a){const{frameLength:h,headerLength:f}=a,d=f+h,p=Math.max(0,t+d-e.length);p?(l=new Uint8Array(d-f),l.set(e.subarray(t+f,e.length),0)):l=e.subarray(t+f,t+d);const g={unit:l,pts:o};return p||i.samples.push(g),{sample:g,length:d,missing:p}}const u=e.length-t;return l=new Uint8Array(u),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:u,missing:-1}}let gh=null;const gq=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],mq=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],vq=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Oq=[0,1,1,4];function tL(i,e,t,n,r){if(t+24>e.length)return;const s=iL(e,t);if(s&&t+s.frameLength<=e.length){const o=s.samplesPerFrame*9e4/s.sampleRate,a=n+r*o,l={unit:e.subarray(t,t+s.frameLength),pts:a,dts:a};return i.config=[],i.channelCount=s.channelCount,i.samplerate=s.sampleRate,i.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function iL(i,e){const t=i[e+1]>>3&3,n=i[e+1]>>1&3,r=i[e+2]>>4&15,s=i[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&s!==3){const o=i[e+2]>>1&1,a=i[e+3]>>6,l=t===3?3-n:n===3?3:4,u=gq[l*14+r-1]*1e3,h=mq[(t===3?0:t===2?1:2)*3+s],f=a===3?1:2,d=vq[t][n],p=Oq[n],g=d*8*p,m=Math.floor(d*u/h+o)*p;if(gh===null){const y=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);gh=y?parseInt(y[1]):0}return!!gh&&gh<=87&&n===2&&u>=224e3&&a===0&&(i[e+3]=i[e+3]|128),{sampleRate:h,channelCount:f,frameLength:m,samplesPerFrame:g}}}function b1(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function nL(i,e){return e+1<i.length&&b1(i,e)}function yq(i,e){return b1(i,e)&&4<=i.length-e}function rL(i,e){if(e+1<i.length&&b1(i,e)){const n=iL(i,e);let r=4;n!=null&&n.frameLength&&(r=n.frameLength);const s=e+r;return s===i.length||nL(i,s)}return!1}class bq extends O1{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=wu(e,0);let n=(t==null?void 0:t.length)||0;if(rL(e,n))return!1;for(let r=e.length;n<r;n++)if(dq(e,n))return M.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return fq(e,t)}appendFrame(e,t,n){KR(e,this.observer,t,n,e.manifestCodec);const r=eL(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const xq=/\/emsg[-/]ID3/i;class Sq{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const s=this.videoTrack=nr("video",1),o=this.audioTrack=nr("audio",1),a=this.txtTrack=nr("text",1);if(this.id3Track=nr("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=DR(e);if(l.video){const{id:u,timescale:c,codec:h}=l.video;s.id=u,s.timescale=a.timescale=c,s.codec=h}if(l.audio){const{id:u,timescale:c,codec:h}=l.audio;o.id=u,o.timescale=c,o.codec=h}a.id=RR.text,s.sampleDuration=0,s.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return Qz(e)}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=pn(this.remainderData,e));const a=Xz(n);this.remainderData=a.remainder,r.samples=a.valid||new Uint8Array}else r.samples=n;const o=this.extractID3Track(r,t);return s.samples=qT(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=qT(e,t),{videoTrack:t,audioTrack:nr(),id3Track:r,textTrack:nr()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=Pe(e.samples,["emsg"]);r&&r.forEach(s=>{const o=qz(s);if(xq.test(o.schemeIdUri)){const a=ae(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=o.payload;n.samples.push({data:u,len:u.byteLength,dts:a,pts:a,type:Mn.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const sL=(i,e)=>{let t=0,n=5;e+=n;const r=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=i[e];const a=Math.min(n,8),l=8-a;s[0]=4278190080>>>24+l<<l,r[0]=(o[0]&s[0])>>l,t=t?t<<a|r[0]:r[0],e+=1,n-=a}return t};class kq extends O1{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const r=oL(e,t,n,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=wu(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&f1(t)!==void 0&&sL(e,n)<16}}function oL(i,e,t,n,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],l=e[t+4]&63,c=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(t+c>e.length)return-1;const h=e[t+6]>>5;let f=0;h===2?f+=2:(h&1&&h!==1&&(f+=2),h&4&&(f+=2));const d=(e[t+6]<<8|e[t+7])>>12-f&1,g=[2,1,2,3,3,4,4,5][h]+d,m=e[t+5]>>3,v=e[t+5]&7,O=new Uint8Array([s<<6|m<<1|v>>2,(v&3)<<6|h<<3|d<<2|l>>4,l<<4&224]),y=1536/a*9e4,x=n+r*y,b=e.subarray(t,t+c);return i.config=O,i.channelCount=g,i.samplerate=a,i.samples.push({unit:b,pts:x}),c}class Tq{constructor(){this.VideoSample=null}createVideoSample(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const s=n.units;r=s[s.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,r=n.length;if(r){const s=n[r-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&M.log(e.pts+"/"+e.dts+":"+e.debug)}}class TE{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");r.set(e.subarray(n,n+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&M.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,r;for(let s=0;s<e;s++)n!==0&&(r=this.readEG(),n=(t+r+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,r=0,s,o,a;const l=this.readUByte.bind(this),u=this.readBits.bind(this),c=this.readUEG.bind(this),h=this.readBoolean.bind(this),f=this.skipBits.bind(this),d=this.skipEG.bind(this),p=this.skipUEG.bind(this),g=this.skipScalingList.bind(this);l();const m=l();if(u(5),f(3),l(),p(),m===100||m===110||m===122||m===244||m===44||m===83||m===86||m===118||m===128){const E=c();if(E===3&&f(1),p(),p(),f(1),h())for(o=E!==3?8:12,a=0;a<o;a++)h()&&(a<6?g(16):g(64))}p();const v=c();if(v===0)c();else if(v===1)for(f(1),d(),d(),s=c(),a=0;a<s;a++)d();p(),f(1);const O=c(),y=c(),x=u(1);x===0&&f(1),f(1),h()&&(e=c(),t=c(),n=c(),r=c());let b=[1,1];if(h()&&h())switch(l()){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:{b=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((O+1)*16-e*2-t*2),height:(2-x)*(y+1)*16-(x?2:4)*(n+r),pixelRatio:b}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Eq extends Tq{parseAVCPES(e,t,n,r,s){const o=this.parseAVCNALu(e,n.data);let a=this.VideoSample,l,u=!1;n.data=null,a&&o.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),o.forEach(c=>{var h;switch(c.type){case 1:{let g=!1;l=!0;const m=c.data;if(u&&m.length>4){const v=new TE(m).readSliceType();(v===2||v===4||v===7||v===9)&&(g=!0)}if(g){var f;(f=a)!=null&&f.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.frame=!0,a.key=g;break}case 5:l=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:{l=!0,MR(c.data,1,n.pts,t.samples);break}case 7:{var d,p;l=!0,u=!0;const g=c.data,v=new TE(g).readSPS();if(!e.sps||e.width!==v.width||e.height!==v.height||((d=e.pixelRatio)==null?void 0:d[0])!==v.pixelRatio[0]||((p=e.pixelRatio)==null?void 0:p[1])!==v.pixelRatio[1]){e.width=v.width,e.height=v.height,e.pixelRatio=v.pixelRatio,e.sps=[g],e.duration=s;const O=g.subarray(1,4);let y="avc1.";for(let x=0;x<3;x++){let b=O[x].toString(16);b.length<2&&(b="0"+b),y+=b}e.codec=y}break}case 8:l=!0,e.pps=[c.data];break;case 9:l=!0,e.audFound=!0,a&&this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:l=!0;break;default:l=!1,a&&(a.debug+="unknown NAL "+c.type+" ");break}a&&l&&a.units.push(c)}),r&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let r=e.naluState||0;const s=r,o=[];let a=0,l,u,c,h=-1,f=0;for(r===-1&&(h=0,f=t[0]&31,r=0,a=1);a<n;){if(l=t[a++],!r){r=l?0:1;continue}if(r===1){r=l?0:2;continue}if(!l)r=3;else if(l===1){if(u=a-r-1,h>=0){const d={data:t.subarray(h,u),type:f};o.push(d)}else{const d=this.getLastNalUnit(e.samples);d&&(s&&a<=4-s&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-s)),u>0&&(d.data=pn(d.data,t.subarray(0,u)),d.state=0))}a<n?(c=t[a]&31,h=a,f=c,r=0):r=-1}else r=0}if(h>=0&&r>=0){const d={data:t.subarray(h,n),type:f,state:r};o.push(d)}if(o.length===0){const d=this.getLastNalUnit(e.samples);d&&(d.data=pn(d.data,t))}return e.naluState=r,o}}class wq{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new m1(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);r.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)n.set(e.subarray(s,s+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(n.subarray(r,r+16),s);return e}decryptAvcSample(e,t,n,r,s){const o=FR(s.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)})}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){r();return}const s=e[t].units;for(;!(n>=s.length);n++){const o=s[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,r,o),!this.decrypter.isSync()))return}}}}const Nt=188;class ns{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new Eq}static probe(e){const t=ns.syncOffset(e);return t>0&&M.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let n=Math.min(Nt*5,t-Nt)+1,r=0;for(;r<n;){let s=!1,o=-1,a=0;for(let l=r;l<t;l+=Nt)if(e[l]===71&&(t-l===Nt||e[l+Nt]===71)){if(a++,o===-1&&(o=l,o!==0&&(n=Math.min(o+Nt*99,e.length-Nt)+1)),s||(s=Tv(e,l)===0),s&&a>1&&(o===0&&a>2||l+Nt>n))return o}else{if(a)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:RR[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ns.createTrack("video"),this._audioTrack=ns.createTrack("audio",r),this._id3Track=ns.createTrack("id3"),this._txtTrack=ns.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){n||(this.sampleAes=null);let s;const o=this._videoTrack,a=this._audioTrack,l=this._id3Track,u=this._txtTrack;let c=o.pid,h=o.pesData,f=a.pid,d=l.pid,p=a.pesData,g=l.pesData,m=null,v=this.pmtParsed,O=this._pmtId,y=e.length;if(this.remainderData&&(e=pn(this.remainderData,e),y=e.length,this.remainderData=null),y<Nt&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:u};const x=Math.max(0,ns.syncOffset(e));y-=(y-x)%Nt,y<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let b=0;for(let T=x;T<y;T+=Nt)if(e[T]===71){const _=!!(e[T+1]&64),D=Tv(e,T),A=(e[T+3]&48)>>4;let I;if(A>1){if(I=T+5+e[T+4],I===T+Nt)continue}else I=T+4;switch(D){case c:_&&(h&&(s=Go(h))&&this.videoParser.parseAVCPES(o,u,s,!1,this._duration),h={data:[],size:0}),h&&(h.data.push(e.subarray(I,T+Nt)),h.size+=T+Nt-I);break;case f:if(_){if(p&&(s=Go(p)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,s);break;case"mp3":this.parseMPEGPES(a,s);break;case"ac3":this.parseAC3PES(a,s);break}p={data:[],size:0}}p&&(p.data.push(e.subarray(I,T+Nt)),p.size+=T+Nt-I);break;case d:_&&(g&&(s=Go(g))&&this.parseID3PES(l,s),g={data:[],size:0}),g&&(g.data.push(e.subarray(I,T+Nt)),g.size+=T+Nt-I);break;case 0:_&&(I+=e[I]+1),O=this._pmtId=_q(e,I);break;case O:{_&&(I+=e[I]+1);const L=Cq(e,I,this.typeSupported,n,this.observer);c=L.videoPid,c>0&&(o.pid=c,o.segmentCodec=L.segmentVideoCodec),f=L.audioPid,f>0&&(a.pid=f,a.segmentCodec=L.segmentAudioCodec),d=L.id3Pid,d>0&&(l.pid=d),m!==null&&!v&&(M.warn(`MPEG-TS PMT found at ${T} after unknown PID '${m}'. Backtracking to sync byte @${x} to parse all TS packets.`),m=null,T=x-188),v=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=D;break}}else b++;b>0&&xd(this.observer,new Error(`Found ${b} TS packet/s that do not start with 0x47`)),o.pesData=h,a.pesData=p,l.pesData=g;const E={audioTrack:a,videoTrack:o,id3Track:l,textTrack:u};return r&&this.extractRemainingSamples(E),E}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:s}=e,o=n.pesData,a=t.pesData,l=r.pesData;let u;if(o&&(u=Go(o))?(this.videoParser.parseAVCPES(n,s,u,!0,this._duration),n.pesData=null):n.pesData=o,a&&(u=Go(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else a!=null&&a.size&&M.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(u=Go(l))?(this.parseID3PES(r,u),r.pesData=null):r.pesData=l}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new wq(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let s=t.data;if(r){this.aacOverFlow=null;const h=r.missing,f=r.sample.unit.byteLength;if(h===-1)s=pn(r.sample.unit,s);else{const d=f-h;r.sample.unit.set(s.subarray(0,h),d),e.samples.push(r.sample),n=r.missing}}let o,a;for(o=n,a=s.length;o<a-1&&!bd(s,o);o++);if(o!==n){let h;const f=o<a-1;if(f?h=`AAC PES did not start with ADTS header,offset:${o}`:h="No ADTS header found in AAC PES",xd(this.observer,new Error(h),f),!f)return}KR(e,this.observer,s,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(r){const h=JR(e.samplerate);l=r.sample.pts+h}else{M.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,c;for(;o<a;)if(c=eL(e,s,o,l,u),o+=c.length,c.missing){this.aacOverFlow=c;break}else for(u++;o<a-1&&!bd(s,o);o++);}parseMPEGPES(e,t){const n=t.data,r=n.length;let s=0,o=0;const a=t.pts;if(a===void 0){M.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<r;)if(nL(n,o)){const l=tL(e,n,o,a,s);if(l)o+=l.length,s++;else break}else o++}parseAC3PES(e,t){{const n=t.data,r=t.pts;if(r===void 0){M.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=n.length;let o=0,a=0,l;for(;a<s&&(l=oL(e,n,a,r,o++))>0;)a+=l}}parseID3PES(e,t){if(t.pts===void 0){M.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=At({},t,{type:this._videoTrack?Mn.emsg:Mn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Tv(i,e){return((i[e+1]&31)<<8)+i[e+2]}function _q(i,e){return(i[e+10]&31)<<8|i[e+11]}function Cq(i,e,t,n,r){const s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(i[e+1]&15)<<8|i[e+2],a=e+3+o-4,l=(i[e+10]&15)<<8|i[e+11];for(e+=12+l;e<a;){const u=Tv(i,e),c=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!n){E0("ADTS AAC");break}case 15:s.audioPid===-1&&(s.audioPid=u);break;case 21:s.id3Pid===-1&&(s.id3Pid=u);break;case 219:if(!n){E0("H.264");break}case 27:s.videoPid===-1&&(s.videoPid=u,s.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?M.log("MPEG audio found, not supported in this browser"):s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="mp3");break;case 193:if(!n){E0("AC-3");break}case 129:t.ac3?s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="ac3"):M.log("AC-3 audio found, not supported in this browser");break;case 6:if(s.audioPid===-1&&c>0){let h=e+5,f=c;for(;f>2;){switch(i[h]){case 106:t.ac3!==!0?M.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=u,s.segmentAudioCodec="ac3");break}const p=i[h+1]+2;h+=p,f-=p}}break;case 194:case 135:return xd(r,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return xd(r,new Error("Unsupported HEVC in M2TS found")),s}e+=c+5}return s}function xd(i,e,t){M.warn(`parsing error: ${e.message}`),i.emit(S.ERROR,S.ERROR,{type:be.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function E0(i){M.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function Go(i){let e=0,t,n,r,s,o;const a=i.data;if(!i||i.size===0)return null;for(;a[0].length<19&&a.length>1;)a[0]=pn(a[0],a[1]),a.splice(1,1);if(t=a[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>i.size-6)return null;const u=t[7];u&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,u&64?(o=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-o>60*9e4&&(M.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),r=t[8];let c=r+9;if(i.size<=c)return null;i.size-=c;const h=new Uint8Array(i.size);for(let f=0,d=a.length;f<d;f++){t=a[f];let p=t.byteLength;if(c)if(c>p){c-=p;continue}else t=t.subarray(c),p-=c,c=0;h.set(t,e),e+=p}return n&&(n-=r+3),{data:h,pts:s,dts:o,len:n}}return null}class Aq extends O1{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=wu(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&f1(t)!==void 0&&sL(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if(rL(e,n))return M.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return yq(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return tL(e,t,n,this.basePTS,this.frameIndex)}}class EE{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Wr=Math.pow(2,32)-1;class F{static init(){F.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in F.types)F.types.hasOwnProperty(e)&&(F.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);F.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);F.STTS=F.STSC=F.STCO=s,F.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),F.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),F.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),F.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);F.FTYP=F.box(F.types.ftyp,o,l,o,a),F.DINF=F.box(F.types.dinf,F.box(F.types.dref,r))}static box(e,...t){let n=8,r=t.length;const s=r;for(;r--;)n+=t[r].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(e,4),r=0,n=8;r<s;r++)o.set(t[r],n),n+=t[r].byteLength;return o}static hdlr(e){return F.box(F.types.hdlr,F.HDLR_TYPES[e])}static mdat(e){return F.box(F.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Wr+1)),r=Math.floor(t%(Wr+1));return F.box(F.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return F.box(F.types.mdia,F.mdhd(e.timescale,e.duration),F.hdlr(e.type),F.minf(e))}static mfhd(e){return F.box(F.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?F.box(F.types.minf,F.box(F.types.smhd,F.SMHD),F.DINF,F.stbl(e)):F.box(F.types.minf,F.box(F.types.vmhd,F.VMHD),F.DINF,F.stbl(e))}static moof(e,t,n){return F.box(F.types.moof,F.mfhd(e),F.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=F.trak(e[t]);return F.box.apply(null,[F.types.moov,F.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(F.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=F.trex(e[t]);return F.box.apply(null,[F.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Wr+1)),r=Math.floor(t%(Wr+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return F.box(F.types.mvhd,s)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,s;for(r=0;r<t.length;r++)s=t[r].flags,n[r+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return F.box(F.types.sdtp,n)}static stbl(e){return F.box(F.types.stbl,F.stsd(e),F.box(F.types.stts,F.STTS),F.box(F.types.stsc,F.STSC),F.box(F.types.stsz,F.STSZ),F.box(F.types.stco,F.STCO))}static avc1(e){let t=[],n=[],r,s,o;for(r=0;r<e.sps.length;r++)s=e.sps[r],o=s.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(s));for(r=0;r<e.pps.length;r++)s=e.pps[r],o=s.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(s));const a=F.box(F.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,u=e.height,c=e.pixelRatio[0],h=e.pixelRatio[1];return F.box(F.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,F.box(F.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),F.box(F.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,h>>24,h>>16&255,h>>8&255,h&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return F.box(F.types.mp4a,F.audioStsd(e),F.box(F.types.esds,F.esds(e)))}static mp3(e){return F.box(F.types[".mp3"],F.audioStsd(e))}static ac3(e){return F.box(F.types["ac-3"],F.audioStsd(e),F.box(F.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?F.box(F.types.stsd,F.STSD,F.mp3(e)):e.segmentCodec==="ac3"?F.box(F.types.stsd,F.STSD,F.ac3(e)):F.box(F.types.stsd,F.STSD,F.mp4a(e)):F.box(F.types.stsd,F.STSD,F.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,r=e.width,s=e.height,o=Math.floor(n/(Wr+1)),a=Math.floor(n%(Wr+1));return F.box(F.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const n=F.sdtp(e),r=e.id,s=Math.floor(t/(Wr+1)),o=Math.floor(t%(Wr+1));return F.box(F.types.traf,F.box(F.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),F.box(F.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),F.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,F.box(F.types.trak,F.tkhd(e),F.mdia(e))}static trex(e){const t=e.id;return F.box(F.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,s=12+16*r,o=new Uint8Array(s);let a,l,u,c,h,f;for(t+=8+s,o.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<r;a++)l=n[a],u=l.duration,c=l.size,h=l.flags,f=l.cts,o.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,h.degradPrio&61440,h.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*a);return F.box(F.types.trun,o)}static initSegment(e){F.types||F.init();const t=F.moov(e);return pn(F.FTYP,t)}}F.types=void 0;F.HDLR_TYPES=void 0;F.STTS=void 0;F.STSC=void 0;F.STCO=void 0;F.STSZ=void 0;F.VMHD=void 0;F.SMHD=void 0;F.STSD=void 0;F.FTYP=void 0;F.DINF=void 0;const aL=9e4;function x1(i,e,t=1,n=!1){const r=i*e*t;return n?Math.round(r):r}function Pq(i,e,t=1,n=!1){return x1(i,e,1/t,n)}function Rl(i,e=!1){return x1(i,1e3,1/aL,e)}function Rq(i,e=1){return x1(i,aL,1/e)}const Lq=10*1e3,wE=1024,Iq=1152,Dq=1536;let Ho=null,w0=null;class gf{constructor(e,t,n,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,Ho===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ho=o?parseInt(o[1]):0}if(w0===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);w0=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){M.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){M.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){M.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,r=e.reduce((s,o)=>{let a=o.pts,l=a-s;return l<-4294967296&&(t=!0,a=tn(a,n),l=a-s),l>0?s:a},n);return t&&M.debug("PTS rollover detected"),r}remux(e,t,n,r,s,o,a,l){let u,c,h,f,d,p,g=s,m=s;const v=e.pid>-1,O=t.pid>-1,y=t.samples.length,x=e.samples.length>0,b=a&&y>0||y>1;if((!v||x)&&(!O||b)||this.ISGenerated||a){if(this.ISGenerated){var T,_,D,A;const B=this.videoTrackConfig;B&&(t.width!==B.width||t.height!==B.height||((T=t.pixelRatio)==null?void 0:T[0])!==((_=B.pixelRatio)==null?void 0:_[0])||((D=t.pixelRatio)==null?void 0:D[1])!==((A=B.pixelRatio)==null?void 0:A[1]))&&this.resetInitSegment()}else h=this.generateIS(e,t,s,o);const I=this.isVideoContiguous;let L=-1,$;if(b&&(L=$q(t.samples),!I&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,L>0){M.warn(`[mp4-remuxer]: Dropped ${L} out of ${y} video samples due to a missing keyframe`);const B=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(L),t.dropped+=L,m+=(t.samples[0].pts-B)/t.inputTimeScale,$=m}else L===-1&&(M.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),p=!1);if(this.ISGenerated){if(x&&b){const B=this.getVideoStartPts(t.samples),j=(tn(e.samples[0].pts,B)-B)/t.inputTimeScale;g+=Math.max(0,j),m+=Math.max(0,-j)}if(x){if(e.samplerate||(M.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(e,t,s,o)),c=this.remuxAudio(e,g,this.isAudioContiguous,o,O||b||l===Oe.AUDIO?m:void 0),b){const B=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(M.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(e,t,s,o)),u=this.remuxVideo(t,m,I,B)}}else b&&(u=this.remuxVideo(t,m,I,0));u&&(u.firstKeyFrame=L,u.independent=L!==-1,u.firstKeyFramePTS=$)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(d=lL(n,s,this._initPTS,this._initDTS)),r.samples.length&&(f=uL(r,s,this._initPTS))),{audio:c,video:u,initSegment:h,independent:p,text:f,id3:d}}generateIS(e,t,n,r){const s=e.samples,o=t.samples,a=this.typeSupported,l={},u=this._initPTS;let c=!u||r,h="audio/mp4",f,d,p;if(c&&(f=d=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(h="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:h,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):F.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(p=e.inputTimeScale,!u||p!==u.timescale?f=d=s[0].pts-Math.round(p*n):c=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:F.initSegment([t]),metadata:{width:t.width,height:t.height}},c)if(p=t.inputTimeScale,!u||p!==u.timescale){const g=this.getVideoStartPts(o),m=Math.round(p*n);d=Math.min(d,tn(o[0].dts,g)-m),f=Math.min(f,g-m)}else c=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:f,timescale:p},this._initDTS={baseTime:d,timescale:p}):f=p=void 0,{tracks:l,initPTS:f,timescale:p}}remuxVideo(e,t,n,r){const s=e.inputTimeScale,o=e.samples,a=[],l=o.length,u=this._initPTS;let c=this.nextAvcDts,h=8,f=this.videoSampleDuration,d,p,g=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,v=!1;if(!n||c===null){const z=t*s,W=o[0].pts-tn(o[0].dts,o[0].pts);Ho&&c!==null&&Math.abs(z-W-c)<15e3?n=!0:c=z-W}const O=u.baseTime*s/u.timescale;for(let z=0;z<l;z++){const W=o[z];W.pts=tn(W.pts-O,c),W.dts=tn(W.dts-O,c),W.dts<o[z>0?z-1:z].dts&&(v=!0)}v&&o.sort(function(z,W){const he=z.dts-W.dts,se=z.pts-W.pts;return he||se}),d=o[0].dts,p=o[o.length-1].dts;const y=p-d,x=y?Math.round(y/(l-1)):f||e.inputTimeScale/30;if(n){const z=d-c,W=z>x,he=z<-1;if((W||he)&&(W?M.warn(`AVC: ${Rl(z,!0)} ms (${z}dts) hole between fragments detected at ${t.toFixed(3)}`):M.warn(`AVC: ${Rl(-z,!0)} ms (${z}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!he||c>=o[0].pts||Ho)){d=c;const se=o[0].pts-z;if(W)o[0].dts=d,o[0].pts=se;else for(let oe=0;oe<o.length&&!(o[oe].dts>se);oe++)o[oe].dts-=z,o[oe].pts-=z;M.log(`Video: Initial PTS/DTS adjusted: ${Rl(se,!0)}/${Rl(d,!0)}, delta: ${Rl(z,!0)} ms`)}}d=Math.max(0,d);let b=0,E=0,T=d;for(let z=0;z<l;z++){const W=o[z],he=W.units,se=he.length;let oe=0;for(let Se=0;Se<se;Se++)oe+=he[Se].data.length;E+=oe,b+=se,W.length=oe,W.dts<T?(W.dts=T,T+=x/4|0||1):T=W.dts,g=Math.min(W.pts,g),m=Math.max(W.pts,m)}p=o[l-1].dts;const _=E+4*b+8;let D;try{D=new Uint8Array(_)}catch(z){this.observer.emit(S.ERROR,S.ERROR,{type:be.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:z,bytes:_,reason:`fail allocating video mdat ${_}`});return}const A=new DataView(D.buffer);A.setUint32(0,_),D.set(F.types.mdat,4);let I=!1,L=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,B=Number.NEGATIVE_INFINITY,Z=Number.NEGATIVE_INFINITY;for(let z=0;z<l;z++){const W=o[z],he=W.units;let se=0;for(let $e=0,Ke=he.length;$e<Ke;$e++){const kt=he[$e],Ai=kt.data,jr=kt.data.byteLength;A.setUint32(h,jr),h+=4,D.set(Ai,h),h+=jr,se+=4+jr}let oe;if(z<l-1)f=o[z+1].dts-W.dts,oe=o[z+1].pts-W.pts;else{const $e=this.config,Ke=z>0?W.dts-o[z-1].dts:x;if(oe=z>0?W.pts-o[z-1].pts:x,$e.stretchShortVideoTrack&&this.nextAudioPts!==null){const kt=Math.floor($e.maxBufferHole*s),Ai=(r?g+r*s:this.nextAudioPts)-W.pts;Ai>kt?(f=Ai-Ke,f<0?f=Ke:I=!0,M.log(`[mp4-remuxer]: It is approximately ${Ai/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=Ke}else f=Ke}const Se=Math.round(W.pts-W.dts);L=Math.min(L,f),B=Math.max(B,f),$=Math.min($,oe),Z=Math.max(Z,oe),a.push(new _E(W.key,f,se,Se))}if(a.length){if(Ho){if(Ho<70){const z=a[0].flags;z.dependsOn=2,z.isNonSync=0}}else if(w0&&Z-$<B-L&&x/B<.025&&a[0].cts===0){M.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let z=d;for(let W=0,he=a.length;W<he;W++){const se=z+a[W].duration,oe=z+a[W].cts;if(W<he-1){const Se=se+a[W+1].cts;a[W].duration=Se-oe}else a[W].duration=W?a[W-1].duration:x;a[W].cts=0,z=se}}}f=I||!f?x:f,this.nextAvcDts=c=p+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const ne={data1:F.moof(e.sequenceNumber++,d,At({},e,{samples:a})),data2:D,startPTS:g/s,endPTS:(m+f)/s,startDTS:d/s,endDTS:c/s,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ne}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return Iq;case"ac3":return Dq;default:return wE}}remuxAudio(e,t,n,r,s){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,u=this.getSamplesPerFrame(e),c=u*l,h=this._initPTS,f=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,d=[],p=s!==void 0;let g=e.samples,m=f?0:8,v=this.nextAudioPts||-1;const O=t*o,y=h.baseTime*o/h.timescale;if(this.isAudioContiguous=n=n||g.length&&v>0&&(r&&Math.abs(O-v)<9e3||Math.abs(tn(g[0].pts-y,O)-v)<20*c),g.forEach(function(j){j.pts=tn(j.pts-y,O)}),!n||v<0){if(g=g.filter(j=>j.pts>=0),!g.length)return;s===0?v=0:r&&!p?v=Math.max(0,O):v=g[0].pts}if(e.segmentCodec==="aac"){const j=this.config.maxAudioFramesDrift;for(let ie=0,ne=v;ie<g.length;ie++){const z=g[ie],W=z.pts,he=W-ne,se=Math.abs(1e3*he/o);if(he<=-j*c&&p)ie===0&&(M.warn(`Audio frame @ ${(W/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*he/o)} ms.`),this.nextAudioPts=v=ne=W);else if(he>=j*c&&se<Lq&&p){let oe=Math.round(he/c);ne=W-oe*c,ne<0&&(oe--,ne+=c),ie===0&&(this.nextAudioPts=v=ne),M.warn(`[mp4-remuxer]: Injecting ${oe} audio frame @ ${(ne/o).toFixed(3)}s due to ${Math.round(1e3*he/o)} ms gap.`);for(let Se=0;Se<oe;Se++){const $e=Math.max(ne,0);let Ke=EE.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Ke||(M.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ke=z.unit.subarray()),g.splice(ie,0,{unit:Ke,pts:$e}),ne+=c,ie++}}z.pts=ne,ne+=c}}let x=null,b=null,E,T=0,_=g.length;for(;_--;)T+=g[_].unit.byteLength;for(let j=0,ie=g.length;j<ie;j++){const ne=g[j],z=ne.unit;let W=ne.pts;if(b!==null){const se=d[j-1];se.duration=Math.round((W-b)/l)}else if(n&&e.segmentCodec==="aac"&&(W=v),x=W,T>0){T+=m;try{E=new Uint8Array(T)}catch(se){this.observer.emit(S.ERROR,S.ERROR,{type:be.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:se,bytes:T,reason:`fail allocating audio mdat ${T}`});return}f||(new DataView(E.buffer).setUint32(0,T),E.set(F.types.mdat,4))}else return;E.set(z,m);const he=z.byteLength;m+=he,d.push(new _E(!0,u,he,0)),b=W}const D=d.length;if(!D)return;const A=d[d.length-1];this.nextAudioPts=v=b+l*A.duration;const I=f?new Uint8Array(0):F.moof(e.sequenceNumber++,x/l,At({},e,{samples:d}));e.samples=[];const L=x/o,$=v/o,Z={data1:I,data2:E,startPTS:L,endPTS:$,startDTS:L,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:D};return this.isAudioContiguous=!0,Z}remuxEmptyAudio(e,t,n,r){const s=e.inputTimeScale,o=e.samplerate?e.samplerate:s,a=s/o,l=this.nextAudioPts,u=this._initDTS,c=u.baseTime*9e4/u.timescale,h=(l!==null?l:r.startDTS*s)+c,f=r.endDTS*s+c,d=a*wE,p=Math.ceil((f-h)/d),g=EE.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(M.warn("[mp4-remuxer]: remux empty Audio"),!g){M.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const m=[];for(let v=0;v<p;v++){const O=h+v*d;m.push({unit:g,pts:O,dts:O})}return e.samples=m,this.remuxAudio(e,t,n,!1)}}function tn(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function $q(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function lL(i,e,t,n){const r=i.samples.length;if(!r)return;const s=i.inputTimeScale;for(let a=0;a<r;a++){const l=i.samples[a];l.pts=tn(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=tn(l.dts-n.baseTime*s/n.timescale,e*s)/s}const o=i.samples;return i.samples=[],{samples:o}}function uL(i,e,t){const n=i.samples.length;if(!n)return;const r=i.inputTimeScale;for(let o=0;o<n;o++){const a=i.samples[o];a.pts=tn(a.pts-t.baseTime*r/t.timescale,e*r)/r}i.samples.sort((o,a)=>o.pts-a.pts);const s=i.samples;return i.samples=[],{samples:s}}class _E{constructor(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class Mq{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(Vz(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const r=this.initData=DR(e);r.audio&&(t=CE(r.audio,We.AUDIO)),r.video&&(n=CE(r.video,We.VIDEO));const s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:M.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,r,s,o){var a,l;let{initPTS:u,lastEndTime:c}=this;const h={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};ae(c)||(c=this.lastEndTime=s||0);const f=t.samples;if(!(f!=null&&f.length))return h;const d={initPTS:void 0,timescale:1};let p=this.initData;if((a=p)!=null&&a.length||(this.generateInitSegment(f),p=this.initData),!((l=p)!=null&&l.length))return M.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),h;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1);const g=jz(f,p),m=Zz(p,f),v=m===null?s:m;(Fq(u,v,s,g)||d.timescale!==u.timescale&&o)&&(d.initPTS=v-s,u&&u.timescale===1&&M.warn(`Adjusting initPTS by ${d.initPTS-u.baseTime}`),this.initPTS=u={baseTime:d.initPTS,timescale:1});const O=e?v-u.baseTime/u.timescale:c,y=O+g;Hz(p,f,u.baseTime/u.timescale),g>0?this.lastEndTime=y:(M.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const x=!!p.audio,b=!!p.video;let E="";x&&(E+="audio"),b&&(E+="video");const T={data1:f,startPTS:O,startDTS:O,endPTS:y,endDTS:y,type:E,hasAudio:x,hasVideo:b,nb:1,dropped:0};return h.audio=T.type==="audio"?T:void 0,h.video=T.type!=="audio"?T:void 0,h.initSegment=d,h.id3=lL(n,s,u,u),r.samples.length&&(h.text=uL(r,s,u)),h}}function Fq(i,e,t,n){if(i===null)return!0;const r=Math.max(n,1),s=e-i.baseTime/i.timescale;return Math.abs(s-t)>r}function CE(i,e){const t=i==null?void 0:i.codec;if(t&&t.length>4)return t;if(e===We.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return pd(t,!1);const n="mp4a.40.5";return M.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${n}"`),n}return M.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let Pr;try{Pr=self.performance.now.bind(self.performance)}catch{M.debug("Unable to use Performance API on this environment"),Pr=$a==null?void 0:$a.Date.now}const mf=[{demux:Sq,remux:Mq},{demux:ns,remux:gf},{demux:bq,remux:gf},{demux:Aq,remux:gf}];mf.splice(2,0,{demux:kq,remux:gf});class AE{constructor(e,t,n,r,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const s=n.transmuxing;s.executeStart=Pr();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:l}=this;r&&(this.currentTransmuxState=r);const{contiguous:u,discontinuity:c,trackSwitch:h,accurateTimeOffset:f,timeOffset:d,initSegmentChange:p}=r||a,{audioCodec:g,videoCodec:m,defaultInitPts:v,duration:O,initSegmentData:y}=l,x=Nq(o,t);if(x&&x.method==="AES-128"){const _=this.getDecrypter();if(_.isSync()){let D=_.softwareDecrypt(o,x.key.buffer,x.iv.buffer);if(n.part>-1&&(D=_.flush()),!D)return s.executeEnd=Pr(),_0(n);o=new Uint8Array(D)}else return this.decryptionPromise=_.webCryptoDecrypt(o,x.key.buffer,x.iv.buffer).then(D=>{const A=this.push(D,null,n);return this.decryptionPromise=null,A}),this.decryptionPromise}const b=this.needsProbing(c,h);if(b){const _=this.configureTransmuxer(o);if(_)return M.warn(`[transmuxer] ${_.message}`),this.observer.emit(S.ERROR,S.ERROR,{type:be.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:_,reason:_.message}),s.executeEnd=Pr(),_0(n)}(c||h||p||b)&&this.resetInitSegment(y,g,m,O,t),(c||p||b)&&this.resetInitialTimestamp(v),u||this.resetContiguity();const E=this.transmux(o,x,d,f,n),T=this.currentTransmuxState;return T.contiguous=!0,T.discontinuity=!1,T.trackSwitch=!1,s.executeEnd=Pr(),E}flush(e){const t=e.transmuxing;t.executeStart=Pr();const{decrypter:n,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const o=[],{timeOffset:a}=r;if(n){const h=n.flush();h&&o.push(this.push(h,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u)return t.executeEnd=Pr(),[_0(e)];const c=l.flush(a);return vf(c)?c.then(h=>(this.flushRemux(o,h,e),o)):(this.flushRemux(o,c,e),o)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:s,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;M.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const c=this.remuxer.remux(r,s,o,a,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=Pr()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,s){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,n,r),a.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,s){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,r,s):o=this.transmuxUnencrypted(e,n,r,s),o}transmuxUnencrypted(e,t,n,r){const{audioTrack:s,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,a,l,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,s){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r,vendor:s}=this;let o;for(let f=0,d=mf.length;f<d;f++){var a;if((a=mf[f].demux)!=null&&a.probe(e)){o=mf[f];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,u=this.remuxer,c=o.remux,h=o.demux;(!u||!(u instanceof c))&&(this.remuxer=new c(n,t,r,s)),(!l||!(l instanceof h))&&(this.demuxer=new h(n,t,r),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new m1(this.config)),e}}function Nq(i,e){let t=null;return i.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const _0=i=>({remuxResult:{},chunkMeta:i});function vf(i){return"then"in i&&i.then instanceof Function}class Qq{constructor(e,t,n,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=s||null}}class Bq{constructor(e,t,n,r,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=o}}var cL={exports:{}};(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,h,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new r(c,h||l,f),p=t?t+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],d]:l._events[p].push(d):(l._events[p]=d,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=t?t+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,d=h.length,p=new Array(d);f<d;f++)p[f]=h[f].fn;return p},a.prototype.listenerCount=function(u){var c=t?t+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,f,d,p){var g=t?t+u:u;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,O,y;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,h),!0;case 4:return m.fn.call(m.context,c,h,f),!0;case 5:return m.fn.call(m.context,c,h,f,d),!0;case 6:return m.fn.call(m.context,c,h,f,d,p),!0}for(y=1,O=new Array(v-1);y<v;y++)O[y-1]=arguments[y];m.fn.apply(m.context,O)}else{var x=m.length,b;for(y=0;y<x;y++)switch(m[y].once&&this.removeListener(u,m[y].fn,void 0,!0),v){case 1:m[y].fn.call(m[y].context);break;case 2:m[y].fn.call(m[y].context,c);break;case 3:m[y].fn.call(m[y].context,c,h);break;case 4:m[y].fn.call(m[y].context,c,h,f);break;default:if(!O)for(b=1,O=new Array(v-1);b<v;b++)O[b-1]=arguments[b];m[y].fn.apply(m[y].context,O)}}return!0},a.prototype.on=function(u,c,h){return s(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return s(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,f){var d=t?t+u:u;if(!this._events[d])return this;if(!c)return o(this,d),this;var p=this._events[d];if(p.fn)p.fn===c&&(!f||p.once)&&(!h||p.context===h)&&o(this,d);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==c||f&&!p[g].once||h&&p[g].context!==h)&&m.push(p[g]);m.length?this._events[d]=m.length===1?m[0]:m:o(this,d)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,i.exports=a})(cL);var Uq=cL.exports,S1=cz(Uq);class hL{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const o=(u,c)=>{c=c||{},c.frag=this.frag,c.id=this.id,u===S.ERROR&&(this.error=c.error),this.hls.trigger(u,c)};this.observer=new S1,this.observer.on(S.FRAG_DECRYPTED,o),this.observer.on(S.ERROR,o);const a=fo(s.preferManagedMediaSource)||{isTypeSupported:()=>!1},l={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||oq())){try{s.workerPath?(M.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=lq(s.workerPath)):(M.log(`injecting Web Worker for "${t}"`),this.workerContext=aq()),this.onwmsg=h=>this.onWorkerMessage(h);const{worker:c}=this.workerContext;c.addEventListener("message",this.onwmsg),c.onerror=h=>{const f=new Error(`${h.message}  (${h.filename}:${h.lineno})`);s.enableWorker=!1,M.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(S.ERROR,{type:be.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})},c.postMessage({cmd:"init",typeSupported:l,vendor:"",id:t,config:JSON.stringify(s)})}catch(c){M.warn(`Error setting up "${t}" Web Worker, fallback to inline`,c),this.resetWorker(),this.error=null,this.transmuxer=new AE(this.observer,l,s,"",t)}return}this.transmuxer=new AE(this.observer,l,s,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,r,s,o,a,l,u,c){var h,f;u.transmuxing.start=self.performance.now();const{transmuxer:d}=this,p=o?o.start:s.start,g=s.decryptdata,m=this.frag,v=!(m&&s.cc===m.cc),O=!(m&&u.level===m.level),y=m?u.sn-m.sn:-1,x=this.part?u.part-this.part.index:-1,b=y===0&&u.id>1&&u.id===(m==null?void 0:m.stats.chunkCount),E=!O&&(y===1||y===0&&(x===1||b&&x<=0)),T=self.performance.now();(O||y||s.stats.parsing.start===0)&&(s.stats.parsing.start=T),o&&(x||!E)&&(o.stats.parsing.start=T);const _=!(m&&((h=s.initSegment)==null?void 0:h.url)===((f=m.initSegment)==null?void 0:f.url)),D=new Bq(v,E,l,O,p,_);if(!E||v||_){M.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${u.sn} p: ${u.part} level: ${u.level} id: ${u.id}
        discontinuity: ${v}
        trackSwitch: ${O}
        contiguous: ${E}
        accurateTimeOffset: ${l}
        timeOffset: ${p}
        initSegmentChange: ${_}`);const A=new Qq(n,r,t,a,c);this.configureTransmuxer(A)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:g,chunkMeta:u,state:D},e instanceof ArrayBuffer?[e]:[]);else if(d){const A=d.push(e,g,u,D);vf(A)?(d.async=!0,A.then(I=>{this.handleTransmuxComplete(I)}).catch(I=>{this.transmuxerError(I,u,"transmuxer-interface push error")})):(d.async=!1,this.handleTransmuxComplete(A))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);vf(n)||t.async?(vf(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){M.warn(`worker message received with no ${t?"event name":"data"}`);return}const n=this.hls;if(this.hls)switch(t.event){case"init":{var r;const s=(r=this.workerContext)==null?void 0:r.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":M[t.data.logType]&&M[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const PE=100;class Vq extends v1{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",Oe.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(S.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(S.ERROR,this.onError,this),e.on(S.BUFFER_RESET,this.onBufferReset,this),e.on(S.BUFFER_CREATED,this.onBufferCreated,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(S.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(S.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(S.ERROR,this.onError,this),e.off(S.BUFFER_RESET,this.onBufferReset,this),e.off(S.BUFFER_CREATED,this.onBufferCreated,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(S.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){if(n==="main"){const o=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${r}`),this.videoTrackCC=o,this.state===X.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=X.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(PE),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=X.IDLE):(this.loadedmetadata=!1,this.state=X.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case X.IDLE:this.doTickIdle();break;case X.WAITING_TRACK:{var e;const{levels:n,trackId:r}=this,s=n==null||(e=n[r])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=X.WAITING_INIT_PTS}break}case X.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),r=this.retryDate;if(!r||n>=r||(t=this.media)!=null&&t.seeking){const{levels:s,trackId:o}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((s==null?void 0:s[o])||null),this.state=X.IDLE}break}case X.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:r,part:s,cache:o,complete:a}=n;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=X.FRAG_LOADING;const l=o.flush(),u={frag:r,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),a&&super._handleFragmentLoadComplete(u)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),u=tt.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);kv(u.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${u.end} is needed`),this.clearWaitingFragment())}}else this.state=X.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=X.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:r}=this,s=e.config;if(!this.buffering||!n&&(this.startFragRequested||!s.startFragPrefetch)||!(t!=null&&t[r]))return;const o=t[r],a=o.details;if(!a||a.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(a)){this.state=X.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,We.AUDIO,Oe.AUDIO));const u=this.getFwdBufferInfo(l,Oe.AUDIO);if(u===null)return;if(!this.switchingTrack&&this._streamEnded(u,a)){e.trigger(S.BUFFER_EOS,{type:"audio"}),this.state=X.ENDED;return}const c=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Oe.MAIN),h=u.len,f=this.getMaxBufferLength(c==null?void 0:c.len),d=a.fragments,p=d[0].start,g=this.getLoadPosition(),m=this.flushing?g:u.end;if(this.switchingTrack&&n){const x=g;a.PTSKnown&&x<p&&(u.end>p||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=p+.05)}if(h>=f&&!this.switchingTrack&&m<d[d.length-1].start)return;let v=this.getNextFragment(m,a),O=!1;if(v&&this.isLoopLoading(v,m)&&(O=!!v.gap,v=this.getNextFragmentLoopLoading(v,a,u,Oe.MAIN,f)),!v){this.bufferFlushed=!0;return}const y=c&&v.start>c.end+a.targetduration;if(y||!(c!=null&&c.len)&&u.len){const x=this.getAppendedFrag(v.start,Oe.MAIN);if(x===null||(O||(O=!!x.gap||!!y&&c.len===0),y&&!O||O&&u.nextStart&&u.nextStart<x.end))return}this.loadFragment(v,o,m)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Ma(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?this.setInterval(PE):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=X.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=X.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(S.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:r}=this,{details:s,id:o}=t;if(!r){this.warn(`Audio tracks were reset while loading level ${o}`);return}this.log(`Audio track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const a=r[o];let l=0;if(s.live||(n=a.details)!=null&&n.live){this.checkLiveUpdate(s);const c=this.mainDetails;if(s.deltaUpdateFailed||!c)return;if(!a.details&&s.hasProgramDateTime&&c.hasProgramDateTime)yd(s,c),l=s.fragments[0].start;else{var u;l=this.alignPlaylists(s,a.details,(u=this.levelLastLoaded)==null?void 0:u.details)}}a.details=s,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(this.mainDetails||s,l),this.state===X.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=X.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:s}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[a];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const c=u.details;if(!c){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const h=o.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let f=this.transmuxer;f||(f=this.transmuxer=new hL(this.hls,Oe.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const d=this.initPTS[n.cc],p=(t=n.initSegment)==null?void 0:t.data;if(d!==void 0){const m=r?r.index:-1,v=m!==-1,O=new g1(n.level,n.sn,n.stats.chunkCount,s.byteLength,m,v);f.push(s,p,h,"",n,r,c.totalduration,!1,O,d)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${a}`);const{cache:g}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new WR,complete:!1};g.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=X.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type!==Oe.AUDIO){if(!this.loadedmetadata&&n.type===Oe.MAIN){const s=this.videoBuffer||this.media;s&&tt.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(S.AUDIO_TRACK_SWITCHED,Gt({},s)))}this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=X.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Oe.AUDIO,t);break;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===X.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===Fe.AUDIO_TRACK&&(this.state=X.IDLE);break;case Q.BUFFER_APPEND_ERROR:case Q.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===Q.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==We.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==We.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===X.ENDED&&(this.state=X.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,Oe.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:u,level:c}=a,{details:h}=c,{audio:f,text:d,id3:p,initSegment:g}=s;if(this.fragContextChanged(l)||!h){this.fragmentTracker.removeFragment(l);return}if(this.state=X.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),g!=null&&g.tracks){const m=l.initSegment||l;this._bufferInitSegment(c,g.tracks,m,o),r.trigger(S.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:n,tracks:g.tracks})}if(f){const{startPTS:m,endPTS:v,startDTS:O,endDTS:y}=f;u&&(u.elementaryStreams[We.AUDIO]={startPTS:m,endPTS:v,startDTS:O,endDTS:y}),l.setElementaryStreamInfo(We.AUDIO,m,v,O,y),this.bufferFragmentData(f,l,u,o)}if(p!=null&&(t=p.samples)!=null&&t.length){const m=At({id:n,frag:l,details:h},p);r.trigger(S.FRAG_PARSING_METADATA,m)}if(d){const m=At({id:n,frag:l,details:h},d);r.trigger(S.FRAG_PARSING_USERDATA,m)}}_bufferInitSegment(e,t,n,r){if(this.state!==X.PARSING)return;t.video&&delete t.video;const s=t.audio;if(!s)return;s.id="audio";const o=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${o}/${s.codec}]`),o&&o.split(",").length===1&&(s.levelCodec=o),this.hls.trigger(S.BUFFER_CODECS,t);const a=s.initSegment;if(a!=null&&a.byteLength){const l={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:a};this.hls.trigger(S.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===Vt.NOT_LOADED||r===Vt.PARTIAL){var s;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=X.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragments[0].start!==t.details.fragments[0].start&&yd(t.details,o)}else this.startFragRequested=!0,super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:r,characteristics:s,audioCodec:o,channels:a}=this.bufferedTrack;lo({name:t,lang:n,assocLang:r,characteristics:s,audioCodec:o,channels:a},e,zs)||(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(S.AUDIO_TRACK_SWITCHED,Gt({},e))}}function fL(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Au(i[t].attrs,e[t].attrs))return!1;return!0}function Au(i,e,t){const n=i["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>i[r]!==e[r])}function Ev(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class Zq extends p1{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.LEVEL_LOADING,this.onLevelLoading,this),e.on(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(S.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.LEVEL_LOADING,this.onLevelLoading,this),e.off(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(S.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(S.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r){this.warn(`Audio track with id:${n} and group:${r} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,r=this.groupIds;let s=this.currentTrack;if(!n||(r==null?void 0:r.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(r==null?void 0:r.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(f=>!n||n.indexOf(f.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(f=>f.default)&&(this.selectDefaultTrack=!1),a.forEach((f,d)=>{f.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.audioPreference;if(!s&&l){const f=lr(l,a,zs);if(f>-1)s=a[f];else{const d=lr(l,this.tracks);s=this.tracks[d]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const c={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(S.AUDIO_TRACKS_UPDATED,c);const h=this.trackId;if(u!==-1&&h===-1)this.setAudioTrack(u);else if(a.length&&h===-1){var o;const f=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(f.message),this.hls.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:f})}}else this.shouldReloadPlaylist(s)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===Fe.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const r=this.currentTrack;if(r&&lo(e,r,zs))return r;const s=lr(e,this.tracksInGroup,zs);if(s>-1){const o=this.tracksInGroup[s];return this.setAudioTrack(s),o}else if(r){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const a=ZW(e,t.levels,n,o,zs);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const o=lr(e,n);if(o>-1)return n[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e],s=r.details&&!r.details.live;if(e===this.trackId&&r===n&&s||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(S.AUDIO_TRACK_SWITCHING,Gt({},r)),s))return;const o=this.switchParams(r.url,n==null?void 0:n.details,r.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(!(this.selectDefaultTrack&&!r.default)&&(!e||lo(e,r,zs)))return n}if(e){const{name:n,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:l}=e;for(let u=0;u<t.length;u++){const c=t[u];if(lo({name:n,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:l},c,zs))return u}for(let u=0;u<t.length;u++){const c=t[u];if(Au(e.attrs,c.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const c=t[u];if(Au(e.attrs,c.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(S.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}}const RE=500;class jq extends v1{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Oe.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.ERROR,this.onError,this),e.on(S.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(S.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(S.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(S.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.ERROR,this.onError,this),e.off(S.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(S.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(S.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(S.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=X.IDLE,this.setInterval(RE),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragPrevious=n,this.state=X.IDLE,!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const a=n.start;for(let u=0;u<s.length;u++)if(a>=s[u].start&&a<=s[u].end){o=s[u];break}const l=n.start+n.duration;o?o.end=l:(o={start:a,end:l},s.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(n===0&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=s){o.shift();continue}else if(o[a].start<s)o[a].start=s;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(n,s,Oe.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Oe.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===Oe.SUBTITLE&&(t.details===Q.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==X.STOPPED&&(this.state=X.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&fL(this.levels,t)){this.levels=t.map(n=>new Ma(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const r=new Ma(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Oe.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(RE)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:r,levels:s}=this,{details:o,id:a}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}const l=s[a];if(a>=s.length||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(o.live||(n=l.details)!=null&&n.live){const h=this.mainDetails;if(o.deltaUpdateFailed||!h)return;const f=h.fragments[0];if(!l.details)o.hasProgramDateTime&&h.hasProgramDateTime?(yd(o,h),u=o.fragments[0].start):f&&(u=f.start,Sv(o,u));else{var c;u=this.alignPlaylists(o,l.details,(c=this.levelLastLoaded)==null?void 0:c.details),u===0&&f&&(u=f.start,Sv(o,u))}}l.details=o,this.levelLastLoaded=l,a===r&&(!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,u),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===X.IDLE&&(Od(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r!=null&&r.key&&r.iv&&r.method==="AES-128"){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer).catch(a=>{throw s.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const l=performance.now();s.trigger(S.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=X.IDLE})}}doTick(){if(!this.media){this.state=X.IDLE;return}if(this.state===X.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:r}=this,s=this.getLoadPosition(),o=tt.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:a,len:l}=o,u=this.getFwdBufferInfo(this.media,Oe.MAIN),c=n.details,h=this.getMaxBufferLength(u==null?void 0:u.len)+c.levelTargetDuration;if(l>h)return;const f=c.fragments,d=f.length,p=c.edge;let g=null;const m=this.fragPrevious;if(a<p){const v=r.maxFragLookUpTolerance,O=a>p-v?0:v;g=Od(m,f,Math.max(f[0].start,a),O),!g&&m&&m.start<f[0].start&&(g=f[0])}else g=f[d-1];if(!g)return;if(g=this.mapToInitFragWhenRequired(g),g.sn!=="initSegment"){const v=g.sn-c.startSN,O=f[v-1];O&&O.cc===g.cc&&this.fragmentTracker.getState(O)===Vt.NOT_LOADED&&(g=O)}this.fragmentTracker.getState(g)===Vt.NOT_LOADED&&this.loadFragment(g,n,a)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new Gq(this.tracksBuffered[this.currentTrackId]||[])}}class Gq{constructor(e){this.buffered=void 0;const t=(n,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class Hq extends p1{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=ff(this.media.textTracks);for(let s=0;s<n.length;s++)if(n[s].mode==="hidden")t=n[s];else if(n[s].mode==="showing"){t=n[s];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.LEVEL_LOADING,this.onLevelLoading,this),e.on(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(S.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.LEVEL_LOADING,this.onLevelLoading,this),e.off(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(S.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(S.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),ff(this.media.textTracks).forEach(t=>{fa(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r){this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,r=this.groupIds;let s=this.currentTrack;if(!n||(r==null?void 0:r.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(r==null?void 0:r.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(c=>!n||n.indexOf(c.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(c=>c.default)&&(this.selectDefaultTrack=!1),o.forEach((c,h)=>{c.id=h});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!s&&a){this.selectDefaultTrack=!1;const c=lr(a,o);if(c>-1)s=o[c];else{const h=lr(a,this.tracks);s=this.tracks[h]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const u={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(S.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const s=t[r];if(!(n&&!s.default||!n&&!e)&&(!e||lo(s,e)))return r}if(e){for(let r=0;r<t.length;r++){const s=t[r];if(Au(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const s=t[r];if(Au(e.attrs,s.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(Ev(r,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Fe.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&lo(e,n))return n;const r=lr(e,this.tracksInGroup);if(r>-1){const s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}else{if(n)return null;{const s=lr(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(S.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=ff(e.textTracks),n=this.currentTrack;let r;if(n&&(r=t.filter(s=>Ev(n,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==r&&(s.mode="disabled")}),r){const s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!ae(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(S.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:o,groupId:a="",name:l,type:u,url:c}=r;this.hls.trigger(S.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:u,url:c});const h=this.switchParams(r.url,n==null?void 0:n.details,r.details);this.loadPlaylist(h)}}class Xq{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const r=this.queues[t];r.push(e),r.length===1&&!n&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(s=>{t=s}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(r){M.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${r}`),n.onError(r);const s=this.buffers[e];s!=null&&s.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const LE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class zq{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:n,mediaSource:r}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(S.MEDIA_ATTACHED,{media:n,mediaSource:r})),r&&r.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:r}=this;n!==r&&M.error(`Media element src was set while attaching MediaSource (${r} > ${n})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=nW(fo(e.config.preferManagedMediaSource)),this.log=M.log.bind(M,t),this.warn=M.warn.bind(M,t),this.error=M.error.bind(M,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.BUFFER_RESET,this.onBufferReset,this),e.on(S.BUFFER_APPENDING,this.onBufferAppending,this),e.on(S.BUFFER_CODECS,this.onBufferCodecs,this),e.on(S.BUFFER_EOS,this.onBufferEos,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(S.FRAG_PARSED,this.onFragParsed,this),e.on(S.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.BUFFER_RESET,this.onBufferReset,this),e.off(S.BUFFER_APPENDING,this.onBufferAppending,this),e.off(S.BUFFER_CODECS,this.onBufferCodecs,this),e.off(S.BUFFER_EOS,this.onBufferEos,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(S.FRAG_PARSED,this.onFragParsed,this),e.off(S.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Xq(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,r=fo(this.appendSource);if(n&&r){var s;const o=this.mediaSource=new r;this.log(`created media source: ${(s=o.constructor)==null?void 0:s.name}`),o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.addEventListener("startstreaming",this._onStartStreaming),o.addEventListener("endstreaming",this._onEndStreaming));const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{n.removeAttribute("src");const l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&o instanceof l,IE(n),Wq(n,a),n.load()}catch{n.src=a}else n.src=a;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(r){this.warn(`onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&IE(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(S.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(r){this.warn(`onBufferReset ${e}`,r)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,r=Object.keys(t);if(r.forEach(o=>{if(n){const l=this.tracks[o];if(l&&typeof l.buffer.changeType=="function"){var a;const{id:u,codec:c,levelCodec:h,container:f,metadata:d}=t[o],p=eE(l.codec,l.levelCodec),g=p==null?void 0:p.replace(LE,"$1");let m=eE(c,h);const v=(a=m)==null?void 0:a.replace(LE,"$1");if(m&&g!==v){o.slice(0,5)==="audio"&&(m=pd(m,this.appendSource));const O=`${f};codecs=${m}`;this.appendChangeType(o,O),this.log(`switching codec ${p} to ${m}`),this.tracks[o]={buffer:l.buffer,codec:c,container:f,levelCodec:h,metadata:d,id:u}}}}else this.pendingTracks[o]=t[o]}),n)return;const s=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==s&&(this.log(`${s} bufferCodec event(s) expected ${r.join(",")}`),this.bufferCodecEventsExpected=s),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,r={execute:()=>{const s=this.sourceBuffer[e];s&&(this.log(`changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{this.warn(`Failed to change ${e} SourceBuffer type`,s)}};n.append(r,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:r,tracks:s}=this,{data:o,type:a,frag:l,part:u,chunkMeta:c}=t,h=c.buffering[a],f=self.performance.now();h.start=f;const d=l.stats.buffering,p=u?u.stats.buffering:null;d.start===0&&(d.start=f),p&&p.start===0&&(p.start=f);const g=s.audio;let m=!1;a==="audio"&&(g==null?void 0:g.container)==="audio/mpeg"&&(m=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const v=l.start,O={execute:()=>{if(h.executeStart=self.performance.now(),m){const y=this.sourceBuffer[a];if(y){const x=v-y.timestampOffset;Math.abs(x)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${v} (delta: ${x}) sn: ${l.sn})`),y.timestampOffset=v)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{const y=self.performance.now();h.executeEnd=h.end=y,d.first===0&&(d.first=y),p&&p.first===0&&(p.first=y);const{sourceBuffer:x}=this,b={};for(const E in x)b[E]=tt.getBuffered(x[E]);this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(S.BUFFER_APPENDED,{type:a,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:b})},onError:y=>{const x={type:be.MEDIA_ERROR,parent:l.type,details:Q.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:l,part:u,chunkMeta:c,error:y,err:y,fatal:!1};if(y.code===DOMException.QUOTA_EXCEEDED_ERR)x.details=Q.BUFFER_FULL_ERROR;else{const b=++this.appendErrors[a];x.details=Q.BUFFER_APPEND_ERROR,this.warn(`Failed ${b}/${n.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),b>=n.config.appendErrorMaxRetry&&(x.fatal=!0)}n.trigger(S.ERROR,x)}};r.append(O,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){const{operationQueue:n}=this,r=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(S.BUFFER_FLUSHED,{type:s})},onError:o=>{this.warn(`Failed to remove from ${s} SourceBuffer`,o)}});t.type?n.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{n.append(r(s),s)})}onFragParsed(e,t){const{frag:n,part:r}=t,s=[],o=r?r.elementaryStreams:n.elementaryStreams;o[We.AUDIOVIDEO]?s.push("audiovideo"):(o[We.AUDIO]&&s.push("audio"),o[We.VIDEO]&&s.push("video"));const a=()=>{const l=self.performance.now();n.stats.buffering.end=l,r&&(r.stats.buffering.end=l);const u=r?r.stats:n.stats;this.hls.trigger(S.FRAG_BUFFERED,{frag:n,part:r,stats:u,id:n.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,s)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((r,s)=>{const o=this.sourceBuffer[s];return o&&(!t.type||t.type===s)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${s} sourceBuffer now EOS`))),r&&!!(!o||o.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const o=this.sourceBuffer[s];o&&(o.ending=!1)});const{mediaSource:r}=this;if(!r||r.readyState!=="open"){r&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),r.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.getSourceBufferTypes().length)return;const s=e.config,o=n.currentTime,a=t.levelTargetDuration,l=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(ae(l)&&l>0){const u=Math.max(l,a),c=Math.floor(o/a)*a-u;this.flushBackBuffer(o,a,c)}if(ae(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const u=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),c=Math.max(u,a),h=Math.floor(o/a)*a+c;this.flushFrontBuffer(o,a,h)}}flushBackBuffer(e,t,n){const{details:r,sourceBuffer:s}=this;this.getSourceBufferTypes().forEach(a=>{const l=s[a];if(l){const u=tt.getBuffered(l);if(u.length>0&&n>u.start(0)){if(this.hls.trigger(S.BACK_BUFFER_REACHED,{bufferEnd:n}),r!=null&&r.live)this.hls.trigger(S.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l.ended&&u.end(u.length-1)-e<t*2){this.log(`Cannot flush ${a} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(S.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:a})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:r}=this;this.getSourceBufferTypes().forEach(o=>{const a=r[o];if(a){const l=tt.getBuffered(a),u=l.length;if(u<2)return;const c=l.start(u-1),h=l.end(u-1);if(n>c||e>=c&&e<=h)return;if(a.ended&&e-h<2*t){this.log(`Cannot flush ${o} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(S.BUFFER_FLUSHING,{startOffset:c,endOffset:1/0,type:o})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:r}=this,s=e.fragments[0].start+e.totalduration,o=n.duration,a=ae(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(r.duration=1/0,this.updateSeekableRange(e)):(s>a&&s>o||!ae(o))&&(this.log(`Updating Media Source duration to ${s.toFixed(3)}`),r.duration=s)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const s=Math.max(0,n[0].start),o=Math.max(s,s+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${s}-${o}.`),t.setLiveSeekableRange(s,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,r=Object.keys(n).length;if(r&&(!e||r===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(S.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const s in e)if(!t[s]){var r;const o=e[s];if(!o)throw Error(`source buffer exists for track ${s}, however track does not`);let a=((r=o.levelCodec)==null?void 0:r.indexOf(","))===-1?o.levelCodec:o.codec;a&&s.slice(0,5)==="audio"&&(a=pd(a,this.appendSource));const l=`${o.container};codecs=${a}`;this.log(`creating sourceBuffer(${l})`);try{const u=t[s]=n.addSourceBuffer(l),c=s;this.addBufferListener(c,"updatestart",this._onSBUpdateStart),this.addBufferListener(c,"updateend",this._onSBUpdateEnd),this.addBufferListener(c,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(c,"bufferedchange",(h,f)=>{const d=f.removedRanges;d!=null&&d.length&&this.hls.trigger(S.BUFFER_FLUSHED,{type:s})}),this.tracks[s]={buffer:u,codec:a,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(u){this.error(`error while trying to add sourceBuffer: ${u.message}`),this.hls.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,sourceBufferName:s,mimeType:l})}}}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${r}`,t),this.hls.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const s=this.operationQueue.current(e);s&&s.onError(r)}removeExecutor(e,t,n){const{media:r,mediaSource:s,operationQueue:o,sourceBuffer:a}=this,l=a[e];if(!r||!s||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),o.shiftAndExecuteNext(e);return}const u=ae(r.duration)?r.duration:1/0,c=ae(s.duration)?s.duration:1/0,h=Math.max(0,t),f=Math.min(n,u,c);f>h&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${h},${f}] from the ${e} SourceBuffer`),l.remove(h,f)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(!n){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,r=t.map(s=>n.appendBlocker(s));Promise.all(r).then(()=>{e(),t.forEach(s=>{const o=this.sourceBuffer[s];o!=null&&o.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const r=this.sourceBuffer[e];if(!r)return;const s=n.bind(this,e);this.listeners[e].push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}function IE(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function Wq(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}const qq={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},dL=i=>String.fromCharCode(qq[i]||i),En=15,wr=100,Yq={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Kq={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Jq={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},eY={25:2,26:4,29:6,30:8,31:10,27:13,28:15},tY=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class iY{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;M.log(`${this.time} [${e}] ${n}`)}}}const Zs=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class pL{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class nY{constructor(){this.uchar=" ",this.penState=new pL}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class rY{constructor(e){this.chars=[],this.pos=0,this.currPenState=new pL,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<wr;t++)this.chars.push(new nY);this.logger=e}equals(e){for(let t=0;t<wr;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<wr;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<wr;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>wr&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=wr)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=dL(e);if(this.pos>=wr){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<wr;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<wr;n++){const r=this.chars[n].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class C0{constructor(e){this.rows=[],this.currRow=En-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<En;t++)this.rows.push(new rY(e));this.logger=e}reset(){for(let e=0;e<En;e++)this.rows[e].clear();this.currRow=En-1}equals(e){let t=!0;for(let n=0;n<En;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<En;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<En;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<En;a++)this.rows[a].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[s].cueStartTime,l=this.logger.time;if(a!==null&&l!==null&&a<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(o.rows[s+u])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,o=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let s=0;s<En;s++){const o=this.rows[s].getTextString();o&&(r=s+1,e?t.push("Row "+r+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class DE{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new C0(n),this.nonDisplayedMemory=new C0(n),this.lastOutputScreen=new C0(n),this.currRollUpRow=this.displayedMemory.rows[En-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[En-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class $E{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=oY(),this.logger=void 0;const r=this.logger=new iY;this.channels=[null,new DE(e,t,r),new DE(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const r=t[n]&127,s=t[n+1]&127;let o=!1,a=null;if(r===0&&s===0)continue;this.logger.log(3,()=>"["+Zs([t[n],t[n+1]])+"] -> ("+Zs([r,s])+")");const l=this.cmdHistory;if(r>=16&&r<=31){if(sY(r,s,l)){mh(null,null,l),this.logger.log(3,()=>"Repeated command ("+Zs([r,s])+") is dropped");continue}mh(r,s,this.cmdHistory),o=this.parseCmd(r,s),o||(o=this.parseMidrow(r,s)),o||(o=this.parsePAC(r,s)),o||(o=this.parseBackgroundAttributes(r,s))}else mh(null,null,l);if(!o&&(a=this.parseChars(r,s),a)){const c=this.currentChannel;c&&c>0?this.channels[c].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Zs([r,s])+" orig: "+Zs([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(n||r))return!1;const s=e===20||e===21||e===23?1:2,o=this.channels[s];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Zs([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(r||s))return!1;const o=e<=23?1:2;t>=64&&t<=95?n=o===1?Yq[e]:Jq[e]:n=o===1?Kq[e]:eY[e];const a=this.channels[o];return a?(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,r.underline=(n&1)===1,n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let o;s===17?o=t+80:s===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+dL(o)+"' in channel "+n),r=[o]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+Zs(r).join(",")),r}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let s;const o={};e===16||e===24?(s=Math.floor((t-32)/2),o.background=tY[s],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}mh(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function mh(i,e,t){t.a=i,t.b=e}function sY(i,e,t){return t.a===i&&t.b===e}function oY(){return{a:null,b:null}}class vh{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var k1=function(){if($a!=null&&$a.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;const u=l.toLowerCase();return~a.indexOf(u)?u:!1}function n(a){return t(i,a)}function r(a){return t(e,a)}function s(a,...l){let u=1;for(;u<arguments.length;u++){const c=arguments[u];for(const h in c)a[h]=c[h]}return a}function o(a,l,u){const c=this,h={enumerable:!0};c.hasBeenReset=!1;let f="",d=!1,p=a,g=l,m=u,v=null,O="",y=!0,x="auto",b="start",E=50,T="middle",_=50,D="middle";Object.defineProperty(c,"id",s({},h,{get:function(){return f},set:function(A){f=""+A}})),Object.defineProperty(c,"pauseOnExit",s({},h,{get:function(){return d},set:function(A){d=!!A}})),Object.defineProperty(c,"startTime",s({},h,{get:function(){return p},set:function(A){if(typeof A!="number")throw new TypeError("Start time must be set to a number.");p=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",s({},h,{get:function(){return g},set:function(A){if(typeof A!="number")throw new TypeError("End time must be set to a number.");g=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",s({},h,{get:function(){return m},set:function(A){m=""+A,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",s({},h,{get:function(){return v},set:function(A){v=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",s({},h,{get:function(){return O},set:function(A){const I=n(A);if(I===!1)throw new SyntaxError("An invalid or illegal string was specified.");O=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",s({},h,{get:function(){return y},set:function(A){y=!!A,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",s({},h,{get:function(){return x},set:function(A){if(typeof A!="number"&&A!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");x=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",s({},h,{get:function(){return b},set:function(A){const I=r(A);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");b=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",s({},h,{get:function(){return E},set:function(A){if(A<0||A>100)throw new Error("Position must be between 0 and 100.");E=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",s({},h,{get:function(){return T},set:function(A){const I=r(A);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");T=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",s({},h,{get:function(){return _},set:function(A){if(A<0||A>100)throw new Error("Size must be between 0 and 100.");_=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",s({},h,{get:function(){return D},set:function(A){const I=r(A);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");D=I,this.hasBeenReset=!0}})),c.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class aY{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function gL(i){function e(n,r,s,o){return(n|0)*3600+(r|0)*60+(s|0)+parseFloat(o||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class lY{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function mL(i,e,t,n){const r=n?i.split(n):[i];for(const s in r){if(typeof r[s]!="string")continue;const o=r[s].split(t);if(o.length!==2)continue;const a=o[0],l=o[1];e(a,l)}}const wv=new k1(0,0,""),Oh=wv.align==="middle"?"middle":"center";function uY(i,e,t){const n=i;function r(){const a=gL(i);if(a===null)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),a}function s(a,l){const u=new lY;mL(a,function(f,d){let p;switch(f){case"region":for(let g=t.length-1;g>=0;g--)if(t[g].id===d){u.set(f,t[g].region);break}break;case"vertical":u.alt(f,d,["rl","lr"]);break;case"line":p=d.split(","),u.integer(f,p[0]),u.percent(f,p[0])&&u.set("snapToLines",!1),u.alt(f,p[0],["auto"]),p.length===2&&u.alt("lineAlign",p[1],["start",Oh,"end"]);break;case"position":p=d.split(","),u.percent(f,p[0]),p.length===2&&u.alt("positionAlign",p[1],["start",Oh,"end","line-left","line-right","auto"]);break;case"size":u.percent(f,d);break;case"align":u.alt(f,d,["start",Oh,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let c=u.get("line","auto");c==="auto"&&wv.line===-1&&(c=-1),l.line=c,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",Oh);let h=u.get("position","auto");h==="auto"&&wv.position===50&&(h=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=h}function o(){i=i.replace(/^\s+/,"")}if(o(),e.startTime=r(),o(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);i=i.slice(3),o(),e.endTime=r(),o(),s(i,e)}function vL(i){return i.replace(/<br(?: \/)?>/gi,`
`)}class cY{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new aY,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,o=0;for(s=vL(s);o<s.length&&s[o]!=="\r"&&s[o]!==`
`;)++o;const a=s.slice(0,o);return s[o]==="\r"&&++o,s[o]===`
`&&++o,t.buffer=s.slice(o),a}function r(s){mL(s,function(o,a){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();const a=s.match(/^()?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=n(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new k1(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{uY(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=s.indexOf("-->")!==-1;if(!s||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const hY=/\r\n|\n\r|\n|\r/g,A0=function(e,t,n=0){return e.slice(n,n+t.length)===t},fY=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!ae(t)||!ae(n)||!ae(r)||!ae(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=60*60*1e3*s,t},P0=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function T1(i,e,t){return P0(i.toString())+P0(e.toString())+P0(t)}const dY=function(e,t,n){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(o=s)!=null&&o.new;){var o;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=n};function pY(i,e,t,n,r,s,o){const a=new cY,l=pr(new Uint8Array(i)).trim().replace(hY,`
`).split(`
`),u=[],c=e?Rq(e.baseTime,e.timescale):0;let h="00:00.000",f=0,d=0,p,g=!0;a.oncue=function(m){const v=t[n];let O=t.ccOffset;const y=(f-c)/9e4;if(v!=null&&v.new&&(d!==void 0?O=t.ccOffset=v.start:dY(t,n,y)),y){if(!e){p=new Error("Missing initPTS for VTT MPEGTS");return}O=y-t.presentationOffset}const x=m.endTime-m.startTime,b=tn((m.startTime+O-d)*9e4,r*9e4)/9e4;m.startTime=Math.max(b,0),m.endTime=Math.max(b+x,0);const E=m.text.trim();m.text=decodeURIComponent(encodeURIComponent(E)),m.id||(m.id=T1(m.startTime,m.endTime,E)),m.endTime>0&&u.push(m)},a.onparsingerror=function(m){p=m},a.onflush=function(){if(p){o(p);return}s(u)},l.forEach(m=>{if(g)if(A0(m,"X-TIMESTAMP-MAP=")){g=!1,m.slice(16).split(",").forEach(v=>{A0(v,"LOCAL:")?h=v.slice(6):A0(v,"MPEGTS:")&&(f=parseInt(v.slice(7)))});try{d=fY(h)/1e3}catch(v){p=v}return}else m===""&&(g=!1);a.parse(m+`
`)}),a.flush()}const R0="stpp.ttml.im1t",OL=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,yL=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,gY={left:"start",center:"center",right:"end",start:"start",end:"end"};function ME(i,e,t,n){const r=Pe(new Uint8Array(i),["mdat"]);if(r.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const s=r.map(a=>pr(a)),o=Pq(e.baseTime,1,e.timescale);try{s.forEach(a=>t(mY(a,o)))}catch(a){n(a)}}function mY(i,e){const r=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((h,f)=>(h[f]=r.getAttribute(`ttp:${f}`)||s[f],h),{}),a=r.getAttribute("xml:space")!=="preserve",l=FE(L0(r,"styling","style")),u=FE(L0(r,"layout","region")),c=L0(r,"body","[begin]");return[].map.call(c,h=>{const f=bL(h,a);if(!f||!h.hasAttribute("begin"))return null;const d=D0(h.getAttribute("begin"),o),p=D0(h.getAttribute("dur"),o);let g=D0(h.getAttribute("end"),o);if(d===null)throw NE(h);if(g===null){if(p===null)throw NE(h);g=d+p}const m=new k1(d-e,g-e,f);m.id=T1(m.startTime,m.endTime,m.text);const v=u[h.getAttribute("region")],O=l[h.getAttribute("style")],y=vY(v,O,l),{textAlign:x}=y;if(x){const b=gY[x];b&&(m.lineAlign=b),m.align=x}return At(m,y),m}).filter(h=>h!==null)}function L0(i,e,t){const n=i.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function FE(i){return i.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function bL(i,e){return[].slice.call(i.childNodes).reduce((t,n,r)=>{var s;return n.nodeName==="br"&&r?t+`
`:(s=n.childNodes)!=null&&s.length?bL(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function vY(i,e,t){const n="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(r=t[o]),s.reduce((a,l)=>{const u=I0(e,n,l)||I0(i,n,l)||I0(r,n,l);return u&&(a[l]=u),a},{})}function I0(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function NE(i){return new Error(`Could not parse ttml timestamp ${i}`)}function D0(i,e){if(!i)return null;let t=gL(i);return t===null&&(OL.test(i)?t=OY(i,e):yL.test(i)&&(t=yY(i,e))),t}function OY(i,e){const t=OL.exec(i),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function yY(i,e){const t=yL.exec(i),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class bY{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=BE(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(S.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(S.FRAG_LOADING,this.onFragLoading,this),e.on(S.FRAG_LOADED,this.onFragLoaded,this),e.on(S.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(S.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(S.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(S.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(S.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(S.FRAG_LOADING,this.onFragLoading,this),e.off(S.FRAG_LOADED,this.onFragLoaded,this),e.off(S.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(S.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(S.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(S.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new vh(this,"textTrack1"),t=new vh(this,"textTrack2"),n=new vh(this,"textTrack3"),r=new vh(this,"textTrack4");this.cea608Parser1=new $E(1,e,t),this.cea608Parser2=new $E(3,n,r)}}addCues(e,t,n,r,s){let o=!1;for(let a=s.length;a--;){const l=s[a],u=xY(l[0],l[1],t,n);if(u>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),o=!0,u/(n-t)>.5))return}if(o||s.push([t,n]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,n,r)}else{const a=this.Cues.newCue(null,t,n,r);this.hls.trigger(S.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){const{unparsedVttFrags:o}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(a=>{this.onFragLoaded(S.FRAG_LOADED,a)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){const s=n.textTracks[r];if(QE(s,{name:e,lang:t,attrs:{}}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:s,languageCode:o}=t[e],a=this.getExistingTrack(s,o);if(a)n[e]=a,fa(n[e]),BR(n[e],r);else{const l=this.createTextTrack("captions",s,o);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,r={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(S.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{fa(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=BE(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)fa(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(s=>s.textCodec===R0);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(fL(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media,a=o?ff(o.textTracks):null;if(this.tracks.forEach((l,u)=>{let c;if(a){let h=null;for(let f=0;f<a.length;f++)if(a[f]&&QE(a[f],l)){h=a[f],a[f]=null;break}h&&(c=h)}if(c)fa(c);else{const h=xL(l);c=this.createTextTrack(h,l.name,l.lang),c&&(c.mode="disabled")}c&&this.textTracks.push(c)}),a!=null&&a.length){const l=a.filter(u=>u!==null).map(u=>u.label);l.length&&M.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(S.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;const s=`textTrack${r[1]}`,o=this.captionsProperties[s];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Oe.MAIN){var n,r;const{cea608Parser1:s,cea608Parser2:o,lastSn:a}=this,{cc:l,sn:u}=t.frag,c=(n=(r=t.part)==null?void 0:r.index)!=null?n:-1;s&&o&&(u!==a+1||u===a&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),o.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===Oe.SUBTITLE)if(r.byteLength){const s=n.decryptdata,o="stats"in t;if(s==null||!s.encrypted||o){const a=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),a&&a.textCodec===R0?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;ME(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{M.log(`Failed to parse IMSC1: ${r}`),n.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:s,unparsedVttFrags:o}=this,a=s.length-1;if(!s[n.cc]&&a===-1){o.push(e);return}const l=this.hls,u=(t=n.initSegment)!=null&&t.data?pn(n.initSegment.data,new Uint8Array(r)):r;pY(u,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,c=>{this._appendCues(c,n.level),l.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},c=>{const h=c.message==="Missing initPTS for VTT MPEGTS";h?o.push(e):this._fallbackToIMSC1(n,r),M.log(`Failed to parse VTT cue: ${c}`),!(h&&a>n.cc)&&l.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:c})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||ME(t,this.initPTS[e.cc],()=>{n.textCodec=R0,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(s=>UR(r,s))}else{const r=this.tracks[t];if(!r)return;const s=r.default?"default":"subtitles"+t;n.trigger(S.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Oe.SUBTITLE&&this.onFragLoaded(S.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:r}=this;if(!this.enabled||!n||!r)return;const{frag:s,samples:o}=t;if(!(s.type===Oe.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let a=0;a<o.length;a++){const l=o[a].bytes;if(l){const u=this.extractCea608Data(l);n.addData(o[a].pts,u[0]),r.addData(o[a].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:s}){const{media:o}=this;if(!(!o||o.currentTime<n)){if(!s||s==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>yv(a[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(l=>yv(a[l],t,r))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let r=2;for(let s=0;s<n;s++){const o=e[r++],a=127&e[r++],l=127&e[r++];if(a===0&&l===0)continue;if((4&o)!==0){const c=3&o;(c===0||c===1)&&(t[c].push(a),t[c].push(l))}}return t}}function xL(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function QE(i,e){return!!i&&i.kind===xL(e)&&Ev(e,i)}function xY(i,e,t,n){return Math.min(e,n)-Math.max(i,t)}function BE(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class E1{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(S.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(S.BUFFER_CODECS,this.onBufferCodecs,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(S.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(S.BUFFER_CODECS,this.onBufferCodecs,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&ae(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&M.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,E1.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const r=(a,l)=>l?a.width!==l.width||a.height!==l.height:!0;let s=e.length-1;const o=Math.max(t,n);for(let a=0;a<e.length;a+=1){const l=e[a];if((l.width>=o||l.height>=o)&&r(l,e[a+1])){s=a;break}}return s}}class SY{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const s=r-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/s,u=this.hls;if(u.trigger(S.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),l>0&&o>u.config.fpsDroppedMonitoringThreshold*a){let c=u.currentLevel;M.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)&&(c=c-1,u.trigger(S.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const yh="[eme]";class va{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=va.CDMCleanupPromise?[va.CDMCleanupPromise]:[],this.debug=M.debug.bind(M,yh),this.log=M.log.bind(M,yh),this.warn=M.warn.bind(M,yh),this.error=M.error.bind(M,yh),this.onMediaEncrypted=t=>{const{initDataType:n,initData:r}=t,s=`"${t.type}" event: init data type: "${n}"`;if(this.debug(s),r!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=uh(this.config));const a=o.map(m0).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(a)}this.keyFormatPromise.then(o=>{const a=p0(o);let l,u;if(n==="sinf"){if(a!==Xe.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${a}`);return}const p=$t(new Uint8Array(r));try{const g=c1(JSON.parse(p).sinf),m=$R(g);if(!m)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=m.subarray(8,24),u=Xe.FAIRPLAY}catch(g){this.warn(`${s} Failed to parse sinf: ${g}`);return}}else{if(a!==Xe.WIDEVINE&&a!==Xe.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${a}`);return}const p=Jz(r),g=p.filter(v=>!!v.systemId&&g0(v.systemId)===a);g.length>1&&this.warn(`${s} Using first of ${g.length} pssh found for selected key-system ${a}`);const m=g[0];if(!m){p.length===0||p.some(v=>!v.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${p.map(v=>g0(v.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=g0(m.systemId),m.version===0&&m.data)if(u===Xe.WIDEVINE){const v=m.data.length-22;l=m.data.subarray(v,v+16)}else u===Xe.PLAYREADY&&(l=_R(m.data))}if(!u||!l){this.log(`Unable to handle ${s} with key-system ${a}`);return}const c=ir.hexDump(l),{keyIdToKeySessionPromise:h,mediaKeySessions:f}=this;let d=h[c];for(let p=0;p<f.length;p++){const g=f[p],m=g.decryptdata;if(!m.keyId)continue;const v=ir.hexDump(m.keyId);if(c===v||m.uri.replace(/-/g,"").indexOf(c)!==-1){if(d=h[v],m.pssh)break;delete h[v],m.pssh=new Uint8Array(r),m.keyId=l,d=h[c]=d.then(()=>this.generateRequestWithPreferredKeySession(g,n,r,"encrypted-event-key-match")),d.catch(O=>this.handleError(O));break}}if(!d){if(u!==a){this.log(`Ignoring "${s}" with ${u} init data for selected key-system ${a}`);return}d=h[c]=this.getKeySystemSelectionPromise([u]).then(({keySystem:p,mediaKeys:g})=>{var m;this.throwIfDestroyed();const v=new _u("ISO-23001-7",c,(m=m0(p))!=null?m:"");return v.pssh=new Uint8Array(r),v.keyId=l,this.attemptSetMediaKeys(p,g).then(()=>{this.throwIfDestroyed();const O=this.createMediaKeySessionContext({decryptdata:v,keySystem:p,mediaKeys:g});return this.generateRequestWithPreferredKeySession(O,n,r,"encrypted-event-no-match")})}),d.catch(p=>this.handleError(p))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(S.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(S.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(S.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(S.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(S.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===Xe.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(o,a,l)=>!!o&&l.indexOf(o)===a,r=t.map(o=>o.audioCodec).filter(n),s=t.map(o=>o.videoCodec).filter(n);return r.length+s.length===0&&s.push("avc1.42e01e"),new Promise((o,a)=>{const l=u=>{const c=u.shift();this.getMediaKeysPromise(c,r,s).then(h=>o({keySystem:c,mediaKeys:h})).catch(h=>{u.length?l(u):h instanceof Ki?a(h):a(new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_ACCESS,error:h,fatal:!0},h.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${n}`;return wR===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return n(e,t)}getMediaKeysPromise(e,t,n){const r=Cz(e,t,n,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let o=s==null?void 0:s.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),o=this.requestMediaKeySystemAccess(e,r);const a=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),o.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),a.mediaKeys=l.createMediaKeys().then(c=>(this.log(`Media-keys created for "${e}"`),u.then(h=>h?this.setMediaKeysServerCertificate(c,e,h):c))),a.mediaKeys.catch(c=>{this.error(`Failed to create media-keys for "${e}"}: ${c}`)}),a.mediaKeys})}return o.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${ir.hexDump(e.keyId||[])}`);const r=n.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return ir.hexDump(e.keyId)}updateKeySession(e,t){var n;const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${ir.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),r.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const r=uh(this.config),s=e.map(p0).filter(o=>!!o&&r.indexOf(o)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:o})=>{const a=m0(o);a?t(a):n(new Error(`Unable to find format for key-system "${o}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),r=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let s=this.keyIdToKeySessionPromise[n];return s||(s=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:a})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(o,a).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:o,mediaKeys:a,decryptdata:t});return this.generateRequestWithPreferredKeySession(l,"cenc",t.pssh,"playlist-key")}))),s.catch(o=>this.handleError(o))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Ki?this.hls.trigger(S.ERROR,e.data):this.hls.trigger(S.ERROR,{type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const r=p0(e.keyFormat),s=r?[r]:uh(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=uh(this.config)),e.length===0)throw new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,n,r){var s,o;const a=(s=this.config.drmSystems)==null||(o=s[e.keySystem])==null?void 0:o.generateRequest;if(a)try{const p=a.call(this.hls,t,n,e);if(!p)throw new Error("Invalid response from configured generateRequest filter");t=p.initDataType,n=e.decryptdata.pssh=p.initData?new Uint8Array(p.initData):null}catch(p){var l;if(this.warn(p.message),(l=this.hls)!=null&&l.config.debug)throw p}if(n===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${u} (init data type: ${t} length: ${n?n.byteLength:null})`);const c=new S1,h=e._onmessage=p=>{const g=e.mediaKeysSession;if(!g){c.emit("error",new Error("invalid state"));return}const{messageType:m,message:v}=p;this.log(`"${m}" message event for session "${g.sessionId}" message size: ${v.byteLength}`),m==="license-request"||m==="license-renewal"?this.renewLicense(e,v).catch(O=>{this.handleError(O),c.emit("error",O)}):m==="license-release"?e.keySystem===Xe.FAIRPLAY&&(this.updateKeySession(e,vv("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${m}"`)},f=e._onkeystatuseschange=p=>{if(!e.mediaKeysSession){c.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const m=e.keyStatus;c.emit("keyStatus",m),m==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",h),e.mediaKeysSession.addEventListener("keystatuseschange",f);const d=new Promise((p,g)=>{c.on("error",g),c.on("keyStatus",m=>{m.startsWith("usable")?p():m==="output-restricted"?g(new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):m==="internal-error"?g(new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${m}"`)):m==="expired"?g(new Error("key expired while generating request")):this.warn(`unhandled key status change "${m}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var p;this.log(`Request generated for key-session "${(p=e.mediaKeysSession)==null?void 0:p.sessionId}" keyId: ${u}`)}).catch(p=>{throw new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_SESSION,error:p,fatal:!1},`Error generating key-session request: ${p}`)}).then(()=>d).catch(p=>{throw c.removeAllListeners(),this.removeSession(e),p}).then(()=>(c.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${ir.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${ir.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,r=new n(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,a)=>{const l={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(f,d,p,g)=>{o(f.data)},onError:(f,d,p,g)=>{a(new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:Gt({url:l.url,data:void 0},f)},`"${e}" certificate request failed (${s}). Status: ${f.code} (${f.text})`))},onTimeout:(f,d,p)=>{a(new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(f,d,p)=>{a(new Error("aborted"))}};r.load(l,c,h)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,s)=>{e.setServerCertificate(n).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),r(e)}).catch(o=>{s(new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(r=>{throw new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:r,fatal:!0},r.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(n,"application/xml"),s=r.querySelectorAll("HttpHeader");if(s.length>0){let c;for(let h=0,f=s.length;h<f;h++){var o,a;c=s[h];const d=(o=c.querySelector("name"))==null?void 0:o.textContent,p=(a=c.querySelector("value"))==null?void 0:a.textContent;d&&p&&e.setRequestHeader(d,p)}}const l=r.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return vv(atob(u))}setupLicenseXHR(e,t,n,r){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,n,r)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),s.call(this.hls,e,t,n,r)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((r,s)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let l=a.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,a,o,e)}catch(c){this.error(c)}r(l)}else{const l=n.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||a.status>=400&&a.status<500)s(new Ki({type:be.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const c=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${c} attempts left`),this.requestLicense(e,t).then(r,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:l,licenseChallenge:u})=>{e.keySystem==Xe.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},_u.clearKeyUriToKeyIdMap();const n=t.length;va.CDMCleanupPromise=Promise.all(t.map(r=>this.removeSession(r)).concat(e==null?void 0:e.setMediaKeys(null).catch(r=>{this.log(`Could not clear media keys: ${r}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(r=>{this.log(`Could not close sessions and clear media keys: ${r}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((r,s)=>(r.indexOf(s.keyFormat)===-1&&r.push(s.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}va.CDMCleanupPromise=void 0;class Ki extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var ei;(function(i){i.MANIFEST="m",i.AUDIO="a",i.VIDEO="v",i.MUXED="av",i.INIT="i",i.CAPTION="c",i.TIMED_TEXT="tt",i.KEY="k",i.OTHER="o"})(ei||(ei={}));var _v;(function(i){i.DASH="d",i.HLS="h",i.SMOOTH="s",i.OTHER="o"})(_v||(_v={}));var Js;(function(i){i.OBJECT="CMCD-Object",i.REQUEST="CMCD-Request",i.SESSION="CMCD-Session",i.STATUS="CMCD-Status"})(Js||(Js={}));const kY={[Js.OBJECT]:["br","d","ot","tb"],[Js.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Js.SESSION]:["cid","pr","sf","sid","st","v"],[Js.STATUS]:["bs","rtp"]};class Fa{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof Fa?n:new Fa(n))),this.value=e,this.params=t}}class SL{constructor(e){this.description=void 0,this.description=e}}const TY="Dict";function EY(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function wY(i,e,t,n){return new Error(`failed to ${i} "${EY(e)}" as ${t}`,{cause:n})}const UE="Bare Item",_Y="Boolean",CY="Byte Sequence",AY="Decimal",PY="Integer";function RY(i){return i<-999999999999999||999999999999999<i}const LY=/[\x00-\x1f\x7f]+/,IY="Token",DY="Key";function mr(i,e,t){return wY("serialize",i,e,t)}function $Y(i){if(typeof i!="boolean")throw mr(i,_Y);return i?"?1":"?0"}function MY(i){return btoa(String.fromCharCode(...i))}function FY(i){if(ArrayBuffer.isView(i)===!1)throw mr(i,CY);return`:${MY(i)}:`}function kL(i){if(RY(i))throw mr(i,PY);return i.toString()}function NY(i){return`@${kL(i.getTime()/1e3)}`}function TL(i,e){if(i<0)return-TL(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const r=Math.floor(i*t);return(r%2===0?r:r+1)/t}else return Math.round(i*t)/t}function QY(i){const e=TL(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw mr(i,AY);const t=e.toString();return t.includes(".")?t:`${t}.0`}const BY="String";function UY(i){if(LY.test(i))throw mr(i,BY);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function VY(i){return i.description||i.toString().slice(7,-1)}function VE(i){const e=VY(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw mr(e,IY);return e}function Cv(i){switch(typeof i){case"number":if(!ae(i))throw mr(i,UE);return Number.isInteger(i)?kL(i):QY(i);case"string":return UY(i);case"symbol":return VE(i);case"boolean":return $Y(i);case"object":if(i instanceof Date)return NY(i);if(i instanceof Uint8Array)return FY(i);if(i instanceof SL)return VE(i);default:throw mr(i,UE)}}function Av(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw mr(i,DY);return i}function w1(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${Av(e)}`:`;${Av(e)}=${Cv(t)}`).join("")}function EL(i){return i instanceof Fa?`${Cv(i.value)}${w1(i.params)}`:Cv(i)}function ZY(i){return`(${i.value.map(EL).join(" ")})${w1(i.params)}`}function jY(i,e={whitespace:!0}){if(typeof i!="object")throw mr(i,TY);const t=i instanceof Map?i.entries():Object.entries(i),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([r,s])=>{s instanceof Fa||(s=new Fa(s));let o=Av(r);return s.value===!0?o+=w1(s.params):(o+="=",Array.isArray(s.value)?o+=ZY(s):o+=EL(s)),o}).join(`,${n}`)}function GY(i,e){return jY(i,e)}const HY=i=>i==="ot"||i==="sf"||i==="st",XY=i=>typeof i=="number"?ae(i):i!=null&&i!==""&&i!==!1;function zY(i,e){const t=new URL(i),n=new URL(e);if(t.origin!==n.origin)return i;const r=t.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}function WY(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?s:s&3|8).toString(16)})}}}const Of=i=>Math.round(i),qY=(i,e)=>(e!=null&&e.baseUrl&&(i=zY(i,e.baseUrl)),encodeURIComponent(i)),bh=i=>Of(i/100)*100,YY={br:Of,d:Of,bl:bh,dl:bh,mtp:bh,nor:qY,rtp:bh,tb:Of};function KY(i,e){const t={};if(i==null||typeof i!="object")return t;const n=Object.keys(i).sort(),r=At({},YY,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return n.forEach(o=>{if(s!=null&&s(o))return;let a=i[o];const l=r[o];l&&(a=l(a,e)),!(o==="v"&&a===1)&&(o=="pr"&&a===1||XY(a)&&(HY(o)&&typeof a=="string"&&(a=new SL(a)),t[o]=a))}),t}function wL(i,e={}){return i?GY(KY(i,e),At({whitespace:!1},e)):""}function JY(i,e={}){if(!i)return{};const t=Object.entries(i),n=Object.entries(kY).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),r=t.reduce((s,o)=>{var a,l;const[u,c]=o,h=((a=n.find(f=>f[1].includes(u)))==null?void 0:a[0])||Js.REQUEST;return(l=s[h])!=null||(s[h]={}),s[h][u]=c,s},{});return Object.entries(r).reduce((s,[o,a])=>(s[o]=wL(a,e),s),{})}function eK(i,e,t){return At(i,JY(e,t))}const tK="CMCD";function iK(i,e={}){if(!i)return"";const t=wL(i,e);return`${tK}=${encodeURIComponent(t)}`}const ZE=/CMCD=[^&#]+/;function nK(i,e,t){const n=iK(e,t);if(!n)return i;if(ZE.test(i))return i.replace(ZE,n);const r=i.includes("?")?"&":"?";return`${i}${r}${n}`}class rK{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:ei.MANIFEST,su:!this.initialized})}catch(s){M.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const s=r.frag,o=this.hls.levels[s.level],a=this.getObjectType(s),l={d:s.duration*1e3,ot:a};(a===ei.VIDEO||a===ei.AUDIO||a==ei.MUXED)&&(l.br=o.bitrate/1e3,l.tb=this.getTopBandwidth(a)/1e3,l.bl=this.getBufferLength(a)),this.apply(r,l)}catch(s){M.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||WY(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHED,this.onMediaDetached,this),e.on(S.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHED,this.onMediaDetached,this),e.off(S.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:_v.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){At(t,this.createData());const n=t.ot===ei.INIT||t.ot===ei.VIDEO||t.ot===ei.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((s,o)=>(r.includes(o)&&(s[o]=t[o]),s),{})),this.useHeaders?(e.headers||(e.headers={}),eK(e.headers,t)):e.url=nK(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return ei.TIMED_TEXT;if(e.sn==="initSegment")return ei.INIT;if(t==="audio")return ei.AUDIO;if(t==="main")return this.hls.audioTracks.length?ei.VIDEO:ei.MUXED}getTopBandwidth(e){let t=0,n;const r=this.hls;if(e===ei.AUDIO)n=r.audioTracks;else{const s=r.maxAutoLevel,o=s>-1?s+1:r.levels.length;n=r.levels.slice(0,o)}for(const s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===ei.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:tt.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}}const sK=3e5;class oK{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=M.log.bind(M,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===Xt.SendAlternateToPenaltyBox&&n.flags===Tn.MoveAllAlternatesMatchingHost){const r=this.levels;let s=this.pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:a,pathwayId:l,type:u}=t.context;a&&r?o=this.getPathwayForGroupId(a,u,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!s&&r&&(s=r.reduce((a,l)=>(a.indexOf(l.pathwayId)===-1&&a.push(l.pathwayId),a),[])),s&&s.length>1&&(this.updatePathwayPriority(s),n.resolved=this.pathwayId!==o),n.resolved||M.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${r&&r.length} priorities: ${JSON.stringify(s)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(s=>{r-n[s]>sK&&delete n[s]});for(let s=0;s<e.length;s++){const o=e[s];if(o in n)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,GR(t),this.hls.trigger(S.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[a];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,n){const r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let s=0;s<r.length;s++)if(t===Fe.AUDIO_TRACK&&r[s].hasAudioGroup(e)||t===Fe.SUBTITLE_TRACK&&r[s].hasSubtitleGroup(e))return r[s].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(s=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=s;if(t.some(c=>c.pathwayId===o))return;const u=this.getLevelsForPathway(a).map(c=>{const h=new vt(c.attrs);h["PATHWAY-ID"]=o;const f=h.AUDIO&&`${h.AUDIO}_clone_${o}`,d=h.SUBTITLES&&`${h.SUBTITLES}_clone_${o}`;f&&(n[h.AUDIO]=f,h.AUDIO=f),d&&(r[h.SUBTITLES]=d,h.SUBTITLES=d);const p=_L(c.uri,h["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),g=new Ma({attrs:h,audioCodec:c.audioCodec,bitrate:c.bitrate,height:c.height,name:c.name,url:p,videoCodec:c.videoCodec,width:c.width});if(c.audioGroups)for(let m=1;m<c.audioGroups.length;m++)g.addGroupId("audio",`${c.audioGroups[m]}_clone_${o}`);if(c.subtitleGroups)for(let m=1;m<c.subtitleGroups.length;m++)g.addGroupId("text",`${c.subtitleGroups[m]}_clone_${o}`);return g});t.push(...u),jE(this.audioTracks,n,l,o),jE(this.subtitleTracks,r,l,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const c=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+c)}const s={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},u={onSuccess:(c,h,f,d)=>{this.log(`Loaded steering manifest: "${r}"`);const p=c.data;if(p.VERSION!==1){this.log(`Steering VERSION ${p.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=p.TTL;const{"RELOAD-URI":g,"PATHWAY-CLONES":m,"PATHWAY-PRIORITY":v}=p;if(g)try{this.uri=new self.URL(g,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${g}`);return}this.scheduleRefresh(this.uri||f.url),m&&this.clonePathways(m);const O={steeringManifest:p,url:r.toString()};this.hls.trigger(S.STEERING_MANIFEST_LOADED,O),v&&this.updatePathwayPriority(v)},onError:(c,h,f,d)=>{if(this.log(`Error loading steering manifest: ${c.code} ${c.text} (${h.url})`),this.stopLoad(),c.code===410){this.enabled=!1,this.log(`Steering manifest ${h.url} no longer available`);return}let p=this.timeToLoad*1e3;if(c.code===429){const g=this.loader;if(typeof(g==null?void 0:g.getResponseHeader)=="function"){const m=g.getResponseHeader("Retry-After");m&&(p=parseFloat(m)*1e3)}this.log(`Steering manifest ${h.url} rate limited`);return}this.scheduleRefresh(this.uri||h.url,p)},onTimeout:(c,h,f)=>{this.log(`Timeout loading steering manifest (${h.url})`),this.scheduleRefresh(this.uri||h.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,l,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const r=(n=this.hls)==null?void 0:n.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function jE(i,e,t,n){i&&Object.keys(e).forEach(r=>{const s=i.filter(o=>o.groupId===r).map(o=>{const a=At({},o);return a.details=void 0,a.attrs=new vt(a.attrs),a.url=a.attrs.URI=_L(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[r],a.attrs["PATHWAY-ID"]=n,a});i.push(...s)})}function _L(i,e,t,n){const{HOST:r,PARAMS:s,[t]:o}=n;let a;e&&(a=o==null?void 0:o[e],a&&(i=a));const l=new self.URL(i);return r&&!a&&(l.host=r),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}const aK=/^age:\s*[\d.]+\s*$/im;class CL{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new kp,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return s(n,t.url)}).catch(o=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),s(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{this.callbacks.onError({code:n.status,text:o.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=n.loadPolicy;if(r)for(const a in r)e.setRequestHeader(a,r[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&ae(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,a=t.responseType==="text"?t.responseText:null;if(o>=200&&o<300){const h=a??t.response;if(h!=null){n.loading.end=Math.max(self.performance.now(),n.loading.first);const f=t.responseType==="arraybuffer"?h.byteLength:h.length;if(n.loaded=n.total=f,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const d=this.callbacks.onProgress;if(d&&d(n,e,h,t),!this.callbacks)return;const p={url:t.responseURL,data:h,code:o};this.callbacks.onSuccess(p,n,e,t);return}}const l=s.loadPolicy.errorRetry,u=n.retry,c={url:e.url,data:void 0,code:o};vd(l,u,!1,c)?this.retry(l):(M.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,n))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(vd(e,t,!0))this.retry(e);else{var n;M.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=d1(e,n.retry),n.retry++,M.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&aK.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function lK(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const uK=/(\d+)-(\d+)\/(\d+)/;class GE{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||dK,this.controller=new self.AbortController,this.stats=new kp}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=cK(e,this.controller.signal),o=n.onProgress,a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&ae(u)?u:c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(h=>{this.response=this.loader=h;const f=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},c-(f-r.loading.start)),!h.ok){const{status:d,statusText:p}=h;throw new pK(p||"fetch, bad network response",d,h)}return r.loading.first=f,r.total=fK(h.headers)||r.total,o&&ae(t.highWaterMark)?this.loadProgressively(h,r,e,t.highWaterMark,o):a?h.arrayBuffer():e.responseType==="json"?h.json():h.text()}).then(h=>{const f=this.response;if(!f)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const d=h[l];d&&(r.loaded=r.total=d);const p={url:f.url,data:h,code:f.status};o&&!ae(t.highWaterMark)&&o(r,e,h,f),n.onSuccess(p,r,e,f)}).catch(h=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;const f=h&&h.code||0,d=h?h.message:null;n.onError({code:f,text:d},e,h?h.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,s){const o=new WR,a=e.body.getReader(),l=()=>a.read().then(u=>{if(u.done)return o.dataLength&&s(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const c=u.value,h=c.length;return t.loaded+=h,h<r||o.dataLength?(o.push(c),o.dataLength>=r&&s(t,n,o.flush(),e)):s(t,n,c,e),l()}).catch(()=>Promise.reject());return l()}}function cK(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(At({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function hK(i){const e=uK.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function fK(i){const e=i.get("Content-Range");if(e){const n=hK(e);if(ae(n))return n}const t=i.get("Content-Length");if(t)return parseInt(t)}function dK(i,e){return new self.Request(i.url,e)}class pK extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const gK=/\s/,mK={newCue(i,e,t,n){const r=[];let s,o,a,l,u;const c=self.VTTCue||self.TextTrackCue;for(let f=0;f<n.rows.length;f++)if(s=n.rows[f],a=!0,l=0,u="",!s.isEmpty()){var h;for(let g=0;g<s.chars.length;g++)gK.test(s.chars[g].uchar)&&a?l++:(u+=s.chars[g].uchar,a=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const d=vL(u.trim()),p=T1(e,t,d);i!=null&&(h=i.cues)!=null&&h.getCueById(p)||(o=new c(e,t,d),o.id=p,o.line=f+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),r.push(o))}return i&&r.length&&(r.sort((f,d)=>f.line==="auto"||d.line==="auto"?0:f.line>8&&d.line>8?d.line-f.line:f.line-d.line),r.forEach(f=>UR(i,f))),r}},vK={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},AL=Gt(Gt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:CL,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:jW,bufferController:zq,capLevelController:E1,errorController:LW,fpsController:SY,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:wR,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:vK},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},OK()),{},{subtitleStreamController:jq,subtitleTrackController:Hq,timelineController:bY,audioStreamController:Vq,audioTrackController:Zq,emeController:va,cmcdController:rK,contentSteeringController:oK});function OK(){return{cueHandler:mK,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function yK(i,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=Pv(i),n=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(s=>{const o=`${s==="level"?"playlist":s}LoadPolicy`,a=e[o]===void 0,l=[];r.forEach(u=>{const c=`${s}Loading${u}`,h=e[c];if(h!==void 0&&a){l.push(c);const f=t[o].default;switch(e[o]={default:f},u){case"TimeOut":f.maxLoadTimeMs=h,f.maxTimeToFirstByteMs=h;break;case"MaxRetry":f.errorRetry.maxNumRetry=h,f.timeoutRetry.maxNumRetry=h;break;case"RetryDelay":f.errorRetry.retryDelayMs=h,f.timeoutRetry.retryDelayMs=h;break;case"MaxRetryTimeout":f.errorRetry.maxRetryDelayMs=h,f.timeoutRetry.maxRetryDelayMs=h;break}}}),l.length&&M.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),Gt(Gt({},t),e)}function Pv(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(Pv):Object.keys(i).reduce((e,t)=>(e[t]=Pv(i[t]),e),{}):i}function bK(i){const e=i.loader;e!==GE&&e!==CL?(M.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):lK()&&(i.loader=GE,i.progressive=!0,i.enableSoftwareAES=!0,M.log("[config]: Progressive streaming enabled, using FetchLoader"))}let $0;class xK extends p1{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this),e.on(S.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this),e.off(S.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,r=[],s={},o={};let a=!1,l=!1,u=!1;t.levels.forEach(c=>{var h,f;const d=c.attrs;let{audioCodec:p,videoCodec:g}=c;((h=p)==null?void 0:h.indexOf("mp4a.40.34"))!==-1&&($0||($0=/chrome|firefox/i.test(navigator.userAgent)),$0&&(c.audioCodec=p=void 0)),p&&(c.audioCodec=p=pd(p,n)),((f=g)==null?void 0:f.indexOf("avc1"))===0&&(g=c.videoCodec=aW(g));const{width:m,height:v,unknownCodecs:O}=c;if(a||(a=!!(m&&v)),l||(l=!!g),u||(u=!!p),O!=null&&O.length||p&&!b0(p,"audio",n)||g&&!b0(g,"video",n))return;const{CODECS:y,"FRAME-RATE":x,"HDCP-LEVEL":b,"PATHWAY-ID":E,RESOLUTION:T,"VIDEO-RANGE":_}=d,A=`${`${E||"."}-`}${c.bitrate}-${T}-${x}-${y}-${_}-${b}`;if(s[A])if(s[A].uri!==c.url&&!c.attrs["PATHWAY-ID"]){const I=o[A]+=1;c.attrs["PATHWAY-ID"]=new Array(I+1).join(".");const L=new Ma(c);s[A]=L,r.push(L)}else s[A].addGroupId("audio",d.AUDIO),s[A].addGroupId("text",d.SUBTITLES);else{const I=new Ma(c);s[A]=I,o[A]=1,r.push(I)}}),this.filterAndSortMediaOptions(r,t,a,l,u)}filterAndSortMediaOptions(e,t,n,r,s){let o=[],a=[],l=e;if((n||r)&&s&&(l=l.filter(({videoCodec:p,videoRange:g,width:m,height:v})=>(!!p||!!(m&&v))&&bW(g))),l.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const p=new Error("no level with compatible codecs found in manifest");this.hls.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:p,reason:p.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:p}=this.hls.config;o=t.audioTracks.filter(g=>!g.audioCodec||b0(g.audioCodec,"audio",p)),HE(o)}t.subtitles&&(a=t.subtitles,HE(a));const u=l.slice(0);l.sort((p,g)=>{if(p.attrs["HDCP-LEVEL"]!==g.attrs["HDCP-LEVEL"])return(p.attrs["HDCP-LEVEL"]||"")>(g.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&p.height!==g.height)return p.height-g.height;if(p.frameRate!==g.frameRate)return p.frameRate-g.frameRate;if(p.videoRange!==g.videoRange)return gd.indexOf(p.videoRange)-gd.indexOf(g.videoRange);if(p.videoCodec!==g.videoCodec){const m=JT(p.videoCodec),v=JT(g.videoCodec);if(m!==v)return v-m}if(p.uri===g.uri&&p.codecSet!==g.codecSet){const m=dd(p.codecSet),v=dd(g.codecSet);if(m!==v)return v-m}return p.averageBitrate!==g.averageBitrate?p.averageBitrate-g.averageBitrate:0});let c=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let p=0;p<u.length;p++)if(u[p].pathwayId===l[0].pathwayId){c=u[p];break}}this._levels=l;for(let p=0;p<l.length;p++)if(l[p]===c){var h;this._firstLevel=p;const g=c.bitrate,m=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${g}`),((h=this.hls.userConfig)==null?void 0:h.abrEwmaDefaultEstimate)===void 0){const v=Math.min(g,this.hls.config.abrEwmaDefaultEstimateMax);v>m&&m===AL.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=v)}break}const f=s&&!r,d={levels:l,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:r,altAudio:!f&&o.some(p=>!!p.url)};this.hls.trigger(S.MANIFEST_PARSED,d),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const c=new Error("invalid level idx"),h=e<0;if(this.hls.trigger(S.ERROR,{type:be.OTHER_ERROR,details:Q.LEVEL_SWITCH_ERROR,level:e,fatal:h,error:c,reason:c.message}),h)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&r&&s===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${n}${s?" with Pathway "+s:""}`);const l={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(S.LEVEL_SWITCHING,l);const u=o.details;if(!u||u.live){const c=this.switchParams(o.uri,r==null?void 0:r.details,u);this.loadPlaylist(c)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===Fe.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Oe.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(s=>!!n[s]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:s}=t,o=this._levels[r];if(!o){var a;this.warn(`Invalid level index ${r}`),(a=t.deliveryDirectives)!=null&&a.skip&&(s.deltaUpdateFailed=!0);return}r===this.currentLevelIndex?(o.fragmentError===0&&(o.loadError=0),this.playlistLoaded(r,t,o.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let r=n.uri;if(e)try{r=e.addDirectives(r)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const s=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} ${r}`),this.clearTimer(),this.hls.trigger(S.LEVEL_LOADING,{url:r,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((r,s)=>s!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(o=>o.level=-1)),!1));GR(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(S.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(S.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function HE(i){const e={};i.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}class SK{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[n].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Q.KEY_LOAD_ERROR,n,r,s){return new Ar({type:be.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:r}=e;for(let s=0;s<t.length;s++){const o=t[s];if(r<=o.cc&&(n==="initSegment"||o.sn==="initSegment"||n<o.sn)){this.emeController.selectKeySystemFormat(o).then(a=>{o.setKeyFormat(a)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,u))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if((n=a)!=null&&n.decryptdata.key)return s.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});if((r=a)!=null&&r.keyLoadPromise){var l;switch((l=a.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}}switch(a=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(n);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=n.loader,s=new r(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(f,d,p,g)=>{const{frag:m,keyInfo:v,url:O}=p;if(!m.decryptdata||v!==this.keyUriToKeyInfo[O])return a(this.createKeyLoadError(m,Q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),g));v.decryptdata.key=m.decryptdata.key=new Uint8Array(f.data),m.keyLoader=null,v.loader=null,o({frag:m,keyInfo:v})},onError:(f,d,p,g)=>{this.resetLoader(d),a(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`HTTP Error ${f.code} loading key ${f.text}`),p,Gt({url:l.url,data:void 0},f)))},onTimeout:(f,d,p)=>{this.resetLoader(d),a(this.createKeyLoadError(t,Q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),p))},onAbort:(f,d,p)=>{this.resetLoader(d),a(this.createKeyLoadError(t,Q.INTERNAL_ABORTED,new Error("key loading aborted"),p))}};s.load(l,c,h)})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}}function PL(){return self.SourceBuffer||self.WebKitSourceBuffer}function RL(){if(!fo())return!1;const e=PL();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function kK(){if(!RL())return!1;const i=fo();return typeof(i==null?void 0:i.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(Cu(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(Cu(e,"audio"))))}function TK(){var i;const e=PL();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const EK=250,yf=2,wK=.1,_K=.05;class CK{constructor(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:r,stalled:s}=this;if(r===null)return;const{currentTime:o,seeking:a}=r,l=this.seeking&&!a,u=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,a||(this.nudgeRetry=0),s!==null){if(this.stallReported){const m=self.performance.now()-s;M.warn(`playback not stuck anymore @${o}, after ${Math.round(m)}ms`),this.stallReported=!1}this.stalled=null}return}if(u||l){this.stalled=null;return}if(r.paused&&!a||r.ended||r.playbackRate===0||!tt.getBuffered(r).length){this.nudgeRetry=0;return}const c=tt.bufferInfo(r,o,0),h=c.nextStart||0;if(a){const m=c.len>yf,v=!h||t&&t.start<=o||h-o>yf&&!this.fragmentTracker.getPartialFragment(o);if(m||v)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var f;if(!(c.len>0)&&!h)return;const v=Math.max(h,c.start||0)-o,O=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,x=(O==null||(f=O.details)==null?void 0:f.live)?O.details.targetduration*2:yf,b=this.fragmentTracker.getPartialFragment(o);if(v>0&&(v<=x||b)){r.paused||this._trySkipBufferHole(b);return}}const d=self.performance.now();if(s===null){this.stalled=d;return}const p=d-s;if(!a&&p>=EK&&(this._reportStall(c),!this.media))return;const g=tt.bufferInfo(r,o,n.maxBufferHole);this._tryFixBufferStall(g,p)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:r,media:s}=this;if(s===null)return;const o=s.currentTime,a=r.getPartialFragment(o);a&&(this._trySkipBufferHole(a)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(M.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:r}=this;if(!r&&n){this.stallReported=!0;const s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);M.warn(s.message),t.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:r}=this;if(r===null)return 0;const s=r.currentTime,o=tt.bufferInfo(r,s,0),a=s<o.start?o.start:o.nextStart;if(a){const l=o.len<=t.maxBufferHole,u=o.len>0&&o.len<1&&r.readyState<3,c=a-s;if(c>0&&(l||u)){if(c>t.maxBufferHole){const{fragmentTracker:f}=this;let d=!1;if(s===0){const p=f.getAppendedFrag(0,Oe.MAIN);p&&a<p.end&&(d=!0)}if(!d){const p=e||f.getAppendedFrag(s,Oe.MAIN);if(p){let g=!1,m=p.end;for(;m<a;){const v=f.getPartialFragment(m);if(v)m+=v.duration;else{g=!0;break}}if(g)return 0}}}const h=Math.max(a+_K,s+wK);if(M.warn(`skipping hole, adjusting currentTime from ${s} to ${h}`),this.moved=!0,this.stalled=null,r.currentTime=h,e&&!e.gap){const f=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${h}`);n.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:f,reason:f.message,frag:e})}return h}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:r}=this;if(n===null)return;const s=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const o=s+(r+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${s} to ${o}`);M.warn(a.message),n.currentTime=o,t.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);M.error(o.message),t.trigger(S.ERROR,{type:be.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}const AK=100;class PK extends v1{constructor(e,t,n){super(e,t,n,"[stream-controller]",Oe.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.LEVEL_LOADING,this.onLevelLoading,this),e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(S.ERROR,this.onError,this),e.on(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(S.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(S.BUFFER_CREATED,this.onBufferCreated,this),e.on(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(S.ERROR,this.onError,this),e.off(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(S.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(S.BUFFER_CREATED,this.onBufferCreated,this),e.off(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(AK),this.level=-1,!this.startFragRequested){let r=n.startLevel;r===-1&&(n.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=n.firstAutoLevel),n.nextLoadLevel=r,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=X.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=X.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case X.WAITING_LEVEL:{const{levels:t,level:n}=this,r=t==null?void 0:t[n],s=r==null?void 0:r.details;if(s&&(!s.live||this.levelLastLoaded===r)){if(this.waitForCdnTuneIn(s))break;this.state=X.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=X.IDLE;break}break}case X.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:r,level:s}=this,o=r==null?void 0:r[s];this.resetStartWhenNotLoaded(o||null),this.state=X.IDLE}}break}this.state===X.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(t===null||!r&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[s]))return;const o=n[s],a=this.getMainFwdBufferInfo();if(a===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){const g={};this.altAudio&&(g.type="video"),this.hls.trigger(S.BUFFER_EOS,g),this.state=X.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=o.details;if(!u||this.state===X.WAITING_LEVEL||u.live&&this.levelLastLoaded!==o){this.level=s,this.state=X.WAITING_LEVEL;return}const c=a.len,h=this.getMaxBufferLength(o.maxBitrate);if(c>=h)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const f=this.backtrackFragment?this.backtrackFragment.start:a.end;let d=this.getNextFragment(f,u);if(this.couldBacktrack&&!this.fragPrevious&&d&&d.sn!=="initSegment"&&this.fragmentTracker.getState(d)!==Vt.OK){var p;const m=((p=this.backtrackFragment)!=null?p:d).sn-u.startSN,v=u.fragments[m-1];v&&d.cc===v.cc&&(d=v,this.fragmentTracker.removeFragment(v))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(d&&this.isLoopLoading(d,f)){if(!d.gap){const m=this.audioOnly&&!this.altAudio?We.AUDIO:We.VIDEO,v=(m===We.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;v&&this.afterBufferFlushed(v,m,Oe.MAIN)}d=this.getNextFragmentLoopLoading(d,u,a,Oe.MAIN,h)}d&&(d.initSegment&&!d.initSegment.data&&!this.bitrateTest&&(d=d.initSegment),this.loadFragment(d,o,f))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===Vt.NOT_LOADED||r===Vt.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Oe.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<s.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,l=e[a],u=this.fragLastKbps;u&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:n=0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const l=a.maxStartPTS?a.maxStartPTS:a.start,u=a.duration,c=Math.max(o.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case X.KEY_LOADING:case X.FRAG_LOADING:case X.FRAG_LOADING_WAITING_RETRY:case X.PARSING:case X.PARSED:this.state=X.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new CK(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;ae(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(S.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,r=!1;t.levels.forEach(s=>{const o=s.audioCodec;o&&(n=n||o.indexOf("mp4a.40.2")!==-1,r=r||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&r&&!TK(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==X.IDLE)return;const r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(r.details))&&(this.state=X.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:r}=this,s=t.level,o=t.details,a=o.totalduration;if(!r){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const l=r[s],u=this.fragCurrent;u&&(this.state===X.FRAG_LOADING||this.state===X.FRAG_LOADING_WAITING_RETRY)&&u.level!==t.level&&u.loader&&this.abortCurrentFrag();let c=0;if(o.live||(n=l.details)!=null&&n.live){var h;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;c=this.alignPlaylists(o,l.details,(h=this.levelLastLoaded)==null?void 0:h.details)}if(l.details=o,this.levelLastLoaded=l,this.hls.trigger(S.LEVEL_UPDATED,{details:o,level:s}),this.state===X.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=X.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,c),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:s}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const a=o[n.level],l=a.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const u=a.videoCodec,c=l.PTSKnown||!l.live,h=(t=n.initSegment)==null?void 0:t.data,f=this._getAudioCodec(a),d=this.transmuxer=this.transmuxer||new hL(this.hls,Oe.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=r?r.index:-1,g=p!==-1,m=new g1(n.level,n.sn,n.stats.chunkCount,s.byteLength,p,g),v=this.initPTS[n.cc];d.push(s,h,f,u,n,r,l.totalduration,c,m,v)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;n&&(s.trigger(S.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(S.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,r=!!this.hls.audioTracks[n].url;if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,s,o=!1;for(const a in n){const l=n[a];if(l.id==="main"){if(s=a,r=l,a==="video"){const u=n[a];u&&(this.videoBuffer=u.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n&&n.type!==Oe.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===X.PARSED&&(this.state=X.IDLE);return}const s=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=X.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Oe.MAIN,t);break;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===X.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===Fe.LEVEL&&(this.state=X.IDLE);break;case Q.BUFFER_APPEND_ERROR:case Q.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===Q.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!tt.getBuffered(e).length){const n=this.state!==X.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=X.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==We.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===We.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,Oe.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const r=tt.getBuffered(e),o=(r.length?r.start(0):0)-n;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=X.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),r.trigger(S.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:u,level:c}=a,{video:h,text:f,id3:d,initSegment:p}=s,{details:g}=c,m=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=X.PARSING,p){if(p!=null&&p.tracks){const y=l.initSegment||l;this._bufferInitSegment(c,p.tracks,y,o),r.trigger(S.FRAG_PARSING_INIT_SEGMENT,{frag:y,id:n,tracks:p.tracks})}const v=p.initPTS,O=p.timescale;ae(v)&&(this.initPTS[l.cc]={baseTime:v,timescale:O},r.trigger(S.INIT_PTS_FOUND,{frag:l,id:n,initPTS:v,timescale:O}))}if(h&&g&&l.sn!=="initSegment"){const v=g.fragments[l.sn-1-g.startSN],O=l.sn===g.startSN,y=!v||l.cc>v.cc;if(s.independent!==!1){const{startPTS:x,endPTS:b,startDTS:E,endDTS:T}=h;if(u)u.elementaryStreams[h.type]={startPTS:x,endPTS:b,startDTS:E,endDTS:T};else if(h.firstKeyFrame&&h.independent&&o.id===1&&!y&&(this.couldBacktrack=!0),h.dropped&&h.independent){const _=this.getMainFwdBufferInfo(),D=(_?_.end:this.getLoadPosition())+this.config.maxBufferHole,A=h.firstKeyFramePTS?h.firstKeyFramePTS:x;if(!O&&D<A-this.config.maxBufferHole&&!y){this.backtrack(l);return}else y&&(l.gap=!0);l.setElementaryStreamInfo(h.type,l.start,b,l.start,T,!0)}else O&&x>yf&&(l.gap=!0);l.setElementaryStreamInfo(h.type,x,b,E,T),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,u,o,O||y)}else if(O||y)l.gap=!0;else{this.backtrack(l);return}}if(m){const{startPTS:v,endPTS:O,startDTS:y,endDTS:x}=m;u&&(u.elementaryStreams[We.AUDIO]={startPTS:v,endPTS:O,startDTS:y,endDTS:x}),l.setElementaryStreamInfo(We.AUDIO,v,O,y,x),this.bufferFragmentData(m,l,u,o)}if(g&&d!=null&&(t=d.samples)!=null&&t.length){const v={id:n,frag:l,details:g,samples:d.samples};r.trigger(S.FRAG_PARSING_METADATA,v)}if(g&&f){const v={id:n,frag:l,details:g,samples:f.samples};r.trigger(S.FRAG_PARSING_USERDATA,v)}}_bufferInitSegment(e,t,n,r){if(this.state!==X.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:o,audiovideo:a}=t;if(s){let l=e.audioCodec;const u=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5");const c=s.metadata;c&&"channelCount"in c&&(c.channelCount||1)!==1&&u.indexOf("firefox")===-1&&(l="mp4a.40.5")}l&&l.indexOf("mp4a.40.5")!==-1&&u.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(S.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const c=t[l].initSegment;c!=null&&c.byteLength&&this.hls.trigger(S.BUFFER_APPENDING,{type:l,data:c,frag:n,part:null,chunkMeta:r,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Oe.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=X.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(tt.isBuffered(e,n)?t=this.getAppendedFrag(n):tt.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s)&&(this.fragPlaying=t,this.hls.trigger(S.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(S.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&ae(t)&&ae(n.programDateTime)){const r=n.programDateTime+(t-n.start)*1e3;return new Date(r)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class eo{static get version(){return"1.5.20"}static isMSESupported(){return RL()}static isSupported(){return kK()}static getMediaSource(){return fo()}static get Events(){return S}static get ErrorTypes(){return be}static get ErrorDetails(){return Q}static get DefaultConfig(){return eo.defaultConfig?eo.defaultConfig:AL}static set DefaultConfig(e){eo.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new S1,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,Oz(e.debug||!1,"Hls instance");const t=this.config=yK(eo.DefaultConfig,e);this.userConfig=e,t.progressive&&bK(t);const{abrController:n,bufferController:r,capLevelController:s,errorController:o,fpsController:a}=t,l=new o(this),u=this.abrController=new n(this),c=this.bufferController=new r(this),h=this.capLevelController=new s(this),f=new a(this),d=new fW(this),p=new vW(this),g=t.contentSteeringController,m=g?new g(this):null,v=this.levelController=new xK(this,m),O=new HW(this),y=new SK(this.config),x=this.streamController=new PK(this,O,y);h.setStreamController(x),f.setStreamController(x);const b=[d,v,x];m&&b.splice(1,0,m),this.networkControllers=b;const E=[u,c,h,f,p,O];this.audioTrackController=this.createController(t.audioTrackController,b);const T=t.audioStreamController;T&&b.push(new T(this,O,y)),this.subtitleTrackController=this.createController(t.subtitleTrackController,b);const _=t.subtitleStreamController;_&&b.push(new _(this,O,y)),this.createController(t.timelineController,E),y.emeController=this.emeController=this.createController(t.emeController,E),this.cmcdController=this.createController(t.cmcdController,E),this.latencyController=this.createController(OW,E),this.coreComponents=E,b.push(l);const D=l.onErrorOut;typeof D=="function"&&this.on(S.ERROR,D,l)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(M.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const r=e===S.ERROR;this.trigger(S.ERROR,{type:be.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:r,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){M.log("destroy"),this.trigger(S.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){M.log("attachMedia"),this._media=e,this.trigger(S.MEDIA_ATTACHING,{media:e})}detachMedia(){M.log("detachMedia"),this.trigger(S.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,r=this.url=u1.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,M.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(S.MANIFEST_LOADING,{url:e})}startLoad(e=-1){M.log(`startLoad(${e})`),this.started=!0,this.resumeBuffering();for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),!(!this.started||!this.networkControllers));t++);}stopLoad(){M.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}resumeBuffering(){M.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()})}pauseBuffering(){M.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()})}swapAudioCodec(){M.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){M.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){M.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){M.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){M.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){M.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){M.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(M.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){yW(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,n)for(let s=r;s--;){const o=e[s].attrs["HDCP-LEVEL"];if(o&&o<=n)return s}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}eo.defaultConfig=void 0;const RK=["src"],LK=Ze({__name:"video-viewer",setup(i){const{data:e}=mi(Or()),t=HO(),{userInfo:n}=mi(Lm()),r=nf("video"),s=ce("");return tl(async()=>{if(!(!e.value||!r.value))if(e.value.type!=="application/x-mpegurl")s.value=URL.createObjectURL(e.value);else{const o=new eo({xhrSetup(l){l.setRequestHeader("Authorization",n.value.accessToken),l.setRequestHeader("shareId",t.params.shareId??"")}}),a=await e.value.text();o.loadSource(a),o.attachMedia(r.value)}}),(o,a)=>{var l;return Ei(),$r("video",{ref:"video",src:ze(s),key:(l=ze(e))==null?void 0:l.type,controls:"",controlslist:"nodownload"},null,8,RK)}}}),IK=Ze({__name:"excel-viewer",setup(i){const{data:e}=mi(Or()),t=ce("");return tl(async()=>{if(!e.value)return;const n=URL.createObjectURL(e.value);n&&(t.value=n)}),(n,r)=>(Ei(),tc(ze(P5),{src:ze(t),style:{width:"100%"}},null,8,["src"]))}}),DK=ap(IK,[["__scopeId","data-v-d7c7fe53"]]),$K={class:"flex justify-center"},MK=["src"],FK=Ze({__name:"image-viewer",setup(i){const{data:e}=mi(Or()),t=De(()=>e.value?URL.createObjectURL(e.value):"");return(n,r)=>(Ei(),$r("div",$K,[Ko("img",{src:ze(t)},null,8,MK)]))}}),NK=Ze({__name:"pdf-viewer",setup(i){const{data:e}=mi(Or()),t=ce("");return tl(async()=>{if(!e.value)return;const n=URL.createObjectURL(e.value);n&&(t.value=n)}),(n,r)=>(Ei(),tc(ze(R5),{src:ze(t),style:{height:"100%",width:"100%"}},null,8,["src"]))}}),QK=ap(NK,[["__scopeId","data-v-2d0d10eb"]]),BK=Ze({__name:"ppt-viewer",setup(i){const{data:e}=mi(Or()),t=ce("");return tl(async()=>{if(!e.value)return;const n=URL.createObjectURL(e.value);n&&(t.value=n)}),(n,r)=>(Ei(),tc(ze(L5),{src:ze(t)},null,8,["src"]))}}),XE=ap(BK,[["__scopeId","data-v-e1a54170"]]),zE=Ze({__name:"word-viewer",setup(i){const{data:e}=mi(Or()),t=ce("");return tl(async()=>{if(!e.value)return;const n=URL.createObjectURL(e.value);n&&(t.value=n)}),(n,r)=>(Ei(),tc(ze(p5),{src:ze(t)},null,8,["src"]))}});function UK(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function WE(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function qE(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?WE(Object(t),!0).forEach(function(n){UK(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):WE(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function VK(i,e){if(i==null)return{};var t={},n=Object.keys(i),r,s;for(s=0;s<n.length;s++)r=n[s],!(e.indexOf(r)>=0)&&(t[r]=i[r]);return t}function ZK(i,e){if(i==null)return{};var t=VK(i,e),n,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(r=0;r<s.length;r++)n=s[r],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(i,n)&&(t[n]=i[n])}return t}function jK(i,e){return GK(i)||HK(i,e)||XK(i,e)||zK()}function GK(i){if(Array.isArray(i))return i}function HK(i,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var t=[],n=!0,r=!1,s=void 0;try{for(var o=i[Symbol.iterator](),a;!(n=(a=o.next()).done)&&(t.push(a.value),!(e&&t.length===e));n=!0);}catch(l){r=!0,s=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(r)throw s}}return t}}function XK(i,e){if(i){if(typeof i=="string")return YE(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return YE(i,e)}}function YE(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=i[t];return n}function zK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WK(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function KE(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function JE(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?KE(Object(t),!0).forEach(function(n){WK(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):KE(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function qK(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return function(n){return e.reduceRight(function(r,s){return s(r)},n)}}function zl(i){return function e(){for(var t=this,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return r.length>=i.length?i.apply(this,r):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(r,a))}}}function Sd(i){return{}.toString.call(i).includes("Object")}function YK(i){return!Object.keys(i).length}function Pu(i){return typeof i=="function"}function KK(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function JK(i,e){return Sd(e)||Ss("changeType"),Object.keys(e).some(function(t){return!KK(i,t)})&&Ss("changeField"),e}function eJ(i){Pu(i)||Ss("selectorType")}function tJ(i){Pu(i)||Sd(i)||Ss("handlerType"),Sd(i)&&Object.values(i).some(function(e){return!Pu(e)})&&Ss("handlersType")}function iJ(i){i||Ss("initialIsRequired"),Sd(i)||Ss("initialType"),YK(i)&&Ss("initialContent")}function nJ(i,e){throw new Error(i[e]||i.default)}var rJ={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Ss=zl(nJ)(rJ),xh={changes:JK,selector:eJ,handler:tJ,initial:iJ};function sJ(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};xh.initial(i),xh.handler(e);var t={current:i},n=zl(lJ)(t,e),r=zl(aJ)(t),s=zl(xh.changes)(i),o=zl(oJ)(t);function a(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(c){return c};return xh.selector(u),u(t.current)}function l(u){qK(n,r,s,o)(u)}return[a,l]}function oJ(i,e){return Pu(e)?e(i.current):e}function aJ(i,e){return i.current=JE(JE({},i.current),e),e}function lJ(i,e,t){return Pu(e)?e(i.current):Object.keys(t).forEach(function(n){var r;return(r=e[n])===null||r===void 0?void 0:r.call(e,i.current[n])}),t}var uJ={create:sJ},cJ={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function hJ(i){return function e(){for(var t=this,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return r.length>=i.length?i.apply(this,r):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(r,a))}}}function fJ(i){return{}.toString.call(i).includes("Object")}function dJ(i){return i||ew("configIsRequired"),fJ(i)||ew("configType"),i.urls?(pJ(),{paths:{vs:i.urls.monacoBase}}):i}function pJ(){console.warn(LL.deprecation)}function gJ(i,e){throw new Error(i[e]||i.default)}var LL={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},ew=hJ(gJ)(LL),mJ={config:dJ},vJ=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduceRight(function(s,o){return o(s)},r)}};function IL(i,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&i[t]&&Object.assign(e[t],IL(i[t],e[t]))}),qE(qE({},i),e)}var OJ={type:"cancelation",msg:"operation is manually canceled"};function M0(i){var e=!1,t=new Promise(function(n,r){i.then(function(s){return e?r(OJ):n(s)}),i.catch(r)});return t.cancel=function(){return e=!0},t}var yJ=uJ.create({config:cJ,isInitialized:!1,resolve:null,reject:null,monaco:null}),DL=jK(yJ,2),Oc=DL[0],Ep=DL[1];function bJ(i){var e=mJ.config(i),t=e.monaco,n=ZK(e,["monaco"]);Ep(function(r){return{config:IL(r.config,n),monaco:t}})}function xJ(){var i=Oc(function(e){var t=e.monaco,n=e.isInitialized,r=e.resolve;return{monaco:t,isInitialized:n,resolve:r}});if(!i.isInitialized){if(Ep({isInitialized:!0}),i.monaco)return i.resolve(i.monaco),M0(F0);if(window.monaco&&window.monaco.editor)return $L(window.monaco),i.resolve(window.monaco),M0(F0);vJ(SJ,TJ)(EJ)}return M0(F0)}function SJ(i){return document.body.appendChild(i)}function kJ(i){var e=document.createElement("script");return i&&(e.src=i),e}function TJ(i){var e=Oc(function(n){var r=n.config,s=n.reject;return{config:r,reject:s}}),t=kJ("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return i()},t.onerror=e.reject,t}function EJ(){var i=Oc(function(t){var n=t.config,r=t.resolve,s=t.reject;return{config:n,resolve:r,reject:s}}),e=window.require;e.config(i.config),e(["vs/editor/editor.main"],function(t){$L(t),i.resolve(t)},function(t){i.reject(t)})}function $L(i){Oc().monaco||Ep({monaco:i})}function wJ(){return Oc(function(i){var e=i.monaco;return e})}var F0=new Promise(function(i,e){return Ep({resolve:i,reject:e})}),tw={config:bJ,init:xJ,__getMonacoInstance:wJ},_J=Object.defineProperty,CJ=Object.defineProperties,AJ=Object.getOwnPropertyDescriptors,iw=Object.getOwnPropertySymbols,PJ=Object.prototype.hasOwnProperty,RJ=Object.prototype.propertyIsEnumerable,nw=(i,e,t)=>e in i?_J(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,N0=(i,e)=>{for(var t in e||(e={}))PJ.call(e,t)&&nw(i,t,e[t]);if(iw)for(var t of iw(e))RJ.call(e,t)&&nw(i,t,e[t]);return i},LJ=(i,e)=>CJ(i,AJ(e));const Q0={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}};function IJ(i,e){const t=De(()=>{const{width:r,height:s}=i;return LJ(N0({},Q0.wrapper),{width:r,height:s})}),n=De(()=>N0(N0({},Q0.fullWidth),!e.value&&Q0.hide));return{wrapperStyle:t,containerStyle:n}}function DJ(){const i=Qn(tw.__getMonacoInstance()),e=ce(!1);let t;return ft(()=>{i.value||(t=tw.init(),t.then(r=>i.value=r).catch(r=>{(r==null?void 0:r.type)!=="cancelation"&&(e.value=!0,console.error("Monaco initialization error:",r))}))}),{monacoRef:i,unload:()=>t==null?void 0:t.cancel(),isLoadFailed:e}}function rw(i){return typeof i=="function"?i():i}function Rv(i){return i===void 0}function ML(i,e,t,n){return $J(i,n)||MJ(i,e,t,n)}function $J(i,e){return i.editor.getModel(FL(i,e))}function MJ(i,e,t,n){return i.editor.createModel(e,t,n?FL(i,n):void 0)}function FL(i,e){return i.Uri.parse(e)}var FJ=Object.defineProperty,sw=Object.getOwnPropertySymbols,NJ=Object.prototype.hasOwnProperty,QJ=Object.prototype.propertyIsEnumerable,ow=(i,e,t)=>e in i?FJ(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,BJ=(i,e)=>{for(var t in e||(e={}))NJ.call(e,t)&&ow(i,t,e[t]);if(sw)for(var t of sw(e))QJ.call(e,t)&&ow(i,t,e[t]);return i};const UJ={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var VJ=Ze({name:"VueMonacoEditor",model:{prop:"value",event:"update:value"},props:{defaultValue:String,defaultPath:String,defaultLanguage:String,value:String,language:String,path:String,theme:{type:String,default:"vs"},line:Number,options:{type:Object,default:()=>({})},overrideServices:{type:Object,default:()=>({})},saveViewState:{type:Boolean,default:!0},width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},className:String},emits:["update:value","beforeMount","mount","change","validate"],setup(i,e){const t=new Map,n=Qn(null),{monacoRef:r,unload:s,isLoadFailed:o}=DJ(),{editorRef:a}=ZJ(e,i,r,n),{disposeValidator:l}=jJ(e,i,r,a),u=De(()=>!!r.value&&!!a.value),{wrapperStyle:c,containerStyle:h}=IJ(i,u);return g5(()=>{var f,d;(f=l.value)==null||f.call(l),a.value?((d=a.value.getModel())==null||d.dispose(),a.value.dispose()):s()}),pe([()=>i.path,()=>i.value,()=>i.language,()=>i.line],([f,d,p,g],[m,v,O,y])=>{if(u.value){if(f!==m){const x=ML(r.value,d||i.defaultValue||"",p||i.defaultLanguage||"",f||i.defaultPath||"");i.saveViewState&&t.set(m,a.value.saveViewState()),a.value.setModel(x),i.saveViewState&&a.value.restoreViewState(t.get(f)),Rv(g)||a.value.revealLine(g);return}a.value.getValue()!==d&&a.value.setValue(d),p!==O&&r.value.editor.setModelLanguage(a.value.getModel(),p),!Rv(g)&&g!==y&&a.value.revealLine(g)}}),pe(()=>i.options,f=>a.value&&a.value.updateOptions(f),{deep:!0}),pe(()=>i.theme,f=>r.value&&r.value.editor.setTheme(f)),{containerRef:n,isEditorReady:u,isLoadFailed:o,wrapperStyle:c,containerStyle:h}},render(){const{$slots:i,isEditorReady:e,isLoadFailed:t,wrapperStyle:n,containerStyle:r,className:s}=this;return Os("div",{style:n},[!e&&Os("div",{style:UJ},t?i.failure?rw(i.failure):"load failed":i.default?rw(i.default):"loading..."),Os("div",{ref:"containerRef",key:"monaco_editor_container",style:r,class:s})])}});function ZJ({emit:i},e,t,n){const r=Qn(null);ft(()=>{const o=pe(t,()=>{n.value&&t.value&&(wi(()=>o()),s())},{immediate:!0})});function s(){var o;if(!n.value||!t.value||r.value)return;i("beforeMount",t.value);const a=e.path||e.defaultPath,l=ML(t.value,e.value||e.defaultValue||"",e.language||e.defaultLanguage||"",a||"");r.value=t.value.editor.create(n.value,BJ({model:l,theme:e.theme,automaticLayout:!0,autoIndent:"brackets",formatOnPaste:!0,formatOnType:!0},e.options),e.overrideServices),(o=r.value)==null||o.onDidChangeModelContent(u=>{const c=r.value.getValue();c!==e.value&&(i("update:value",c),i("change",c,u))}),r.value&&!Rv(e.line)&&r.value.revealLine(e.line),i("mount",r.value,t.value)}return{editorRef:r}}function jJ({emit:i},e,t,n){const r=ce(null),s=pe([t,n],()=>{if(t.value&&n.value){wi(()=>s());const o=t.value.editor.onDidChangeMarkers(a=>{var l,u;const c=(u=(l=n.value)==null?void 0:l.getModel())==null?void 0:u.uri;if(c&&a.find(f=>f.path===c.path)){const f=t.value.editor.getModelMarkers({resource:c});i("validate",f)}});r.value=()=>o==null?void 0:o.dispose()}});return{disposeValidator:r}}const GJ=i=>{const e=typeof i;return e!=="function"&&e!=="object"||i===null},HJ=i=>{const e=i.flags===""?void 0:i.flags;return new RegExp(i.source,e)},Wl=(i,e=new WeakMap)=>{if(i===null||GJ(i))return i;if(e.has(i))return e.get(i);if(i instanceof RegExp)return HJ(i);if(i instanceof Date)return new Date(i.getTime());if(i instanceof Function)return i;if(i instanceof Map){const n=new Map;return e.set(i,n),i.forEach((r,s)=>{n.set(s,Wl(r,e))}),n}if(i instanceof Set){const n=new Set;e.set(i,n);for(const r of i)n.add(Wl(r,e));return n}if(Array.isArray(i)){const n=[];return e.set(i,n),i.forEach(r=>{n.push(Wl(r,e))}),n}const t={};e.set(i,t);for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=Wl(i[n],e));return t},NL=(i,e=200)=>{let t=0;return(...n)=>new Promise(r=>{t&&(clearTimeout(t),r("cancel")),t=window.setTimeout(()=>{i.apply(void 0,n),t=0,r("done")},e)})},XJ=(i,e={_blank:!0,nofollow:!0})=>{const t=document.createElement("a");t.href=i,e._blank&&(t.target="_blank"),e.nofollow&&(t.rel="noopener noreferrer"),t.click()},QL=()=>{let i=-1;return(e,t,n,r=100)=>{const s=()=>{n&&(typeof r=="number"?setTimeout(n,r):n())};i!==-1&&(cancelAnimationFrame(i),s());let o=e.scrollTop;const a=()=>{i=-1;const l=t-o;o=o+l/5,Math.abs(l)<1?(e.scrollTo(0,t),s()):(e.scrollTo(0,o),i=requestAnimationFrame(a))};i=requestAnimationFrame(a)}},zJ=(i,e=200)=>{let t=0,n=null;const r=s=>{t===0&&(t=s),s-t>=e?(i.apply(void 0,n),n=null,t=0):window.requestAnimationFrame(r)};return(...s)=>{n===null&&window.requestAnimationFrame(r),n=s}},WJ=i=>{const e=t=>{const{scrollHeight:n,scrollWidth:r,offsetHeight:s,offsetWidth:o,scrollLeft:a,scrollTop:l}=i,u=t.x,c=t.y,h=d=>{const p=l+c-d.y,g=a+u-d.x,m=n-s,v=r-o,O={};g>=0&&g<=v&&(O.left=g),p>=0&&p<=m&&(O.top=p),i.scroll(O)};document.addEventListener("mousemove",h);const f=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",f)};document.addEventListener("mouseup",f)};return i.addEventListener("mousedown",e),()=>{i.removeEventListener("mousedown",e)}},Lv=()=>`${Date.now().toString(36)}${Math.random().toString(36).substring(2)}`,aw=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),BL=(i,e,t={})=>{const{excludeKeys:n}=t;for(const r in e)n&&n(r)?i[r]=e[r]:aw(e[r])&&aw(i[r])?i[r]=BL(i[r],e[r],t):i[r]=e[r];return i},C="md-editor",lt="https://unpkg.com",qJ=`${lt}/@highlightjs/cdn-assets@11.10.0/highlight.min.js`,lw={main:`${lt}/prettier@3.3.3/standalone.js`,markdown:`${lt}/prettier@3.3.3/plugins/markdown.js`},YJ={css:`${lt}/cropperjs@1.6.2/dist/cropper.min.css`,js:`${lt}/cropperjs@1.6.2/dist/cropper.min.js`},KJ=`${lt}/screenfull@5.2.0/dist/screenfull.js`,JJ=`${lt}/mermaid@11.3.0/dist/mermaid.min.js`,eee={js:`${lt}/katex@0.16.11/dist/katex.min.js`,css:`${lt}/katex@0.16.11/dist/katex.min.css`},Iv={a11y:{light:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/a11y-light.min.css`,dark:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/a11y-dark.min.css`},atom:{light:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/atom-one-light.min.css`,dark:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/atom-one-dark.min.css`},github:{light:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/github.min.css`,dark:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/github-dark.min.css`},gradient:{light:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/gradient-light.min.css`,dark:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/gradient-dark.min.css`},kimbie:{light:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/kimbie-light.min.css`,dark:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/kimbie-dark.min.css`},paraiso:{light:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/paraiso-light.min.css`,dark:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/qtcreator-light.min.css`,dark:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/stackoverflow-light.min.css`,dark:`${lt}/@highlightjs/cdn-assets@11.10.0/styles/stackoverflow-dark.min.css`}},UL=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","previewOnly","htmlPreview","catalog","github"],VL=["markdownTotal","=","scrollSwitch"],uw={"zh-CN":{toolbarTips:{bold:"",underline:"",italic:"",strikeThrough:"",title:"",sub:"",sup:"",quote:"",unorderedList:"",orderedList:"",task:"",codeRow:"",code:"",link:"",image:"",table:"",mermaid:"mermaid",katex:"katex",revoke:"",next:"",save:"",prettier:"",pageFullscreen:"",fullscreen:"",preview:"",previewOnly:"",htmlPreview:"html",catalog:"",github:""},titleItem:{h1:"",h2:"",h3:"",h4:"",h5:"",h6:""},imgTitleItem:{link:"",upload:"",clip2upload:""},linkModalTips:{linkTitle:"",imageTitle:"",descLabel:"",descLabelPlaceHolder:"...",urlLabel:"",urlLabelPlaceHolder:"...",buttonOK:""},clipModalTips:{title:"",buttonUpload:""},copyCode:{text:"",successTips:"",failTips:""},mermaid:{flow:"",sequence:"",gantt:"",class:"",state:"",pie:"",relationship:"",journey:""},katex:{inline:"",block:""},footer:{markdownTotal:"",scrollAuto:""}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",previewOnly:"preview only",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Image Link",upload:"Upload Images",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Character Count",scrollAuto:"Scroll Auto"}}},Ct={editorExtensions:{highlight:{js:qJ,css:Iv},prettier:{standaloneJs:lw.main,parserMarkdownJs:lw.markdown},cropper:{...YJ},screenfull:{js:KJ},mermaid:{js:JJ},katex:{...eee}},editorExtensionsAttrs:{},editorConfig:{languageUserDefined:{},mermaidTemplate:{},renderDelay:500,zIndex:2e4},codeMirrorExtensions:(i,e)=>e,markdownItConfig:()=>{},markdownItPlugins:i=>i,mermaidConfig:i=>i,katexConfig:i=>i},Sh=.1,pi=({instance:i,ctx:e,props:t={}},n="default")=>{const r=(i==null?void 0:i.$slots[n])||(e==null?void 0:e.slots[n]);return(r?r(i):"")||t[n]},tee={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"},disabled:{type:Boolean,default:void 0}},ia=Ze({name:`${C}-dropdown`,props:tee,setup(i,e){const t=`${C}-dropdown-hidden`,n=di({overlayClass:[t],overlayStyle:{},triggerHover:!1,overlayHover:!1}),r=ce(),s=ce(),o=()=>{var c,h;if(i.disabled)return!1;n.triggerHover=!0;const f=r.value,d=s.value;if(!f||!d)return;const p=f.getBoundingClientRect(),g=f.offsetTop,m=f.offsetLeft,v=p.height,O=p.width,y=f.getRootNode(),x=((c=y.querySelector(i.relative))==null?void 0:c.scrollLeft)||0,b=((h=y.querySelector(i.relative))==null?void 0:h.clientWidth)||0;let E=m-d.offsetWidth/2+O/2-x;E+d.offsetWidth>x+b&&(E=x+b-d.offsetWidth),E<0&&(E=0),n.overlayStyle={...n.overlayStyle,top:g+v+"px",left:E+"px"},i.onChange(!0)},a=()=>{if(i.disabled)return!1;n.overlayHover=!0};pe(()=>i.visible,c=>{c?n.overlayClass=n.overlayClass.filter(h=>h!==t):n.overlayClass.push(t)});let l=-1;const u=c=>{r.value===c.target?n.triggerHover=!1:n.overlayHover=!1,clearTimeout(l),l=window.setTimeout(()=>{!n.overlayHover&&!n.triggerHover&&i.onChange(!1)},10)};return ft(()=>{r.value.addEventListener("mouseenter",o),r.value.addEventListener("mouseleave",u),s.value.addEventListener("mouseenter",a),s.value.addEventListener("mouseleave",u)}),Rs(()=>{r.value.removeEventListener("mouseenter",o),r.value.removeEventListener("mouseleave",u),s.value.removeEventListener("mouseenter",a),s.value.removeEventListener("mouseleave",u)}),()=>{const c=pi({ctx:e}),h=pi({props:i,ctx:e},"overlay"),f=xu(c instanceof Array?c[0]:c,{ref:r,key:"cloned-dropdown-trigger"}),d=R("div",{class:[`${C}-dropdown`,n.overlayClass],style:n.overlayStyle,ref:s},[R("div",{class:`${C}-dropdown-overlay`},[h instanceof Array?h[0]:h])]);return[f,d]}}}),iee={title:{type:String,default:""},visible:{type:Boolean,default:void 0},trigger:{type:[String,Object],default:void 0},onChange:{type:Function,default:void 0},overlay:{type:[String,Object],default:void 0},insert:{type:Function,default:void 0},language:{type:String,default:void 0},theme:{type:String,default:void 0},previewTheme:{type:String,default:void 0},codeTheme:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},showToolbarName:{type:Boolean,default:void 0}},bf=Ze({name:"DropdownToolbar",props:iee,emits:["onChange"],setup(i,e){const t=xe("editorId");return()=>{const n=pi({props:i,ctx:e},"trigger"),r=pi({props:i,ctx:e},"overlay"),s=pi({props:i,ctx:e});return R(ia,{relative:`#${t}-toolbar-wrapper`,visible:i.visible,onChange:o=>{var a;(a=i.onChange)==null||a.call(i,o),e.emit("onChange",o)},overlay:r,disabled:i.disabled},{default:()=>[R("div",{class:[`${C}-toolbar-item`,i.disabled&&`${C}-disabled`],title:i.title||""},[s||n])]})}}});bf.install=i=>(i.component(bf.name,bf),i);var nee=Object.defineProperty,ree=(i,e,t)=>e in i?nee(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,see=(i,e,t)=>ree(i,e+"",t);class oee{constructor(){see(this,"pools",{})}remove(e,t,n){const s=this.pools[e]&&this.pools[e][t];s&&(this.pools[e][t]=s.filter(o=>o!==n))}clear(e){this.pools[e]={}}on(e,t){return this.pools[e]||(this.pools[e]={}),this.pools[e][t.name]||(this.pools[e][t.name]=[]),this.pools[e][t.name].push(t.callback),this.pools[e][t.name].includes(t.callback)}emit(e,t,...n){this.pools[e]||(this.pools[e]={});const s=this.pools[e][t];s&&s.forEach(o=>{try{o(...n)}catch(a){console.error(`${t} monitor event exception`,a)}})}}const Y=new oee,wp="onSave",_1="changeCatalogVisible",ZL="changeFullscreen",cw="pageFullscreenChanged",hw="fullscreenChanged",fw="previewChanged",dw="previewOnlyChanged",pw="htmlPreviewChanged",gw="catalogVisibleChanged",xf="buildFinished",_o="errorCatcher",Ye="replace",_p="uploadImage",Dv="openModals",jL="ctrlZ",GL="ctrlShiftZ",hu="catalogChanged",HL="pushCatalog",C1="rerender",XL="eventListener",zL="taskStateChanged",WL="sendEditorView",kd="getEditorView",mw=(i,e)=>{const t=n=>{const r=i.parentElement||document.body,s=r.offsetWidth,o=r.offsetHeight,{clientWidth:a,clientHeight:l}=document.documentElement,u=n.offsetX,c=n.offsetY,h=d=>{let p=d.x+document.body.scrollLeft-document.body.clientLeft-u,g=d.y+document.body.scrollTop-document.body.clientTop-c;p=p<1?1:p<a-s-1?p:a-s-1,g=g<1?1:g<l-o-1?g:l-o-1,e?e(p,g):(r.style.left=`${p}px`,r.style.top=`${g}px`)};document.addEventListener("mousemove",h);const f=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",f)};document.addEventListener("mouseup",f)};return i.addEventListener("mousedown",t),()=>{i.removeEventListener("mousedown",t)}},sn=(i,e,t="")=>{var n;const r=document.getElementById(e.id);if(r)t!==""&&(Reflect.get(window,t)?(n=e.onload)==null||n.call(r,new Event("load")):e.onload&&r.addEventListener("load",e.onload));else{const s={...e};s.onload=null;const o=lee(i,s);e.onload&&o.addEventListener("load",e.onload),document.head.appendChild(o)}},aee=(i,e)=>{const t=document.getElementById(e.id);t==null||t.remove(),sn(i,e)},lee=(i,e)=>{const t=document.createElement(i);return Object.keys(e).forEach(n=>{e[n]!==void 0&&(t[n]=e[n])}),t},vw=(()=>{const i=t=>{if(!t)return;const n=t.firstChild;let r=1,s=0,o=0,a=!1,l,u,c,h=1;const f=()=>{n.style.transform=`translate(${s}px, ${o}px) scale(${r})`};t.addEventListener("touchstart",d=>{d.touches.length===1?(a=!0,l=d.touches[0].clientX-s,u=d.touches[0].clientY-o):d.touches.length===2&&(c=Math.hypot(d.touches[0].clientX-d.touches[1].clientX,d.touches[0].clientY-d.touches[1].clientY),h=r)},{passive:!1}),t.addEventListener("touchmove",d=>{if(d.preventDefault(),a&&d.touches.length===1)s=d.touches[0].clientX-l,o=d.touches[0].clientY-u,f();else if(d.touches.length===2){const g=Math.hypot(d.touches[0].clientX-d.touches[1].clientX,d.touches[0].clientY-d.touches[1].clientY)/c,m=r;r=h*(1+(g-1));const v=(d.touches[0].clientX+d.touches[1].clientX)/2,O=(d.touches[0].clientY+d.touches[1].clientY)/2,y=n.getBoundingClientRect(),x=(v-y.left)/m,b=(O-y.top)/m;s-=x*(r-m),o-=b*(r-m),f()}},{passive:!1}),t.addEventListener("touchend",()=>{a=!1}),t.addEventListener("wheel",d=>{d.preventDefault();const p=.02,g=r;d.deltaY<0?r+=p:r=Math.max(.1,r-p);const m=n.getBoundingClientRect(),v=d.clientX-m.left,O=d.clientY-m.top;s-=v/g*(r-g),o-=O/g*(r-g),f()},{passive:!1}),t.addEventListener("mousedown",d=>{a=!0,l=d.clientX-s,u=d.clientY-o}),t.addEventListener("mousemove",d=>{a&&(s=d.clientX-l,o=d.clientY-u,f())}),t.addEventListener("mouseup",()=>{a=!1}),t.addEventListener("mouseleave",()=>{a=!1})};return t=>{t==null||t.forEach(n=>{i(n)})}})();/*! medium-zoom 1.1.0 | MIT License | https://github.com/francoischalifour/medium-zoom */var Ws=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},kh=function(e){return e.tagName==="IMG"},uee=function(e){return NodeList.prototype.isPrototypeOf(e)},Sf=function(e){return e&&e.nodeType===1},Ow=function(e){var t=e.currentSrc||e.src;return t.substr(-4).toLowerCase()===".svg"},yw=function(e){try{return Array.isArray(e)?e.filter(kh):uee(e)?[].slice.call(e).filter(kh):Sf(e)?[e].filter(kh):typeof e=="string"?[].slice.call(document.querySelectorAll(e)).filter(kh):[]}catch{throw new TypeError(`The provided selector is invalid.
Expects a CSS selector, a Node element, a NodeList or an array.
See: https://github.com/francoischalifour/medium-zoom`)}},cee=function(e){var t=document.createElement("div");return t.classList.add("medium-zoom-overlay"),t.style.background=e,t},hee=function(e){var t=e.getBoundingClientRect(),n=t.top,r=t.left,s=t.width,o=t.height,a=e.cloneNode(),l=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,u=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return a.removeAttribute("id"),a.style.position="absolute",a.style.top=n+l+"px",a.style.left=r+u+"px",a.style.width=s+"px",a.style.height=o+"px",a.style.transform="",a},Xo=function(e,t){var n=Ws({bubbles:!1,cancelable:!1,detail:void 0},t);if(typeof window.CustomEvent=="function")return new CustomEvent(e,n);var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),r},fee=function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=window.Promise||function(L){function $(){}L($,$)},r=function(L){var $=L.target;if($===D){p();return}y.indexOf($)!==-1&&g({target:$})},s=function(){if(!(b||!_.original)){var L=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(E-L)>T.scrollOffset&&setTimeout(p,150)}},o=function(L){var $=L.key||L.keyCode;($==="Escape"||$==="Esc"||$===27)&&p()},a=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},$=L;if(L.background&&(D.style.background=L.background),L.container&&L.container instanceof Object&&($.container=Ws({},T.container,L.container)),L.template){var B=Sf(L.template)?L.template:document.querySelector(L.template);$.template=B}return T=Ws({},T,$),y.forEach(function(Z){Z.dispatchEvent(Xo("medium-zoom:update",{detail:{zoom:A}}))}),A},l=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return i(Ws({},T,L))},u=function(){for(var L=arguments.length,$=Array(L),B=0;B<L;B++)$[B]=arguments[B];var Z=$.reduce(function(j,ie){return[].concat(j,yw(ie))},[]);return Z.filter(function(j){return y.indexOf(j)===-1}).forEach(function(j){y.push(j),j.classList.add("medium-zoom-image")}),x.forEach(function(j){var ie=j.type,ne=j.listener,z=j.options;Z.forEach(function(W){W.addEventListener(ie,ne,z)})}),A},c=function(){for(var L=arguments.length,$=Array(L),B=0;B<L;B++)$[B]=arguments[B];_.zoomed&&p();var Z=$.length>0?$.reduce(function(j,ie){return[].concat(j,yw(ie))},[]):y;return Z.forEach(function(j){j.classList.remove("medium-zoom-image"),j.dispatchEvent(Xo("medium-zoom:detach",{detail:{zoom:A}}))}),y=y.filter(function(j){return Z.indexOf(j)===-1}),A},h=function(L,$){var B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return y.forEach(function(Z){Z.addEventListener("medium-zoom:"+L,$,B)}),x.push({type:"medium-zoom:"+L,listener:$,options:B}),A},f=function(L,$){var B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return y.forEach(function(Z){Z.removeEventListener("medium-zoom:"+L,$,B)}),x=x.filter(function(Z){return!(Z.type==="medium-zoom:"+L&&Z.listener.toString()===$.toString())}),A},d=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},$=L.target,B=function(){var j={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},ie=void 0,ne=void 0;if(T.container)if(T.container instanceof Object)j=Ws({},j,T.container),ie=j.width-j.left-j.right-T.margin*2,ne=j.height-j.top-j.bottom-T.margin*2;else{var z=Sf(T.container)?T.container:document.querySelector(T.container),W=z.getBoundingClientRect(),he=W.width,se=W.height,oe=W.left,Se=W.top;j=Ws({},j,{width:he,height:se,left:oe,top:Se})}ie=ie||j.width-T.margin*2,ne=ne||j.height-T.margin*2;var $e=_.zoomedHd||_.original,Ke=Ow($e)?ie:$e.naturalWidth||ie,kt=Ow($e)?ne:$e.naturalHeight||ne,Ai=$e.getBoundingClientRect(),jr=Ai.top,Lc=Ai.left,Ao=Ai.width,Po=Ai.height,Ic=Math.min(Math.max(Ao,Ke),ie)/Ao,Dc=Math.min(Math.max(Po,kt),ne)/Po,Ro=Math.min(Ic,Dc),$c=(-Lc+(ie-Ao)/2+T.margin+j.left)/Ro,Mc=(-jr+(ne-Po)/2+T.margin+j.top)/Ro,bl="scale("+Ro+") translate3d("+$c+"px, "+Mc+"px, 0)";_.zoomed.style.transform=bl,_.zoomedHd&&(_.zoomedHd.style.transform=bl)};return new n(function(Z){if($&&y.indexOf($)===-1){Z(A);return}var j=function he(){b=!1,_.zoomed.removeEventListener("transitionend",he),_.original.dispatchEvent(Xo("medium-zoom:opened",{detail:{zoom:A}})),Z(A)};if(_.zoomed){Z(A);return}if($)_.original=$;else if(y.length>0){var ie=y;_.original=ie[0]}else{Z(A);return}if(_.original.dispatchEvent(Xo("medium-zoom:open",{detail:{zoom:A}})),E=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,b=!0,_.zoomed=hee(_.original),document.body.appendChild(D),T.template){var ne=Sf(T.template)?T.template:document.querySelector(T.template);_.template=document.createElement("div"),_.template.appendChild(ne.content.cloneNode(!0)),document.body.appendChild(_.template)}if(_.original.parentElement&&_.original.parentElement.tagName==="PICTURE"&&_.original.currentSrc&&(_.zoomed.src=_.original.currentSrc),document.body.appendChild(_.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),_.original.classList.add("medium-zoom-image--hidden"),_.zoomed.classList.add("medium-zoom-image--opened"),_.zoomed.addEventListener("click",p),_.zoomed.addEventListener("transitionend",j),_.original.getAttribute("data-zoom-src")){_.zoomedHd=_.zoomed.cloneNode(),_.zoomedHd.removeAttribute("srcset"),_.zoomedHd.removeAttribute("sizes"),_.zoomedHd.removeAttribute("loading"),_.zoomedHd.src=_.zoomed.getAttribute("data-zoom-src"),_.zoomedHd.onerror=function(){clearInterval(z),console.warn("Unable to reach the zoom image target "+_.zoomedHd.src),_.zoomedHd=null,B()};var z=setInterval(function(){_.zoomedHd.complete&&(clearInterval(z),_.zoomedHd.classList.add("medium-zoom-image--opened"),_.zoomedHd.addEventListener("click",p),document.body.appendChild(_.zoomedHd),B())},10)}else if(_.original.hasAttribute("srcset")){_.zoomedHd=_.zoomed.cloneNode(),_.zoomedHd.removeAttribute("sizes"),_.zoomedHd.removeAttribute("loading");var W=_.zoomedHd.addEventListener("load",function(){_.zoomedHd.removeEventListener("load",W),_.zoomedHd.classList.add("medium-zoom-image--opened"),_.zoomedHd.addEventListener("click",p),document.body.appendChild(_.zoomedHd),B()})}else B()})},p=function(){return new n(function(L){if(b||!_.original){L(A);return}var $=function B(){_.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(_.zoomed),_.zoomedHd&&document.body.removeChild(_.zoomedHd),document.body.removeChild(D),_.zoomed.classList.remove("medium-zoom-image--opened"),_.template&&document.body.removeChild(_.template),b=!1,_.zoomed.removeEventListener("transitionend",B),_.original.dispatchEvent(Xo("medium-zoom:closed",{detail:{zoom:A}})),_.original=null,_.zoomed=null,_.zoomedHd=null,_.template=null,L(A)};b=!0,document.body.classList.remove("medium-zoom--opened"),_.zoomed.style.transform="",_.zoomedHd&&(_.zoomedHd.style.transform=""),_.template&&(_.template.style.transition="opacity 150ms",_.template.style.opacity=0),_.original.dispatchEvent(Xo("medium-zoom:close",{detail:{zoom:A}})),_.zoomed.addEventListener("transitionend",$)})},g=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},$=L.target;return _.original?p():d({target:$})},m=function(){return T},v=function(){return y},O=function(){return _.original},y=[],x=[],b=!1,E=0,T=t,_={original:null,zoomed:null,zoomedHd:null,template:null};Object.prototype.toString.call(e)==="[object Object]"?T=e:(e||typeof e=="string")&&u(e),T=Ws({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},T);var D=cee(T.background);document.addEventListener("click",r),document.addEventListener("keyup",o),document.addEventListener("scroll",s),window.addEventListener("resize",p);var A={open:d,close:p,toggle:g,update:a,clone:l,attach:u,detach:c,on:h,off:f,getOptions:m,getImages:v,getZoomedImage:O};return A};function dee(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var pee=".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}";dee(pee);var gee=function(){var i=document.getSelection();if(!i.rangeCount)return function(){};for(var e=document.activeElement,t=[],n=0;n<i.rangeCount;n++)t.push(i.getRangeAt(n));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null;break}return i.removeAllRanges(),function(){i.type==="Caret"&&i.removeAllRanges(),i.rangeCount||t.forEach(function(r){i.addRange(r)}),e&&e.focus()}},mee=gee,bw={"text/plain":"Text","text/html":"Url",default:"Text"},vee="Copy to clipboard: #{key}, Enter";function Oee(i){var e=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return i.replace(/#{\s*key\s*}/g,e)}function yee(i,e){var t,n,r,s,o,a,l=!1;e||(e={}),t=e.debug||!1;try{r=mee(),s=document.createRange(),o=document.getSelection(),a=document.createElement("span"),a.textContent=i,a.ariaHidden="true",a.style.all="unset",a.style.position="fixed",a.style.top=0,a.style.clip="rect(0, 0, 0, 0)",a.style.whiteSpace="pre",a.style.webkitUserSelect="text",a.style.MozUserSelect="text",a.style.msUserSelect="text",a.style.userSelect="text",a.addEventListener("copy",function(c){if(c.stopPropagation(),e.format)if(c.preventDefault(),typeof c.clipboardData>"u"){t&&console.warn("unable to use e.clipboardData"),t&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var h=bw[e.format]||bw.default;window.clipboardData.setData(h,i)}else c.clipboardData.clearData(),c.clipboardData.setData(e.format,i);e.onCopy&&(c.preventDefault(),e.onCopy(c.clipboardData))}),document.body.appendChild(a),s.selectNodeContents(a),o.addRange(s);var u=document.execCommand("copy");if(!u)throw new Error("copy command was unsuccessful");l=!0}catch(c){t&&console.error("unable to copy using execCommand: ",c),t&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(e.format||"text",i),e.onCopy&&e.onCopy(window.clipboardData),l=!0}catch(h){t&&console.error("unable to copy using clipboardData: ",h),t&&console.error("falling back to prompt"),n=Oee("message"in e?e.message:vee),window.prompt(n,i)}}finally{o&&(typeof o.removeRange=="function"?o.removeRange(s):o.removeAllRanges()),a&&document.body.removeChild(a),r()}return l}var bee=yee;const xee=op(bee),xw={};function See(i){let e=xw[i];if(e)return e;e=xw[i]=[];for(let t=0;t<128;t++){const n=String.fromCharCode(t);e.push(n)}for(let t=0;t<i.length;t++){const n=i.charCodeAt(t);e[n]="%"+("0"+n.toString(16).toUpperCase()).slice(-2)}return e}function Na(i,e){typeof e!="string"&&(e=Na.defaultChars);const t=See(e);return i.replace(/(%[a-f0-9]{2})+/gi,function(n){let r="";for(let s=0,o=n.length;s<o;s+=3){const a=parseInt(n.slice(s+1,s+3),16);if(a<128){r+=t[a];continue}if((a&224)===192&&s+3<o){const l=parseInt(n.slice(s+4,s+6),16);if((l&192)===128){const u=a<<6&1984|l&63;u<128?r+="":r+=String.fromCharCode(u),s+=3;continue}}if((a&240)===224&&s+6<o){const l=parseInt(n.slice(s+4,s+6),16),u=parseInt(n.slice(s+7,s+9),16);if((l&192)===128&&(u&192)===128){const c=a<<12&61440|l<<6&4032|u&63;c<2048||c>=55296&&c<=57343?r+="":r+=String.fromCharCode(c),s+=6;continue}}if((a&248)===240&&s+9<o){const l=parseInt(n.slice(s+4,s+6),16),u=parseInt(n.slice(s+7,s+9),16),c=parseInt(n.slice(s+10,s+12),16);if((l&192)===128&&(u&192)===128&&(c&192)===128){let h=a<<18&1835008|l<<12&258048|u<<6&4032|c&63;h<65536||h>1114111?r+="":(h-=65536,r+=String.fromCharCode(55296+(h>>10),56320+(h&1023))),s+=9;continue}}r+=""}return r})}Na.defaultChars=";/?:@&=+$,#";Na.componentChars="";const Sw={};function kee(i){let e=Sw[i];if(e)return e;e=Sw[i]=[];for(let t=0;t<128;t++){const n=String.fromCharCode(t);/^[0-9a-z]$/i.test(n)?e.push(n):e.push("%"+("0"+t.toString(16).toUpperCase()).slice(-2))}for(let t=0;t<i.length;t++)e[i.charCodeAt(t)]=i[t];return e}function yc(i,e,t){typeof e!="string"&&(t=e,e=yc.defaultChars),typeof t>"u"&&(t=!0);const n=kee(e);let r="";for(let s=0,o=i.length;s<o;s++){const a=i.charCodeAt(s);if(t&&a===37&&s+2<o&&/^[0-9a-f]{2}$/i.test(i.slice(s+1,s+3))){r+=i.slice(s,s+3),s+=2;continue}if(a<128){r+=n[a];continue}if(a>=55296&&a<=57343){if(a>=55296&&a<=56319&&s+1<o){const l=i.charCodeAt(s+1);if(l>=56320&&l<=57343){r+=encodeURIComponent(i[s]+i[s+1]),s++;continue}}r+="%EF%BF%BD";continue}r+=encodeURIComponent(i[s])}return r}yc.defaultChars=";/?:@&=+$,-_.!~*'()#";yc.componentChars="-_.!~*'()";function A1(i){let e="";return e+=i.protocol||"",e+=i.slashes?"//":"",e+=i.auth?i.auth+"@":"",i.hostname&&i.hostname.indexOf(":")!==-1?e+="["+i.hostname+"]":e+=i.hostname||"",e+=i.port?":"+i.port:"",e+=i.pathname||"",e+=i.search||"",e+=i.hash||"",e}function Td(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const Tee=/^([a-z0-9.+-]+:)/i,Eee=/:[0-9]*$/,wee=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,_ee=["<",">",'"',"`"," ","\r",`
`,"	"],Cee=["{","}","|","\\","^","`"].concat(_ee),Aee=["'"].concat(Cee),kw=["%","/","?",";","#"].concat(Aee),Tw=["/","?","#"],Pee=255,Ew=/^[+a-z0-9A-Z_-]{0,63}$/,Ree=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ww={javascript:!0,"javascript:":!0},_w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function P1(i,e){if(i&&i instanceof Td)return i;const t=new Td;return t.parse(i,e),t}Td.prototype.parse=function(i,e){let t,n,r,s=i;if(s=s.trim(),!e&&i.split("#").length===1){const u=wee.exec(s);if(u)return this.pathname=u[1],u[2]&&(this.search=u[2]),this}let o=Tee.exec(s);if(o&&(o=o[0],t=o.toLowerCase(),this.protocol=o,s=s.substr(o.length)),(e||o||s.match(/^\/\/[^@\/]+@[^@\/]+/))&&(r=s.substr(0,2)==="//",r&&!(o&&ww[o])&&(s=s.substr(2),this.slashes=!0)),!ww[o]&&(r||o&&!_w[o])){let u=-1;for(let p=0;p<Tw.length;p++)n=s.indexOf(Tw[p]),n!==-1&&(u===-1||n<u)&&(u=n);let c,h;u===-1?h=s.lastIndexOf("@"):h=s.lastIndexOf("@",u),h!==-1&&(c=s.slice(0,h),s=s.slice(h+1),this.auth=c),u=-1;for(let p=0;p<kw.length;p++)n=s.indexOf(kw[p]),n!==-1&&(u===-1||n<u)&&(u=n);u===-1&&(u=s.length),s[u-1]===":"&&u--;const f=s.slice(0,u);s=s.slice(u),this.parseHost(f),this.hostname=this.hostname||"";const d=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!d){const p=this.hostname.split(/\./);for(let g=0,m=p.length;g<m;g++){const v=p[g];if(v&&!v.match(Ew)){let O="";for(let y=0,x=v.length;y<x;y++)v.charCodeAt(y)>127?O+="x":O+=v[y];if(!O.match(Ew)){const y=p.slice(0,g),x=p.slice(g+1),b=v.match(Ree);b&&(y.push(b[1]),x.unshift(b[2])),x.length&&(s=x.join(".")+s),this.hostname=y.join(".");break}}}}this.hostname.length>Pee&&(this.hostname=""),d&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const a=s.indexOf("#");a!==-1&&(this.hash=s.substr(a),s=s.slice(0,a));const l=s.indexOf("?");return l!==-1&&(this.search=s.substr(l),s=s.slice(0,l)),s&&(this.pathname=s),_w[t]&&this.hostname&&!this.pathname&&(this.pathname=""),this};Td.prototype.parseHost=function(i){let e=Eee.exec(i);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),i=i.substr(0,i.length-e.length)),i&&(this.hostname=i)};const Lee=Object.freeze(Object.defineProperty({__proto__:null,decode:Na,encode:yc,format:A1,parse:P1},Symbol.toStringTag,{value:"Module"})),qL=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,YL=/[\0-\x1F\x7F-\x9F]/,Iee=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,R1=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,KL=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,JL=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Dee=Object.freeze(Object.defineProperty({__proto__:null,Any:qL,Cc:YL,Cf:Iee,P:R1,S:KL,Z:JL},Symbol.toStringTag,{value:"Module"})),$ee=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(i=>i.charCodeAt(0))),Mee=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(i=>i.charCodeAt(0)));var B0;const Fee=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Nee=(B0=String.fromCodePoint)!==null&&B0!==void 0?B0:function(i){let e="";return i>65535&&(i-=65536,e+=String.fromCharCode(i>>>10&1023|55296),i=56320|i&1023),e+=String.fromCharCode(i),e};function Qee(i){var e;return i>=55296&&i<=57343||i>1114111?65533:(e=Fee.get(i))!==null&&e!==void 0?e:i}var Zt;(function(i){i[i.NUM=35]="NUM",i[i.SEMI=59]="SEMI",i[i.EQUALS=61]="EQUALS",i[i.ZERO=48]="ZERO",i[i.NINE=57]="NINE",i[i.LOWER_A=97]="LOWER_A",i[i.LOWER_F=102]="LOWER_F",i[i.LOWER_X=120]="LOWER_X",i[i.LOWER_Z=122]="LOWER_Z",i[i.UPPER_A=65]="UPPER_A",i[i.UPPER_F=70]="UPPER_F",i[i.UPPER_Z=90]="UPPER_Z"})(Zt||(Zt={}));const Bee=32;var ps;(function(i){i[i.VALUE_LENGTH=49152]="VALUE_LENGTH",i[i.BRANCH_LENGTH=16256]="BRANCH_LENGTH",i[i.JUMP_TABLE=127]="JUMP_TABLE"})(ps||(ps={}));function $v(i){return i>=Zt.ZERO&&i<=Zt.NINE}function Uee(i){return i>=Zt.UPPER_A&&i<=Zt.UPPER_F||i>=Zt.LOWER_A&&i<=Zt.LOWER_F}function Vee(i){return i>=Zt.UPPER_A&&i<=Zt.UPPER_Z||i>=Zt.LOWER_A&&i<=Zt.LOWER_Z||$v(i)}function Zee(i){return i===Zt.EQUALS||Vee(i)}var Qt;(function(i){i[i.EntityStart=0]="EntityStart",i[i.NumericStart=1]="NumericStart",i[i.NumericDecimal=2]="NumericDecimal",i[i.NumericHex=3]="NumericHex",i[i.NamedEntity=4]="NamedEntity"})(Qt||(Qt={}));var us;(function(i){i[i.Legacy=0]="Legacy",i[i.Strict=1]="Strict",i[i.Attribute=2]="Attribute"})(us||(us={}));class jee{constructor(e,t,n){this.decodeTree=e,this.emitCodePoint=t,this.errors=n,this.state=Qt.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=us.Strict}startEntity(e){this.decodeMode=e,this.state=Qt.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case Qt.EntityStart:return e.charCodeAt(t)===Zt.NUM?(this.state=Qt.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=Qt.NamedEntity,this.stateNamedEntity(e,t));case Qt.NumericStart:return this.stateNumericStart(e,t);case Qt.NumericDecimal:return this.stateNumericDecimal(e,t);case Qt.NumericHex:return this.stateNumericHex(e,t);case Qt.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|Bee)===Zt.LOWER_X?(this.state=Qt.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=Qt.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,n,r){if(t!==n){const s=n-t;this.result=this.result*Math.pow(r,s)+parseInt(e.substr(t,s),r),this.consumed+=s}}stateNumericHex(e,t){const n=t;for(;t<e.length;){const r=e.charCodeAt(t);if($v(r)||Uee(r))t+=1;else return this.addToNumericResult(e,n,t,16),this.emitNumericEntity(r,3)}return this.addToNumericResult(e,n,t,16),-1}stateNumericDecimal(e,t){const n=t;for(;t<e.length;){const r=e.charCodeAt(t);if($v(r))t+=1;else return this.addToNumericResult(e,n,t,10),this.emitNumericEntity(r,2)}return this.addToNumericResult(e,n,t,10),-1}emitNumericEntity(e,t){var n;if(this.consumed<=t)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Zt.SEMI)this.consumed+=1;else if(this.decodeMode===us.Strict)return 0;return this.emitCodePoint(Qee(this.result),this.consumed),this.errors&&(e!==Zt.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:n}=this;let r=n[this.treeIndex],s=(r&ps.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const o=e.charCodeAt(t);if(this.treeIndex=Gee(n,r,this.treeIndex+Math.max(1,s),o),this.treeIndex<0)return this.result===0||this.decodeMode===us.Attribute&&(s===0||Zee(o))?0:this.emitNotTerminatedNamedEntity();if(r=n[this.treeIndex],s=(r&ps.VALUE_LENGTH)>>14,s!==0){if(o===Zt.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==us.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:n}=this,r=(n[t]&ps.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,r,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,n){const{decodeTree:r}=this;return this.emitCodePoint(t===1?r[e]&~ps.VALUE_LENGTH:r[e+1],n),t===3&&this.emitCodePoint(r[e+2],n),n}end(){var e;switch(this.state){case Qt.NamedEntity:return this.result!==0&&(this.decodeMode!==us.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Qt.NumericDecimal:return this.emitNumericEntity(0,2);case Qt.NumericHex:return this.emitNumericEntity(0,3);case Qt.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Qt.EntityStart:return 0}}}function eI(i){let e="";const t=new jee(i,n=>e+=Nee(n));return function(r,s){let o=0,a=0;for(;(a=r.indexOf("&",a))>=0;){e+=r.slice(o,a),t.startEntity(s);const u=t.write(r,a+1);if(u<0){o=a+t.end();break}o=a+u,a=u===0?o+1:o}const l=e+r.slice(o);return e="",l}}function Gee(i,e,t,n){const r=(e&ps.BRANCH_LENGTH)>>7,s=e&ps.JUMP_TABLE;if(r===0)return s!==0&&n===s?t:-1;if(s){const l=n-s;return l<0||l>=r?-1:i[t+l]-1}let o=t,a=o+r-1;for(;o<=a;){const l=o+a>>>1,u=i[l];if(u<n)o=l+1;else if(u>n)a=l-1;else return i[l+r]}return-1}const Hee=eI($ee);eI(Mee);function tI(i,e=us.Legacy){return Hee(i,e)}function Xee(i){return Object.prototype.toString.call(i)}function L1(i){return Xee(i)==="[object String]"}const zee=Object.prototype.hasOwnProperty;function Wee(i,e){return zee.call(i,e)}function Cp(i){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t){if(typeof t!="object")throw new TypeError(t+"must be object");Object.keys(t).forEach(function(n){i[n]=t[n]})}}),i}function iI(i,e,t){return[].concat(i.slice(0,e),t,i.slice(e+1))}function I1(i){return!(i>=55296&&i<=57343||i>=64976&&i<=65007||(i&65535)===65535||(i&65535)===65534||i>=0&&i<=8||i===11||i>=14&&i<=31||i>=127&&i<=159||i>1114111)}function Ed(i){if(i>65535){i-=65536;const e=55296+(i>>10),t=56320+(i&1023);return String.fromCharCode(e,t)}return String.fromCharCode(i)}const nI=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,qee=/&([a-z#][a-z0-9]{1,31});/gi,Yee=new RegExp(nI.source+"|"+qee.source,"gi"),Kee=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function Jee(i,e){if(e.charCodeAt(0)===35&&Kee.test(e)){const n=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return I1(n)?Ed(n):i}const t=tI(i);return t!==i?t:i}function ete(i){return i.indexOf("\\")<0?i:i.replace(nI,"$1")}function Qa(i){return i.indexOf("\\")<0&&i.indexOf("&")<0?i:i.replace(Yee,function(e,t,n){return t||Jee(e,n)})}const tte=/[&<>"]/,ite=/[&<>"]/g,nte={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function rte(i){return nte[i]}function ws(i){return tte.test(i)?i.replace(ite,rte):i}const ste=/[.?*+^$[\]\\(){}|-]/g;function ote(i){return i.replace(ste,"\\$&")}function nt(i){switch(i){case 9:case 32:return!0}return!1}function Ru(i){if(i>=8192&&i<=8202)return!0;switch(i){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Lu(i){return R1.test(i)||KL.test(i)}function Iu(i){switch(i){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function Ap(i){return i=i.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(i=i.replace(//g,"")),i.toLowerCase().toUpperCase()}const ate={mdurl:Lee,ucmicro:Dee},lte=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:iI,assign:Cp,escapeHtml:ws,escapeRE:ote,fromCodePoint:Ed,has:Wee,isMdAsciiPunct:Iu,isPunctChar:Lu,isSpace:nt,isString:L1,isValidEntityCode:I1,isWhiteSpace:Ru,lib:ate,normalizeReference:Ap,unescapeAll:Qa,unescapeMd:ete},Symbol.toStringTag,{value:"Module"}));function ute(i,e,t){let n,r,s,o;const a=i.posMax,l=i.pos;for(i.pos=e+1,n=1;i.pos<a;){if(s=i.src.charCodeAt(i.pos),s===93&&(n--,n===0)){r=!0;break}if(o=i.pos,i.md.inline.skipToken(i),s===91){if(o===i.pos-1)n++;else if(t)return i.pos=l,-1}}let u=-1;return r&&(u=i.pos),i.pos=l,u}function cte(i,e,t){let n,r=e;const s={ok:!1,pos:0,str:""};if(i.charCodeAt(r)===60){for(r++;r<t;){if(n=i.charCodeAt(r),n===10||n===60)return s;if(n===62)return s.pos=r+1,s.str=Qa(i.slice(e+1,r)),s.ok=!0,s;if(n===92&&r+1<t){r+=2;continue}r++}return s}let o=0;for(;r<t&&(n=i.charCodeAt(r),!(n===32||n<32||n===127));){if(n===92&&r+1<t){if(i.charCodeAt(r+1)===32)break;r+=2;continue}if(n===40&&(o++,o>32))return s;if(n===41){if(o===0)break;o--}r++}return e===r||o!==0||(s.str=Qa(i.slice(e,r)),s.pos=r,s.ok=!0),s}function hte(i,e,t,n){let r,s=e;const o={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(n)o.str=n.str,o.marker=n.marker;else{if(s>=t)return o;let a=i.charCodeAt(s);if(a!==34&&a!==39&&a!==40)return o;e++,s++,a===40&&(a=41),o.marker=a}for(;s<t;){if(r=i.charCodeAt(s),r===o.marker)return o.pos=s+1,o.str+=Qa(i.slice(e,s)),o.ok=!0,o;if(r===40&&o.marker===41)return o;r===92&&s+1<t&&s++,s++}return o.can_continue=!0,o.str+=Qa(i.slice(e,s)),o}const fte=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:cte,parseLinkLabel:ute,parseLinkTitle:hte},Symbol.toStringTag,{value:"Module"})),xr={};xr.code_inline=function(i,e,t,n,r){const s=i[e];return"<code"+r.renderAttrs(s)+">"+ws(s.content)+"</code>"};xr.code_block=function(i,e,t,n,r){const s=i[e];return"<pre"+r.renderAttrs(s)+"><code>"+ws(i[e].content)+`</code></pre>
`};xr.fence=function(i,e,t,n,r){const s=i[e],o=s.info?Qa(s.info).trim():"";let a="",l="";if(o){const c=o.split(/(\s+)/g);a=c[0],l=c.slice(2).join("")}let u;if(t.highlight?u=t.highlight(s.content,a,l)||ws(s.content):u=ws(s.content),u.indexOf("<pre")===0)return u+`
`;if(o){const c=s.attrIndex("class"),h=s.attrs?s.attrs.slice():[];c<0?h.push(["class",t.langPrefix+a]):(h[c]=h[c].slice(),h[c][1]+=" "+t.langPrefix+a);const f={attrs:h};return`<pre><code${r.renderAttrs(f)}>${u}</code></pre>
`}return`<pre><code${r.renderAttrs(s)}>${u}</code></pre>
`};xr.image=function(i,e,t,n,r){const s=i[e];return s.attrs[s.attrIndex("alt")][1]=r.renderInlineAsText(s.children,t,n),r.renderToken(i,e,t)};xr.hardbreak=function(i,e,t){return t.xhtmlOut?`<br />
`:`<br>
`};xr.softbreak=function(i,e,t){return t.breaks?t.xhtmlOut?`<br />
`:`<br>
`:`
`};xr.text=function(i,e){return ws(i[e].content)};xr.html_block=function(i,e){return i[e].content};xr.html_inline=function(i,e){return i[e].content};function hl(){this.rules=Cp({},xr)}hl.prototype.renderAttrs=function(e){let t,n,r;if(!e.attrs)return"";for(r="",t=0,n=e.attrs.length;t<n;t++)r+=" "+ws(e.attrs[t][0])+'="'+ws(e.attrs[t][1])+'"';return r};hl.prototype.renderToken=function(e,t,n){const r=e[t];let s="";if(r.hidden)return"";r.block&&r.nesting!==-1&&t&&e[t-1].hidden&&(s+=`
`),s+=(r.nesting===-1?"</":"<")+r.tag,s+=this.renderAttrs(r),r.nesting===0&&n.xhtmlOut&&(s+=" /");let o=!1;if(r.block&&(o=!0,r.nesting===1&&t+1<e.length)){const a=e[t+1];(a.type==="inline"||a.hidden||a.nesting===-1&&a.tag===r.tag)&&(o=!1)}return s+=o?`>
`:">",s};hl.prototype.renderInline=function(i,e,t){let n="";const r=this.rules;for(let s=0,o=i.length;s<o;s++){const a=i[s].type;typeof r[a]<"u"?n+=r[a](i,s,e,t,this):n+=this.renderToken(i,s,e)}return n};hl.prototype.renderInlineAsText=function(i,e,t){let n="";for(let r=0,s=i.length;r<s;r++)switch(i[r].type){case"text":n+=i[r].content;break;case"image":n+=this.renderInlineAsText(i[r].children,e,t);break;case"html_inline":case"html_block":n+=i[r].content;break;case"softbreak":case"hardbreak":n+=`
`;break}return n};hl.prototype.render=function(i,e,t){let n="";const r=this.rules;for(let s=0,o=i.length;s<o;s++){const a=i[s].type;a==="inline"?n+=this.renderInline(i[s].children,e,t):typeof r[a]<"u"?n+=r[a](i,s,e,t,this):n+=this.renderToken(i,s,e,t)}return n};function _i(){this.__rules__=[],this.__cache__=null}_i.prototype.__find__=function(i){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===i)return e;return-1};_i.prototype.__compile__=function(){const i=this,e=[""];i.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(n){e.indexOf(n)<0&&e.push(n)})}),i.__cache__={},e.forEach(function(t){i.__cache__[t]=[],i.__rules__.forEach(function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||i.__cache__[t].push(n.fn))})})};_i.prototype.at=function(i,e,t){const n=this.__find__(i),r=t||{};if(n===-1)throw new Error("Parser rule not found: "+i);this.__rules__[n].fn=e,this.__rules__[n].alt=r.alt||[],this.__cache__=null};_i.prototype.before=function(i,e,t,n){const r=this.__find__(i),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+i);this.__rules__.splice(r,0,{name:e,enabled:!0,fn:t,alt:s.alt||[]}),this.__cache__=null};_i.prototype.after=function(i,e,t,n){const r=this.__find__(i),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+i);this.__rules__.splice(r+1,0,{name:e,enabled:!0,fn:t,alt:s.alt||[]}),this.__cache__=null};_i.prototype.push=function(i,e,t){const n=t||{};this.__rules__.push({name:i,enabled:!0,fn:e,alt:n.alt||[]}),this.__cache__=null};_i.prototype.enable=function(i,e){Array.isArray(i)||(i=[i]);const t=[];return i.forEach(function(n){const r=this.__find__(n);if(r<0){if(e)return;throw new Error("Rules manager: invalid rule name "+n)}this.__rules__[r].enabled=!0,t.push(n)},this),this.__cache__=null,t};_i.prototype.enableOnly=function(i,e){Array.isArray(i)||(i=[i]),this.__rules__.forEach(function(t){t.enabled=!1}),this.enable(i,e)};_i.prototype.disable=function(i,e){Array.isArray(i)||(i=[i]);const t=[];return i.forEach(function(n){const r=this.__find__(n);if(r<0){if(e)return;throw new Error("Rules manager: invalid rule name "+n)}this.__rules__[r].enabled=!1,t.push(n)},this),this.__cache__=null,t};_i.prototype.getRules=function(i){return this.__cache__===null&&this.__compile__(),this.__cache__[i]||[]};function Hn(i,e,t){this.type=i,this.tag=e,this.attrs=null,this.map=null,this.nesting=t,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Hn.prototype.attrIndex=function(e){if(!this.attrs)return-1;const t=this.attrs;for(let n=0,r=t.length;n<r;n++)if(t[n][0]===e)return n;return-1};Hn.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};Hn.prototype.attrSet=function(e,t){const n=this.attrIndex(e),r=[e,t];n<0?this.attrPush(r):this.attrs[n]=r};Hn.prototype.attrGet=function(e){const t=this.attrIndex(e);let n=null;return t>=0&&(n=this.attrs[t][1]),n};Hn.prototype.attrJoin=function(e,t){const n=this.attrIndex(e);n<0?this.attrPush([e,t]):this.attrs[n][1]=this.attrs[n][1]+" "+t};function rI(i,e,t){this.src=i,this.env=t,this.tokens=[],this.inlineMode=!1,this.md=e}rI.prototype.Token=Hn;const dte=/\r\n?|\n/g,pte=/\0/g;function gte(i){let e;e=i.src.replace(dte,`
`),e=e.replace(pte,""),i.src=e}function mte(i){let e;i.inlineMode?(e=new i.Token("inline","",0),e.content=i.src,e.map=[0,1],e.children=[],i.tokens.push(e)):i.md.block.parse(i.src,i.md,i.env,i.tokens)}function vte(i){const e=i.tokens;for(let t=0,n=e.length;t<n;t++){const r=e[t];r.type==="inline"&&i.md.inline.parse(r.content,i.md,i.env,r.children)}}function Ote(i){return/^<a[>\s]/i.test(i)}function yte(i){return/^<\/a\s*>/i.test(i)}function bte(i){const e=i.tokens;if(i.md.options.linkify)for(let t=0,n=e.length;t<n;t++){if(e[t].type!=="inline"||!i.md.linkify.pretest(e[t].content))continue;let r=e[t].children,s=0;for(let o=r.length-1;o>=0;o--){const a=r[o];if(a.type==="link_close"){for(o--;r[o].level!==a.level&&r[o].type!=="link_open";)o--;continue}if(a.type==="html_inline"&&(Ote(a.content)&&s>0&&s--,yte(a.content)&&s++),!(s>0)&&a.type==="text"&&i.md.linkify.test(a.content)){const l=a.content;let u=i.md.linkify.match(l);const c=[];let h=a.level,f=0;u.length>0&&u[0].index===0&&o>0&&r[o-1].type==="text_special"&&(u=u.slice(1));for(let d=0;d<u.length;d++){const p=u[d].url,g=i.md.normalizeLink(p);if(!i.md.validateLink(g))continue;let m=u[d].text;u[d].schema?u[d].schema==="mailto:"&&!/^mailto:/i.test(m)?m=i.md.normalizeLinkText("mailto:"+m).replace(/^mailto:/,""):m=i.md.normalizeLinkText(m):m=i.md.normalizeLinkText("http://"+m).replace(/^http:\/\//,"");const v=u[d].index;if(v>f){const b=new i.Token("text","",0);b.content=l.slice(f,v),b.level=h,c.push(b)}const O=new i.Token("link_open","a",1);O.attrs=[["href",g]],O.level=h++,O.markup="linkify",O.info="auto",c.push(O);const y=new i.Token("text","",0);y.content=m,y.level=h,c.push(y);const x=new i.Token("link_close","a",-1);x.level=--h,x.markup="linkify",x.info="auto",c.push(x),f=u[d].lastIndex}if(f<l.length){const d=new i.Token("text","",0);d.content=l.slice(f),d.level=h,c.push(d)}e[t].children=r=iI(r,o,c)}}}}const sI=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,xte=/\((c|tm|r)\)/i,Ste=/\((c|tm|r)\)/ig,kte={c:"",r:"",tm:""};function Tte(i,e){return kte[e.toLowerCase()]}function Ete(i){let e=0;for(let t=i.length-1;t>=0;t--){const n=i[t];n.type==="text"&&!e&&(n.content=n.content.replace(Ste,Tte)),n.type==="link_open"&&n.info==="auto"&&e--,n.type==="link_close"&&n.info==="auto"&&e++}}function wte(i){let e=0;for(let t=i.length-1;t>=0;t--){const n=i[t];n.type==="text"&&!e&&sI.test(n.content)&&(n.content=n.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),n.type==="link_open"&&n.info==="auto"&&e--,n.type==="link_close"&&n.info==="auto"&&e++}}function _te(i){let e;if(i.md.options.typographer)for(e=i.tokens.length-1;e>=0;e--)i.tokens[e].type==="inline"&&(xte.test(i.tokens[e].content)&&Ete(i.tokens[e].children),sI.test(i.tokens[e].content)&&wte(i.tokens[e].children))}const Cte=/['"]/,Cw=/['"]/g,Aw="";function Th(i,e,t){return i.slice(0,e)+t+i.slice(e+1)}function Ate(i,e){let t;const n=[];for(let r=0;r<i.length;r++){const s=i[r],o=i[r].level;for(t=n.length-1;t>=0&&!(n[t].level<=o);t--);if(n.length=t+1,s.type!=="text")continue;let a=s.content,l=0,u=a.length;e:for(;l<u;){Cw.lastIndex=l;const c=Cw.exec(a);if(!c)break;let h=!0,f=!0;l=c.index+1;const d=c[0]==="'";let p=32;if(c.index-1>=0)p=a.charCodeAt(c.index-1);else for(t=r-1;t>=0&&!(i[t].type==="softbreak"||i[t].type==="hardbreak");t--)if(i[t].content){p=i[t].content.charCodeAt(i[t].content.length-1);break}let g=32;if(l<u)g=a.charCodeAt(l);else for(t=r+1;t<i.length&&!(i[t].type==="softbreak"||i[t].type==="hardbreak");t++)if(i[t].content){g=i[t].content.charCodeAt(0);break}const m=Iu(p)||Lu(String.fromCharCode(p)),v=Iu(g)||Lu(String.fromCharCode(g)),O=Ru(p),y=Ru(g);if(y?h=!1:v&&(O||m||(h=!1)),O?f=!1:m&&(y||v||(f=!1)),g===34&&c[0]==='"'&&p>=48&&p<=57&&(f=h=!1),h&&f&&(h=m,f=v),!h&&!f){d&&(s.content=Th(s.content,c.index,Aw));continue}if(f)for(t=n.length-1;t>=0;t--){let x=n[t];if(n[t].level<o)break;if(x.single===d&&n[t].level===o){x=n[t];let b,E;d?(b=e.md.options.quotes[2],E=e.md.options.quotes[3]):(b=e.md.options.quotes[0],E=e.md.options.quotes[1]),s.content=Th(s.content,c.index,E),i[x.token].content=Th(i[x.token].content,x.pos,b),l+=E.length-1,x.token===r&&(l+=b.length-1),a=s.content,u=a.length,n.length=t;continue e}}h?n.push({token:r,pos:c.index,single:d,level:o}):f&&d&&(s.content=Th(s.content,c.index,Aw))}}}function Pte(i){if(i.md.options.typographer)for(let e=i.tokens.length-1;e>=0;e--)i.tokens[e].type!=="inline"||!Cte.test(i.tokens[e].content)||Ate(i.tokens[e].children,i)}function Rte(i){let e,t;const n=i.tokens,r=n.length;for(let s=0;s<r;s++){if(n[s].type!=="inline")continue;const o=n[s].children,a=o.length;for(e=0;e<a;e++)o[e].type==="text_special"&&(o[e].type="text");for(e=t=0;e<a;e++)o[e].type==="text"&&e+1<a&&o[e+1].type==="text"?o[e+1].content=o[e].content+o[e+1].content:(e!==t&&(o[t]=o[e]),t++);e!==t&&(o.length=t)}}const U0=[["normalize",gte],["block",mte],["inline",vte],["linkify",bte],["replacements",_te],["smartquotes",Pte],["text_join",Rte]];function D1(){this.ruler=new _i;for(let i=0;i<U0.length;i++)this.ruler.push(U0[i][0],U0[i][1])}D1.prototype.process=function(i){const e=this.ruler.getRules("");for(let t=0,n=e.length;t<n;t++)e[t](i)};D1.prototype.State=rI;function Sr(i,e,t,n){this.src=i,this.md=e,this.env=t,this.tokens=n,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const r=this.src;for(let s=0,o=0,a=0,l=0,u=r.length,c=!1;o<u;o++){const h=r.charCodeAt(o);if(!c)if(nt(h)){a++,h===9?l+=4-l%4:l++;continue}else c=!0;(h===10||o===u-1)&&(h!==10&&o++,this.bMarks.push(s),this.eMarks.push(o),this.tShift.push(a),this.sCount.push(l),this.bsCount.push(0),c=!1,a=0,l=0,s=o+1)}this.bMarks.push(r.length),this.eMarks.push(r.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Sr.prototype.push=function(i,e,t){const n=new Hn(i,e,t);return n.block=!0,t<0&&this.level--,n.level=this.level,t>0&&this.level++,this.tokens.push(n),n};Sr.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Sr.prototype.skipEmptyLines=function(e){for(let t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Sr.prototype.skipSpaces=function(e){for(let t=this.src.length;e<t;e++){const n=this.src.charCodeAt(e);if(!nt(n))break}return e};Sr.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!nt(this.src.charCodeAt(--e)))return e+1;return e};Sr.prototype.skipChars=function(e,t){for(let n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e};Sr.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e};Sr.prototype.getLines=function(e,t,n,r){if(e>=t)return"";const s=new Array(t-e);for(let o=0,a=e;a<t;a++,o++){let l=0;const u=this.bMarks[a];let c=u,h;for(a+1<t||r?h=this.eMarks[a]+1:h=this.eMarks[a];c<h&&l<n;){const f=this.src.charCodeAt(c);if(nt(f))f===9?l+=4-(l+this.bsCount[a])%4:l++;else if(c-u<this.tShift[a])l++;else break;c++}l>n?s[o]=new Array(l-n+1).join(" ")+this.src.slice(c,h):s[o]=this.src.slice(c,h)}return s.join("")};Sr.prototype.Token=Hn;const Lte=65536;function V0(i,e){const t=i.bMarks[e]+i.tShift[e],n=i.eMarks[e];return i.src.slice(t,n)}function Pw(i){const e=[],t=i.length;let n=0,r=i.charCodeAt(n),s=!1,o=0,a="";for(;n<t;)r===124&&(s?(a+=i.substring(o,n-1),o=n):(e.push(a+i.substring(o,n)),a="",o=n+1)),s=r===92,n++,r=i.charCodeAt(n);return e.push(a+i.substring(o)),e}function Ite(i,e,t,n){if(e+2>t)return!1;let r=e+1;if(i.sCount[r]<i.blkIndent||i.sCount[r]-i.blkIndent>=4)return!1;let s=i.bMarks[r]+i.tShift[r];if(s>=i.eMarks[r])return!1;const o=i.src.charCodeAt(s++);if(o!==124&&o!==45&&o!==58||s>=i.eMarks[r])return!1;const a=i.src.charCodeAt(s++);if(a!==124&&a!==45&&a!==58&&!nt(a)||o===45&&nt(a))return!1;for(;s<i.eMarks[r];){const x=i.src.charCodeAt(s);if(x!==124&&x!==45&&x!==58&&!nt(x))return!1;s++}let l=V0(i,e+1),u=l.split("|");const c=[];for(let x=0;x<u.length;x++){const b=u[x].trim();if(!b){if(x===0||x===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(b))return!1;b.charCodeAt(b.length-1)===58?c.push(b.charCodeAt(0)===58?"center":"right"):b.charCodeAt(0)===58?c.push("left"):c.push("")}if(l=V0(i,e).trim(),l.indexOf("|")===-1||i.sCount[e]-i.blkIndent>=4)return!1;u=Pw(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop();const h=u.length;if(h===0||h!==c.length)return!1;if(n)return!0;const f=i.parentType;i.parentType="table";const d=i.md.block.ruler.getRules("blockquote"),p=i.push("table_open","table",1),g=[e,0];p.map=g;const m=i.push("thead_open","thead",1);m.map=[e,e+1];const v=i.push("tr_open","tr",1);v.map=[e,e+1];for(let x=0;x<u.length;x++){const b=i.push("th_open","th",1);c[x]&&(b.attrs=[["style","text-align:"+c[x]]]);const E=i.push("inline","",0);E.content=u[x].trim(),E.children=[],i.push("th_close","th",-1)}i.push("tr_close","tr",-1),i.push("thead_close","thead",-1);let O,y=0;for(r=e+2;r<t&&!(i.sCount[r]<i.blkIndent);r++){let x=!1;for(let E=0,T=d.length;E<T;E++)if(d[E](i,r,t,!0)){x=!0;break}if(x||(l=V0(i,r).trim(),!l)||i.sCount[r]-i.blkIndent>=4||(u=Pw(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop(),y+=h-u.length,y>Lte))break;if(r===e+2){const E=i.push("tbody_open","tbody",1);E.map=O=[e+2,0]}const b=i.push("tr_open","tr",1);b.map=[r,r+1];for(let E=0;E<h;E++){const T=i.push("td_open","td",1);c[E]&&(T.attrs=[["style","text-align:"+c[E]]]);const _=i.push("inline","",0);_.content=u[E]?u[E].trim():"",_.children=[],i.push("td_close","td",-1)}i.push("tr_close","tr",-1)}return O&&(i.push("tbody_close","tbody",-1),O[1]=r),i.push("table_close","table",-1),g[1]=r,i.parentType=f,i.line=r,!0}function Dte(i,e,t){if(i.sCount[e]-i.blkIndent<4)return!1;let n=e+1,r=n;for(;n<t;){if(i.isEmpty(n)){n++;continue}if(i.sCount[n]-i.blkIndent>=4){n++,r=n;continue}break}i.line=r;const s=i.push("code_block","code",0);return s.content=i.getLines(e,r,4+i.blkIndent,!1)+`
`,s.map=[e,i.line],!0}function $te(i,e,t,n){let r=i.bMarks[e]+i.tShift[e],s=i.eMarks[e];if(i.sCount[e]-i.blkIndent>=4||r+3>s)return!1;const o=i.src.charCodeAt(r);if(o!==126&&o!==96)return!1;let a=r;r=i.skipChars(r,o);let l=r-a;if(l<3)return!1;const u=i.src.slice(a,r),c=i.src.slice(r,s);if(o===96&&c.indexOf(String.fromCharCode(o))>=0)return!1;if(n)return!0;let h=e,f=!1;for(;h++,!(h>=t||(r=a=i.bMarks[h]+i.tShift[h],s=i.eMarks[h],r<s&&i.sCount[h]<i.blkIndent));)if(i.src.charCodeAt(r)===o&&!(i.sCount[h]-i.blkIndent>=4)&&(r=i.skipChars(r,o),!(r-a<l)&&(r=i.skipSpaces(r),!(r<s)))){f=!0;break}l=i.sCount[e],i.line=h+(f?1:0);const d=i.push("fence","code",0);return d.info=c,d.content=i.getLines(e+1,h,l,!0),d.markup=u,d.map=[e,i.line],!0}function Mte(i,e,t,n){let r=i.bMarks[e]+i.tShift[e],s=i.eMarks[e];const o=i.lineMax;if(i.sCount[e]-i.blkIndent>=4||i.src.charCodeAt(r)!==62)return!1;if(n)return!0;const a=[],l=[],u=[],c=[],h=i.md.block.ruler.getRules("blockquote"),f=i.parentType;i.parentType="blockquote";let d=!1,p;for(p=e;p<t;p++){const y=i.sCount[p]<i.blkIndent;if(r=i.bMarks[p]+i.tShift[p],s=i.eMarks[p],r>=s)break;if(i.src.charCodeAt(r++)===62&&!y){let b=i.sCount[p]+1,E,T;i.src.charCodeAt(r)===32?(r++,b++,T=!1,E=!0):i.src.charCodeAt(r)===9?(E=!0,(i.bsCount[p]+b)%4===3?(r++,b++,T=!1):T=!0):E=!1;let _=b;for(a.push(i.bMarks[p]),i.bMarks[p]=r;r<s;){const D=i.src.charCodeAt(r);if(nt(D))D===9?_+=4-(_+i.bsCount[p]+(T?1:0))%4:_++;else break;r++}d=r>=s,l.push(i.bsCount[p]),i.bsCount[p]=i.sCount[p]+1+(E?1:0),u.push(i.sCount[p]),i.sCount[p]=_-b,c.push(i.tShift[p]),i.tShift[p]=r-i.bMarks[p];continue}if(d)break;let x=!1;for(let b=0,E=h.length;b<E;b++)if(h[b](i,p,t,!0)){x=!0;break}if(x){i.lineMax=p,i.blkIndent!==0&&(a.push(i.bMarks[p]),l.push(i.bsCount[p]),c.push(i.tShift[p]),u.push(i.sCount[p]),i.sCount[p]-=i.blkIndent);break}a.push(i.bMarks[p]),l.push(i.bsCount[p]),c.push(i.tShift[p]),u.push(i.sCount[p]),i.sCount[p]=-1}const g=i.blkIndent;i.blkIndent=0;const m=i.push("blockquote_open","blockquote",1);m.markup=">";const v=[e,0];m.map=v,i.md.block.tokenize(i,e,p);const O=i.push("blockquote_close","blockquote",-1);O.markup=">",i.lineMax=o,i.parentType=f,v[1]=i.line;for(let y=0;y<c.length;y++)i.bMarks[y+e]=a[y],i.tShift[y+e]=c[y],i.sCount[y+e]=u[y],i.bsCount[y+e]=l[y];return i.blkIndent=g,!0}function Fte(i,e,t,n){const r=i.eMarks[e];if(i.sCount[e]-i.blkIndent>=4)return!1;let s=i.bMarks[e]+i.tShift[e];const o=i.src.charCodeAt(s++);if(o!==42&&o!==45&&o!==95)return!1;let a=1;for(;s<r;){const u=i.src.charCodeAt(s++);if(u!==o&&!nt(u))return!1;u===o&&a++}if(a<3)return!1;if(n)return!0;i.line=e+1;const l=i.push("hr","hr",0);return l.map=[e,i.line],l.markup=Array(a+1).join(String.fromCharCode(o)),!0}function Rw(i,e){const t=i.eMarks[e];let n=i.bMarks[e]+i.tShift[e];const r=i.src.charCodeAt(n++);if(r!==42&&r!==45&&r!==43)return-1;if(n<t){const s=i.src.charCodeAt(n);if(!nt(s))return-1}return n}function Lw(i,e){const t=i.bMarks[e]+i.tShift[e],n=i.eMarks[e];let r=t;if(r+1>=n)return-1;let s=i.src.charCodeAt(r++);if(s<48||s>57)return-1;for(;;){if(r>=n)return-1;if(s=i.src.charCodeAt(r++),s>=48&&s<=57){if(r-t>=10)return-1;continue}if(s===41||s===46)break;return-1}return r<n&&(s=i.src.charCodeAt(r),!nt(s))?-1:r}function Nte(i,e){const t=i.level+2;for(let n=e+2,r=i.tokens.length-2;n<r;n++)i.tokens[n].level===t&&i.tokens[n].type==="paragraph_open"&&(i.tokens[n+2].hidden=!0,i.tokens[n].hidden=!0,n+=2)}function Qte(i,e,t,n){let r,s,o,a,l=e,u=!0;if(i.sCount[l]-i.blkIndent>=4||i.listIndent>=0&&i.sCount[l]-i.listIndent>=4&&i.sCount[l]<i.blkIndent)return!1;let c=!1;n&&i.parentType==="paragraph"&&i.sCount[l]>=i.blkIndent&&(c=!0);let h,f,d;if((d=Lw(i,l))>=0){if(h=!0,o=i.bMarks[l]+i.tShift[l],f=Number(i.src.slice(o,d-1)),c&&f!==1)return!1}else if((d=Rw(i,l))>=0)h=!1;else return!1;if(c&&i.skipSpaces(d)>=i.eMarks[l])return!1;if(n)return!0;const p=i.src.charCodeAt(d-1),g=i.tokens.length;h?(a=i.push("ordered_list_open","ol",1),f!==1&&(a.attrs=[["start",f]])):a=i.push("bullet_list_open","ul",1);const m=[l,0];a.map=m,a.markup=String.fromCharCode(p);let v=!1;const O=i.md.block.ruler.getRules("list"),y=i.parentType;for(i.parentType="list";l<t;){s=d,r=i.eMarks[l];const x=i.sCount[l]+d-(i.bMarks[l]+i.tShift[l]);let b=x;for(;s<r;){const Z=i.src.charCodeAt(s);if(Z===9)b+=4-(b+i.bsCount[l])%4;else if(Z===32)b++;else break;s++}const E=s;let T;E>=r?T=1:T=b-x,T>4&&(T=1);const _=x+T;a=i.push("list_item_open","li",1),a.markup=String.fromCharCode(p);const D=[l,0];a.map=D,h&&(a.info=i.src.slice(o,d-1));const A=i.tight,I=i.tShift[l],L=i.sCount[l],$=i.listIndent;if(i.listIndent=i.blkIndent,i.blkIndent=_,i.tight=!0,i.tShift[l]=E-i.bMarks[l],i.sCount[l]=b,E>=r&&i.isEmpty(l+1)?i.line=Math.min(i.line+2,t):i.md.block.tokenize(i,l,t,!0),(!i.tight||v)&&(u=!1),v=i.line-l>1&&i.isEmpty(i.line-1),i.blkIndent=i.listIndent,i.listIndent=$,i.tShift[l]=I,i.sCount[l]=L,i.tight=A,a=i.push("list_item_close","li",-1),a.markup=String.fromCharCode(p),l=i.line,D[1]=l,l>=t||i.sCount[l]<i.blkIndent||i.sCount[l]-i.blkIndent>=4)break;let B=!1;for(let Z=0,j=O.length;Z<j;Z++)if(O[Z](i,l,t,!0)){B=!0;break}if(B)break;if(h){if(d=Lw(i,l),d<0)break;o=i.bMarks[l]+i.tShift[l]}else if(d=Rw(i,l),d<0)break;if(p!==i.src.charCodeAt(d-1))break}return h?a=i.push("ordered_list_close","ol",-1):a=i.push("bullet_list_close","ul",-1),a.markup=String.fromCharCode(p),m[1]=l,i.line=l,i.parentType=y,u&&Nte(i,g),!0}function Bte(i,e,t,n){let r=i.bMarks[e]+i.tShift[e],s=i.eMarks[e],o=e+1;if(i.sCount[e]-i.blkIndent>=4||i.src.charCodeAt(r)!==91)return!1;function a(O){const y=i.lineMax;if(O>=y||i.isEmpty(O))return null;let x=!1;if(i.sCount[O]-i.blkIndent>3&&(x=!0),i.sCount[O]<0&&(x=!0),!x){const T=i.md.block.ruler.getRules("reference"),_=i.parentType;i.parentType="reference";let D=!1;for(let A=0,I=T.length;A<I;A++)if(T[A](i,O,y,!0)){D=!0;break}if(i.parentType=_,D)return null}const b=i.bMarks[O]+i.tShift[O],E=i.eMarks[O];return i.src.slice(b,E+1)}let l=i.src.slice(r,s+1);s=l.length;let u=-1;for(r=1;r<s;r++){const O=l.charCodeAt(r);if(O===91)return!1;if(O===93){u=r;break}else if(O===10){const y=a(o);y!==null&&(l+=y,s=l.length,o++)}else if(O===92&&(r++,r<s&&l.charCodeAt(r)===10)){const y=a(o);y!==null&&(l+=y,s=l.length,o++)}}if(u<0||l.charCodeAt(u+1)!==58)return!1;for(r=u+2;r<s;r++){const O=l.charCodeAt(r);if(O===10){const y=a(o);y!==null&&(l+=y,s=l.length,o++)}else if(!nt(O))break}const c=i.md.helpers.parseLinkDestination(l,r,s);if(!c.ok)return!1;const h=i.md.normalizeLink(c.str);if(!i.md.validateLink(h))return!1;r=c.pos;const f=r,d=o,p=r;for(;r<s;r++){const O=l.charCodeAt(r);if(O===10){const y=a(o);y!==null&&(l+=y,s=l.length,o++)}else if(!nt(O))break}let g=i.md.helpers.parseLinkTitle(l,r,s);for(;g.can_continue;){const O=a(o);if(O===null)break;l+=O,r=s,s=l.length,o++,g=i.md.helpers.parseLinkTitle(l,r,s,g)}let m;for(r<s&&p!==r&&g.ok?(m=g.str,r=g.pos):(m="",r=f,o=d);r<s;){const O=l.charCodeAt(r);if(!nt(O))break;r++}if(r<s&&l.charCodeAt(r)!==10&&m)for(m="",r=f,o=d;r<s;){const O=l.charCodeAt(r);if(!nt(O))break;r++}if(r<s&&l.charCodeAt(r)!==10)return!1;const v=Ap(l.slice(1,u));return v?(n||(typeof i.env.references>"u"&&(i.env.references={}),typeof i.env.references[v]>"u"&&(i.env.references[v]={title:m,href:h}),i.line=o),!0):!1}const Ute=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Vte="[a-zA-Z_:][a-zA-Z0-9:._-]*",Zte="[^\"'=<>`\\x00-\\x20]+",jte="'[^']*'",Gte='"[^"]*"',Hte="(?:"+Zte+"|"+jte+"|"+Gte+")",Xte="(?:\\s+"+Vte+"(?:\\s*=\\s*"+Hte+")?)",oI="<[A-Za-z][A-Za-z0-9\\-]*"+Xte+"*\\s*\\/?>",aI="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",zte="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",Wte="<[?][\\s\\S]*?[?]>",qte="<![A-Za-z][^>]*>",Yte="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",Kte=new RegExp("^(?:"+oI+"|"+aI+"|"+zte+"|"+Wte+"|"+qte+"|"+Yte+")"),Jte=new RegExp("^(?:"+oI+"|"+aI+")"),zo=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+Ute.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(Jte.source+"\\s*$"),/^$/,!1]];function eie(i,e,t,n){let r=i.bMarks[e]+i.tShift[e],s=i.eMarks[e];if(i.sCount[e]-i.blkIndent>=4||!i.md.options.html||i.src.charCodeAt(r)!==60)return!1;let o=i.src.slice(r,s),a=0;for(;a<zo.length&&!zo[a][0].test(o);a++);if(a===zo.length)return!1;if(n)return zo[a][2];let l=e+1;if(!zo[a][1].test(o)){for(;l<t&&!(i.sCount[l]<i.blkIndent);l++)if(r=i.bMarks[l]+i.tShift[l],s=i.eMarks[l],o=i.src.slice(r,s),zo[a][1].test(o)){o.length!==0&&l++;break}}i.line=l;const u=i.push("html_block","",0);return u.map=[e,l],u.content=i.getLines(e,l,i.blkIndent,!0),!0}function tie(i,e,t,n){let r=i.bMarks[e]+i.tShift[e],s=i.eMarks[e];if(i.sCount[e]-i.blkIndent>=4)return!1;let o=i.src.charCodeAt(r);if(o!==35||r>=s)return!1;let a=1;for(o=i.src.charCodeAt(++r);o===35&&r<s&&a<=6;)a++,o=i.src.charCodeAt(++r);if(a>6||r<s&&!nt(o))return!1;if(n)return!0;s=i.skipSpacesBack(s,r);const l=i.skipCharsBack(s,35,r);l>r&&nt(i.src.charCodeAt(l-1))&&(s=l),i.line=e+1;const u=i.push("heading_open","h"+String(a),1);u.markup="########".slice(0,a),u.map=[e,i.line];const c=i.push("inline","",0);c.content=i.src.slice(r,s).trim(),c.map=[e,i.line],c.children=[];const h=i.push("heading_close","h"+String(a),-1);return h.markup="########".slice(0,a),!0}function iie(i,e,t){const n=i.md.block.ruler.getRules("paragraph");if(i.sCount[e]-i.blkIndent>=4)return!1;const r=i.parentType;i.parentType="paragraph";let s=0,o,a=e+1;for(;a<t&&!i.isEmpty(a);a++){if(i.sCount[a]-i.blkIndent>3)continue;if(i.sCount[a]>=i.blkIndent){let d=i.bMarks[a]+i.tShift[a];const p=i.eMarks[a];if(d<p&&(o=i.src.charCodeAt(d),(o===45||o===61)&&(d=i.skipChars(d,o),d=i.skipSpaces(d),d>=p))){s=o===61?1:2;break}}if(i.sCount[a]<0)continue;let f=!1;for(let d=0,p=n.length;d<p;d++)if(n[d](i,a,t,!0)){f=!0;break}if(f)break}if(!s)return!1;const l=i.getLines(e,a,i.blkIndent,!1).trim();i.line=a+1;const u=i.push("heading_open","h"+String(s),1);u.markup=String.fromCharCode(o),u.map=[e,i.line];const c=i.push("inline","",0);c.content=l,c.map=[e,i.line-1],c.children=[];const h=i.push("heading_close","h"+String(s),-1);return h.markup=String.fromCharCode(o),i.parentType=r,!0}function nie(i,e,t){const n=i.md.block.ruler.getRules("paragraph"),r=i.parentType;let s=e+1;for(i.parentType="paragraph";s<t&&!i.isEmpty(s);s++){if(i.sCount[s]-i.blkIndent>3||i.sCount[s]<0)continue;let u=!1;for(let c=0,h=n.length;c<h;c++)if(n[c](i,s,t,!0)){u=!0;break}if(u)break}const o=i.getLines(e,s,i.blkIndent,!1).trim();i.line=s;const a=i.push("paragraph_open","p",1);a.map=[e,i.line];const l=i.push("inline","",0);return l.content=o,l.map=[e,i.line],l.children=[],i.push("paragraph_close","p",-1),i.parentType=r,!0}const Eh=[["table",Ite,["paragraph","reference"]],["code",Dte],["fence",$te,["paragraph","reference","blockquote","list"]],["blockquote",Mte,["paragraph","reference","blockquote","list"]],["hr",Fte,["paragraph","reference","blockquote","list"]],["list",Qte,["paragraph","reference","blockquote"]],["reference",Bte],["html_block",eie,["paragraph","reference","blockquote"]],["heading",tie,["paragraph","reference","blockquote"]],["lheading",iie],["paragraph",nie]];function Pp(){this.ruler=new _i;for(let i=0;i<Eh.length;i++)this.ruler.push(Eh[i][0],Eh[i][1],{alt:(Eh[i][2]||[]).slice()})}Pp.prototype.tokenize=function(i,e,t){const n=this.ruler.getRules(""),r=n.length,s=i.md.options.maxNesting;let o=e,a=!1;for(;o<t&&(i.line=o=i.skipEmptyLines(o),!(o>=t||i.sCount[o]<i.blkIndent));){if(i.level>=s){i.line=t;break}const l=i.line;let u=!1;for(let c=0;c<r;c++)if(u=n[c](i,o,t,!1),u){if(l>=i.line)throw new Error("block rule didn't increment state.line");break}if(!u)throw new Error("none of the block rules matched");i.tight=!a,i.isEmpty(i.line-1)&&(a=!0),o=i.line,o<t&&i.isEmpty(o)&&(a=!0,o++,i.line=o)}};Pp.prototype.parse=function(i,e,t,n){if(!i)return;const r=new this.State(i,e,t,n);this.tokenize(r,r.line,r.lineMax)};Pp.prototype.State=Sr;function bc(i,e,t,n){this.src=i,this.env=t,this.md=e,this.tokens=n,this.tokens_meta=Array(n.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}bc.prototype.pushPending=function(){const i=new Hn("text","",0);return i.content=this.pending,i.level=this.pendingLevel,this.tokens.push(i),this.pending="",i};bc.prototype.push=function(i,e,t){this.pending&&this.pushPending();const n=new Hn(i,e,t);let r=null;return t<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),n.level=this.level,t>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],r={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(n),this.tokens_meta.push(r),n};bc.prototype.scanDelims=function(i,e){const t=this.posMax,n=this.src.charCodeAt(i),r=i>0?this.src.charCodeAt(i-1):32;let s=i;for(;s<t&&this.src.charCodeAt(s)===n;)s++;const o=s-i,a=s<t?this.src.charCodeAt(s):32,l=Iu(r)||Lu(String.fromCharCode(r)),u=Iu(a)||Lu(String.fromCharCode(a)),c=Ru(r),h=Ru(a),f=!h&&(!u||c||l),d=!c&&(!l||h||u);return{can_open:f&&(e||!d||l),can_close:d&&(e||!f||u),length:o}};bc.prototype.Token=Hn;function rie(i){switch(i){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function sie(i,e){let t=i.pos;for(;t<i.posMax&&!rie(i.src.charCodeAt(t));)t++;return t===i.pos?!1:(e||(i.pending+=i.src.slice(i.pos,t)),i.pos=t,!0)}const oie=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function aie(i,e){if(!i.md.options.linkify||i.linkLevel>0)return!1;const t=i.pos,n=i.posMax;if(t+3>n||i.src.charCodeAt(t)!==58||i.src.charCodeAt(t+1)!==47||i.src.charCodeAt(t+2)!==47)return!1;const r=i.pending.match(oie);if(!r)return!1;const s=r[1],o=i.md.linkify.matchAtStart(i.src.slice(t-s.length));if(!o)return!1;let a=o.url;if(a.length<=s.length)return!1;a=a.replace(/\*+$/,"");const l=i.md.normalizeLink(a);if(!i.md.validateLink(l))return!1;if(!e){i.pending=i.pending.slice(0,-s.length);const u=i.push("link_open","a",1);u.attrs=[["href",l]],u.markup="linkify",u.info="auto";const c=i.push("text","",0);c.content=i.md.normalizeLinkText(a);const h=i.push("link_close","a",-1);h.markup="linkify",h.info="auto"}return i.pos+=a.length-s.length,!0}function lie(i,e){let t=i.pos;if(i.src.charCodeAt(t)!==10)return!1;const n=i.pending.length-1,r=i.posMax;if(!e)if(n>=0&&i.pending.charCodeAt(n)===32)if(n>=1&&i.pending.charCodeAt(n-1)===32){let s=n-1;for(;s>=1&&i.pending.charCodeAt(s-1)===32;)s--;i.pending=i.pending.slice(0,s),i.push("hardbreak","br",0)}else i.pending=i.pending.slice(0,-1),i.push("softbreak","br",0);else i.push("softbreak","br",0);for(t++;t<r&&nt(i.src.charCodeAt(t));)t++;return i.pos=t,!0}const $1=[];for(let i=0;i<256;i++)$1.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(i){$1[i.charCodeAt(0)]=1});function uie(i,e){let t=i.pos;const n=i.posMax;if(i.src.charCodeAt(t)!==92||(t++,t>=n))return!1;let r=i.src.charCodeAt(t);if(r===10){for(e||i.push("hardbreak","br",0),t++;t<n&&(r=i.src.charCodeAt(t),!!nt(r));)t++;return i.pos=t,!0}let s=i.src[t];if(r>=55296&&r<=56319&&t+1<n){const a=i.src.charCodeAt(t+1);a>=56320&&a<=57343&&(s+=i.src[t+1],t++)}const o="\\"+s;if(!e){const a=i.push("text_special","",0);r<256&&$1[r]!==0?a.content=s:a.content=o,a.markup=o,a.info="escape"}return i.pos=t+1,!0}function cie(i,e){let t=i.pos;if(i.src.charCodeAt(t)!==96)return!1;const r=t;t++;const s=i.posMax;for(;t<s&&i.src.charCodeAt(t)===96;)t++;const o=i.src.slice(r,t),a=o.length;if(i.backticksScanned&&(i.backticks[a]||0)<=r)return e||(i.pending+=o),i.pos+=a,!0;let l=t,u;for(;(u=i.src.indexOf("`",l))!==-1;){for(l=u+1;l<s&&i.src.charCodeAt(l)===96;)l++;const c=l-u;if(c===a){if(!e){const h=i.push("code_inline","code",0);h.markup=o,h.content=i.src.slice(t,u).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return i.pos=l,!0}i.backticks[c]=u}return i.backticksScanned=!0,e||(i.pending+=o),i.pos+=a,!0}function hie(i,e){const t=i.pos,n=i.src.charCodeAt(t);if(e||n!==126)return!1;const r=i.scanDelims(i.pos,!0);let s=r.length;const o=String.fromCharCode(n);if(s<2)return!1;let a;s%2&&(a=i.push("text","",0),a.content=o,s--);for(let l=0;l<s;l+=2)a=i.push("text","",0),a.content=o+o,i.delimiters.push({marker:n,length:0,token:i.tokens.length-1,end:-1,open:r.can_open,close:r.can_close});return i.pos+=r.length,!0}function Iw(i,e){let t;const n=[],r=e.length;for(let s=0;s<r;s++){const o=e[s];if(o.marker!==126||o.end===-1)continue;const a=e[o.end];t=i.tokens[o.token],t.type="s_open",t.tag="s",t.nesting=1,t.markup="~~",t.content="",t=i.tokens[a.token],t.type="s_close",t.tag="s",t.nesting=-1,t.markup="~~",t.content="",i.tokens[a.token-1].type==="text"&&i.tokens[a.token-1].content==="~"&&n.push(a.token-1)}for(;n.length;){const s=n.pop();let o=s+1;for(;o<i.tokens.length&&i.tokens[o].type==="s_close";)o++;o--,s!==o&&(t=i.tokens[o],i.tokens[o]=i.tokens[s],i.tokens[s]=t)}}function fie(i){const e=i.tokens_meta,t=i.tokens_meta.length;Iw(i,i.delimiters);for(let n=0;n<t;n++)e[n]&&e[n].delimiters&&Iw(i,e[n].delimiters)}const lI={tokenize:hie,postProcess:fie};function die(i,e){const t=i.pos,n=i.src.charCodeAt(t);if(e||n!==95&&n!==42)return!1;const r=i.scanDelims(i.pos,n===42);for(let s=0;s<r.length;s++){const o=i.push("text","",0);o.content=String.fromCharCode(n),i.delimiters.push({marker:n,length:r.length,token:i.tokens.length-1,end:-1,open:r.can_open,close:r.can_close})}return i.pos+=r.length,!0}function Dw(i,e){const t=e.length;for(let n=t-1;n>=0;n--){const r=e[n];if(r.marker!==95&&r.marker!==42||r.end===-1)continue;const s=e[r.end],o=n>0&&e[n-1].end===r.end+1&&e[n-1].marker===r.marker&&e[n-1].token===r.token-1&&e[r.end+1].token===s.token+1,a=String.fromCharCode(r.marker),l=i.tokens[r.token];l.type=o?"strong_open":"em_open",l.tag=o?"strong":"em",l.nesting=1,l.markup=o?a+a:a,l.content="";const u=i.tokens[s.token];u.type=o?"strong_close":"em_close",u.tag=o?"strong":"em",u.nesting=-1,u.markup=o?a+a:a,u.content="",o&&(i.tokens[e[n-1].token].content="",i.tokens[e[r.end+1].token].content="",n--)}}function pie(i){const e=i.tokens_meta,t=i.tokens_meta.length;Dw(i,i.delimiters);for(let n=0;n<t;n++)e[n]&&e[n].delimiters&&Dw(i,e[n].delimiters)}const uI={tokenize:die,postProcess:pie};function gie(i,e){let t,n,r,s,o="",a="",l=i.pos,u=!0;if(i.src.charCodeAt(i.pos)!==91)return!1;const c=i.pos,h=i.posMax,f=i.pos+1,d=i.md.helpers.parseLinkLabel(i,i.pos,!0);if(d<0)return!1;let p=d+1;if(p<h&&i.src.charCodeAt(p)===40){for(u=!1,p++;p<h&&(t=i.src.charCodeAt(p),!(!nt(t)&&t!==10));p++);if(p>=h)return!1;if(l=p,r=i.md.helpers.parseLinkDestination(i.src,p,i.posMax),r.ok){for(o=i.md.normalizeLink(r.str),i.md.validateLink(o)?p=r.pos:o="",l=p;p<h&&(t=i.src.charCodeAt(p),!(!nt(t)&&t!==10));p++);if(r=i.md.helpers.parseLinkTitle(i.src,p,i.posMax),p<h&&l!==p&&r.ok)for(a=r.str,p=r.pos;p<h&&(t=i.src.charCodeAt(p),!(!nt(t)&&t!==10));p++);}(p>=h||i.src.charCodeAt(p)!==41)&&(u=!0),p++}if(u){if(typeof i.env.references>"u")return!1;if(p<h&&i.src.charCodeAt(p)===91?(l=p+1,p=i.md.helpers.parseLinkLabel(i,p),p>=0?n=i.src.slice(l,p++):p=d+1):p=d+1,n||(n=i.src.slice(f,d)),s=i.env.references[Ap(n)],!s)return i.pos=c,!1;o=s.href,a=s.title}if(!e){i.pos=f,i.posMax=d;const g=i.push("link_open","a",1),m=[["href",o]];g.attrs=m,a&&m.push(["title",a]),i.linkLevel++,i.md.inline.tokenize(i),i.linkLevel--,i.push("link_close","a",-1)}return i.pos=p,i.posMax=h,!0}function mie(i,e){let t,n,r,s,o,a,l,u,c="";const h=i.pos,f=i.posMax;if(i.src.charCodeAt(i.pos)!==33||i.src.charCodeAt(i.pos+1)!==91)return!1;const d=i.pos+2,p=i.md.helpers.parseLinkLabel(i,i.pos+1,!1);if(p<0)return!1;if(s=p+1,s<f&&i.src.charCodeAt(s)===40){for(s++;s<f&&(t=i.src.charCodeAt(s),!(!nt(t)&&t!==10));s++);if(s>=f)return!1;for(u=s,a=i.md.helpers.parseLinkDestination(i.src,s,i.posMax),a.ok&&(c=i.md.normalizeLink(a.str),i.md.validateLink(c)?s=a.pos:c=""),u=s;s<f&&(t=i.src.charCodeAt(s),!(!nt(t)&&t!==10));s++);if(a=i.md.helpers.parseLinkTitle(i.src,s,i.posMax),s<f&&u!==s&&a.ok)for(l=a.str,s=a.pos;s<f&&(t=i.src.charCodeAt(s),!(!nt(t)&&t!==10));s++);else l="";if(s>=f||i.src.charCodeAt(s)!==41)return i.pos=h,!1;s++}else{if(typeof i.env.references>"u")return!1;if(s<f&&i.src.charCodeAt(s)===91?(u=s+1,s=i.md.helpers.parseLinkLabel(i,s),s>=0?r=i.src.slice(u,s++):s=p+1):s=p+1,r||(r=i.src.slice(d,p)),o=i.env.references[Ap(r)],!o)return i.pos=h,!1;c=o.href,l=o.title}if(!e){n=i.src.slice(d,p);const g=[];i.md.inline.parse(n,i.md,i.env,g);const m=i.push("image","img",0),v=[["src",c],["alt",""]];m.attrs=v,m.children=g,m.content=n,l&&v.push(["title",l])}return i.pos=s,i.posMax=f,!0}const vie=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,Oie=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function yie(i,e){let t=i.pos;if(i.src.charCodeAt(t)!==60)return!1;const n=i.pos,r=i.posMax;for(;;){if(++t>=r)return!1;const o=i.src.charCodeAt(t);if(o===60)return!1;if(o===62)break}const s=i.src.slice(n+1,t);if(Oie.test(s)){const o=i.md.normalizeLink(s);if(!i.md.validateLink(o))return!1;if(!e){const a=i.push("link_open","a",1);a.attrs=[["href",o]],a.markup="autolink",a.info="auto";const l=i.push("text","",0);l.content=i.md.normalizeLinkText(s);const u=i.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return i.pos+=s.length+2,!0}if(vie.test(s)){const o=i.md.normalizeLink("mailto:"+s);if(!i.md.validateLink(o))return!1;if(!e){const a=i.push("link_open","a",1);a.attrs=[["href",o]],a.markup="autolink",a.info="auto";const l=i.push("text","",0);l.content=i.md.normalizeLinkText(s);const u=i.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return i.pos+=s.length+2,!0}return!1}function bie(i){return/^<a[>\s]/i.test(i)}function xie(i){return/^<\/a\s*>/i.test(i)}function Sie(i){const e=i|32;return e>=97&&e<=122}function kie(i,e){if(!i.md.options.html)return!1;const t=i.posMax,n=i.pos;if(i.src.charCodeAt(n)!==60||n+2>=t)return!1;const r=i.src.charCodeAt(n+1);if(r!==33&&r!==63&&r!==47&&!Sie(r))return!1;const s=i.src.slice(n).match(Kte);if(!s)return!1;if(!e){const o=i.push("html_inline","",0);o.content=s[0],bie(o.content)&&i.linkLevel++,xie(o.content)&&i.linkLevel--}return i.pos+=s[0].length,!0}const Tie=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,Eie=/^&([a-z][a-z0-9]{1,31});/i;function wie(i,e){const t=i.pos,n=i.posMax;if(i.src.charCodeAt(t)!==38||t+1>=n)return!1;if(i.src.charCodeAt(t+1)===35){const s=i.src.slice(t).match(Tie);if(s){if(!e){const o=s[1][0].toLowerCase()==="x"?parseInt(s[1].slice(1),16):parseInt(s[1],10),a=i.push("text_special","",0);a.content=I1(o)?Ed(o):Ed(65533),a.markup=s[0],a.info="entity"}return i.pos+=s[0].length,!0}}else{const s=i.src.slice(t).match(Eie);if(s){const o=tI(s[0]);if(o!==s[0]){if(!e){const a=i.push("text_special","",0);a.content=o,a.markup=s[0],a.info="entity"}return i.pos+=s[0].length,!0}}}return!1}function $w(i){const e={},t=i.length;if(!t)return;let n=0,r=-2;const s=[];for(let o=0;o<t;o++){const a=i[o];if(s.push(0),(i[n].marker!==a.marker||r!==a.token-1)&&(n=o),r=a.token,a.length=a.length||0,!a.close)continue;e.hasOwnProperty(a.marker)||(e[a.marker]=[-1,-1,-1,-1,-1,-1]);const l=e[a.marker][(a.open?3:0)+a.length%3];let u=n-s[n]-1,c=u;for(;u>l;u-=s[u]+1){const h=i[u];if(h.marker===a.marker&&h.open&&h.end<0){let f=!1;if((h.close||a.open)&&(h.length+a.length)%3===0&&(h.length%3!==0||a.length%3!==0)&&(f=!0),!f){const d=u>0&&!i[u-1].open?s[u-1]+1:0;s[o]=o-u+d,s[u]=d,a.open=!1,h.end=o,h.close=!1,c=-1,r=-2;break}}}c!==-1&&(e[a.marker][(a.open?3:0)+(a.length||0)%3]=c)}}function _ie(i){const e=i.tokens_meta,t=i.tokens_meta.length;$w(i.delimiters);for(let n=0;n<t;n++)e[n]&&e[n].delimiters&&$w(e[n].delimiters)}function Cie(i){let e,t,n=0;const r=i.tokens,s=i.tokens.length;for(e=t=0;e<s;e++)r[e].nesting<0&&n--,r[e].level=n,r[e].nesting>0&&n++,r[e].type==="text"&&e+1<s&&r[e+1].type==="text"?r[e+1].content=r[e].content+r[e+1].content:(e!==t&&(r[t]=r[e]),t++);e!==t&&(r.length=t)}const Z0=[["text",sie],["linkify",aie],["newline",lie],["escape",uie],["backticks",cie],["strikethrough",lI.tokenize],["emphasis",uI.tokenize],["link",gie],["image",mie],["autolink",yie],["html_inline",kie],["entity",wie]],j0=[["balance_pairs",_ie],["strikethrough",lI.postProcess],["emphasis",uI.postProcess],["fragments_join",Cie]];function xc(){this.ruler=new _i;for(let i=0;i<Z0.length;i++)this.ruler.push(Z0[i][0],Z0[i][1]);this.ruler2=new _i;for(let i=0;i<j0.length;i++)this.ruler2.push(j0[i][0],j0[i][1])}xc.prototype.skipToken=function(i){const e=i.pos,t=this.ruler.getRules(""),n=t.length,r=i.md.options.maxNesting,s=i.cache;if(typeof s[e]<"u"){i.pos=s[e];return}let o=!1;if(i.level<r){for(let a=0;a<n;a++)if(i.level++,o=t[a](i,!0),i.level--,o){if(e>=i.pos)throw new Error("inline rule didn't increment state.pos");break}}else i.pos=i.posMax;o||i.pos++,s[e]=i.pos};xc.prototype.tokenize=function(i){const e=this.ruler.getRules(""),t=e.length,n=i.posMax,r=i.md.options.maxNesting;for(;i.pos<n;){const s=i.pos;let o=!1;if(i.level<r){for(let a=0;a<t;a++)if(o=e[a](i,!1),o){if(s>=i.pos)throw new Error("inline rule didn't increment state.pos");break}}if(o){if(i.pos>=n)break;continue}i.pending+=i.src[i.pos++]}i.pending&&i.pushPending()};xc.prototype.parse=function(i,e,t,n){const r=new this.State(i,e,t,n);this.tokenize(r);const s=this.ruler2.getRules(""),o=s.length;for(let a=0;a<o;a++)s[a](r)};xc.prototype.State=bc;function Aie(i){const e={};i=i||{},e.src_Any=qL.source,e.src_Cc=YL.source,e.src_Z=JL.source,e.src_P=R1.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const t="[><]";return e.src_pseudo_letter="(?:(?!"+t+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+t+"|"+e.src_ZPCc+")(?!"+(i["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+t+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(i["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+t+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function Mv(i){return Array.prototype.slice.call(arguments,1).forEach(function(t){t&&Object.keys(t).forEach(function(n){i[n]=t[n]})}),i}function Rp(i){return Object.prototype.toString.call(i)}function Pie(i){return Rp(i)==="[object String]"}function Rie(i){return Rp(i)==="[object Object]"}function Lie(i){return Rp(i)==="[object RegExp]"}function Mw(i){return Rp(i)==="[object Function]"}function Iie(i){return i.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const cI={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function Die(i){return Object.keys(i||{}).reduce(function(e,t){return e||cI.hasOwnProperty(t)},!1)}const $ie={"http:":{validate:function(i,e,t){const n=i.slice(e);return t.re.http||(t.re.http=new RegExp("^\\/\\/"+t.re.src_auth+t.re.src_host_port_strict+t.re.src_path,"i")),t.re.http.test(n)?n.match(t.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(i,e,t){const n=i.slice(e);return t.re.no_http||(t.re.no_http=new RegExp("^"+t.re.src_auth+"(?:localhost|(?:(?:"+t.re.src_domain+")\\.)+"+t.re.src_domain_root+")"+t.re.src_port+t.re.src_host_terminator+t.re.src_path,"i")),t.re.no_http.test(n)?e>=3&&i[e-3]===":"||e>=3&&i[e-3]==="/"?0:n.match(t.re.no_http)[0].length:0}},"mailto:":{validate:function(i,e,t){const n=i.slice(e);return t.re.mailto||(t.re.mailto=new RegExp("^"+t.re.src_email_name+"@"+t.re.src_host_strict,"i")),t.re.mailto.test(n)?n.match(t.re.mailto)[0].length:0}}},Mie="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Fie="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function Nie(i){i.__index__=-1,i.__text_cache__=""}function Qie(i){return function(e,t){const n=e.slice(t);return i.test(n)?n.match(i)[0].length:0}}function Fw(){return function(i,e){e.normalize(i)}}function wd(i){const e=i.re=Aie(i.__opts__),t=i.__tlds__.slice();i.onCompile(),i.__tlds_replaced__||t.push(Mie),t.push(e.src_xn),e.src_tlds=t.join("|");function n(a){return a.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(n(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(n(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(n(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(n(e.tpl_host_fuzzy_test),"i");const r=[];i.__compiled__={};function s(a,l){throw new Error('(LinkifyIt) Invalid schema "'+a+'": '+l)}Object.keys(i.__schemas__).forEach(function(a){const l=i.__schemas__[a];if(l===null)return;const u={validate:null,link:null};if(i.__compiled__[a]=u,Rie(l)){Lie(l.validate)?u.validate=Qie(l.validate):Mw(l.validate)?u.validate=l.validate:s(a,l),Mw(l.normalize)?u.normalize=l.normalize:l.normalize?s(a,l):u.normalize=Fw();return}if(Pie(l)){r.push(a);return}s(a,l)}),r.forEach(function(a){i.__compiled__[i.__schemas__[a]]&&(i.__compiled__[a].validate=i.__compiled__[i.__schemas__[a]].validate,i.__compiled__[a].normalize=i.__compiled__[i.__schemas__[a]].normalize)}),i.__compiled__[""]={validate:null,normalize:Fw()};const o=Object.keys(i.__compiled__).filter(function(a){return a.length>0&&i.__compiled__[a]}).map(Iie).join("|");i.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+o+")","i"),i.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+o+")","ig"),i.re.schema_at_start=RegExp("^"+i.re.schema_search.source,"i"),i.re.pretest=RegExp("("+i.re.schema_test.source+")|("+i.re.host_fuzzy_test.source+")|@","i"),Nie(i)}function Bie(i,e){const t=i.__index__,n=i.__last_index__,r=i.__text_cache__.slice(t,n);this.schema=i.__schema__.toLowerCase(),this.index=t+e,this.lastIndex=n+e,this.raw=r,this.text=r,this.url=r}function Fv(i,e){const t=new Bie(i,e);return i.__compiled__[t.schema].normalize(t,i),t}function Xi(i,e){if(!(this instanceof Xi))return new Xi(i,e);e||Die(i)&&(e=i,i={}),this.__opts__=Mv({},cI,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Mv({},$ie,i),this.__compiled__={},this.__tlds__=Fie,this.__tlds_replaced__=!1,this.re={},wd(this)}Xi.prototype.add=function(e,t){return this.__schemas__[e]=t,wd(this),this};Xi.prototype.set=function(e){return this.__opts__=Mv(this.__opts__,e),this};Xi.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let t,n,r,s,o,a,l,u,c;if(this.re.schema_test.test(e)){for(l=this.re.schema_search,l.lastIndex=0;(t=l.exec(e))!==null;)if(s=this.testSchemaAt(e,t[2],l.lastIndex),s){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+s;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(u=e.search(this.re.host_fuzzy_test),u>=0&&(this.__index__<0||u<this.__index__)&&(n=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(o=n.index+n[1].length,(this.__index__<0||o<this.__index__)&&(this.__schema__="",this.__index__=o,this.__last_index__=n.index+n[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&(r=e.match(this.re.email_fuzzy))!==null&&(o=r.index+r[1].length,a=r.index+r[0].length,(this.__index__<0||o<this.__index__||o===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=o,this.__last_index__=a))),this.__index__>=0};Xi.prototype.pretest=function(e){return this.re.pretest.test(e)};Xi.prototype.testSchemaAt=function(e,t,n){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,n,this):0};Xi.prototype.match=function(e){const t=[];let n=0;this.__index__>=0&&this.__text_cache__===e&&(t.push(Fv(this,n)),n=this.__last_index__);let r=n?e.slice(n):e;for(;this.test(r);)t.push(Fv(this,n)),r=r.slice(this.__last_index__),n+=this.__last_index__;return t.length?t:null};Xi.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const t=this.re.schema_at_start.exec(e);if(!t)return null;const n=this.testSchemaAt(e,t[2],t[0].length);return n?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+n,Fv(this,0)):null};Xi.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(n,r,s){return n!==s[r-1]}).reverse(),wd(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,wd(this),this)};Xi.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};Xi.prototype.onCompile=function(){};const Oa=2147483647,ur=36,M1=1,Du=26,Uie=38,Vie=700,hI=72,fI=128,dI="-",Zie=/^xn--/,jie=/[^\0-\x7F]/,Gie=/[\x2E\u3002\uFF0E\uFF61]/g,Hie={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},G0=ur-M1,cr=Math.floor,H0=String.fromCharCode;function rs(i){throw new RangeError(Hie[i])}function Xie(i,e){const t=[];let n=i.length;for(;n--;)t[n]=e(i[n]);return t}function pI(i,e){const t=i.split("@");let n="";t.length>1&&(n=t[0]+"@",i=t[1]),i=i.replace(Gie,".");const r=i.split("."),s=Xie(r,e).join(".");return n+s}function gI(i){const e=[];let t=0;const n=i.length;for(;t<n;){const r=i.charCodeAt(t++);if(r>=55296&&r<=56319&&t<n){const s=i.charCodeAt(t++);(s&64512)==56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),t--)}else e.push(r)}return e}const zie=i=>String.fromCodePoint(...i),Wie=function(i){return i>=48&&i<58?26+(i-48):i>=65&&i<91?i-65:i>=97&&i<123?i-97:ur},Nw=function(i,e){return i+22+75*(i<26)-((e!=0)<<5)},mI=function(i,e,t){let n=0;for(i=t?cr(i/Vie):i>>1,i+=cr(i/e);i>G0*Du>>1;n+=ur)i=cr(i/G0);return cr(n+(G0+1)*i/(i+Uie))},vI=function(i){const e=[],t=i.length;let n=0,r=fI,s=hI,o=i.lastIndexOf(dI);o<0&&(o=0);for(let a=0;a<o;++a)i.charCodeAt(a)>=128&&rs("not-basic"),e.push(i.charCodeAt(a));for(let a=o>0?o+1:0;a<t;){const l=n;for(let c=1,h=ur;;h+=ur){a>=t&&rs("invalid-input");const f=Wie(i.charCodeAt(a++));f>=ur&&rs("invalid-input"),f>cr((Oa-n)/c)&&rs("overflow"),n+=f*c;const d=h<=s?M1:h>=s+Du?Du:h-s;if(f<d)break;const p=ur-d;c>cr(Oa/p)&&rs("overflow"),c*=p}const u=e.length+1;s=mI(n-l,u,l==0),cr(n/u)>Oa-r&&rs("overflow"),r+=cr(n/u),n%=u,e.splice(n++,0,r)}return String.fromCodePoint(...e)},OI=function(i){const e=[];i=gI(i);const t=i.length;let n=fI,r=0,s=hI;for(const l of i)l<128&&e.push(H0(l));const o=e.length;let a=o;for(o&&e.push(dI);a<t;){let l=Oa;for(const c of i)c>=n&&c<l&&(l=c);const u=a+1;l-n>cr((Oa-r)/u)&&rs("overflow"),r+=(l-n)*u,n=l;for(const c of i)if(c<n&&++r>Oa&&rs("overflow"),c===n){let h=r;for(let f=ur;;f+=ur){const d=f<=s?M1:f>=s+Du?Du:f-s;if(h<d)break;const p=h-d,g=ur-d;e.push(H0(Nw(d+p%g,0))),h=cr(p/g)}e.push(H0(Nw(h,0))),s=mI(r,u,a===o),r=0,++a}++r,++n}return e.join("")},qie=function(i){return pI(i,function(e){return Zie.test(e)?vI(e.slice(4).toLowerCase()):e})},Yie=function(i){return pI(i,function(e){return jie.test(e)?"xn--"+OI(e):e})},yI={version:"2.3.1",ucs2:{decode:gI,encode:zie},decode:vI,encode:OI,toASCII:Yie,toUnicode:qie},Kie={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},Jie={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},ene={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},tne={default:Kie,zero:Jie,commonmark:ene},ine=/^(vbscript|javascript|file|data):/,nne=/^data:image\/(gif|png|jpeg|webp);/;function rne(i){const e=i.trim().toLowerCase();return ine.test(e)?nne.test(e):!0}const bI=["http:","https:","mailto:"];function sne(i){const e=P1(i,!0);if(e.hostname&&(!e.protocol||bI.indexOf(e.protocol)>=0))try{e.hostname=yI.toASCII(e.hostname)}catch{}return yc(A1(e))}function one(i){const e=P1(i,!0);if(e.hostname&&(!e.protocol||bI.indexOf(e.protocol)>=0))try{e.hostname=yI.toUnicode(e.hostname)}catch{}return Na(A1(e),Na.defaultChars+"%")}function gn(i,e){if(!(this instanceof gn))return new gn(i,e);e||L1(i)||(e=i||{},i="default"),this.inline=new xc,this.block=new Pp,this.core=new D1,this.renderer=new hl,this.linkify=new Xi,this.validateLink=rne,this.normalizeLink=sne,this.normalizeLinkText=one,this.utils=lte,this.helpers=Cp({},fte),this.options={},this.configure(i),e&&this.set(e)}gn.prototype.set=function(i){return Cp(this.options,i),this};gn.prototype.configure=function(i){const e=this;if(L1(i)){const t=i;if(i=tne[t],!i)throw new Error('Wrong `markdown-it` preset "'+t+'", check name')}if(!i)throw new Error("Wrong `markdown-it` preset, can't be empty");return i.options&&e.set(i.options),i.components&&Object.keys(i.components).forEach(function(t){i.components[t].rules&&e[t].ruler.enableOnly(i.components[t].rules),i.components[t].rules2&&e[t].ruler2.enableOnly(i.components[t].rules2)}),this};gn.prototype.enable=function(i,e){let t=[];Array.isArray(i)||(i=[i]),["core","block","inline"].forEach(function(r){t=t.concat(this[r].ruler.enable(i,!0))},this),t=t.concat(this.inline.ruler2.enable(i,!0));const n=i.filter(function(r){return t.indexOf(r)<0});if(n.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+n);return this};gn.prototype.disable=function(i,e){let t=[];Array.isArray(i)||(i=[i]),["core","block","inline"].forEach(function(r){t=t.concat(this[r].ruler.disable(i,!0))},this),t=t.concat(this.inline.ruler2.disable(i,!0));const n=i.filter(function(r){return t.indexOf(r)<0});if(n.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+n);return this};gn.prototype.use=function(i){const e=[this].concat(Array.prototype.slice.call(arguments,1));return i.apply(i,e),this};gn.prototype.parse=function(i,e){if(typeof i!="string")throw new Error("Input data should be a String");const t=new this.core.State(i,this,e);return this.core.process(t),t.tokens};gn.prototype.render=function(i,e){return e=e||{},this.renderer.render(this.parse(i,e),this.options,e)};gn.prototype.parseInline=function(i,e){const t=new this.core.State(i,this,e);return t.inlineMode=!0,this.core.process(t),t.tokens};gn.prototype.renderInline=function(i,e){return e=e||{},this.renderer.render(this.parseInline(i,e),this.options,e)};const Qw=new Set([!0,!1,"alt","title"]);function xI(i,e){return(Array.isArray(i)?i:[]).filter(([t])=>t!==e)}function SI(i,e){i&&i.attrs&&(i.attrs=xI(i.attrs,e))}function ane(i,e){if(!Qw.has(i))throw new TypeError(`figcaption must be one of: ${[...Qw]}.`);if(i==="alt")return e.content;const t=e.attrs.find(([n])=>n==="title");return Array.isArray(t)&&t[1]?(SI(e,"title"),t[1]):void 0}function lne(i,e){e=e||{},i.core.ruler.before("linkify","image_figures",function(t){let n=1;for(let r=1,s=t.tokens.length;r<s-1;++r){const o=t.tokens[r];if(o.type!=="inline"||!o.children||o.children.length!==1&&o.children.length!==3||o.children.length===1&&o.children[0].type!=="image")continue;if(o.children.length===3){const[u,c,h]=o.children;if(u.type!=="link_open"||c.type!=="image"||h.type!=="link_close")continue}if(r!==0&&t.tokens[r-1].type!=="paragraph_open"||r!==s-1&&t.tokens[r+1].type!=="paragraph_close")continue;const a=t.tokens[r-1];let l;if(a.type="figure_open",a.tag="figure",t.tokens[r+1].type="figure_close",t.tokens[r+1].tag="figure",e.dataType&&t.tokens[r-1].attrPush(["data-type","image"]),e.link&&o.children.length===1){[l]=o.children;const u=new t.Token("link_open","a",1);u.attrPush(["href",l.attrGet("src")]),o.children.unshift(u),o.children.push(new t.Token("link_close","a",-1))}if(l=o.children.length===1?o.children[0]:o.children[1],e.figcaption){const u=ane(e.figcaption,l);if(u){const[c]=i.parseInline(u,t.env);o.children.push(new t.Token("figcaption_open","figcaption",1)),o.children.push(...c.children),o.children.push(new t.Token("figcaption_close","figcaption",-1)),l.attrs&&(l.attrs=xI(l.attrs,"title"))}}if(e.copyAttrs&&l.attrs){const u=e.copyAttrs===!0?"":e.copyAttrs;a.attrs=l.attrs.filter(([c])=>c.match(u)).map(c=>Array.from(c))}if(e.tabindex&&(t.tokens[r-1].attrPush(["tabindex",n]),n++),e.lazy&&(l.attrs.some(([u])=>u==="loading")||l.attrs.push(["loading","lazy"])),e.async&&(l.attrs.some(([u])=>u==="decoding")||l.attrs.push(["decoding","async"])),e.classes&&typeof e.classes=="string"){let u=!1;for(let c=0,h=l.attrs.length;c<h&&!u;c++){const f=l.attrs[c];f[0]==="class"&&(f[1]=`${f[1]} ${e.classes}`,u=!0)}u||l.attrs.push(["class",e.classes])}if(e.removeSrc){const u=l.attrs.find(([c])=>c==="src");l.attrs.push(["data-src",u[1]]),SI(l,"src")}}})}const une=/\\([ \\!"#$%&'()*+,./:;<=>?@[\]^_`{|}~-])/g;function cne(i,e){const t=i.posMax,n=i.pos;if(i.src.charCodeAt(n)!==126||e||n+2>=t)return!1;i.pos=n+1;let r=!1;for(;i.pos<t;){if(i.src.charCodeAt(i.pos)===126){r=!0;break}i.md.inline.skipToken(i)}if(!r||n+1===i.pos)return i.pos=n,!1;const s=i.src.slice(n+1,i.pos);if(s.match(/(^|[^\\])(\\\\)*\s/))return i.pos=n,!1;i.posMax=i.pos,i.pos=n+1;const o=i.push("sub_open","sub",1);o.markup="~";const a=i.push("text","",0);a.content=s.replace(une,"$1");const l=i.push("sub_close","sub",-1);return l.markup="~",i.pos=i.posMax+1,i.posMax=t,!0}function hne(i){i.inline.ruler.after("emphasis","sub",cne)}const fne=/\\([ \\!"#$%&'()*+,./:;<=>?@[\]^_`{|}~-])/g;function dne(i,e){const t=i.posMax,n=i.pos;if(i.src.charCodeAt(n)!==94||e||n+2>=t)return!1;i.pos=n+1;let r=!1;for(;i.pos<t;){if(i.src.charCodeAt(i.pos)===94){r=!0;break}i.md.inline.skipToken(i)}if(!r||n+1===i.pos)return i.pos=n,!1;const s=i.src.slice(n+1,i.pos);if(s.match(/(^|[^\\])(\\\\)*\s/))return i.pos=n,!1;i.posMax=i.pos,i.pos=n+1;const o=i.push("sup_open","sup",1);o.markup="^";const a=i.push("text","",0);a.content=s.replace(fne,"$1");const l=i.push("sup_close","sup",-1);return l.markup="^",i.pos=i.posMax+1,i.posMax=t,!0}function pne(i){i.inline.ruler.after("emphasis","sup",dne)}const gne=(i,e="image.png")=>{const t=i.split(","),n=t[0].match(/:(.*?);/);if(n){const r=n[1],s=atob(t[1]);let o=s.length;const a=new Uint8Array(o);for(;o--;)a[o]=s.charCodeAt(o);return new File([a],e,{type:r})}return null},mne=(i,e)=>{if(!i)return i;const t=e.split(`
`),n=['<span rn-wrapper aria-hidden="true">'];return t.forEach(()=>{n.push("<span></span>")}),n.push("</span>"),`<span class="${C}-code-block">${i}</span>${n.join("")}`},vne=(i,e)=>{if(!i||!e)return 0;const t=i==null?void 0:i.getBoundingClientRect();if(e===document.documentElement)return t.top-e.clientTop;const n=e==null?void 0:e.getBoundingClientRect();return t.top-n.top},Bw=(()=>{let i=0;return()=>++i})(),Wo=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,kI=new Set,Nv=typeof process=="object"&&process?process:{},TI=(i,e,t,n)=>{typeof Nv.emitWarning=="function"?Nv.emitWarning(i,e,t,n):console.error(`[${t}] ${e}: ${i}`)};let _d=globalThis.AbortController,Uw=globalThis.AbortSignal;var L2;if(typeof _d>"u"){Uw=class{constructor(){pt(this,"onabort");pt(this,"_onabort",[]);pt(this,"reason");pt(this,"aborted",!1)}addEventListener(n,r){this._onabort.push(r)}},_d=class{constructor(){pt(this,"signal",new Uw);e()}abort(n){var r,s;if(!this.signal.aborted){this.signal.reason=n,this.signal.aborted=!0;for(const o of this.signal._onabort)o(n);(s=(r=this.signal).onabort)==null||s.call(r,n)}}};let i=((L2=Nv.env)==null?void 0:L2.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{i&&(i=!1,TI("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const One=i=>!kI.has(i),Kr=i=>i&&i===Math.floor(i)&&i>0&&isFinite(i),EI=i=>Kr(i)?i<=Math.pow(2,8)?Uint8Array:i<=Math.pow(2,16)?Uint16Array:i<=Math.pow(2,32)?Uint32Array:i<=Number.MAX_SAFE_INTEGER?kf:null:null;class kf extends Array{constructor(e){super(e),this.fill(0)}}var dr,wa;let yne=(dr=class{constructor(e,t){pt(this,"heap");pt(this,"length");if(!P(dr,wa))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}static create(e){const t=EI(e);if(!t)return[];ye(dr,wa,!0);const n=new dr(e,t);return ye(dr,wa,!1),n}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},wa=new WeakMap,je(dr,wa,!1),dr);var I2,D2,wn,Di,_n,Cn,_a,Ca,It,An,Et,at,_e,ui,$i,ii,Bt,Pn,Ut,Rn,Ln,Mi,In,hs,ci,te,Bv,no,Ir,Ju,Fi,wI,ro,Aa,ec,Jr,es,Uv,Tf,Ef,ot,Vv,ql,ts,Zv;const Fb=class Fb{constructor(e){je(this,te);je(this,wn);je(this,Di);je(this,_n);je(this,Cn);je(this,_a);je(this,Ca);pt(this,"ttl");pt(this,"ttlResolution");pt(this,"ttlAutopurge");pt(this,"updateAgeOnGet");pt(this,"updateAgeOnHas");pt(this,"allowStale");pt(this,"noDisposeOnSet");pt(this,"noUpdateTTL");pt(this,"maxEntrySize");pt(this,"sizeCalculation");pt(this,"noDeleteOnFetchRejection");pt(this,"noDeleteOnStaleGet");pt(this,"allowStaleOnFetchAbort");pt(this,"allowStaleOnFetchRejection");pt(this,"ignoreFetchAbort");je(this,It);je(this,An);je(this,Et);je(this,at);je(this,_e);je(this,ui);je(this,$i);je(this,ii);je(this,Bt);je(this,Pn);je(this,Ut);je(this,Rn);je(this,Ln);je(this,Mi);je(this,In);je(this,hs);je(this,ci);je(this,no,()=>{});je(this,Ir,()=>{});je(this,Ju,()=>{});je(this,Fi,()=>!1);je(this,ro,e=>{});je(this,Aa,(e,t,n)=>{});je(this,ec,(e,t,n,r)=>{if(n||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});pt(this,I2,"LRUCache");const{max:t=0,ttl:n,ttlResolution:r=1,ttlAutopurge:s,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:l,dispose:u,disposeAfter:c,noDisposeOnSet:h,noUpdateTTL:f,maxSize:d=0,maxEntrySize:p=0,sizeCalculation:g,fetchMethod:m,memoMethod:v,noDeleteOnFetchRejection:O,noDeleteOnStaleGet:y,allowStaleOnFetchRejection:x,allowStaleOnFetchAbort:b,ignoreFetchAbort:E}=e;if(t!==0&&!Kr(t))throw new TypeError("max option must be a nonnegative integer");const T=t?EI(t):Array;if(!T)throw new Error("invalid max value: "+t);if(ye(this,wn,t),ye(this,Di,d),this.maxEntrySize=p||P(this,Di),this.sizeCalculation=g,this.sizeCalculation){if(!P(this,Di)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(v!==void 0&&typeof v!="function")throw new TypeError("memoMethod must be a function if defined");if(ye(this,Ca,v),m!==void 0&&typeof m!="function")throw new TypeError("fetchMethod must be a function if specified");if(ye(this,_a,m),ye(this,hs,!!m),ye(this,Et,new Map),ye(this,at,new Array(t).fill(void 0)),ye(this,_e,new Array(t).fill(void 0)),ye(this,ui,new T(t)),ye(this,$i,new T(t)),ye(this,ii,0),ye(this,Bt,0),ye(this,Pn,yne.create(t)),ye(this,It,0),ye(this,An,0),typeof u=="function"&&ye(this,_n,u),typeof c=="function"?(ye(this,Cn,c),ye(this,Ut,[])):(ye(this,Cn,void 0),ye(this,Ut,void 0)),ye(this,In,!!P(this,_n)),ye(this,ci,!!P(this,Cn)),this.noDisposeOnSet=!!h,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!O,this.allowStaleOnFetchRejection=!!x,this.allowStaleOnFetchAbort=!!b,this.ignoreFetchAbort=!!E,this.maxEntrySize!==0){if(P(this,Di)!==0&&!Kr(P(this,Di)))throw new TypeError("maxSize must be a positive integer if specified");if(!Kr(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");ue(this,te,wI).call(this)}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!y,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=Kr(r)||r===0?r:1,this.ttlAutopurge=!!s,this.ttl=n||0,this.ttl){if(!Kr(this.ttl))throw new TypeError("ttl must be a positive integer if specified");ue(this,te,Bv).call(this)}if(P(this,wn)===0&&this.ttl===0&&P(this,Di)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!P(this,wn)&&!P(this,Di)){const _="LRU_CACHE_UNBOUNDED";One(_)&&(kI.add(_),TI("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",_,Fb))}}static unsafeExposeInternals(e){return{starts:P(e,Ln),ttls:P(e,Mi),sizes:P(e,Rn),keyMap:P(e,Et),keyList:P(e,at),valList:P(e,_e),next:P(e,ui),prev:P(e,$i),get head(){return P(e,ii)},get tail(){return P(e,Bt)},free:P(e,Pn),isBackgroundFetch:t=>{var n;return ue(n=e,te,ot).call(n,t)},backgroundFetch:(t,n,r,s)=>{var o;return ue(o=e,te,Ef).call(o,t,n,r,s)},moveToTail:t=>{var n;return ue(n=e,te,ql).call(n,t)},indexes:t=>{var n;return ue(n=e,te,Jr).call(n,t)},rindexes:t=>{var n;return ue(n=e,te,es).call(n,t)},isStale:t=>{var n;return P(n=e,Fi).call(n,t)}}}get max(){return P(this,wn)}get maxSize(){return P(this,Di)}get calculatedSize(){return P(this,An)}get size(){return P(this,It)}get fetchMethod(){return P(this,_a)}get memoMethod(){return P(this,Ca)}get dispose(){return P(this,_n)}get disposeAfter(){return P(this,Cn)}getRemainingTTL(e){return P(this,Et).has(e)?1/0:0}*entries(){for(const e of ue(this,te,Jr).call(this))P(this,_e)[e]!==void 0&&P(this,at)[e]!==void 0&&!ue(this,te,ot).call(this,P(this,_e)[e])&&(yield[P(this,at)[e],P(this,_e)[e]])}*rentries(){for(const e of ue(this,te,es).call(this))P(this,_e)[e]!==void 0&&P(this,at)[e]!==void 0&&!ue(this,te,ot).call(this,P(this,_e)[e])&&(yield[P(this,at)[e],P(this,_e)[e]])}*keys(){for(const e of ue(this,te,Jr).call(this)){const t=P(this,at)[e];t!==void 0&&!ue(this,te,ot).call(this,P(this,_e)[e])&&(yield t)}}*rkeys(){for(const e of ue(this,te,es).call(this)){const t=P(this,at)[e];t!==void 0&&!ue(this,te,ot).call(this,P(this,_e)[e])&&(yield t)}}*values(){for(const e of ue(this,te,Jr).call(this))P(this,_e)[e]!==void 0&&!ue(this,te,ot).call(this,P(this,_e)[e])&&(yield P(this,_e)[e])}*rvalues(){for(const e of ue(this,te,es).call(this))P(this,_e)[e]!==void 0&&!ue(this,te,ot).call(this,P(this,_e)[e])&&(yield P(this,_e)[e])}[(D2=Symbol.iterator,I2=Symbol.toStringTag,D2)](){return this.entries()}find(e,t={}){for(const n of ue(this,te,Jr).call(this)){const r=P(this,_e)[n],s=ue(this,te,ot).call(this,r)?r.__staleWhileFetching:r;if(s!==void 0&&e(s,P(this,at)[n],this))return this.get(P(this,at)[n],t)}}forEach(e,t=this){for(const n of ue(this,te,Jr).call(this)){const r=P(this,_e)[n],s=ue(this,te,ot).call(this,r)?r.__staleWhileFetching:r;s!==void 0&&e.call(t,s,P(this,at)[n],this)}}rforEach(e,t=this){for(const n of ue(this,te,es).call(this)){const r=P(this,_e)[n],s=ue(this,te,ot).call(this,r)?r.__staleWhileFetching:r;s!==void 0&&e.call(t,s,P(this,at)[n],this)}}purgeStale(){let e=!1;for(const t of ue(this,te,es).call(this,{allowStale:!0}))P(this,Fi).call(this,t)&&(ue(this,te,ts).call(this,P(this,at)[t],"expire"),e=!0);return e}info(e){const t=P(this,Et).get(e);if(t===void 0)return;const n=P(this,_e)[t],r=ue(this,te,ot).call(this,n)?n.__staleWhileFetching:n;if(r===void 0)return;const s={value:r};if(P(this,Mi)&&P(this,Ln)){const o=P(this,Mi)[t],a=P(this,Ln)[t];if(o&&a){const l=o-(Wo.now()-a);s.ttl=l,s.start=Date.now()}}return P(this,Rn)&&(s.size=P(this,Rn)[t]),s}dump(){const e=[];for(const t of ue(this,te,Jr).call(this,{allowStale:!0})){const n=P(this,at)[t],r=P(this,_e)[t],s=ue(this,te,ot).call(this,r)?r.__staleWhileFetching:r;if(s===void 0||n===void 0)continue;const o={value:s};if(P(this,Mi)&&P(this,Ln)){o.ttl=P(this,Mi)[t];const a=Wo.now()-P(this,Ln)[t];o.start=Math.floor(Date.now()-a)}P(this,Rn)&&(o.size=P(this,Rn)[t]),e.unshift([n,o])}return e}load(e){this.clear();for(const[t,n]of e){if(n.start){const r=Date.now()-n.start;n.start=Wo.now()-r}this.set(t,n.value,n)}}set(e,t,n={}){var f,d,p,g,m;if(t===void 0)return this.delete(e),this;const{ttl:r=this.ttl,start:s,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:l}=n;let{noUpdateTTL:u=this.noUpdateTTL}=n;const c=P(this,ec).call(this,e,t,n.size||0,a);if(this.maxEntrySize&&c>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),ue(this,te,ts).call(this,e,"set"),this;let h=P(this,It)===0?void 0:P(this,Et).get(e);if(h===void 0)h=P(this,It)===0?P(this,Bt):P(this,Pn).length!==0?P(this,Pn).pop():P(this,It)===P(this,wn)?ue(this,te,Tf).call(this,!1):P(this,It),P(this,at)[h]=e,P(this,_e)[h]=t,P(this,Et).set(e,h),P(this,ui)[P(this,Bt)]=h,P(this,$i)[h]=P(this,Bt),ye(this,Bt,h),Fc(this,It)._++,P(this,Aa).call(this,h,c,l),l&&(l.set="add"),u=!1;else{ue(this,te,ql).call(this,h);const v=P(this,_e)[h];if(t!==v){if(P(this,hs)&&ue(this,te,ot).call(this,v)){v.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:O}=v;O!==void 0&&!o&&(P(this,In)&&((f=P(this,_n))==null||f.call(this,O,e,"set")),P(this,ci)&&((d=P(this,Ut))==null||d.push([O,e,"set"])))}else o||(P(this,In)&&((p=P(this,_n))==null||p.call(this,v,e,"set")),P(this,ci)&&((g=P(this,Ut))==null||g.push([v,e,"set"])));if(P(this,ro).call(this,h),P(this,Aa).call(this,h,c,l),P(this,_e)[h]=t,l){l.set="replace";const O=v&&ue(this,te,ot).call(this,v)?v.__staleWhileFetching:v;O!==void 0&&(l.oldValue=O)}}else l&&(l.set="update")}if(r!==0&&!P(this,Mi)&&ue(this,te,Bv).call(this),P(this,Mi)&&(u||P(this,Ju).call(this,h,r,s),l&&P(this,Ir).call(this,l,h)),!o&&P(this,ci)&&P(this,Ut)){const v=P(this,Ut);let O;for(;O=v==null?void 0:v.shift();)(m=P(this,Cn))==null||m.call(this,...O)}return this}pop(){var e;try{for(;P(this,It);){const t=P(this,_e)[P(this,ii)];if(ue(this,te,Tf).call(this,!0),ue(this,te,ot).call(this,t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(P(this,ci)&&P(this,Ut)){const t=P(this,Ut);let n;for(;n=t==null?void 0:t.shift();)(e=P(this,Cn))==null||e.call(this,...n)}}}has(e,t={}){const{updateAgeOnHas:n=this.updateAgeOnHas,status:r}=t,s=P(this,Et).get(e);if(s!==void 0){const o=P(this,_e)[s];if(ue(this,te,ot).call(this,o)&&o.__staleWhileFetching===void 0)return!1;if(P(this,Fi).call(this,s))r&&(r.has="stale",P(this,Ir).call(this,r,s));else return n&&P(this,no).call(this,s),r&&(r.has="hit",P(this,Ir).call(this,r,s)),!0}else r&&(r.has="miss");return!1}peek(e,t={}){const{allowStale:n=this.allowStale}=t,r=P(this,Et).get(e);if(r===void 0||!n&&P(this,Fi).call(this,r))return;const s=P(this,_e)[r];return ue(this,te,ot).call(this,s)?s.__staleWhileFetching:s}async fetch(e,t={}){const{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:l=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:d=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:g,forceRefresh:m=!1,status:v,signal:O}=t;if(!P(this,hs))return v&&(v.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:s,status:v});const y={allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:s,ttl:o,noDisposeOnSet:a,size:l,sizeCalculation:u,noUpdateTTL:c,noDeleteOnFetchRejection:h,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:d,status:v,signal:O};let x=P(this,Et).get(e);if(x===void 0){v&&(v.fetch="miss");const b=ue(this,te,Ef).call(this,e,x,y,g);return b.__returned=b}else{const b=P(this,_e)[x];if(ue(this,te,ot).call(this,b)){const A=n&&b.__staleWhileFetching!==void 0;return v&&(v.fetch="inflight",A&&(v.returnedStale=!0)),A?b.__staleWhileFetching:b.__returned=b}const E=P(this,Fi).call(this,x);if(!m&&!E)return v&&(v.fetch="hit"),ue(this,te,ql).call(this,x),r&&P(this,no).call(this,x),v&&P(this,Ir).call(this,v,x),b;const T=ue(this,te,Ef).call(this,e,x,y,g),D=T.__staleWhileFetching!==void 0&&n;return v&&(v.fetch=E?"stale":"refresh",D&&E&&(v.returnedStale=!0)),D?T.__staleWhileFetching:T.__returned=T}}async forceFetch(e,t={}){const n=await this.fetch(e,t);if(n===void 0)throw new Error("fetch() returned undefined");return n}memo(e,t={}){const n=P(this,Ca);if(!n)throw new Error("no memoMethod provided to constructor");const{context:r,forceRefresh:s,...o}=t,a=this.get(e,o);if(!s&&a!==void 0)return a;const l=n(e,a,{options:o,context:r});return this.set(e,l,o),l}get(e,t={}){const{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:o}=t,a=P(this,Et).get(e);if(a!==void 0){const l=P(this,_e)[a],u=ue(this,te,ot).call(this,l);return o&&P(this,Ir).call(this,o,a),P(this,Fi).call(this,a)?(o&&(o.get="stale"),u?(o&&n&&l.__staleWhileFetching!==void 0&&(o.returnedStale=!0),n?l.__staleWhileFetching:void 0):(s||ue(this,te,ts).call(this,e,"expire"),o&&n&&(o.returnedStale=!0),n?l:void 0)):(o&&(o.get="hit"),u?l.__staleWhileFetching:(ue(this,te,ql).call(this,a),r&&P(this,no).call(this,a),l))}else o&&(o.get="miss")}delete(e){return ue(this,te,ts).call(this,e,"delete")}clear(){return ue(this,te,Zv).call(this,"delete")}};wn=new WeakMap,Di=new WeakMap,_n=new WeakMap,Cn=new WeakMap,_a=new WeakMap,Ca=new WeakMap,It=new WeakMap,An=new WeakMap,Et=new WeakMap,at=new WeakMap,_e=new WeakMap,ui=new WeakMap,$i=new WeakMap,ii=new WeakMap,Bt=new WeakMap,Pn=new WeakMap,Ut=new WeakMap,Rn=new WeakMap,Ln=new WeakMap,Mi=new WeakMap,In=new WeakMap,hs=new WeakMap,ci=new WeakMap,te=new WeakSet,Bv=function(){const e=new kf(P(this,wn)),t=new kf(P(this,wn));ye(this,Mi,e),ye(this,Ln,t),ye(this,Ju,(s,o,a=Wo.now())=>{if(t[s]=o!==0?a:0,e[s]=o,o!==0&&this.ttlAutopurge){const l=setTimeout(()=>{P(this,Fi).call(this,s)&&ue(this,te,ts).call(this,P(this,at)[s],"expire")},o+1);l.unref&&l.unref()}}),ye(this,no,s=>{t[s]=e[s]!==0?Wo.now():0}),ye(this,Ir,(s,o)=>{if(e[o]){const a=e[o],l=t[o];if(!a||!l)return;s.ttl=a,s.start=l,s.now=n||r();const u=s.now-l;s.remainingTTL=a-u}});let n=0;const r=()=>{const s=Wo.now();if(this.ttlResolution>0){n=s;const o=setTimeout(()=>n=0,this.ttlResolution);o.unref&&o.unref()}return s};this.getRemainingTTL=s=>{const o=P(this,Et).get(s);if(o===void 0)return 0;const a=e[o],l=t[o];if(!a||!l)return 1/0;const u=(n||r())-l;return a-u},ye(this,Fi,s=>{const o=t[s],a=e[s];return!!a&&!!o&&(n||r())-o>a})},no=new WeakMap,Ir=new WeakMap,Ju=new WeakMap,Fi=new WeakMap,wI=function(){const e=new kf(P(this,wn));ye(this,An,0),ye(this,Rn,e),ye(this,ro,t=>{ye(this,An,P(this,An)-e[t]),e[t]=0}),ye(this,ec,(t,n,r,s)=>{if(ue(this,te,ot).call(this,n))return 0;if(!Kr(r))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(r=s(n,t),!Kr(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return r}),ye(this,Aa,(t,n,r)=>{if(e[t]=n,P(this,Di)){const s=P(this,Di)-e[t];for(;P(this,An)>s;)ue(this,te,Tf).call(this,!0)}ye(this,An,P(this,An)+e[t]),r&&(r.entrySize=n,r.totalCalculatedSize=P(this,An))})},ro=new WeakMap,Aa=new WeakMap,ec=new WeakMap,Jr=function*({allowStale:e=this.allowStale}={}){if(P(this,It))for(let t=P(this,Bt);!(!ue(this,te,Uv).call(this,t)||((e||!P(this,Fi).call(this,t))&&(yield t),t===P(this,ii)));)t=P(this,$i)[t]},es=function*({allowStale:e=this.allowStale}={}){if(P(this,It))for(let t=P(this,ii);!(!ue(this,te,Uv).call(this,t)||((e||!P(this,Fi).call(this,t))&&(yield t),t===P(this,Bt)));)t=P(this,ui)[t]},Uv=function(e){return e!==void 0&&P(this,Et).get(P(this,at)[e])===e},Tf=function(e){var s,o;const t=P(this,ii),n=P(this,at)[t],r=P(this,_e)[t];return P(this,hs)&&ue(this,te,ot).call(this,r)?r.__abortController.abort(new Error("evicted")):(P(this,In)||P(this,ci))&&(P(this,In)&&((s=P(this,_n))==null||s.call(this,r,n,"evict")),P(this,ci)&&((o=P(this,Ut))==null||o.push([r,n,"evict"]))),P(this,ro).call(this,t),e&&(P(this,at)[t]=void 0,P(this,_e)[t]=void 0,P(this,Pn).push(t)),P(this,It)===1?(ye(this,ii,ye(this,Bt,0)),P(this,Pn).length=0):ye(this,ii,P(this,ui)[t]),P(this,Et).delete(n),Fc(this,It)._--,t},Ef=function(e,t,n,r){const s=t===void 0?void 0:P(this,_e)[t];if(ue(this,te,ot).call(this,s))return s;const o=new _d,{signal:a}=n;a==null||a.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});const l={signal:o.signal,options:n,context:r},u=(g,m=!1)=>{const{aborted:v}=o.signal,O=n.ignoreFetchAbort&&g!==void 0;if(n.status&&(v&&!m?(n.status.fetchAborted=!0,n.status.fetchError=o.signal.reason,O&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),v&&!O&&!m)return h(o.signal.reason);const y=d;return P(this,_e)[t]===d&&(g===void 0?y.__staleWhileFetching?P(this,_e)[t]=y.__staleWhileFetching:ue(this,te,ts).call(this,e,"fetch"):(n.status&&(n.status.fetchUpdated=!0),this.set(e,g,l.options))),g},c=g=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=g),h(g)),h=g=>{const{aborted:m}=o.signal,v=m&&n.allowStaleOnFetchAbort,O=v||n.allowStaleOnFetchRejection,y=O||n.noDeleteOnFetchRejection,x=d;if(P(this,_e)[t]===d&&(!y||x.__staleWhileFetching===void 0?ue(this,te,ts).call(this,e,"fetch"):v||(P(this,_e)[t]=x.__staleWhileFetching)),O)return n.status&&x.__staleWhileFetching!==void 0&&(n.status.returnedStale=!0),x.__staleWhileFetching;if(x.__returned===x)throw g},f=(g,m)=>{var O;const v=(O=P(this,_a))==null?void 0:O.call(this,e,s,l);v&&v instanceof Promise&&v.then(y=>g(y===void 0?void 0:y),m),o.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(g(void 0),n.allowStaleOnFetchAbort&&(g=y=>u(y,!0)))})};n.status&&(n.status.fetchDispatched=!0);const d=new Promise(f).then(u,c),p=Object.assign(d,{__abortController:o,__staleWhileFetching:s,__returned:void 0});return t===void 0?(this.set(e,p,{...l.options,status:void 0}),t=P(this,Et).get(e)):P(this,_e)[t]=p,p},ot=function(e){if(!P(this,hs))return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof _d},Vv=function(e,t){P(this,$i)[t]=e,P(this,ui)[e]=t},ql=function(e){e!==P(this,Bt)&&(e===P(this,ii)?ye(this,ii,P(this,ui)[e]):ue(this,te,Vv).call(this,P(this,$i)[e],P(this,ui)[e]),ue(this,te,Vv).call(this,P(this,Bt),e),ye(this,Bt,e))},ts=function(e,t){var r,s,o,a;let n=!1;if(P(this,It)!==0){const l=P(this,Et).get(e);if(l!==void 0)if(n=!0,P(this,It)===1)ue(this,te,Zv).call(this,t);else{P(this,ro).call(this,l);const u=P(this,_e)[l];if(ue(this,te,ot).call(this,u)?u.__abortController.abort(new Error("deleted")):(P(this,In)||P(this,ci))&&(P(this,In)&&((r=P(this,_n))==null||r.call(this,u,e,t)),P(this,ci)&&((s=P(this,Ut))==null||s.push([u,e,t]))),P(this,Et).delete(e),P(this,at)[l]=void 0,P(this,_e)[l]=void 0,l===P(this,Bt))ye(this,Bt,P(this,$i)[l]);else if(l===P(this,ii))ye(this,ii,P(this,ui)[l]);else{const c=P(this,$i)[l];P(this,ui)[c]=P(this,ui)[l];const h=P(this,ui)[l];P(this,$i)[h]=P(this,$i)[l]}Fc(this,It)._--,P(this,Pn).push(l)}}if(P(this,ci)&&((o=P(this,Ut))!=null&&o.length)){const l=P(this,Ut);let u;for(;u=l==null?void 0:l.shift();)(a=P(this,Cn))==null||a.call(this,...u)}return n},Zv=function(e){var t,n,r;for(const s of ue(this,te,es).call(this,{allowStale:!0})){const o=P(this,_e)[s];if(ue(this,te,ot).call(this,o))o.__abortController.abort(new Error("deleted"));else{const a=P(this,at)[s];P(this,In)&&((t=P(this,_n))==null||t.call(this,o,a,e)),P(this,ci)&&((n=P(this,Ut))==null||n.push([o,a,e]))}}if(P(this,Et).clear(),P(this,_e).fill(void 0),P(this,at).fill(void 0),P(this,Mi)&&P(this,Ln)&&(P(this,Mi).fill(0),P(this,Ln).fill(0)),P(this,Rn)&&P(this,Rn).fill(0),ye(this,ii,0),ye(this,Bt,0),P(this,Pn).length=0,ye(this,An,0),ye(this,It,0),P(this,ci)&&P(this,Ut)){const s=P(this,Ut);let o;for(;o=s==null?void 0:s.shift();)(r=P(this,Cn))==null||r.call(this,...o)}};let Qv=Fb;const on={hljs:`${C}-hljs`,hlcss:`${C}-hlCss`,prettier:`${C}-prettier`,prettierMD:`${C}-prettierMD`,cropperjs:`${C}-cropper`,croppercss:`${C}-cropperCss`,screenfull:`${C}-screenfull`,mermaidM:`${C}-mermaid-m`,mermaid:`${C}-mermaid`,katexjs:`${C}-katex`,katexcss:`${C}-katexCss`},bne=(i,e)=>{const t=xe("editorId"),{noImgZoomIn:n}=i,r=NL(()=>{const s=document.querySelectorAll(`#${t}-preview img:not(.not-zoom):not(.medium-zoom-image)`);s.length!==0&&fee(s,{background:"#00000073"})});ft(()=>{!n&&i.setting.preview&&r()}),pe([e,Nn(i.setting,"preview")],()=>{!n&&i.setting.preview&&r()})},xne=(i,e,t)=>{const n=xe("editorId"),r=xe("rootRef"),s=xe("usedLanguageText"),o=()=>{r.value.querySelectorAll(`#${n} .${C}-preview .${C}-code`).forEach(u=>{let c=-1;const h=u.querySelector(`.${C}-copy-button`);h&&(h.onclick=f=>{f.preventDefault(),clearTimeout(c);const p=(u.querySelector("input:checked + pre code")||u.querySelector("pre code")).textContent,g=xee(i.formatCopiedText(p)),{text:m,successTips:v,failTips:O}=s.value.copyCode,y=g?v:O;h.dataset.isIcon?h.dataset.tips=y:h.innerHTML=y,c=window.setTimeout(()=>{h.dataset.isIcon?h.dataset.tips=m:h.innerHTML=m},1500)})})},a=()=>{wi(o)},l=u=>{u&&wi(o)};pe([e,t],a),pe(()=>i.setting.preview,l),pe(()=>i.setting.htmlPreview,l),ft(o)},Sne=i=>{const e=xe("highlight"),t=Qn(Ct.editorExtensions.highlight.instance);return ft(()=>{i.noHighlight||t.value||(sn("link",{...e.value.css,rel:"stylesheet",id:on.hlcss}),sn("script",{...e.value.js,id:on.hljs,onload(){t.value=window.hljs}},"hljs"))}),pe(()=>e.value.css,()=>{i.noHighlight||Ct.editorExtensions.highlight.instance||aee("link",{...e.value.css,rel:"stylesheet",id:on.hlcss})}),t},wf=new Qv({max:1e3,ttl:6e5}),kne=i=>{const e=xe("theme"),t=xe("rootRef"),{editorExtensions:n,editorExtensionsAttrs:r,mermaidConfig:s}=Ct,o=Qn(n.mermaid.instance),a=Qn(-1),l=()=>{const c=o.value;!i.noMermaid&&c&&(c.initialize(s({startOnLoad:!1,theme:e.value==="dark"?"dark":"default"})),a.value=a.value+1)};return pe(()=>e.value,()=>{wf.clear(),l()}),ft(()=>{var c,h;if(i.noMermaid||o.value)return;const f=n.mermaid.js;/\.mjs/.test(f)?(sn("link",{...(c=r.mermaid)==null?void 0:c.js,rel:"modulepreload",href:f,id:on.mermaidM}),import(f).then(d=>{o.value=d.default,l()})):sn("script",{...(h=r.mermaid)==null?void 0:h.js,src:f,id:on.mermaid,onload(){o.value=window.mermaid,l()}},"mermaid")}),{mermaidRef:o,reRenderRef:a,replaceMermaid:async()=>{if(!i.noMermaid&&o.value){const c=t.value.querySelectorAll(`div.${C}-mermaid`),h=document.createElement("div"),f=document.body.offsetWidth>1366?document.body.offsetWidth:1366,d=document.body.offsetHeight>768?document.body.offsetHeight:768;h.style.width=f+"px",h.style.height=d+"px",h.style.position="fixed",h.style.zIndex="-10000",h.style.top="-10000";let p=c.length;p>0&&document.body.appendChild(h),await Promise.allSettled(Array.from(c).map(g=>(async v=>{var O;let y=wf.get(v.innerText);if(!y){const x=Lv();let b={svg:""};try{b=await o.value.render(x,v.innerText,h),y=await i.sanitizeMermaid(b.svg);const E=document.createElement("p");E.className=`${C}-mermaid`,E.setAttribute("data-processed",""),E.innerHTML=y,(O=E.children[0])==null||O.removeAttribute("height"),wf.set(v.innerText,E.innerHTML),v.dataset.line!==void 0&&(E.dataset.line=v.dataset.line),v.replaceWith(E)}catch{}--p===0&&h.remove()}})(g)))}}}},Tne=i=>{const e=Qn(Ct.editorExtensions.katex.instance);return ft(()=>{if(i.noKatex||e.value)return;const{editorExtensions:t}=Ct;sn("script",{src:t.katex.js,id:on.katexjs,onload(){e.value=window.katex}},"katex"),sn("link",{rel:"stylesheet",href:t.katex.css,id:on.katexcss})}),e},Ene=(i,e)=>{const t=i.renderer.rules.fence.bind(i.renderer.rules);i.renderer.rules.fence=(n,r,s,o,a)=>{const l=n[r],u=l.content.trim();if(l.info==="mermaid"){let c;n[r].map&&n[r].level===0&&(c=n[r].map[0],n[r].attrSet("data-line",String(c)));const h=wf.get(u);return h?`<p class="${C}-mermaid" ${c!==void 0?"data-line="+c:""} data-processed>${h}</p>`:`<div class="${C}-mermaid" ${c!==void 0?"data-line="+c:""} data-mermaid-theme=${e.themeRef.value}>${u}</div>`}return t(n,r,s,o,a)}},Cd=(i,e)=>{const t=i.attrs?i.attrs.slice():[];return e.forEach(n=>{const r=i.attrIndex(n[0]);r<0?t.push(n):(t[r]=t[r].slice(),t[r][1]+=` ${n[1]}`)}),t},wne=(i,e)=>{const t=[{open:"$$",close:"$$"},{open:"$",close:"$"},{open:"\\[",close:"\\]"},{open:"\\(",close:"\\)"}];let n,r,s;for(const o of t)if(i.src.startsWith(o.open,i.pos)){const a=i.pos+o.open.length;for(n=a;(n=i.src.indexOf(o.close,n))!==-1;){for(s=n-1;i.src[s]==="\\";)s-=1;if((n-s)%2===1)break;n+=o.close.length}if(n===-1)return e||(i.pending+=o.open),i.pos=a,!0;if(n-a===0)return e||(i.pending+=o.open+o.close),i.pos=a+o.close.length,!0;if(!e){const l=i.src.slice(a,n);r=i.push("math_inline","math",0),r.markup=o.open,r.content=l}return i.pos=n+o.close.length,!0}return!1},_ne=(i,e,t,n)=>{const r=[{open:"$$",close:"$$"},{open:"\\[",close:"\\]"}];let s,o,a,l,u=!1,c=i.bMarks[e]+i.tShift[e],h=i.eMarks[e];for(const f of r)if(i.src.slice(c,c+f.open.length)===f.open&&i.src.slice(h-f.close.length,h)===f.close){if(c+=f.open.length,s=i.src.slice(c,h),n)return!0;for(s.trim().slice(-f.close.length)===f.close&&(s=s.trim().slice(0,-f.close.length),u=!0),a=e;!u&&(a++,!(a>=t||(c=i.bMarks[a]+i.tShift[a],h=i.eMarks[a],c<h&&i.tShift[a]<i.blkIndent)));)i.src.slice(c,h).trim().slice(-f.close.length)===f.close&&(l=i.src.slice(0,h).lastIndexOf(f.close),o=i.src.slice(c,l),u=!0);i.line=a+1;const d=i.push("math_block","math",0);return d.block=!0,d.content=(s&&s.trim()?s+`
`:"")+i.getLines(e+1,a,i.tShift[e],!0)+(o&&o.trim()?o:""),d.map=[e,i.line],d.markup=f.open,!0}return!1},Cne=(i,{katexRef:e})=>{const t=(r,s,o,a,l)=>{const u=r[s],c={attrs:Cd(u,[["class",`${C}-katex-inline`]])};if(e.value){const h=e.value.renderToString(u.content,Ct.katexConfig({throwOnError:!1}));return`<span ${l.renderAttrs(c)} data-processed>${h}</span>`}else return`<span ${l.renderAttrs(c)}>${u.content}</span>`},n=(r,s,o,a,l)=>{const u=r[s],c={attrs:Cd(u,[["class",`${C}-katex-block`]])};if(e.value){const h=e.value.renderToString(u.content,Ct.katexConfig({throwOnError:!1,displayMode:!0}));return`<p ${l.renderAttrs(c)} data-processed>${h}</p>`}else return`<p ${l.renderAttrs(c)}>${u.content}</p>`};i.inline.ruler.before("escape","math_inline",wne),i.block.ruler.after("blockquote","math_block",_ne,{alt:["paragraph","reference","blockquote","list"]}),i.renderer.rules.math_inline=t,i.renderer.rules.math_block=n},Ane=(i,e)=>{e=e||{};const t=3,n=e.marker||"!",r=n.charCodeAt(0),s=n.length;let o="",a="";const l=(c,h,f,d,p)=>{const g=c[h];return g.type==="admonition_open"?c[h].attrPush(["class",`${C}-admonition ${C}-admonition-${g.info}`]):g.type==="admonition_title_open"&&c[h].attrPush(["class",`${C}-admonition-title`]),p.renderToken(c,h,f)},u=c=>{const h=c.trim().split(" ",2);a="",o=h[0],h.length>1&&(a=c.substring(o.length+2))};i.block.ruler.before("code","admonition",(c,h,f,d)=>{let p,g,m,v=!1,O=c.bMarks[h]+c.tShift[h],y=c.eMarks[h];if(r!==c.src.charCodeAt(O))return!1;for(p=O+1;p<=y&&n[(p-O)%s]===c.src[p];p++);const x=Math.floor((p-O)/s);if(x!==t)return!1;p-=(p-O)%s;const b=c.src.slice(O,p),E=c.src.slice(p,y);if(u(E),d)return!0;for(g=h;g++,!(g>=f||(O=c.bMarks[g]+c.tShift[g],y=c.eMarks[g],O<y&&c.sCount[g]<c.blkIndent));)if(r===c.src.charCodeAt(O)&&!(c.sCount[g]-c.blkIndent>=4)){for(p=O+1;p<=y&&n[(p-O)%s]===c.src[p];p++);if(!(Math.floor((p-O)/s)<x)&&(p-=(p-O)%s,p=c.skipSpaces(p),!(p<y))){v=!0;break}}const T=c.parentType,_=c.lineMax;return c.parentType="root",c.lineMax=g,m=c.push("admonition_open","div",1),m.markup=b,m.block=!0,m.info=o,m.map=[h,g],a&&(m=c.push("admonition_title_open","p",1),m.markup=b+" "+o,m.map=[h,g],m=c.push("inline","",0),m.content=a,m.map=[h,c.line-1],m.children=[],m=c.push("admonition_title_close","p",-1),m.markup=b+" "+o),c.md.block.tokenize(c,h+1,g),m=c.push("admonition_close","div",-1),m.markup=c.src.slice(O,p),m.block=!0,c.parentType=T,c.lineMax=_,c.line=g+(v?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),i.renderer.rules.admonition_open=l,i.renderer.rules.admonition_title_open=l,i.renderer.rules.admonition_title_close=l,i.renderer.rules.admonition_close=l},Pne=(i,e)=>{i.renderer.rules.heading_open=(t,n)=>{var r;const s=t[n],o=((r=t[n+1].children)==null?void 0:r.reduce((l,u)=>l+(["text","code_inline","math_inline"].includes(u.type)&&u.content||""),""))||"",a=s.markup.length;return e.headsRef.value.push({text:o,level:a,line:s.map[0]}),s.map&&s.level===0&&s.attrSet("id",e.mdHeadingId(o,a,e.headsRef.value.length)),i.renderer.renderToken(t,n,e)},i.renderer.rules.heading_close=(t,n,r,s,o)=>o.renderToken(t,n,r)},Rne={copy:`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy ${C}-icon"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>`,"collapse-tips":`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-chevron-left ${C}-icon"><circle cx="12" cy="12" r="10"/><path d="m14 16-4-4 4-4"/></svg>`},Lne=(i,e)=>typeof e[i]=="string"?e[i]:Rne[i],Ine=Lne,Dne=(i,e)=>{const t=i.renderer.rules.fence,n=i.utils.unescapeAll,r=/\[(\w*)(?::([\w ]*))?\]/,s=/::(open|close)/,o=h=>h.info?n(h.info).trim():"",a=h=>{const f=o(h),[d=null,p=""]=(r.exec(f)||[]).slice(1);return[d,p]},l=h=>{const f=o(h);return f?f.split(/(\s+)/g)[0]:""},u=h=>{const f=h.info.match(s)||[],d=f[1]==="open"||f[1]!=="close"&&e.codeFoldable&&h.content.trim().split(`
`).length<e.autoFoldThreshold,p=f[1]||e.codeFoldable?"details":"div",g=f[1]||e.codeFoldable?"summary":"div";return{open:d,tagContainer:p,tagHeader:g}},c=(h,f,d,p,g)=>{var m;if(h[f].hidden)return"";const v=(m=e.usedLanguageTextRef.value)==null?void 0:m.copyCode.text,O=e.customIconRef.value.copy||v,y=!!e.customIconRef.value.copy,x=`<span class="${C}-collapse-tips">${Ine("collapse-tips",e.customIconRef.value)}</span>`,[b]=a(h[f]);if(b===null){const{open:ne,tagContainer:z,tagHeader:W}=u(h[f]),he=[["class",`${C}-code`]];ne&&he.push(["open",""]);const se={attrs:Cd(h[f],he)};h[f].info=h[f].info.replace(s,"");const oe=t(h,f,d,p,g);return`
        <${z} ${g.renderAttrs(se)}>
          <${W} class="${C}-code-head">
            <div class="${C}-code-flag"><span></span><span></span><span></span></div>
            <div class="${C}-code-action">
              <span class="${C}-code-lang">${h[f].info.trim()}</span>
              <span class="${C}-copy-button" data-tips="${v}"${y?" data-is-icon=true":""}>${O}</span>
              ${e.extraTools||""}
              ${z==="details"?x:""}
            </div>
          </${W}>
          ${oe}
        </${z}>
      `}let E,T,_,D,A="",I="",L="";const{open:$,tagContainer:B,tagHeader:Z}=u(h[f]),j=[["class",`${C}-code`]];$&&j.push(["open",""]);const ie={attrs:Cd(h[f],j)};for(let ne=f;ne<h.length&&(E=h[ne],[T,_]=a(E),T===b);ne++){E.info=E.info.replace(r,"").replace(s,""),E.hidden=!0;const z=`${C}-codetab-${e.editorId}-${f}-${ne-f}`;D=ne-f>0?"":"checked",A+=`
        <li>
          <input
            type="radio"
            id="label-${C}-codetab-label-1-${e.editorId}-${f}-${ne-f}"
            name="${C}-codetab-label-${e.editorId}-${f}"
            class="${z}"
            ${D}
          >
          <label
            for="label-${C}-codetab-label-1-${e.editorId}-${f}-${ne-f}"
            onclick="this.getRootNode().querySelectorAll('.${z}').forEach(e => e.click())"
          >
            ${_||l(E)}
          </label>
        </li>`,I+=`
        <div role="tabpanel">
          <input
            type="radio"
            name="${C}-codetab-pre-${e.editorId}-${f}"
            class="${z}"
            ${D}
            role="presentation">
          ${t(h,ne,d,p,g)}
        </div>`,L+=`
        <input
          type="radio"
          name="${C}-codetab-lang-${e.editorId}-${f}"
          class="${z}"
          ${D}
          role="presentation">
        <span class=${C}-code-lang role="note">${l(E)}</span>`}return`
      <${B} ${g.renderAttrs(ie)}>
        <${Z} class="${C}-code-head">
          <div class="${C}-code-flag">
            <ul class="${C}-codetab-label" role="tablist">${A}</ul>
          </div>
          <div class="${C}-code-action">
            <span class="${C}-codetab-lang">${L}</span>
            <span class="${C}-copy-button" data-tips="${v}"${y?" data-is-icon=true":""}>${O}</span>
            ${e.extraTools||""}
            ${B==="details"?x:""}
          </div>
        </${Z}>
        ${I}
      </${B}>
    `};i.renderer.rules.fence=c,i.renderer.rules.code_block=c},Vw=(i,e,t)=>{const n=i.attrIndex(e),r=[e,t];n<0?i.attrPush(r):(i.attrs=i.attrs||[],i.attrs[n]=r)},$ne=i=>i.type==="inline",Mne=i=>i.type==="paragraph_open",Fne=i=>i.type==="list_item_open",Nne=i=>i.content.indexOf("[ ] ")===0||i.content.indexOf("[x] ")===0||i.content.indexOf("[X] ")===0,Qne=(i,e)=>$ne(i[e])&&Mne(i[e-1])&&Fne(i[e-2])&&Nne(i[e]),Bne=(i,e)=>{const t=i[e].level-1;for(let n=e-1;n>=0;n--)if(i[n].level===t)return n;return-1},Une=i=>{const e=new i("html_inline","",0);return e.content="<label>",e},Vne=i=>{const e=new i("html_inline","",0);return e.content="</label>",e},Zne=(i,e,t)=>{const n=new t("html_inline","",0);return n.content='<label class="task-list-item-label" for="'+e+'">'+i+"</label>",n.attrs=[{for:e}],n},jne=(i,e,t)=>{const n=new e("html_inline","",0),r=t.enabled?" ":' disabled="" ';return i.content.indexOf("[ ] ")===0?n.content='<input class="task-list-item-checkbox"'+r+'type="checkbox">':(i.content.indexOf("[x] ")===0||i.content.indexOf("[X] ")===0)&&(n.content='<input class="task-list-item-checkbox" checked=""'+r+'type="checkbox">'),n},Gne=(i,e,t)=>{if(i.children=i.children||[],i.children.unshift(jne(i,e,t)),i.children[1].content=i.children[1].content.slice(3),i.content=i.content.slice(3),t.label)if(t.labelAfter){i.children.pop();const n="task-item-"+Math.ceil(Math.random()*(1e4*1e3)-1e3);i.children[0].content=i.children[0].content.slice(0,-1)+' id="'+n+'">',i.children.push(Zne(i.content,n,e))}else i.children.unshift(Une(e)),i.children.push(Vne(e))},Hne=(i,e={})=>{i.core.ruler.after("inline","github-task-lists",t=>{const n=t.tokens;for(let r=2;r<n.length;r++)Qne(n,r)&&(Gne(n[r],t.Token,e),Vw(n[r-2],"class","task-list-item"+(e.enabled?" enabled":" ")),Vw(n[Bne(n,r-2)],"class","contains-task-list"))})},Xne=i=>{i.core.ruler.push("init-line-number",e=>(e.tokens.forEach(t=>{t.map&&(t.attrs||(t.attrs=[]),t.attrs.push(["data-line",t.map[0].toString()]))}),!0))},zne=(i,e)=>{const{editorConfig:t,markdownItConfig:n,markdownItPlugins:r}=Ct,s=xe("editorId"),o=xe("language"),a=xe("usedLanguageText"),l=xe("showCodeRowNumber"),u=xe("theme"),c=xe("customIcon"),h=xe("rootRef"),f=ce([]),d=Sne(i),p=Tne(i),{reRenderRef:g,replaceMermaid:m}=kne(i),v=gn({html:!0,breaks:!0,linkify:!0});n(v,{editorId:s});const O=[{type:"image",plugin:lne,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:Ane,options:{}},{type:"taskList",plugin:Hne,options:{}},{type:"heading",plugin:Pne,options:{mdHeadingId:i.mdHeadingId,headsRef:f}},{type:"code",plugin:Dne,options:{editorId:s,usedLanguageTextRef:a,codeFoldable:i.codeFoldable,autoFoldThreshold:i.autoFoldThreshold,customIconRef:c}},{type:"sub",plugin:hne,options:{}},{type:"sup",plugin:pne,options:{}}];i.noKatex||O.push({type:"katex",plugin:Cne,options:{katexRef:p}}),i.noMermaid||O.push({type:"mermaid",plugin:Ene,options:{themeRef:u}}),r(O,{editorId:s}).forEach(A=>{v.use(A.plugin,A.options)});const y=v.options.highlight;v.set({highlight:(A,I,L)=>{if(y){const Z=y(A,I,L);if(Z)return Z}let $;!i.noHighlight&&d.value?d.value.getLanguage(I)?$=d.value.highlight(A,{language:I,ignoreIllegals:!0}).value:$=d.value.highlightAuto(A).value:$=v.utils.escapeHtml(A);const B=l?mne($.replace(/^\n+|\n+$/g,""),A.replace(/^\n+|\n+$/g,"")):`<span class="${C}-code-block">${$.replace(/^\n+|\n+$/g,"")}</span>`;return`<pre><code class="language-${I}" language=${I}>${B}</code></pre>`}}),Xne(v);const x=ce(`_article-key_${Lv()}`),b=ce(i.sanitize(v.render(i.modelValue))),E=()=>{Y.emit(s,xf,b.value),i.onHtmlChanged(b.value),i.onGetCatalog(f.value),Y.emit(s,hu,f.value),wi(()=>{m().then(()=>{var A;vw((A=h.value)==null?void 0:A.querySelectorAll(`#${s} .${C}-mermaid`))})})},T=()=>{f.value=[],b.value=i.sanitize(v.render(i.modelValue)),E()},_=De(()=>(i.noKatex||p.value)&&(i.noHighlight||d.value));let D=-1;return pe([Nn(i,"modelValue"),_,g,o],()=>{D=window.setTimeout(()=>{T()},e?0:t.renderDelay)}),pe(()=>i.setting.preview,()=>{i.setting.preview&&wi(()=>{m().then(()=>{var A;vw((A=h.value)==null?void 0:A.querySelectorAll(`#${s} .${C}-mermaid`))}),Y.emit(s,hu,f.value)})}),ft(E),ft(()=>{Y.on(s,{name:HL,callback(){Y.emit(s,hu,f.value)}}),Y.on(s,{name:C1,callback:()=>{x.value=`_article-key_${Lv()}`,T()}})}),Rs(()=>{clearTimeout(D)}),{html:b,key:x}},Zw={checked:{regexp:/- \[x\]/,value:"- [ ]"},unChecked:{regexp:/- \[\s\]/,value:"- [x]"}},Wne=(i,e)=>{const t=xe("editorId"),n=xe("rootRef");let r=()=>{};const s=()=>{if(!n.value)return!1;const o=n.value.querySelectorAll(".task-list-item.enabled"),a=l=>{var u;l.preventDefault();const c=l.target.checked?"unChecked":"checked",h=(u=l.target.parentElement)==null?void 0:u.dataset.line;if(!h)return;const f=Number(h),d=i.modelValue.split(`
`),p=d[Number(f)].replace(Zw[c].regexp,Zw[c].value);i.previewOnly?(d[Number(f)]=p,i.onChange(d.join(`
`))):Y.emit(t,zL,f+1,p)};o.forEach(l=>{l.addEventListener("click",a)}),r=()=>{o.forEach(l=>{l.removeEventListener("click",a)})}};Rs(()=>{r()}),pe([e],()=>{r(),wi(s)},{immediate:!0})},qne=(i,e,t)=>{const n=()=>{wi(()=>{var s;(s=i.onRemount)==null||s.call(i)})},r=s=>{s&&n()};pe([e,t],n),pe(()=>i.setting.preview,r),pe(()=>i.setting.htmlPreview,r),ft(n)},_I={modelValue:{type:String,default:""},onChange:{type:Function,default:()=>{}},setting:{type:Object,default:()=>({preview:!0})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:i=>i},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:i=>i},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean},sanitizeMermaid:{type:Function},codeFoldable:{type:Boolean},autoFoldThreshold:{type:Number},onRemount:{type:Function}},Yne={..._I,updateModelValue:{type:Function,default:()=>{}},placeholder:{type:String,default:""},scrollAuto:{type:Boolean},autofocus:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},maxlength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function,default:()=>{}},onFocus:{type:Function,default:()=>{}},noPrettier:{type:Boolean},completions:{type:Array},catalogVisible:{type:Boolean},theme:{type:String,default:"light"},onInput:{type:Function},onDrop:{type:Function,default:()=>{}},inputBoxWidth:{type:String},oninputBoxWidthChange:{type:Function},transformImgUrl:{type:Function,default:i=>i},catalogLayout:{type:String}},CI=Ze({name:"ContentPreview",props:_I,setup(i){const e=xe("editorId"),t=xe("previewTheme"),n=xe("showCodeRowNumber"),{html:r,key:s}=zne(i,i.previewOnly);return xne(i,r,s),bne(i,r),Wne(i,r),qne(i,r,s),()=>R(bo,null,[i.setting.preview&&R("div",{id:`${e}-preview-wrapper`,class:`${C}-preview-wrapper`,key:"content-preview-wrapper"},[R("div",{key:s.value,id:`${e}-preview`,class:[`${C}-preview`,`${t==null?void 0:t.value}-theme`,n&&`${C}-scrn`],innerHTML:r.value},null)]),!i.previewOnly&&i.setting.htmlPreview&&R("div",{id:`${e}-html-wrapper`,class:`${C}-preview-wrapper`,key:"html-preview-wrapper"},[R("div",{class:`${C}-html`},[r.value])])])}}),Kne=(i,e,t)=>{const{editorId:n}=t,r=di({buildFinished:!1,html:""});pe(()=>i.modelValue,()=>{r.buildFinished=!1}),ft(()=>{Y.on(n,{name:xf,callback(s){r.buildFinished=!0,r.html=s}}),Y.on(n,{name:wp,callback(){const s=new Promise(o=>{if(r.buildFinished)o(r.html);else{const a=l=>{o(l),Y.remove(n,xf,a)};Y.on(n,{name:xf,callback:a})}});i.onSave?i.onSave(i.modelValue,s):e.emit("onSave",i.modelValue,s)}})})},AI=(i,e)=>{const t=Ct.editorExtensions.highlight,n=Ct.editorExtensionsAttrs.highlight,r=sre(i);Ni("editorId",r),Ni("rootRef",e),Ni("theme",De(()=>i.theme)),Ni("language",De(()=>i.language)),Ni("highlight",De(()=>{const{js:o}=t,a={...Iv,...t.css},{js:l,css:u={}}=n||{},c=i.codeStyleReverse&&i.codeStyleReverseList.includes(i.previewTheme)?"dark":i.theme,h=a[i.codeTheme]?a[i.codeTheme][c]:Iv.atom[c],f=a[i.codeTheme]&&u[i.codeTheme]?u[i.codeTheme][c]:u.atom?u.atom[c]:{};return{js:{src:o,...l},css:{href:h,...f}}})),Ni("showCodeRowNumber",i.showCodeRowNumber);const s=De(()=>{const o={...uw,...Ct.editorConfig.languageUserDefined};return BL(Wl(uw["en-US"]),o[i.language]||{})});return Ni("usedLanguageText",s),Ni("previewTheme",De(()=>i.previewTheme)),Ni("customIcon",De(()=>i.customIcon)),{editorId:r}},Jne=(i,e)=>(Ni("tabWidth",i.tabWidth),Ni("disabled",De(()=>i.disabled)),AI(i,e)),ere=i=>{const{noPrettier:e,noUploadImg:t}=i,{editorExtensions:n,editorExtensionsAttrs:r}=Ct,s=e||n.prettier.prettierInstance,o=e||n.prettier.parserMarkdownInstance,a=t||n.cropper.instance;ft(()=>{if(!a){const{js:l={},css:u={}}=r.cropper||{};sn("link",{...u,rel:"stylesheet",href:n.cropper.css,id:on.croppercss}),sn("script",{...l,src:n.cropper.js,id:on.cropperjs})}if(!s){const{standaloneJs:l={}}=r.prettier||{};sn("script",{...l,src:n.prettier.standaloneJs,id:on.prettier})}if(!o){const{parserMarkdownJs:l={}}=r.prettier||{};sn("script",{...l,src:n.prettier.parserMarkdownJs,id:on.prettierMD})}})},tre=(i,e,t)=>{const{editorId:n}=t;ft(()=>{Y.on(n,{name:_o,callback:r=>{i.onError instanceof Function?i.onError(r):e.emit("onError",r)}})})},ire=(i,e,t)=>{const{editorId:n}=t,r=di({pageFullscreen:i.pageFullscreen,fullscreen:!1,preview:i.preview,htmlPreview:i.preview?!1:i.htmlPreview,previewOnly:!1}),s=di({...r}),o=(u,c)=>{const h=c===void 0?!r[u]:c;switch(u){case"preview":{r.htmlPreview=!1,r.previewOnly=!1;break}case"htmlPreview":{r.preview=!1,r.previewOnly=!1;break}case"previewOnly":{h?!r.preview&&!r.htmlPreview&&(r.preview=!0):(s.preview||(r.preview=!1),s.htmlPreview||(r.htmlPreview=!1));break}}s[u]=h,r[u]=h};let a="";const l=()=>{r.pageFullscreen||r.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=a};return pe(()=>[r.pageFullscreen,r.fullscreen],l),ft(()=>{Y.on(n,{name:_p,callback(u,c){const h=f=>{Y.emit(n,Ye,"image",{desc:"",urls:f}),c==null||c()};i.onUploadImg?i.onUploadImg(u,h):e.emit("onUploadImg",u,h)}}),a=document.body.style.overflow,l()}),[r,o]},nre=(i,e)=>{const{editorId:t}=e,n=ce(!1);return ft(()=>{Y.on(t,{name:_1,callback:r=>{r===void 0?n.value=!n.value:n.value=r}})}),n},rre=(i,e,t)=>{const{editorId:n,catalogVisible:r,setting:s,updateSetting:o,codeRef:a}=t;pe(()=>s.pageFullscreen,u=>{Y.emit(n,cw,u)}),pe(()=>s.fullscreen,u=>{Y.emit(n,hw,u)}),pe(()=>s.preview,u=>{Y.emit(n,fw,u)}),pe(()=>s.previewOnly,u=>{Y.emit(n,dw,u)}),pe(()=>s.htmlPreview,u=>{Y.emit(n,pw,u)}),pe(r,u=>{Y.emit(n,gw,u)});const l={on(u,c){switch(u){case"pageFullscreen":{Y.on(n,{name:cw,callback(h){c(h)}});break}case"fullscreen":{Y.on(n,{name:hw,callback(h){c(h)}});break}case"preview":{Y.on(n,{name:fw,callback(h){c(h)}});break}case"previewOnly":{Y.on(n,{name:dw,callback(h){c(h)}});break}case"htmlPreview":{Y.on(n,{name:pw,callback(h){c(h)}});break}case"catalog":{Y.on(n,{name:gw,callback(h){c(h)}});break}}},togglePageFullscreen(u){o("pageFullscreen",u)},toggleFullscreen(u){Y.emit(n,ZL,u)},togglePreview(u){o("preview",u)},togglePreviewOnly(u){o("previewOnly",u)},toggleHtmlPreview(u){o("htmlPreview",u)},toggleCatalog(u){Y.emit(n,_1,u)},triggerSave(){Y.emit(n,wp)},insert(u){Y.emit(n,Ye,"universal",{generate:u})},focus(u){var c;(c=a.value)==null||c.focus(u)},rerender(){Y.emit(n,C1)},getSelectedText(){var u;return(u=a.value)==null?void 0:u.getSelectedText()},resetHistory(){var u;(u=a.value)==null||u.resetHistory()},domEventHandlers(u){Y.emit(n,XL,u)},execCommand(u){Y.emit(n,Ye,u)},getEditorView(){var u;return(u=a.value)==null?void 0:u.getEditorView()}};e.expose(l)},sre=i=>{const e=m5();return i.id||i.editorId||`${C}-${e}`},ore=i=>i,PI={modelValue:{type:String,default:""},onChange:{type:Function,default:void 0},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function,default:void 0},onGetCatalog:{type:Function,default:void 0},editorId:{type:String,default:void 0},id:{type:String,default:void 0},showCodeRowNumber:{type:Boolean,default:!0},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:ore},sanitize:{type:Function,default:i=>i},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},formatCopiedText:{type:Function,default:i=>i},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean,default:!1},customIcon:{type:Object,default:{}},sanitizeMermaid:{type:Function,default:i=>Promise.resolve(i)},codeFoldable:{type:Boolean,default:!0},autoFoldThreshold:{type:Number,default:30},onRemount:{type:Function,default:void 0}},are={...PI,onSave:{type:Function,default:void 0},onUploadImg:{type:Function,default:void 0},pageFullscreen:{type:Boolean,default:!1},preview:{type:Boolean,default:!0},htmlPreview:{type:Boolean,default:!1},toolbars:{type:Array,default:UL},toolbarsExclude:{type:Array,default:[]},noPrettier:{type:Boolean,default:!1},tabWidth:{type:Number,default:2},tableShape:{type:Array,default:[6,4]},placeholder:{type:String,default:""},defToolbars:{type:[String,Object],default:void 0},onError:{type:Function,default:void 0},footers:{type:Array,default:VL},scrollAuto:{type:Boolean,default:!0},defFooters:{type:[String,Object],default:void 0},noUploadImg:{type:Boolean,default:!1},autoFocus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},maxLength:{type:Number,default:void 0},autoDetectCode:{type:Boolean,default:!1},onBlur:{type:Function,default:void 0},onFocus:{type:Function,default:void 0},completions:{type:Array,default:void 0},showToolbarName:{type:Boolean,default:!1},onInput:{type:Function,default:void 0},onDrop:{type:Function,default:void 0},inputBoxWidth:{type:String,default:"50%"},oninputBoxWidthChange:{type:Function,default:void 0},transformImgUrl:{type:Function,default:i=>i},catalogLayout:{type:String,default:"fixed"}},RI=["onHtmlChanged","onGetCatalog","onChange","onRemount","update:modelValue"],lre=[...RI,"onSave","onUploadImg","onError","onBlur","onFocus","onInput","onDrop","oninputBoxWidthChange"],ure=(i,e,t)=>{const{editorId:n}=t,r={rerender(){Y.emit(n,C1)}};e.expose(r)},_f=Ze({name:"MdPreview",props:PI,emits:RI,setup(i,e){const{noKatex:t,noMermaid:n,noHighlight:r}=i,s=ce(),{editorId:o}=AI(i,s);return ure(i,e,{editorId:o}),Rs(()=>{Y.clear(o)}),()=>R("div",{id:o,class:[C,i.class,i.theme==="dark"&&`${C}-dark`,`${C}-previewOnly`],style:i.style,ref:s},[R(CI,{modelValue:i.modelValue,onChange:a=>{var l;(l=i.onChange)==null||l.call(i,a),e.emit("onChange",a),e.emit("update:modelValue",a)},onHtmlChanged:a=>{var l;(l=i.onHtmlChanged)==null||l.call(i,a),e.emit("onHtmlChanged",a)},onGetCatalog:a=>{var l;(l=i.onGetCatalog)==null||l.call(i,a),e.emit("onGetCatalog",a)},mdHeadingId:i.mdHeadingId,noMermaid:n,sanitize:i.sanitize,noKatex:t,formatCopiedText:i.formatCopiedText,noHighlight:r,noImgZoomIn:i.noImgZoomIn,previewOnly:!0,sanitizeMermaid:i.sanitizeMermaid,codeFoldable:i.codeFoldable,autoFoldThreshold:i.autoFoldThreshold,onRemount:()=>{var a;(a=i.onRemount)==null||a.call(i),e.emit("onRemount")}},null)])}});_f.install=i=>(i.component(_f.name,_f),i);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cre=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hre=({size:i,strokeWidth:e=2,absoluteStrokeWidth:t,color:n,iconNode:r,name:s,class:o,...a},{slots:l})=>Os("svg",{...wh,width:i||wh.width,height:i||wh.height,stroke:n||wh.stroke,"stroke-width":t?Number(e)*24/Number(i):e,class:["lucide",`lucide-${cre(s??"icon")}`],...a},[...r.map(u=>Os(...u)),...l.default?[l.default()]:[]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=(i,e)=>(t,{slots:n})=>Os(hre,{...t,iconNode:e,name:i},n);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fre=He("BoldIcon",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dre=He("ChartAreaIcon",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 11.207a.5.5 0 0 1 .146-.353l2-2a.5.5 0 0 1 .708 0l3.292 3.292a.5.5 0 0 0 .708 0l4.292-4.292a.5.5 0 0 1 .854.353V16a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1z",key:"q0gr47"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pre=He("CodeXmlIcon",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gre=He("CodeIcon",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mre=He("ExpandIcon",[["path",{d:"m21 21-6-6m6 6v-4.8m0 4.8h-4.8",key:"1c15vz"}],["path",{d:"M3 16.2V21m0 0h4.8M3 21l6-6",key:"1fsnz2"}],["path",{d:"M21 7.8V3m0 0h-4.8M21 3l-6 6",key:"hawz9i"}],["path",{d:"M3 7.8V3m0 0h4.8M3 3l6 6",key:"u9ee12"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vre=He("EyeIcon",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ore=He("ForwardIcon",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yre=He("HeadingIcon",[["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M6 20V4",key:"1w1bmo"}],["path",{d:"M18 20V4",key:"o2hl4u"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bre=He("ImageIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xre=He("ItalicIcon",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sre=He("LinkIcon",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kre=He("ListOrderedIcon",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tre=He("ListTodoIcon",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ere=He("ListTreeIcon",[["path",{d:"M21 12h-8",key:"1bmf0i"}],["path",{d:"M21 6H8",key:"1pqkrb"}],["path",{d:"M21 18h-8",key:"1tm79t"}],["path",{d:"M3 6v4c0 1.1.9 2 2 2h3",key:"1ywdgy"}],["path",{d:"M3 10v6c0 1.1.9 2 2 2h3",key:"2wc746"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wre=He("ListIcon",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _re=He("Maximize2Icon",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cre=He("Minimize2Icon",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Are=He("QuoteIcon",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pre=He("ReplyIcon",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rre=He("SaveIcon",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lre=He("ShrinkIcon",[["path",{d:"m15 15 6 6m-6-6v4.8m0-4.8h4.8",key:"17vawe"}],["path",{d:"M9 19.8V15m0 0H4.2M9 15l-6 6",key:"chjx8e"}],["path",{d:"M15 4.2V9m0 0h4.8M15 9l6-6",key:"lav6yq"}],["path",{d:"M9 4.2V9m0 0H4.2M9 9 3 3",key:"1pxi2q"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=He("SquareCodeIcon",[["path",{d:"M10 9.5 8 12l2 2.5",key:"3mjy60"}],["path",{d:"m14 9.5 2 2.5-2 2.5",key:"1bir2l"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ire=He("SquareSigmaIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M16 8.9V7H8l4 5-4 5h8v-1.9",key:"9nih0i"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dre=He("StrikethroughIcon",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $re=He("SubscriptIcon",[["path",{d:"m4 5 8 8",key:"1eunvl"}],["path",{d:"m12 5-8 8",key:"1ah0jp"}],["path",{d:"M20 19h-4c0-1.5.44-2 1.5-2.5S20 15.33 20 14c0-.47-.17-.93-.48-1.29a2.11 2.11 0 0 0-2.62-.44c-.42.24-.74.62-.9 1.07",key:"e8ta8j"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mre=He("SuperscriptIcon",[["path",{d:"m4 19 8-8",key:"hr47gm"}],["path",{d:"m12 19-8-8",key:"1dhhmo"}],["path",{d:"M20 12h-4c0-1.5.442-2 1.5-2.5S20 8.334 20 7.002c0-.472-.17-.93-.484-1.29a2.105 2.105 0 0 0-2.617-.436c-.42.239-.738.614-.899 1.06",key:"1dfcux"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fre=He("TableIcon",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nre=He("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qre=He("UnderlineIcon",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bre=He("UploadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ure=He("ViewIcon",[["path",{d:"M21 17v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2",key:"mrq65r"}],["path",{d:"M21 7V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2",key:"be3xqs"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["path",{d:"M18.944 12.33a1 1 0 0 0 0-.66 7.5 7.5 0 0 0-13.888 0 1 1 0 0 0 0 .66 7.5 7.5 0 0 0 13.888 0",key:"11ak4c"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vre=He("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Zre=()=>R("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-github-icon"},[R("path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"},null),R("path",{d:"M9 18c-4.51 2-5-2-7-2"},null)]),jre={bold:fre,underline:Qre,italic:xre,"strike-through":Dre,title:yre,sub:$re,sup:Mre,quote:Are,"unordered-list":wre,"ordered-list":kre,task:Tre,"code-row":gre,code:jw,link:Sre,image:bre,table:Fre,revoke:Pre,next:Ore,save:Rre,prettier:jw,minimize:Cre,maximize:_re,"fullscreen-exit":Lre,fullscreen:mre,"preview-only":Ure,preview:vre,"preview-html":pre,catalog:Ere,github:Zre,mermaid:dre,formula:Ire,close:Vre,delete:Nre,upload:Bre},Gre=Ze({name:`${C}-icon-set`,props:{name:{type:String,default:""}},setup(i){return()=>Os(jre[i.name],{class:`${C}-icon`})}}),Me=Ze({name:`${C}-icon`,props:{name:{type:String,default:""}},setup(i){const e=xe("customIcon");return()=>{const t=e.value[i.name];return typeof t=="object"?typeof t.component=="object"?Os(t.component,t.props):R("span",{innerHTML:t.component},null):R(Gre,{name:i.name},null)}}}),Hre={title:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},width:{type:String,default:"auto"},height:{type:String,default:"auto"},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:()=>{}},class:{type:String,default:void 0},style:{type:[Object,String],default:()=>({})},showMask:{type:Boolean,default:!0}},ya=Ze({name:"MdModal",props:Hre,emits:["onClose"],setup(i,e){const t=xe("theme"),n=xe("rootRef"),r=ce(i.visible),s=ce([`${C}-modal`]),o=ce(),a=ce(),l=ce(),u=Qn();let c=()=>{};const h=di({maskStyle:{zIndex:-1},modalStyle:{zIndex:-1},initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),f=De(()=>i.isFullscreen?{width:"100%",height:"100%"}:{width:i.width,height:i.height});pe(()=>i.isFullscreen,g=>{g?c():wi(()=>{c=mw(a.value,(m,v)=>{h.initPos.left=m+"px",h.initPos.top=v+"px"})})}),pe(()=>i.visible,g=>{g?(h.maskStyle.zIndex=Ct.editorConfig.zIndex+Bw(),h.modalStyle.zIndex=Ct.editorConfig.zIndex+Bw(),s.value.push("zoom-in"),r.value=g,wi(()=>{const m=o.value.offsetWidth/2,v=o.value.offsetHeight/2,O=document.documentElement.clientWidth/2,y=document.documentElement.clientHeight/2;h.initPos.left=O-m+"px",h.initPos.top=y-v+"px",i.isFullscreen||(c=mw(a.value,(x,b)=>{h.initPos.left=x+"px",h.initPos.top=b+"px"}))}),setTimeout(()=>{s.value=s.value.filter(m=>m!=="zoom-in")},140)):(s.value.push("zoom-out"),c(),setTimeout(()=>{s.value=s.value.filter(m=>m!=="zoom-out"),r.value=g},130))});const d=De(()=>({display:r.value?"block":"none"})),p=De(()=>typeof i.style=="string"?[i.style,d.value].join("; "):i.style instanceof Object?{...d.value,...i.style}:d.value);return ft(()=>{var g;const m=(g=n.value)==null?void 0:g.getRootNode();l.value=m instanceof Document?document.body:m}),()=>{const g=pi({ctx:e}),m=pi({props:i,ctx:e},"title");return l.value?R(v5,{to:l.value},{default:()=>[R("div",{ref:u,class:`${C}-modal-container`,"data-theme":t.value},[R("div",{class:i.class,style:p.value},[i.showMask&&R("div",{class:`${C}-modal-mask`,style:h.maskStyle,onClick:()=>{var v;(v=i.onClose)==null||v.call(i),e.emit("onClose")}},null),R("div",{class:s.value,style:{...h.modalStyle,...h.initPos,...f.value},ref:o},[R("div",{class:`${C}-modal-header`,ref:a},[m||""]),R("div",{class:`${C}-modal-body`},[g]),R("div",{class:`${C}-modal-func`},[i.showAdjust&&R("div",{class:`${C}-modal-adjust`,onClick:v=>{v.stopPropagation(),i.isFullscreen?h.initPos=h.historyPos:(h.historyPos=h.initPos,h.initPos={left:"0",top:"0"}),i.onAdjust(!i.isFullscreen)}},[R(Me,{name:i.isFullscreen?"minimize":"maximize"},null)]),R("div",{class:`${C}-modal-close`,onClick:v=>{var O;v.stopPropagation(),(O=i.onClose)==null||O.call(i),e.emit("onClose")}},[R(Me,{name:"close"},null)])])])])])]}):""}}});ya.install=i=>(i.component(ya.name,ya),i);const Xre=`.${C}-preview > [data-line]`,da=(i,e)=>+getComputedStyle(i).getPropertyValue(e).replace("px",""),zre=(i,e)=>{const t=NL(()=>{i.removeEventListener("scroll",n),i.addEventListener("scroll",n),e.removeEventListener("scroll",n),e.addEventListener("scroll",n)},50),n=r=>{const s=i.clientHeight,o=e.clientHeight,a=i.scrollHeight,l=e.scrollHeight,u=(a-s)/(l-o);r.target===i?(e.removeEventListener("scroll",n),e.scrollTo({top:i.scrollTop/u}),t()):(i.removeEventListener("scroll",n),i.scrollTo({top:e.scrollTop*u}),t())};return[()=>{t().finally(()=>{i.dispatchEvent(new Event("scroll"))})},()=>{i.removeEventListener("scroll",n),e.removeEventListener("scroll",n)}]},Wre=(i,e,t)=>{const{view:n}=t,r=QL(),s=v=>n.lineBlockAt(n.state.doc.line(v+1).from).top,o=v=>n.lineBlockAt(n.state.doc.line(v+1).from).bottom;let a=[],l=[],u=[];const c=()=>{a=[],l=Array.from(e.querySelectorAll(Xre)),u=l.map(b=>Number(b.dataset.line));const v=[...u],{lines:O}=n.state.doc;let y=v.shift()||0,x=v.shift()||O;for(let b=0;b<O;b++)b===x&&(y=b,x=v.shift()||O),a.push({start:y,end:x-1})},h=(v,O)=>{let y=1;for(let x=l.length-1;x-1>=0;x--){const b=l[x],E=l[x-1];if(b.offsetTop+b.offsetHeight>O&&E.offsetTop<O){y=Number(E.dataset.line);break}}for(let x=a.length-1;x>=0;x--){const b=o(a[x].end),E=s(a[x].start);if(b>v&&E<=v){y=y<a[x].start?y:a[x].start;break}}return y};let f=0,d=0;const p=()=>{var v,O,y;if(d!==0)return!1;f++;const{scrollDOM:x,contentHeight:b}=n;let E=da(e,"padding-top");const T=n.lineBlockAtHeight(x.scrollTop),{number:_}=n.state.doc.lineAt(T.from),D=a[_-1];if(!D)return!1;let A=1;const I=e.querySelector(`[data-line="${D.start}"]`)||((v=e.firstElementChild)==null?void 0:v.firstElementChild),L=e.querySelector(`[data-line="${D.end+1}"]`)||((O=e.lastElementChild)==null?void 0:O.lastElementChild),$=x.scrollHeight-x.clientHeight,B=e.scrollHeight-e.clientHeight;let Z=s(D.start),j=o(D.end),ie=I.offsetTop,ne=L.offsetTop-ie;Z===0&&(ie=0,I===L?(E=0,j=b-x.offsetHeight,ne=B):ne=L.offsetTop),A=(x.scrollTop-Z)/(j-Z);const z=L==((y=e.lastElementChild)==null?void 0:y.lastElementChild)?L.offsetTop+L.clientHeight:L.offsetTop;if(j>=$||z>B){const he=h($,B);Z=s(he),A=(x.scrollTop-Z)/($-Z);const se=e.querySelector(`[data-line="${he}"]`);Z>0&&se&&(ie=se.offsetTop),ne=B-ie+da(e,"padding-top")}const W=ie-E+ne*A;r(e,W,()=>{f--})},g=()=>{var v,O,y,x,b,E;if(f!==0)return;d++;const{scrollDOM:T}=n,_=e.scrollTop,D=e.scrollHeight,A=T.scrollHeight-T.clientHeight,I=e.scrollHeight-e.clientHeight;let L=(v=e.firstElementChild)==null?void 0:v.firstElementChild,$=(O=e.firstElementChild)==null?void 0:O.lastElementChild;if(u.length>0){let se=Math.ceil(u[u.length-1]*(_/D)),oe=u.findLastIndex(Se=>Se<=se);oe=oe===-1?0:oe,se=u[oe];for(let Se=oe;Se>=0&&Se<u.length;)if(l[Se].offsetTop>_){if(Se-1>=0){Se--;continue}se=-1,oe=Se;break}else{if(Se+1<u.length&&l[Se+1].offsetTop<_){Se++;continue}se=u[Se],oe=Se;break}switch(oe){case-1:{L=(y=e.firstElementChild)==null?void 0:y.firstElementChild,$=l[oe];break}case u.length-1:{L=l[oe],$=(x=e.firstElementChild)==null?void 0:x.lastElementChild;break}default:L=l[oe],$=l[oe+1===l.length?oe:oe+1]}}let B=L===((b=e.firstElementChild)==null?void 0:b.firstElementChild)?0:L.offsetTop-da(L,"margin-top"),Z=$.offsetTop,j=0;const{start:ie,end:ne}=a[Number(L.dataset.line||0)];let z=s(ie);const W=s(ne+1===n.state.doc.lines?ne:ne+1);let he=0;if(W>A||$.offsetTop+$.offsetHeight>I){const se=h(A,I),oe=e.querySelector(`[data-line="${se}"]`);B=oe?oe.offsetTop-da(oe,"margin-top"):B,z=s(se),j=(_-B)/(I-B),he=A-z}else L===((E=e.firstElementChild)==null?void 0:E.firstElementChild)?(L===$&&(Z=$.offsetTop+$.offsetHeight+ +getComputedStyle($).marginBottom.replace("px","")),he=W,j=Math.max(_/Z,0)):(j=Math.max((_-B)/(Z-B),0),he=W-z);r(i,z+he*j,()=>{d--})},m=v=>{var O;const{scrollDOM:y,contentHeight:x}=n,b=y.clientHeight;if(x<=b||e.firstElementChild.clientHeight<=e.clientHeight||n.state.doc.lines<=((O=a[a.length-1])==null?void 0:O.end))return!1;v.target===i?p():g()};return[()=>{c(),i.addEventListener("scroll",m),e.addEventListener("scroll",m),i.dispatchEvent(new Event("scroll"))},()=>{i.removeEventListener("scroll",m),e.removeEventListener("scroll",m)}]},qre={tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},onActive:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},LI=Ze({props:qre,setup(i){const e=xe("scrollElementRef"),t=xe("roorNodeRef"),n=ce();return pe(()=>i.tocItem.active,r=>{r&&(n.value?i.onActive(i.tocItem,n.value):wi(()=>{i.onActive(i.tocItem,n.value)}))},{immediate:!0}),()=>{const{tocItem:r,mdHeadingId:s,onClick:o,scrollElementOffsetTop:a}=i;return R("div",{ref:n,class:[`${C}-catalog-link`,r.active&&`${C}-catalog-active`],onClick:l=>{if(l.stopPropagation(),o(l,r),l.defaultPrevented)return;const u=s(r.text,r.level,r.index),c=t.value.getElementById(u),h=e.value;if(c&&h){let f=c.offsetParent,d=c.offsetTop;if(h.contains(f))for(;f&&h!=f;)d+=f==null?void 0:f.offsetTop,f=f==null?void 0:f.offsetParent;const p=c.previousElementSibling;let g=0;p||(g=da(c,"margin-top")),h==null||h.scrollTo({top:d-a-g,behavior:"smooth"})}}},[R("span",{title:r.text},[r.text]),r.children&&r.children.length>0&&R("div",{class:`${C}-catalog-wrapper`},[r.children.map(l=>R(LI,{mdHeadingId:s,key:`${r.text}-link-${l.level}-${l.text}`,tocItem:l,onActive:i.onActive,onClick:o,scrollElementOffsetTop:a},null))])])}}}),Yre={editorId:{type:String,default:void 0},class:{type:String,default:""},mdHeadingId:{type:Function,default:i=>i},scrollElement:{type:[String,Object],default:void 0},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function,default:void 0},onActive:{type:Function,default:void 0},isScrollElementInShadow:{type:Boolean,default:!1},syncWith:{type:String,default:"preview"}},fu=Ze({name:"MdCatalog",props:Yre,emits:["onClick","onActive"],setup(i,e){const t=i.editorId,n=`#${t}-preview-wrapper`,r=di({list:[],show:!1,scrollElement:i.scrollElement||n}),s=Qn(),o=ce(),a=ce(),l=ce(),u=ce(),c=Qn(),h=ce({});Ni("scrollElementRef",a),Ni("roorNodeRef",u);const f=De(()=>{const y=[];return r.list.forEach((x,b)=>{const{text:E,level:T,line:_}=x,D={level:T,text:E,line:_,index:b+1,active:s.value===x};if(y.length===0)y.push(D);else{let A=y[y.length-1];if(D.level>A.level)for(let I=A.level+1;I<=6;I++){const{children:L}=A;if(!L){A.children=[D];break}if(A=L[L.length-1],D.level<=A.level){L.push(D);break}}else y.push(D)}}),y}),d=()=>{var y;if(r.scrollElement instanceof HTMLElement)return r.scrollElement;let x=document;return(r.scrollElement===n||i.isScrollElementInShadow)&&(x=(y=o.value)==null?void 0:y.getRootNode()),x.querySelector(r.scrollElement)},p=y=>{if(y.length===0)return s.value=void 0,r.list=[],!1;const{activeHead:x}=y.reduce((b,E,T)=>{var _;let D=0;if(i.syncWith==="preview"){const A=(_=u.value)==null?void 0:_.getElementById(i.mdHeadingId(E.text,E.level,T+1));A instanceof HTMLElement&&(D=vne(A,a.value))}else{const A=c.value;if(A){const I=A.lineBlockAt(A.state.doc.line(E.line+1).from).top,L=A.scrollDOM.scrollTop;D=I-L}}return D<i.offsetTop&&D>b.minTop?{activeHead:E,minTop:D}:b},{activeHead:y[0],minTop:Number.MIN_SAFE_INTEGER});s.value=x,r.list=y},g=(y,x)=>{var b;h.value.top=x.offsetTop+da(x,"padding-top")+"px",(b=i.onActive)==null||b.call(i,y,x),e.emit("onActive",y,x)},m=()=>{p(r.list)},v=y=>{var x,b,E;if((x=l.value)==null||x.removeEventListener("scroll",m),i.syncWith==="editor")l.value=(b=c.value)==null?void 0:b.scrollDOM;else{const T=d();a.value=T,l.value=T===document.documentElement?document:T}p(y),(E=l.value)==null||E.addEventListener("scroll",m)},O=y=>{c.value=y};return pe([()=>i.syncWith,c],()=>{v(r.list)}),ft(()=>{u.value=o.value.getRootNode(),Y.on(t,{name:hu,callback:v}),Y.on(t,{name:kd,callback:O}),Y.emit(t,HL),Y.emit(t,WL)}),Rs(()=>{var y;Y.remove(t,hu,v),Y.remove(t,kd,O),(y=l.value)==null||y.removeEventListener("scroll",m)}),()=>R("div",{class:[`${C}-catalog`,i.theme==="dark"&&`${C}-catalog-dark`,i.class||""],ref:o},[f.value.length>0&&R(bo,null,[R("div",{class:`${C}-catalog-indicator`,style:h.value},null),R("div",{class:`${C}-catalog-container`},[f.value.map(y=>R(LI,{mdHeadingId:i.mdHeadingId,tocItem:y,key:`link-${y.level}-${y.text}`,onActive:g,onClick:(x,b)=>{var E;(E=i.onClick)==null||E.call(i,x,b),e.emit("onClick",x,b)},scrollElementOffsetTop:i.scrollElementOffsetTop},null))])])])}});fu.install=i=>(i.component(fu.name,fu),i);let jv=[],II=[];(()=>{let i="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<i.length;e++)(e%2?II:jv).push(t=t+i[e])})();function Kre(i){if(i<768)return!1;for(let e=0,t=jv.length;;){let n=e+t>>1;if(i<jv[n])t=n;else if(i>=II[n])e=n+1;else return!0;if(e==t)return!1}}function Gw(i){return i>=127462&&i<=127487}const Hw=8205;function Jre(i,e,t=!0,n=!0){return(t?DI:ese)(i,e,n)}function DI(i,e,t){if(e==i.length)return e;e&&$I(i.charCodeAt(e))&&MI(i.charCodeAt(e-1))&&e--;let n=X0(i,e);for(e+=Xw(n);e<i.length;){let r=X0(i,e);if(n==Hw||r==Hw||t&&Kre(r))e+=Xw(r),n=r;else if(Gw(r)){let s=0,o=e-2;for(;o>=0&&Gw(X0(i,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function ese(i,e,t){for(;e>0;){let n=DI(i,e-2,t);if(n<e)return n;e--}return 0}function X0(i,e){let t=i.charCodeAt(e);if(!MI(t)||e+1==i.length)return t;let n=i.charCodeAt(e+1);return $I(n)?(t-55296<<10)+(n-56320)+65536:t}function $I(i){return i>=56320&&i<57344}function MI(i){return i>=55296&&i<56320}function Xw(i){return i<65536?1:2}class Ue{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=Ba(this,e,t);let r=[];return this.decompose(0,e,r,2),n.length&&n.decompose(0,n.length,r,3),this.decompose(t,this.length,r,1),rr.from(r,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Ba(this,e,t);let n=[];return this.decompose(e,t,n,0),rr.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),r=new du(this),s=new du(e);for(let o=t,a=t;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(a+=r.value.length,r.done||a>=n)return!0}}iter(e=1){return new du(this,e)}iterRange(e,t=this.length){return new FI(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;n=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new NI(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Ue.empty:e.length<=32?new xt(e):rr.from(xt.split(e,[]))}}class xt extends Ue{constructor(e,t=tse(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,r){for(let s=0;;s++){let o=this.text[s],a=r+o.length;if((t?n:a)>=e)return new ise(r,a,n,o);r=a+1,n++}}decompose(e,t,n,r){let s=e<=0&&t>=this.length?this:new xt(zw(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let o=n.pop(),a=Cf(s.text,o.text.slice(),0,s.length);if(a.length<=32)n.push(new xt(a,o.length+s.length));else{let l=a.length>>1;n.push(new xt(a.slice(0,l)),new xt(a.slice(l)))}}else n.push(s)}replace(e,t,n){if(!(n instanceof xt))return super.replace(e,t,n);[e,t]=Ba(this,e,t);let r=Cf(this.text,Cf(n.text,zw(this.text,0,e)),t),s=this.length+n.length-(t-e);return r.length<=32?new xt(r,s):rr.from(xt.split(r,[]),s)}sliceString(e,t=this.length,n=`
`){[e,t]=Ba(this,e,t);let r="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(r+=n),e<l&&t>s&&(r+=a.slice(Math.max(0,e-s),t-s)),s=l+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],r=-1;for(let s of e)n.push(s),r+=s.length+1,n.length==32&&(t.push(new xt(n,r)),n=[],r=-1);return r>-1&&t.push(new xt(n,r)),t}}class rr extends Ue{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,r){for(let s=0;;s++){let o=this.children[s],a=r+o.length,l=n+o.lines-1;if((t?l:a)>=e)return o.lineInner(e,t,n,r);r=a+1,n=l+1}}decompose(e,t,n,r){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&t>=o){let u=r&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!u?n.push(a):a.decompose(e-o,t-o,n,u)}o=l+1}}replace(e,t,n){if([e,t]=Ba(this,e,t),n.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e>=s&&t<=a){let l=o.replace(e-s,t-s,n),u=this.lines-o.lines+l.lines;if(l.lines<u>>4&&l.lines>u>>6){let c=this.children.slice();return c[r]=l,new rr(c,this.length-(t-e)+n.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){[e,t]=Ba(this,e,t);let r="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(r+=n),e<l&&t>o&&(r+=a.sliceString(e-o,t-o,n)),o=l+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof rr))return 0;let n=0,[r,s,o,a]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,s+=t){if(r==o||s==a)return n;let l=this.children[r],u=e.children[s];if(l!=u)return n+l.scanIdentical(u,t);n+=l.length+1}}static from(e,t=e.reduce((n,r)=>n+r.length+1,-1)){let n=0;for(let d of e)n+=d.lines;if(n<32){let d=[];for(let p of e)p.flatten(d);return new xt(d,t)}let r=Math.max(32,n>>5),s=r<<1,o=r>>1,a=[],l=0,u=-1,c=[];function h(d){let p;if(d.lines>s&&d instanceof rr)for(let g of d.children)h(g);else d.lines>o&&(l>o||!l)?(f(),a.push(d)):d instanceof xt&&l&&(p=c[c.length-1])instanceof xt&&d.lines+p.lines<=32?(l+=d.lines,u+=d.length+1,c[c.length-1]=new xt(p.text.concat(d.text),p.length+1+d.length)):(l+d.lines>r&&f(),l+=d.lines,u+=d.length+1,c.push(d))}function f(){l!=0&&(a.push(c.length==1?c[0]:rr.from(c,u)),u=-1,l=c.length=0)}for(let d of e)h(d);return f(),a.length==1?a[0]:new rr(a,t)}}Ue.empty=new xt([""],0);function tse(i){let e=-1;for(let t of i)e+=t.length+1;return e}function Cf(i,e,t=0,n=1e9){for(let r=0,s=0,o=!0;s<i.length&&r<=n;s++){let a=i[s],l=r+a.length;l>=t&&(l>n&&(a=a.slice(0,n-r)),r<t&&(a=a.slice(t-r)),o?(e[e.length-1]+=a,o=!1):e.push(a)),r=l+1}return e}function zw(i,e,t){return Cf(i,[""],e,t)}class du{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof xt?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,r=this.nodes[n],s=this.offsets[n],o=s>>1,a=r instanceof xt?r.text.length:r.children.length;if(o==(t>0?a:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof xt){let l=r.text[o+(t<0?-1:0)];if(this.offsets[n]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=r.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof xt?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class FI{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new du(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=n?r:t<0?r.slice(r.length-n):r.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class NI{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:r}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Ue.prototype[Symbol.iterator]=function(){return this.iter()},du.prototype[Symbol.iterator]=FI.prototype[Symbol.iterator]=NI.prototype[Symbol.iterator]=function(){return this});let ise=class{constructor(e,t,n,r){this.from=e,this.to=t,this.number=n,this.text=r}get length(){return this.to-this.from}};function Ba(i,e,t){return e=Math.max(0,Math.min(i.length,e)),[e,Math.max(e,Math.min(i.length,t))]}function qt(i,e,t=!0,n=!0){return Jre(i,e,t,n)}function nse(i){return i>=56320&&i<57344}function rse(i){return i>=55296&&i<56320}function ss(i,e){let t=i.charCodeAt(e);if(!rse(t)||e+1==i.length)return t;let n=i.charCodeAt(e+1);return nse(n)?(t-55296<<10)+(n-56320)+65536:t}function QI(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function Ys(i){return i<65536?1:2}const Gv=/\r\n?|\n/;var fi=function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i}(fi||(fi={}));class gr{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,r=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(n,r,s),r+=s):r+=o,n+=s}}iterChangedRanges(e,t=!1){Hv(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];r<0?e.push(n,r):e.push(r,n)}return new gr(e)}composeDesc(e){return this.empty?e:e.empty?this:BI(this,e)}mapDesc(e,t=!1){return e.empty?this:Xv(this,e,t)}mapPos(e,t=-1,n=fi.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],u=r+a;if(l<0){if(u>e)return s+(e-r);s+=a}else{if(n!=fi.Simple&&u>=e&&(n==fi.TrackDel&&r<e&&u>e||n==fi.TrackBefore&&r<e||n==fi.TrackAfter&&u>e))return null;if(u>e||u==e&&t<0&&!a)return e==r||t<0?s:s+l;s+=l}r=u}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,t=e){for(let n=0,r=0;n<this.sections.length&&r<=t;){let s=this.sections[n++],o=this.sections[n++],a=r+s;if(o>=0&&r<=t&&a>=e)return r<e&&a>t?"cover":!0;r=a}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+n+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new gr(e)}static create(e){return new gr(e)}}class Mt extends gr{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Hv(this,(t,n,r,s,o)=>e=e.replace(r,r+(n-t),o),!1),e}mapDesc(e,t=!1){return Xv(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let r=0,s=0;r<t.length;r+=2){let o=t[r],a=t[r+1];if(a>=0){t[r]=a,t[r+1]=o;let l=r>>1;for(;n.length<l;)n.push(Ue.empty);n.push(o?e.slice(s,s+o):Ue.empty)}s+=o}return new Mt(t,n)}compose(e){return this.empty?e:e.empty?this:BI(this,e,!0)}map(e,t=!1){return e.empty?this:Xv(this,e,t,!0)}iterChanges(e,t=!1){Hv(this,e,t)}get desc(){return gr.create(this.sections)}filter(e){let t=[],n=[],r=[],s=new $u(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-a);ni(r,c,-1);let h=s.ins==-1?-1:s.off==0?s.ins:0;ni(t,c,h),h>0&&gs(n,t,s.text),s.forward(c),a+=c}let u=e[o++];for(;a<u;){if(s.done)break e;let c=Math.min(s.len,u-a);ni(t,c,-1),ni(r,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),a+=c}}return{changes:new Mt(t,n),filtered:gr.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],r=this.sections[t+1];r<0?e.push(n):r==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let r=[],s=[],o=0,a=null;function l(c=!1){if(!c&&!r.length)return;o<t&&ni(r,t-o,-1);let h=new Mt(r,s);a=a?a.compose(h.map(a)):h,r=[],s=[],o=0}function u(c){if(Array.isArray(c))for(let h of c)u(h);else if(c instanceof Mt){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);l(),a=a?a.compose(c.map(a)):c}else{let{from:h,to:f=h,insert:d}=c;if(h>f||h<0||f>t)throw new RangeError(`Invalid change range ${h} to ${f} (in doc of length ${t})`);let p=d?typeof d=="string"?Ue.of(d.split(n||Gv)):d:Ue.empty,g=p.length;if(h==f&&g==0)return;h<o&&l(),h>o&&ni(r,h-o,-1),ni(r,f-h,g),gs(s,r,p),o=f}}return u(e),l(!a),a}static empty(e){return new Mt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;n.length<r;)n.push(Ue.empty);n[r]=Ue.of(s.slice(1)),t.push(s[0],n[r].length)}}}return new Mt(t,n)}static createSet(e,t){return new Mt(e,t)}}function ni(i,e,t,n=!1){if(e==0&&t<=0)return;let r=i.length-2;r>=0&&t<=0&&t==i[r+1]?i[r]+=e:r>=0&&e==0&&i[r]==0?i[r+1]+=t:n?(i[r]+=e,i[r+1]+=t):i.push(e,t)}function gs(i,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<i.length)i[i.length-1]=i[i.length-1].append(t);else{for(;i.length<n;)i.push(Ue.empty);i.push(t)}}function Hv(i,e,t){let n=i.inserted;for(let r=0,s=0,o=0;o<i.sections.length;){let a=i.sections[o++],l=i.sections[o++];if(l<0)r+=a,s+=a;else{let u=r,c=s,h=Ue.empty;for(;u+=a,c+=l,l&&n&&(h=h.append(n[o-2>>1])),!(t||o==i.sections.length||i.sections[o+1]<0);)a=i.sections[o++],l=i.sections[o++];e(r,u,s,c,h),r=u,s=c}}}function Xv(i,e,t,n=!1){let r=[],s=n?[]:null,o=new $u(i),a=new $u(e);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let u=Math.min(o.len,a.len);ni(r,u,-1),o.forward(u),a.forward(u)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!t))){let u=a.len;for(ni(r,a.ins,-1);u;){let c=Math.min(o.len,u);o.ins>=0&&l<o.i&&o.len<=c&&(ni(r,0,o.ins),s&&gs(s,r,o.text),l=o.i),o.forward(c),u-=c}a.next()}else if(o.ins>=0){let u=0,c=o.len;for(;c;)if(a.ins==-1){let h=Math.min(c,a.len);u+=h,c-=h,a.forward(h)}else if(a.ins==0&&a.len<c)c-=a.len,a.next();else break;ni(r,u,l<o.i?o.ins:0),s&&l<o.i&&gs(s,r,o.text),l=o.i,o.forward(o.len-c)}else{if(o.done&&a.done)return s?Mt.createSet(r,s):gr.create(r);throw new Error("Mismatched change set lengths")}}}function BI(i,e,t=!1){let n=[],r=t?[]:null,s=new $u(i),o=new $u(e);for(let a=!1;;){if(s.done&&o.done)return r?Mt.createSet(n,r):gr.create(n);if(s.ins==0)ni(n,s.len,0,a),s.next();else if(o.len==0&&!o.done)ni(n,0,o.ins,a),r&&gs(r,n,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),u=n.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;ni(n,l,c,a),r&&c&&gs(r,n,o.text)}else o.ins==-1?(ni(n,s.off?0:s.len,l,a),r&&gs(r,n,s.textBit(l))):(ni(n,s.off?0:s.len,o.off?0:o.ins,a),r&&!o.off&&gs(r,n,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||n.length>u),s.forward2(l),o.forward(l)}}}}class $u{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Ue.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?Ue.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class to{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let n,r;return this.empty?n=r=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),n==this.from&&r==this.to?this:new to(n,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return G.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return G.range(this.anchor,n)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return G.range(e.anchor,e.head)}static create(e,t,n){return new to(e,t,n)}}class G{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:G.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new G([this.main],0)}addRange(e,t=!0){return G.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,G.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new G(e.ranges.map(t=>to.fromJSON(t)),e.main)}static single(e,t=e){return new G([G.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=n:s.from<n)return G.normalized(e.slice(),t);n=s.to}return new G(e,t)}static cursor(e,t=0,n,r){return to.create(e,e,(t==0?0:t<0?8:16)|(n==null?7:Math.min(6,n))|(r??16777215)<<6)}static range(e,t,n,r){let s=(n??16777215)<<6|(r==null?7:Math.min(6,r));return t<e?to.create(t,e,48|s):to.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let n=e[t];e.sort((r,s)=>r.from-s.from),t=e.indexOf(n);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);r<=t&&t--,e.splice(--r,2,s.anchor>s.head?G.range(l,a):G.range(a,l))}}return new G(e,t)}}function UI(i,e){for(let t of i.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let F1=0;class de{constructor(e,t,n,r,s){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=r,this.id=F1++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new de(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:N1),!!e.static,e.enables)}of(e){return new Af([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Af(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Af(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}}function N1(i,e){return i==e||i.length==e.length&&i.every((t,n)=>t===e[n])}class Af{constructor(e,t,n,r){this.dependencies=e,this.facet=t,this.type=n,this.value=r,this.id=F1++}dynamicSlot(e){var t;let n=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,u=!1,c=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?u=!0:((t=e[h.id])!==null&&t!==void 0?t:1)&1||c.push(e[h.id]);return{create(h){return h.values[o]=n(h),1},update(h,f){if(l&&f.docChanged||u&&(f.docChanged||f.selection)||zv(h,c)){let d=n(h);if(a?!Ww(d,h.values[o],r):!r(d,h.values[o]))return h.values[o]=d,1}return 0},reconfigure:(h,f)=>{let d,p=f.config.address[s];if(p!=null){let g=Pd(f,p);if(this.dependencies.every(m=>m instanceof de?f.facet(m)===h.facet(m):m instanceof yn?f.field(m,!1)==h.field(m,!1):!0)||(a?Ww(d=n(h),g,r):r(d=n(h),g)))return h.values[o]=g,0}else d=n(h);return h.values[o]=d,1}}}}function Ww(i,e,t){if(i.length!=e.length)return!1;for(let n=0;n<i.length;n++)if(!t(i[n],e[n]))return!1;return!0}function zv(i,e){let t=!1;for(let n of e)pu(i,n)&1&&(t=!0);return t}function sse(i,e,t){let n=t.map(l=>i[l.id]),r=t.map(l=>l.type),s=n.filter(l=>!(l&1)),o=i[e.id]>>1;function a(l){let u=[];for(let c=0;c<n.length;c++){let h=Pd(l,n[c]);if(r[c]==2)for(let f of h)u.push(f);else u.push(h)}return e.combine(u)}return{create(l){for(let u of n)pu(l,u);return l.values[o]=a(l),1},update(l,u){if(!zv(l,s))return 0;let c=a(l);return e.compare(c,l.values[o])?0:(l.values[o]=c,1)},reconfigure(l,u){let c=zv(l,n),h=u.config.facets[e.id],f=u.facet(e);if(h&&!c&&N1(t,h))return l.values[o]=f,0;let d=a(l);return e.compare(d,f)?(l.values[o]=f,0):(l.values[o]=d,1)}}}const _h=de.define({static:!0});class yn{constructor(e,t,n,r,s){this.id=e,this.createF=t,this.updateF=n,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let t=new yn(F1++,e.create,e.update,e.compare||((n,r)=>n===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(_h).find(n=>n.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,r)=>{let s=n.values[t],o=this.updateF(s,r);return this.compareF(s,o)?0:(n.values[t]=o,1)},reconfigure:(n,r)=>{let s=n.facet(_h),o=r.facet(_h),a;return(a=s.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(n.values[t]=a.create(n),1):r.config.address[this.id]!=null?(n.values[t]=r.field(this),0):(n.values[t]=this.create(n),1)}}}init(e){return[this,_h.of({field:this,create:e})]}get extension(){return this}}const Ks={lowest:4,low:3,default:2,high:1,highest:0};function Ll(i){return e=>new VI(e,i)}const Vr={highest:Ll(Ks.highest),high:Ll(Ks.high),default:Ll(Ks.default),low:Ll(Ks.low),lowest:Ll(Ks.lowest)};class VI{constructor(e,t){this.inner=e,this.prec=t}}class sr{of(e){return new Wv(this,e)}reconfigure(e){return sr.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Wv{constructor(e,t){this.compartment=e,this.inner=t}}class Ad{constructor(e,t,n,r,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let r=[],s=Object.create(null),o=new Map;for(let f of ose(e,t,o))f instanceof yn?r.push(f):(s[f.facet.id]||(s[f.facet.id]=[])).push(f);let a=Object.create(null),l=[],u=[];for(let f of r)a[f.id]=u.length<<1,u.push(d=>f.slot(d));let c=n==null?void 0:n.config.facets;for(let f in s){let d=s[f],p=d[0].facet,g=c&&c[f]||[];if(d.every(m=>m.type==0))if(a[p.id]=l.length<<1|1,N1(g,d))l.push(n.facet(p));else{let m=p.combine(d.map(v=>v.value));l.push(n&&p.compare(m,n.facet(p))?n.facet(p):m)}else{for(let m of d)m.type==0?(a[m.id]=l.length<<1|1,l.push(m.value)):(a[m.id]=u.length<<1,u.push(v=>m.dynamicSlot(v)));a[p.id]=u.length<<1,u.push(m=>sse(m,p,d))}}let h=u.map(f=>f(a));return new Ad(e,o,h,a,l,s)}}function ose(i,e,t){let n=[[],[],[],[],[]],r=new Map;function s(o,a){let l=r.get(o);if(l!=null){if(l<=a)return;let u=n[l].indexOf(o);u>-1&&n[l].splice(u,1),o instanceof Wv&&t.delete(o.compartment)}if(r.set(o,a),Array.isArray(o))for(let u of o)s(u,a);else if(o instanceof Wv){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(o.compartment)||o.inner;t.set(o.compartment,u),s(u,a)}else if(o instanceof VI)s(o.inner,o.prec);else if(o instanceof yn)n[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof Af)n[a].push(o),o.facet.extensions&&s(o.facet.extensions,Ks.default);else{let u=o.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(u,a)}}return s(i,Ks.default),n.reduce((o,a)=>o.concat(a))}function pu(i,e){if(e&1)return 2;let t=e>>1,n=i.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;i.status[t]=4;let r=i.computeSlot(i,i.config.dynamicSlots[t]);return i.status[t]=2|r}function Pd(i,e){return e&1?i.config.staticValues[e>>1]:i.values[e>>1]}const ZI=de.define(),qv=de.define({combine:i=>i.some(e=>e),static:!0}),jI=de.define({combine:i=>i.length?i[0]:void 0,static:!0}),GI=de.define(),HI=de.define(),XI=de.define(),zI=de.define({combine:i=>i.length?i[0]:!1});class Zr{constructor(e,t){this.type=e,this.value=t}static define(){return new ase}}class ase{of(e){return new Zr(this,e)}}class lse{constructor(e){this.map=e}of(e){return new Ve(this,e)}}class Ve{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new Ve(this.type,t)}is(e){return this.type==e}static define(e={}){return new lse(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let r of e){let s=r.map(t);s&&n.push(s)}return n}}Ve.reconfigure=Ve.define();Ve.appendConfig=Ve.define();class _t{constructor(e,t,n,r,s,o){this.startState=e,this.changes=t,this.selection=n,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,n&&UI(n,t.newLength),s.some(a=>a.type==_t.time)||(this.annotations=s.concat(_t.time.of(Date.now())))}static create(e,t,n,r,s,o){return new _t(e,t,n,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(_t.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}_t.time=Zr.define();_t.userEvent=Zr.define();_t.addToHistory=Zr.define();_t.remote=Zr.define();function use(i,e){let t=[];for(let n=0,r=0;;){let s,o;if(n<i.length&&(r==e.length||e[r]>=i[n]))s=i[n++],o=i[n++];else if(r<e.length)s=e[r++],o=e[r++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function WI(i,e,t){var n;let r,s,o;return t?(r=e.changes,s=Mt.empty(e.changes.length),o=i.changes.compose(e.changes)):(r=e.changes.map(i.changes),s=i.changes.mapDesc(e.changes,!0),o=i.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(n=i.selection)===null||n===void 0?void 0:n.map(r),effects:Ve.mapEffects(i.effects,r).concat(Ve.mapEffects(e.effects,s)),annotations:i.annotations.length?i.annotations.concat(e.annotations):e.annotations,scrollIntoView:i.scrollIntoView||e.scrollIntoView}}function Yv(i,e,t){let n=e.selection,r=ba(e.annotations);return e.userEvent&&(r=r.concat(_t.userEvent.of(e.userEvent))),{changes:e.changes instanceof Mt?e.changes:Mt.of(e.changes||[],t,i.facet(jI)),selection:n&&(n instanceof G?n:G.single(n.anchor,n.head)),effects:ba(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function qI(i,e,t){let n=Yv(i,e.length?e[0]:{},i.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;n=WI(n,Yv(i,e[s],o?n.changes.newLength:i.doc.length),o)}let r=_t.create(i,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return hse(t?cse(r):r)}function cse(i){let e=i.startState,t=!0;for(let r of e.facet(GI)){let s=r(i);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:use(t,s))}if(t!==!0){let r,s;if(t===!1)s=i.changes.invertedDesc,r=Mt.empty(e.doc.length);else{let o=i.changes.filter(t);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}i=_t.create(e,r,i.selection&&i.selection.map(s),Ve.mapEffects(i.effects,s),i.annotations,i.scrollIntoView)}let n=e.facet(HI);for(let r=n.length-1;r>=0;r--){let s=n[r](i);s instanceof _t?i=s:Array.isArray(s)&&s.length==1&&s[0]instanceof _t?i=s[0]:i=qI(e,ba(s),!1)}return i}function hse(i){let e=i.startState,t=e.facet(XI),n=i;for(let r=t.length-1;r>=0;r--){let s=t[r](i);s&&Object.keys(s).length&&(n=WI(n,Yv(e,s,i.changes.newLength),!0))}return n==i?i:_t.create(e,i.changes,i.selection,n.effects,n.annotations,n.scrollIntoView)}const fse=[];function ba(i){return i==null?fse:Array.isArray(i)?i:[i]}var Yt=function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i}(Yt||(Yt={}));const dse=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Kv;try{Kv=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function pse(i){if(Kv)return Kv.test(i);for(let e=0;e<i.length;e++){let t=i[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||dse.test(t)))return!0}return!1}function gse(i){return e=>{if(!/\S/.test(e))return Yt.Space;if(pse(e))return Yt.Word;for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>-1)return Yt.Word;return Yt.Other}}class Be{constructor(e,t,n,r,s,o){this.config=e,this.doc=t,this.selection=n,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)pu(this,a<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return pu(this,n),Pd(this,n)}update(...e){return qI(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:r}=t;for(let a of e.effects)a.is(sr.reconfigure)?(t&&(r=new Map,t.compartments.forEach((l,u)=>r.set(u,l)),t=null),r.set(a.value.compartment,a.value.extension)):a.is(Ve.reconfigure)?(t=null,n=a.value):a.is(Ve.appendConfig)&&(t=null,n=ba(n).concat(a.value));let s;t?s=e.startState.values.slice():(t=Ad.resolve(n,r,this),s=new Be(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,u)=>u.reconfigure(l,this),null).values);let o=e.startState.facet(qv)?e.newSelection:e.newSelection.asSingle();new Be(t,e.newDoc,o,s,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:G.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),r=this.changes(n.changes),s=[n.range],o=ba(n.effects);for(let a=1;a<t.ranges.length;a++){let l=e(t.ranges[a]),u=this.changes(l.changes),c=u.map(r);for(let f=0;f<a;f++)s[f]=s[f].map(c);let h=r.mapDesc(u,!0);s.push(l.range.map(h)),r=r.compose(c),o=Ve.mapEffects(o,c).concat(Ve.mapEffects(ba(l.effects),h))}return{changes:r,selection:G.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Mt?e:Mt.of(e,this.doc.length,this.facet(Be.lineSeparator))}toText(e){return Ue.of(e.split(this.facet(Be.lineSeparator)||Gv))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(pu(this,t),Pd(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let r=e[n];r instanceof yn&&this.config.address[r.id]!=null&&(t[n]=r.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(n){for(let s in n)if(Object.prototype.hasOwnProperty.call(e,s)){let o=n[s],a=e[s];r.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Be.create({doc:e.doc,selection:G.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=Ad.resolve(e.extensions||[],new Map),n=e.doc instanceof Ue?e.doc:Ue.of((e.doc||"").split(t.staticFacet(Be.lineSeparator)||Gv)),r=e.selection?e.selection instanceof G?e.selection:G.single(e.selection.anchor,e.selection.head):G.single(0);return UI(r,n.length),t.staticFacet(qv)||(r=r.asSingle()),new Be(t,n,r,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Be.tabSize)}get lineBreak(){return this.facet(Be.lineSeparator)||`
`}get readOnly(){return this.facet(zI)}phrase(e,...t){for(let n of this.facet(Be.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>t.length?n:t[s-1]})),e}languageDataAt(e,t,n=-1){let r=[];for(let s of this.facet(ZI))for(let o of s(this,t,n))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return gse(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-n,a=e-n;for(;o>0;){let l=qt(t,o,!1);if(s(t.slice(l,o))!=Yt.Word)break;o=l}for(;a<r;){let l=qt(t,a);if(s(t.slice(a,l))!=Yt.Word)break;a=l}return o==a?null:G.range(o+n,a+n)}}Be.allowMultipleSelections=qv;Be.tabSize=de.define({combine:i=>i.length?i[0]:4});Be.lineSeparator=jI;Be.readOnly=zI;Be.phrases=de.define({compare(i,e){let t=Object.keys(i),n=Object.keys(e);return t.length==n.length&&t.every(r=>i[r]==e[r])}});Be.languageData=ZI;Be.changeFilter=GI;Be.transactionFilter=HI;Be.transactionExtender=XI;sr.reconfigure=Ve.define();function Lp(i,e,t={}){let n={};for(let r of i)for(let s of Object.keys(r)){let o=r[s],a=n[s];if(a===void 0)n[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(t,s))n[s]=t[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)n[r]===void 0&&(n[r]=e[r]);return n}class po{eq(e){return this==e}range(e,t=e){return Jv.create(e,t,this)}}po.prototype.startSide=po.prototype.endSide=0;po.prototype.point=!1;po.prototype.mapMode=fi.TrackDel;let Jv=class YI{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new YI(e,t,n)}};function eO(i,e){return i.from-e.from||i.value.startSide-e.value.startSide}class Q1{constructor(e,t,n,r){this.from=e,this.to=t,this.value=n,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,r=0){let s=n?this.to:this.from;for(let o=r,a=s.length;;){if(o==a)return o;let l=o+a>>1,u=s[l]-e||(n?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return u>=0?o:a;u>=0?a=l:o=l+1}}between(e,t,n,r){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(n,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let n=[],r=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let u=this.value[l],c=this.from[l]+e,h=this.to[l]+e,f,d;if(c==h){let p=t.mapPos(c,u.startSide,u.mapMode);if(p==null||(f=d=p,u.startSide!=u.endSide&&(d=t.mapPos(c,u.endSide),d<f)))continue}else if(f=t.mapPos(c,u.startSide),d=t.mapPos(h,u.endSide),f>d||f==d&&u.startSide>0&&u.endSide<=0)continue;(d-f||u.endSide-u.startSide)<0||(o<0&&(o=f),u.point&&(a=Math.max(a,d-f)),n.push(u),r.push(f-o),s.push(d-o))}return{mapped:n.length?new Q1(r,s,n,a):null,pos:o}}}class ct{constructor(e,t,n,r){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=r}static create(e,t,n,r){return new ct(e,t,n,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(n&&(t=t.slice().sort(eO)),this.isEmpty)return t.length?ct.of(t):this;let a=new KI(this,null,-1).goto(0),l=0,u=[],c=new Ua;for(;a.value||l<t.length;)if(l<t.length&&(a.from-t[l].from||a.startSide-t[l].value.startSide)>=0){let h=t[l++];c.addInner(h.from,h.to,h.value)||u.push(h)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(a.chunkIndex)<t[l].from)&&(!o||r>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&c.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||r>a.to||s<a.from||o(a.from,a.to,a.value))&&(c.addInner(a.from,a.to,a.value)||u.push(Jv.create(a.from,a.to,a.value))),a.next());return c.finishInner(this.nextLayer.isEmpty&&!u.length?ct.empty:this.nextLayer.update({add:u,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],r=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],u=e.touchesRange(a,a+l.length);if(u===!1)r=Math.max(r,l.maxPoint),t.push(l),n.push(e.mapPos(a));else if(u===!0){let{mapped:c,pos:h}=l.map(a,e);c&&(r=Math.max(r,c.maxPoint),t.push(c),n.push(h))}}let s=this.nextLayer.map(e);return t.length==0?s:new ct(n,t,s||ct.empty,r)}between(e,t,n){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return Mu.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Mu.from(e).goto(t)}static compare(e,t,n,r,s=-1){let o=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),a=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),l=qw(o,a,n),u=new Il(o,l,s),c=new Il(a,l,s);n.iterGaps((h,f,d)=>Yw(u,h,c,f,d,r)),n.empty&&n.length==0&&Yw(u,0,c,0,0,r)}static eq(e,t,n=0,r){r==null&&(r=999999999);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=qw(s,o),l=new Il(s,a,0).goto(n),u=new Il(o,a,0).goto(n);for(;;){if(l.to!=u.to||!tO(l.active,u.active)||l.point&&(!u.point||!l.point.eq(u.point)))return!1;if(l.to>r)return!0;l.next(),u.next()}}static spans(e,t,n,r,s=-1){let o=new Il(e,null,s).goto(t),a=t,l=o.openStart;for(;;){let u=Math.min(o.to,n);if(o.point){let c=o.activeForPoint(o.to),h=o.pointFrom<t?c.length+1:o.point.startSide<0?c.length:Math.min(c.length,l);r.point(a,u,o.point,c,h,o.pointRank),l=Math.min(o.openEnd(u),c.length)}else u>a&&(r.span(a,u,o.active,l),l=o.openEnd(u));if(o.to>n)return l+(o.point&&o.to>n?1:0);a=o.to,o.next()}}static of(e,t=!1){let n=new Ua;for(let r of e instanceof Jv?[e]:t?mse(e):e)n.add(r.from,r.to,r.value);return n.finish()}static join(e){if(!e.length)return ct.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let r=e[n];r!=ct.empty;r=r.nextLayer)t=new ct(r.chunkPos,r.chunk,t,Math.max(r.maxPoint,t.maxPoint));return t}}ct.empty=new ct([],[],null,-1);function mse(i){if(i.length>1)for(let e=i[0],t=1;t<i.length;t++){let n=i[t];if(eO(e,n)>0)return i.slice().sort(eO);e=n}return i}ct.empty.nextLayer=ct.empty;class Ua{finishChunk(e){this.chunks.push(new Q1(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new Ua)).add(e,t,n)}addInner(e,t,n){let r=e-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(ct.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=ct.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function qw(i,e,t){let n=new Map;for(let s of i)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&n.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=n.get(s.chunk[o]);a!=null&&(t?t.mapPos(a):a)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(a,a+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class KI{constructor(e,t,n,r=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Mu{constructor(e){this.heap=e}static from(e,t=null,n=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&r.push(new KI(o,t,n,s));return r.length==1?r[0]:new Mu(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)z0(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)z0(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),z0(this.heap,0)}}}function z0(i,e){for(let t=i[e];;){let n=(e<<1)+1;if(n>=i.length)break;let r=i[n];if(n+1<i.length&&r.compare(i[n+1])>=0&&(r=i[n+1],n++),t.compare(r)<0)break;i[n]=t,i[e]=r,e=n}}class Il{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Mu.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Ch(this.active,e),Ch(this.activeTo,e),Ch(this.activeRank,e),this.minActive=Kw(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:r,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||r-this.activeTo[t])>0;)t++;Ah(this.active,t,n),Ah(this.activeTo,t,r),Ah(this.activeRank,t,s),e&&Ah(e,t,this.cursor.from),this.minActive=Kw(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&Ch(n,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let r=n.length-1;r>=0&&n[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function Yw(i,e,t,n,r,s){i.goto(e),t.goto(n);let o=n+r,a=n,l=n-e;for(;;){let u=i.to+l-t.to,c=u||i.endSide-t.endSide,h=c<0?i.to+l:t.to,f=Math.min(h,o);if(i.point||t.point?i.point&&t.point&&(i.point==t.point||i.point.eq(t.point))&&tO(i.activeForPoint(i.to),t.activeForPoint(t.to))||s.comparePoint(a,f,i.point,t.point):f>a&&!tO(i.active,t.active)&&s.compareRange(a,f,i.active,t.active),h>o)break;(u||i.openEnd!=t.openEnd)&&s.boundChange&&s.boundChange(h),a=h,c<=0&&i.next(),c>=0&&t.next()}}function tO(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!=e[t]&&!i[t].eq(e[t]))return!1;return!0}function Ch(i,e){for(let t=e,n=i.length-1;t<n;t++)i[t]=i[t+1];i.pop()}function Ah(i,e,t){for(let n=i.length-1;n>=e;n--)i[n+1]=i[n];i[e]=t}function Kw(i,e){let t=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||i[r].endSide-i[t].endSide)<0&&(t=r,n=e[r]);return t}function Nr(i,e,t=i.length){let n=0;for(let r=0;r<t&&r<i.length;)i.charCodeAt(r)==9?(n+=e-n%e,r++):(n++,r=qt(i,r));return n}function vse(i,e,t,n){for(let r=0,s=0;;){if(s>=e)return r;if(r==i.length)break;s+=i.charCodeAt(r)==9?t-s%t:1,r=qt(i,r)}return n===!0?-1:i.length}const iO="",Jw=typeof Symbol>"u"?"__"+iO:Symbol.for(iO),nO=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),e_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class _s{constructor(e,t){this.rules=[];let{finish:n}=t||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,u){let c=[],h=/^@(\w+)\b/.exec(o[0]),f=h&&h[1]=="keyframes";if(h&&a==null)return l.push(o[0]+";");for(let d in a){let p=a[d];if(/&/.test(d))s(d.split(/,\s*/).map(g=>o.map(m=>g.replace(/&/,m))).reduce((g,m)=>g.concat(m)),p,l);else if(p&&typeof p=="object"){if(!h)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(r(d),p,c,f)}else p!=null&&c.push(d.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+p+";")}(c.length||f)&&l.push((n&&!h&&!u?o.map(n):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=e_[Jw]||1;return e_[Jw]=e+1,iO+e.toString(36)}static mount(e,t,n){let r=e[nO],s=n&&n.nonce;r?s&&r.setNonce(s):r=new Ose(e,s),r.mount(Array.isArray(t)?t:[t],e)}}let t_=new Map;class Ose{constructor(e,t){let n=e.ownerDocument||e,r=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let s=t_.get(n);if(s)return e[nO]=s;this.sheet=new r.CSSStyleSheet,t_.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[nO]=this}mount(e,t){let n=this.sheet,r=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,a),n)for(let u=0;u<a.rules.length;u++)n.insertRule(a.rules[u],r++)}else{for(;s<l;)r+=this.modules[s++].rules.length;r+=a.rules.length,s++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=t.head||t;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Cs={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Fu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},yse=typeof navigator<"u"&&/Mac/.test(navigator.platform),bse=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Wt=0;Wt<10;Wt++)Cs[48+Wt]=Cs[96+Wt]=String(Wt);for(var Wt=1;Wt<=24;Wt++)Cs[Wt+111]="F"+Wt;for(var Wt=65;Wt<=90;Wt++)Cs[Wt]=String.fromCharCode(Wt+32),Fu[Wt]=String.fromCharCode(Wt);for(var W0 in Cs)Fu.hasOwnProperty(W0)||(Fu[W0]=Cs[W0]);function xse(i){var e=yse&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||bse&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",t=!e&&i.key||(i.shiftKey?Fu:Cs)[i.keyCode]||i.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Nu(i){let e;return i.nodeType==11?e=i.getSelection?i:i.ownerDocument:e=i,e.getSelection()}function rO(i,e){return e?i==e||i.contains(e.nodeType!=1?e.parentNode:e):!1}function Pf(i,e){if(!e.anchorNode)return!1;try{return rO(i,e.anchorNode)}catch{return!1}}function Va(i){return i.nodeType==3?mo(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function gu(i,e,t,n){return t?i_(i,e,t,n,-1)||i_(i,e,t,n,1):!1}function go(i){for(var e=0;;e++)if(i=i.previousSibling,!i)return e}function Rd(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}function i_(i,e,t,n,r){for(;;){if(i==t&&e==n)return!0;if(e==(r<0?0:vr(i))){if(i.nodeName=="DIV")return!1;let s=i.parentNode;if(!s||s.nodeType!=1)return!1;e=go(i)+(r<0?0:1),i=s}else if(i.nodeType==1){if(i=i.childNodes[e+(r<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;e=r<0?vr(i):0}else return!1}}function vr(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function Sc(i,e){let t=e?i.left:i.right;return{left:t,right:t,top:i.top,bottom:i.bottom}}function Sse(i){let e=i.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function JI(i,e){let t=e.width/i.offsetWidth,n=e.height/i.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-i.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-i.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function kse(i,e,t,n,r,s,o,a){let l=i.ownerDocument,u=l.defaultView||window;for(let c=i,h=!1;c&&!h;)if(c.nodeType==1){let f,d=c==l.body,p=1,g=1;if(d)f=Sse(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(h=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let O=c.getBoundingClientRect();({scaleX:p,scaleY:g}=JI(c,O)),f={left:O.left,right:O.left+c.clientWidth*p,top:O.top,bottom:O.top+c.clientHeight*g}}let m=0,v=0;if(r=="nearest")e.top<f.top?(v=-(f.top-e.top+o),t>0&&e.bottom>f.bottom+v&&(v=e.bottom-f.bottom+v+o)):e.bottom>f.bottom&&(v=e.bottom-f.bottom+o,t<0&&e.top-v<f.top&&(v=-(f.top+v-e.top+o)));else{let O=e.bottom-e.top,y=f.bottom-f.top;v=(r=="center"&&O<=y?e.top+O/2-y/2:r=="start"||r=="center"&&t<0?e.top-o:e.bottom-y+o)-f.top}if(n=="nearest"?e.left<f.left?(m=-(f.left-e.left+s),t>0&&e.right>f.right+m&&(m=e.right-f.right+m+s)):e.right>f.right&&(m=e.right-f.right+s,t<0&&e.left<f.left+m&&(m=-(f.left+m-e.left+s))):m=(n=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:n=="start"==a?e.left-s:e.right-(f.right-f.left)+s)-f.left,m||v)if(d)u.scrollBy(m,v);else{let O=0,y=0;if(v){let x=c.scrollTop;c.scrollTop+=v/g,y=(c.scrollTop-x)*g}if(m){let x=c.scrollLeft;c.scrollLeft+=m/p,O=(c.scrollLeft-x)*p}e={left:e.left-O,top:e.top-y,right:e.right-O,bottom:e.bottom-y},O&&Math.abs(O-m)<1&&(n="nearest"),y&&Math.abs(y-v)<1&&(r="nearest")}if(d)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function Tse(i){let e=i.ownerDocument,t,n;for(let r=i.parentNode;r&&!(r==e.body||t&&n);)if(r.nodeType==1)!n&&r.scrollHeight>r.clientHeight&&(n=r),!t&&r.scrollWidth>r.clientWidth&&(t=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:t,y:n}}class Ese{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?vr(t):0),n,Math.min(e.focusOffset,n?vr(n):0))}set(e,t,n,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=r}}let qo=null;function eD(i){if(i.setActive)return i.setActive();if(qo)return i.focus(qo);let e=[];for(let t=i;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(i.focus(qo==null?{get preventScroll(){return qo={preventScroll:!0},!0}}:void 0),!qo){qo=!1;for(let t=0;t<e.length;){let n=e[t++],r=e[t++],s=e[t++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=s&&(n.scrollLeft=s)}}}let n_;function mo(i,e,t=e){let n=n_||(n_=document.createRange());return n.setEnd(i,t),n.setStart(i,e),n}function xa(i,e,t,n){let r={key:e,code:e,keyCode:t,which:t,cancelable:!0};n&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=n);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,i.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,i.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function wse(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function tD(i){for(;i.attributes.length;)i.removeAttributeNode(i.attributes[0])}function _se(i,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,vr(t));;)if(n){if(t.nodeType!=1)return!1;let r=t.childNodes[n-1];r.contentEditable=="false"?n--:(t=r,n=vr(t))}else{if(t==i)return!0;n=go(t),t=t.parentNode}}function iD(i){return i.scrollTop>Math.max(1,i.scrollHeight-i.clientHeight-4)}function nD(i,e){for(let t=i,n=e;;){if(t.nodeType==3&&n>0)return{node:t,offset:n};if(t.nodeType==1&&n>0){if(t.contentEditable=="false")return null;t=t.childNodes[n-1],n=vr(t)}else if(t.parentNode&&!Rd(t))n=go(t),t=t.parentNode;else return null}}function rD(i,e){for(let t=i,n=e;;){if(t.nodeType==3&&n<t.nodeValue.length)return{node:t,offset:n};if(t.nodeType==1&&n<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[n],n=0}else if(t.parentNode&&!Rd(t))n=go(t)+1,t=t.parentNode;else return null}}class ri{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new ri(e.parentNode,go(e),t)}static after(e,t){return new ri(e.parentNode,go(e)+1,t)}}const B1=[];class et{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,r=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=r?r.nextSibling:n.firstChild)){let a=et.get(s);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,t),o.flags&=-8}if(s=r?r.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&s!=o.dom&&(t.written=!0),o.dom.parentNode==n)for(;s&&s!=o.dom;)s=r_(s);else n.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:n.firstChild,s&&t&&t.node==n&&(t.written=!0);s;)s=r_(s)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let r=vr(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!et.get(n);)n=n.nextSibling;if(!n)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==n)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,n=0){let r=-1,s=-1,o=-1,a=-1;for(let l=0,u=n,c=n;l<this.children.length;l++){let h=this.children[l],f=u+h.length;if(u<e&&f>t)return h.domBoundsAround(e,t,u);if(f>=e&&r==-1&&(r=l,s=u),u>t&&h.dom.parentNode==this.dom){o=l,a=c;break}c=f,u=f+h.breakAfter}return{from:s,to:a<0?n+this.length:a,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=B1){this.markDirty();for(let r=e;r<t;r++){let s=this.children[r];s.parent==this&&n.indexOf(s)<0&&s.destroy()}n.length<250?this.children.splice(e,t-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(t));for(let r=0;r<n.length;r++)n[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new sD(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}et.prototype.breakAfter=0;function r_(i){let e=i.nextSibling;return i.parentNode.removeChild(i),e}class sD{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function oD(i,e,t,n,r,s,o,a,l){let{children:u}=i,c=u.length?u[e]:null,h=s.length?s[s.length-1]:null,f=h?h.breakAfter:o;if(!(e==n&&c&&!o&&!f&&s.length<2&&c.merge(t,r,s.length?h:null,t==0,a,l))){if(n<u.length){let d=u[n];d&&(r<d.length||d.breakAfter&&(h!=null&&h.breakAfter))?(e==n&&(d=d.split(r),r=0),!f&&h&&d.merge(0,r,h,!0,0,l)?s[s.length-1]=d:((r||d.children.length&&!d.children[0].length)&&d.merge(0,r,null,!1,0,l),s.push(d))):d!=null&&d.breakAfter&&(h?h.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,a,0),e++));e<n&&s.length;)if(u[n-1].become(s[s.length-1]))n--,s.pop(),l=s.length?0:a;else if(u[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&n<u.length&&!u[e-1].breakAfter&&u[n].merge(0,0,u[e-1],!1,a,l)&&e--,(e<n||s.length)&&i.replaceChildren(e,n,s)}}function aD(i,e,t,n,r,s){let o=i.childCursor(),{i:a,off:l}=o.findPos(t,1),{i:u,off:c}=o.findPos(e,-1),h=e-t;for(let f of n)h+=f.length;i.length+=h,oD(i,u,c,a,l,n,0,r,s)}let Si=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},sO=typeof document<"u"?document:{documentElement:{style:{}}};const oO=/Edge\/(\d+)/.exec(Si.userAgent),lD=/MSIE \d/.test(Si.userAgent),aO=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Si.userAgent),Ip=!!(lD||aO||oO),s_=!Ip&&/gecko\/(\d+)/i.test(Si.userAgent),q0=!Ip&&/Chrome\/(\d+)/.exec(Si.userAgent),o_="webkitFontSmoothing"in sO.documentElement.style,uD=!Ip&&/Apple Computer/.test(Si.vendor),a_=uD&&(/Mobile\/\w+/.test(Si.userAgent)||Si.maxTouchPoints>2);var re={mac:a_||/Mac/.test(Si.platform),windows:/Win/.test(Si.platform),linux:/Linux|X11/.test(Si.platform),ie:Ip,ie_version:lD?sO.documentMode||6:aO?+aO[1]:oO?+oO[1]:0,gecko:s_,gecko_version:s_?+(/Firefox\/(\d+)/.exec(Si.userAgent)||[0,0])[1]:0,chrome:!!q0,chrome_version:q0?+q0[1]:0,ios:a_,android:/Android\b/.test(Si.userAgent),webkit:o_,safari:uD,webkit_version:o_?+(/\bAppleWebKit\/(\d+)/.exec(Si.userAgent)||[0,0])[1]:0,tabSize:sO.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Cse=256;class Un extends et{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof Un)||this.length-(t-e)+n.length>Cse||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Un(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new ri(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Ase(this.dom,e,t)}}class Qr extends et{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let r of t)r.setParent(this)}setAttrs(e){if(tD(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,r,s,o){return n&&(!(n instanceof Qr&&n.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(aD(this,e,t,n?n.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],n=0,r=-1,s=0;for(let a of this.children){let l=n+a.length;l>e&&t.push(n<e?a.split(e-n):a),r<0&&n>=e&&(r=s),n=l,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Qr(this.mark,t,o)}domAtPos(e){return cD(this,e)}coordsAt(e,t){return fD(this,e,t)}}function Ase(i,e,t){let n=i.nodeValue.length;e>n&&(e=n);let r=e,s=e,o=0;e==0&&t<0||e==n&&t>=0?re.chrome||re.gecko||(e?(r--,o=1):s<n&&(s++,o=-1)):t<0?r--:s<n&&s++;let a=mo(i,r,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:t>=0)?0:a.length-1];return re.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,u=>u.width)||l),o?Sc(l,o<0):l||null}class io extends et{static create(e,t,n){return new io(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=io.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,n,r,s,o){return n&&(!(n instanceof io)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof io&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Ue.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):Ue.empty}domAtPos(e){return(this.length?e==0:this.side>0)?ri.before(this.dom):ri.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let r=this.dom.getClientRects(),s=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?r.length-1:0;s=r[a],!(e>0?a==0:a==r.length-1||s.top<s.bottom);a+=o?-1:1);return Sc(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Za extends et{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Za&&e.side==this.side}split(){return new Za(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?ri.before(this.dom):ri.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Ue.empty}get isHidden(){return!0}}Un.prototype.children=io.prototype.children=Za.prototype.children=B1;function cD(i,e){let t=i.dom,{children:n}=i,r=0;for(let s=0;r<n.length;r++){let o=n[r],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=r;s>0;s--){let o=n[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=r;s<n.length;s++){let o=n[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new ri(t,0)}function hD(i,e,t){let n,{children:r}=i;t>0&&e instanceof Qr&&r.length&&(n=r[r.length-1])instanceof Qr&&n.mark.eq(e.mark)?hD(n,e.children[0],t-1):(r.push(e),e.setParent(i)),i.length+=e.length}function fD(i,e,t){let n=null,r=-1,s=null,o=-1;function a(u,c){for(let h=0,f=0;h<u.children.length&&f<=c;h++){let d=u.children[h],p=f+d.length;p>=c&&(d.children.length?a(d,c-f):(!s||s.isHidden&&t>0)&&(p>c||f==p&&d.getSide()>0)?(s=d,o=c-f):(f<c||f==p&&d.getSide()<0&&!d.isHidden)&&(n=d,r=c-f)),f=p}}a(i,e);let l=(t<0?n:s)||n||s;return l?l.coordsAt(Math.max(0,l==n?r:o),t):Pse(i)}function Pse(i){let e=i.dom.lastChild;if(!e)return i.dom.getBoundingClientRect();let t=Va(e);return t[t.length-1]||null}function lO(i,e){for(let t in i)t=="class"&&e.class?e.class+=" "+i.class:t=="style"&&e.style?e.style+=";"+i.style:e[t]=i[t];return e}const l_=Object.create(null);function Ld(i,e,t){if(i==e)return!0;i||(i=l_),e||(e=l_);let n=Object.keys(i),r=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=r.length-(t&&r.indexOf(t)>-1?1:0))return!1;for(let s of n)if(s!=t&&(r.indexOf(s)==-1||i[s]!==e[s]))return!1;return!0}function uO(i,e,t){let n=!1;if(e)for(let r in e)t&&r in t||(n=!0,r=="style"?i.style.cssText="":i.removeAttribute(r));if(t)for(let r in t)e&&e[r]==t[r]||(n=!0,r=="style"?i.style.cssText=t[r]:i.setAttribute(r,t[r]));return n}function Rse(i){let e=Object.create(null);for(let t=0;t<i.attributes.length;t++){let n=i.attributes[t];e[n.name]=n.value}return e}class kc{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Hi=function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i}(Hi||(Hi={}));class qe extends po{constructor(e,t,n,r){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Tc(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new As(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,r;if(e.isBlockGap)n=-5e8,r=4e8;else{let{start:s,end:o}=dD(e,t);n=(s?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new As(e,n,r,t,e.widget||null,!0)}static line(e){return new Ec(e)}static set(e,t=!1){return ct.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}qe.none=ct.empty;class Tc extends qe{constructor(e){let{start:t,end:n}=dD(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof Tc&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&Ld(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Tc.prototype.point=!1;class Ec extends qe{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Ec&&this.spec.class==e.spec.class&&Ld(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Ec.prototype.mapMode=fi.TrackBefore;Ec.prototype.point=!0;class As extends qe{constructor(e,t,n,r,s,o){super(t,n,s,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?fi.TrackBefore:fi.TrackAfter:fi.TrackDel}get type(){return this.startSide!=this.endSide?Hi.WidgetRange:this.startSide<=0?Hi.WidgetBefore:Hi.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof As&&Lse(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}As.prototype.point=!0;function dD(i,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=i;return t==null&&(t=i.inclusive),n==null&&(n=i.inclusive),{start:t??e,end:n??e}}function Lse(i,e){return i==e||!!(i&&e&&i.compare(e))}function Rf(i,e,t,n=0){let r=t.length-1;r>=0&&t[r]+n>=i?t[r]=Math.max(t[r],e):t.push(i,e)}class wt extends et{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,r,s,o){if(n){if(!(n instanceof wt))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),aD(this,e,t,n?n.children.slice():[],s,o),!0}split(e){let t=new wt;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:r}=this.childPos(e);r&&(t.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let s=n;s<this.children.length;s++)t.append(this.children[s],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Ld(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){hD(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=lO(t,this.attrs||{})),n&&(this.attrs=lO({class:n},this.attrs||{}))}domAtPos(e){return cD(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&(tD(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(uO(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&et.get(r)instanceof Qr;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((n=et.get(r))===null||n===void 0?void 0:n.isEditable)==!1&&(!re.ios||!this.children.some(s=>s instanceof Un))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof Un)||/[^ -~]/.test(n.text))return null;let r=Va(n.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=fD(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=n.bottom-n.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(e){return e instanceof wt&&this.children.length==0&&e.children.length==0&&Ld(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let n=0,r=0;n<e.children.length;n++){let s=e.children[n],o=r+s.length;if(o>=t){if(s instanceof wt)return s;if(o>t)break}r=o+s.breakAfter}return null}}class Mr extends et{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,r,s,o){return n&&(!(n instanceof Mr)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?ri.before(this.dom):ri.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new Mr(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return B1}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Ue.empty}domBoundsAround(){return null}become(e){return e instanceof Mr&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);return n||(this.widget instanceof cO?null:Sc(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}}class cO extends kc{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class mu{constructor(e,t,n,r){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Mr&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new wt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Ph(new Za(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Mr)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(Ph(new Un(this.text.slice(this.textOff,this.textOff+r)),t),n),this.atCursorPos=!0,this.textOff+=r,e-=r,n=0}}span(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,n,r,s,o){if(this.disallowBlockEffectsFor[o]&&n instanceof As){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=t-e;if(n instanceof As)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Mr(n.widget||ja.block,a,n));else{let l=io.create(n.widget||ja.inline,a,a?0:n.startSide),u=this.atCursorPos&&!l.isEditable&&s<=r.length&&(e<t||n.startSide>0),c=!l.isEditable&&(e<t||s>r.length||n.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!u&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),u&&(h.append(Ph(new Za(1),r),s),s=r.length+Math.max(0,s-r.length)),h.append(Ph(l,r),s),this.atCursorPos=c,this.pendingBuffer=c?e<t||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,n,r,s){let o=new mu(e,t,n,s);return o.openEnd=ct.spans(r,t,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Ph(i,e){for(let t of e)i=new Qr(t,[i],i.length);return i}class ja extends kc{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}ja.inline=new ja("span");ja.block=new ja("div");var Ot=function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i}(Ot||(Ot={}));const vo=Ot.LTR,U1=Ot.RTL;function pD(i){let e=[];for(let t=0;t<i.length;t++)e.push(1<<+i[t]);return e}const Ise=pD("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Dse=pD("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),hO=Object.create(null),Yn=[];for(let i of["()","[]","{}"]){let e=i.charCodeAt(0),t=i.charCodeAt(1);hO[e]=t,hO[t]=-e}function gD(i){return i<=247?Ise[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?Dse[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8204?256:64336<=i&&i<=65023?4:1}const $se=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ms{get dir(){return this.level%2?U1:vo}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,r){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=t&&a.to>=t){if(a.level==n)return o;(s<0||(r!=0?r<0?a.from<t:a.to>t:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function mD(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++){let n=i[t],r=e[t];if(n.from!=r.from||n.to!=r.to||n.direction!=r.direction||!mD(n.inner,r.inner))return!1}return!0}const Je=[];function Mse(i,e,t,n,r){for(let s=0;s<=n.length;s++){let o=s?n[s-1].to:e,a=s<n.length?n[s].from:t,l=s?256:r;for(let u=o,c=l,h=l;u<a;u++){let f=gD(i.charCodeAt(u));f==512?f=c:f==8&&h==4&&(f=16),Je[u]=f==4?2:f,f&7&&(h=f),c=f}for(let u=o,c=l,h=l;u<a;u++){let f=Je[u];if(f==128)u<a-1&&c==Je[u+1]&&c&24?f=Je[u]=c:Je[u]=256;else if(f==64){let d=u+1;for(;d<a&&Je[d]==64;)d++;let p=u&&c==8||d<t&&Je[d]==8?h==1?1:8:256;for(let g=u;g<d;g++)Je[g]=p;u=d-1}else f==8&&h==1&&(Je[u]=1);c=f,f&7&&(h=f)}}}function Fse(i,e,t,n,r){let s=r==1?2:1;for(let o=0,a=0,l=0;o<=n.length;o++){let u=o?n[o-1].to:e,c=o<n.length?n[o].from:t;for(let h=u,f,d,p;h<c;h++)if(d=hO[f=i.charCodeAt(h)])if(d<0){for(let g=a-3;g>=0;g-=3)if(Yn[g+1]==-d){let m=Yn[g+2],v=m&2?r:m&4?m&1?s:r:0;v&&(Je[h]=Je[Yn[g]]=v),a=g;break}}else{if(Yn.length==189)break;Yn[a++]=h,Yn[a++]=f,Yn[a++]=l}else if((p=Je[h])==2||p==1){let g=p==r;l=g?0:1;for(let m=a-3;m>=0;m-=3){let v=Yn[m+2];if(v&2)break;if(g)Yn[m+2]|=2;else{if(v&4)break;Yn[m+2]|=4}}}}}function Nse(i,e,t,n){for(let r=0,s=n;r<=t.length;r++){let o=r?t[r-1].to:i,a=r<t.length?t[r].from:e;for(let l=o;l<a;){let u=Je[l];if(u==256){let c=l+1;for(;;)if(c==a){if(r==t.length)break;c=t[r++].to,a=r<t.length?t[r].from:e}else if(Je[c]==256)c++;else break;let h=s==1,f=(c<e?Je[c]:n)==1,d=h==f?h?1:2:n;for(let p=c,g=r,m=g?t[g-1].to:i;p>l;)p==m&&(p=t[--g].from,m=g?t[g-1].to:i),Je[--p]=d;l=c}else s=u,l++}}}function fO(i,e,t,n,r,s,o){let a=n%2?2:1;if(n%2==r%2)for(let l=e,u=0;l<t;){let c=!0,h=!1;if(u==s.length||l<s[u].from){let g=Je[l];g!=a&&(c=!1,h=g==16)}let f=!c&&a==1?[]:null,d=c?n:n+1,p=l;e:for(;;)if(u<s.length&&p==s[u].from){if(h)break e;let g=s[u];if(!c)for(let m=g.to,v=u+1;;){if(m==t)break e;if(v<s.length&&s[v].from==m)m=s[v++].to;else{if(Je[m]==a)break e;break}}if(u++,f)f.push(g);else{g.from>l&&o.push(new ms(l,g.from,d));let m=g.direction==vo!=!(d%2);dO(i,m?n+1:n,r,g.inner,g.from,g.to,o),l=g.to}p=g.to}else{if(p==t||(c?Je[p]!=a:Je[p]==a))break;p++}f?fO(i,l,p,n+1,r,f,o):l<p&&o.push(new ms(l,p,d)),l=p}else for(let l=t,u=s.length;l>e;){let c=!0,h=!1;if(!u||l>s[u-1].to){let g=Je[l-1];g!=a&&(c=!1,h=g==16)}let f=!c&&a==1?[]:null,d=c?n:n+1,p=l;e:for(;;)if(u&&p==s[u-1].to){if(h)break e;let g=s[--u];if(!c)for(let m=g.from,v=u;;){if(m==e)break e;if(v&&s[v-1].to==m)m=s[--v].from;else{if(Je[m-1]==a)break e;break}}if(f)f.push(g);else{g.to<l&&o.push(new ms(g.to,l,d));let m=g.direction==vo!=!(d%2);dO(i,m?n+1:n,r,g.inner,g.from,g.to,o),l=g.from}p=g.from}else{if(p==e||(c?Je[p-1]!=a:Je[p-1]==a))break;p--}f?fO(i,p,l,n+1,r,f,o):p<l&&o.push(new ms(p,l,d)),l=p}}function dO(i,e,t,n,r,s,o){let a=e%2?2:1;Mse(i,r,s,n,a),Fse(i,r,s,n,a),Nse(r,s,n,a),fO(i,r,s,e,t,n,o)}function Qse(i,e,t){if(!i)return[new ms(0,0,e==U1?1:0)];if(e==vo&&!t.length&&!$se.test(i))return vD(i.length);if(t.length)for(;i.length>Je.length;)Je[Je.length]=256;let n=[],r=e==vo?0:1;return dO(i,r,r,t,0,i.length,n),n}function vD(i){return[new ms(0,i,0)]}let OD="";function Bse(i,e,t,n,r){var s;let o=n.head-i.from,a=ms.find(e,o,(s=n.bidiLevel)!==null&&s!==void 0?s:-1,n.assoc),l=e[a],u=l.side(r,t);if(o==u){let f=a+=r?1:-1;if(f<0||f>=e.length)return null;l=e[a=f],o=l.side(!r,t),u=l.side(r,t)}let c=qt(i.text,o,l.forward(r,t));(c<l.from||c>l.to)&&(c=u),OD=i.text.slice(Math.min(o,c),Math.max(o,c));let h=a==(r?e.length-1:0)?null:e[a+(r?1:-1)];return h&&c==u&&h.level+(r?0:1)<l.level?G.cursor(h.side(!r,t)+i.from,h.forward(r,t)?1:-1,h.level):G.cursor(c+i.from,l.forward(r,t)?-1:1,l.level)}function Use(i,e,t){for(let n=e;n<t;n++){let r=gD(i.charCodeAt(n));if(r==1)return vo;if(r==2||r==4)return U1}return vo}const yD=de.define(),bD=de.define(),xD=de.define(),SD=de.define(),pO=de.define(),kD=de.define(),TD=de.define(),V1=de.define(),Z1=de.define(),ED=de.define({combine:i=>i.some(e=>e)}),wD=de.define({combine:i=>i.some(e=>e)}),_D=de.define();class Sa{constructor(e,t="nearest",n="nearest",r=5,s=5,o=!1){this.range=e,this.y=t,this.x=n,this.yMargin=r,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Sa(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Sa(G.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Rh=Ve.define({map:(i,e)=>i.map(e)}),CD=Ve.define();function ji(i,e,t){let n=i.facet(SD);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Dr=de.define({combine:i=>i.length?i[0]:!0});let Vse=0;const Yl=de.define();class zi{constructor(e,t,n,r,s){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=r,this.extension=s(this)}static define(e,t){const{eventHandlers:n,eventObservers:r,provide:s,decorations:o}=t||{};return new zi(Vse++,e,n,r,a=>{let l=[Yl.of(a)];return o&&l.push(Qu.of(u=>{let c=u.plugin(a);return c?o(c):qe.none})),s&&l.push(s(a)),l})}static fromClass(e,t){return zi.define(n=>new e(n),t)}}class Y0{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(ji(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){ji(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){ji(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const AD=de.define(),j1=de.define(),Qu=de.define(),PD=de.define(),G1=de.define(),RD=de.define();function u_(i,e){let t=i.state.facet(RD);if(!t.length)return t;let n=t.map(s=>s instanceof Function?s(i):s),r=[];return ct.spans(n,e.from,e.to,{point(){},span(s,o,a,l){let u=s-e.from,c=o-e.from,h=r;for(let f=a.length-1;f>=0;f--,l--){let d=a[f].spec.bidiIsolate,p;if(d==null&&(d=Use(e.text,u,c)),l>0&&h.length&&(p=h[h.length-1]).to==u&&p.direction==d)p.to=c,h=p.inner;else{let g={from:u,to:c,direction:d,inner:[]};h.push(g),h=g.inner}}}}),r}const LD=de.define();function H1(i){let e=0,t=0,n=0,r=0;for(let s of i.state.facet(LD)){let o=s(i);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(n=Math.max(n,o.top)),o.bottom!=null&&(r=Math.max(r,o.bottom)))}return{left:e,right:t,top:n,bottom:r}}const Kl=de.define();class hn{constructor(e,t,n,r){this.fromA=e,this.toA=t,this.fromB=n,this.toB=r}join(e){return new hn(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let r=0,s=0,o=0,a=0;;r++){let l=r==e.length?null:e[r],u=o-a,c=l?l.fromB:1e9;for(;s<t.length&&t[s]<c;){let h=t[s],f=t[s+1],d=Math.max(a,h),p=Math.min(c,f);if(d<=p&&new hn(d+u,p+u,d,p).addToSet(n),f>c)break;s+=2}if(!l)return n;new hn(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),o=l.toA,a=l.toB}}}class Id{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=Mt.empty(this.startState.doc.length);for(let s of n)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,a,l)=>r.push(new hn(s,o,a,l))),this.changedRanges=r}static create(e,t,n){return new Id(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class c_ extends et{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=qe.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new wt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new hn(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:u,toA:c})=>c<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?r=this.domChanged.newSel.head:!Wse(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let s=r>-1?jse(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:c}=this.hasComposition;n=new hn(u,c,e.changes.mapPos(u,-1),e.changes.mapPos(c,1)).addToSet(n.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(re.ie||re.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=Xse(o,a,e.changes);return n=hn.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=re.chrome||re.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||r.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Mr&&o.widget instanceof cO&&s.push(o.dom);r.updateGaps(s)}updateChildren(e,t,n){let r=n?n.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let o=r.length-1;;o--){let a=o>=0?r[o]:null;if(!a)break;let{fromA:l,toA:u,fromB:c,toB:h}=a,f,d,p,g;if(n&&n.range.fromB<h&&n.range.toB>c){let x=mu.build(this.view.state.doc,c,n.range.fromB,this.decorations,this.dynamicDecorationMap),b=mu.build(this.view.state.doc,n.range.toB,h,this.decorations,this.dynamicDecorationMap);d=x.breakAtStart,p=x.openStart,g=b.openEnd;let E=this.compositionView(n);b.breakAtStart?E.breakAfter=1:b.content.length&&E.merge(E.length,E.length,b.content[0],!1,b.openStart,0)&&(E.breakAfter=b.content[0].breakAfter,b.content.shift()),x.content.length&&E.merge(0,0,x.content[x.content.length-1],!0,0,x.openEnd)&&x.content.pop(),f=x.content.concat(E).concat(b.content)}else({content:f,breakAtStart:d,openStart:p,openEnd:g}=mu.build(this.view.state.doc,c,h,this.decorations,this.dynamicDecorationMap));let{i:m,off:v}=s.findPos(u,1),{i:O,off:y}=s.findPos(l,-1);oD(this,O,y,m,v,f,d,p,g)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let n of t.effects)n.is(CD)&&(this.editContextFormatting=n.value)}compositionView(e){let t=new Un(e.text.nodeValue);t.flags|=8;for(let{deco:r}of e.marks)t=new Qr(r,[t],t.length);let n=new wt;return n.append(t,0),n}fixCompositionDOM(e){let t=(s,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=et.get(s);a&&a!=o&&(a.dom=null),o.setDOM(s)},n=this.childPos(e.range.fromB,1),r=this.children[n.i];t(e.line,r);for(let s=e.marks.length-1;s>=-1;s--)n=r.childPos(n.off,1),r=r.children[n.i],t(s>=0?e.marks[s].node:e.text,r)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,r=n==this.dom,s=!r&&!(this.view.state.facet(Dr)||this.dom.tabIndex>-1)&&Pf(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(r||t||s))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),u=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(re.gecko&&a.empty&&!this.hasComposition&&Zse(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=u=new ri(h,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||(!gu(l.node,l.offset,c.anchorNode,c.anchorOffset)||!gu(u.node,u.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,a))&&(this.view.observer.ignore(()=>{re.android&&re.chrome&&this.dom.contains(c.focusNode)&&zse(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=Nu(this.view.root);if(h)if(a.empty){if(re.gecko){let f=Gse(l.node,l.offset);if(f&&f!=3){let d=(f==1?nD:rD)(l.node,l.offset);d&&(l=new ri(d.node,d.offset))}}h.collapse(l.node,l.offset),a.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=a.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(u.node,u.offset)}catch{}}else{let f=document.createRange();a.anchor>a.head&&([l,u]=[u,l]),f.setEnd(u.node,u.offset),f.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(f)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new ri(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new ri(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&gu(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=Nu(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let o=wt.find(this,t.head);if(!o)return;let a=o.posAtStart;if(t.head==a||t.head==a+o.length)return;let l=this.coordsAt(t.head,-1),u=this.coordsAt(t.head,1);if(!l||!u||l.bottom>u.top)return;let c=this.domAtPos(t.head+t.assoc);n.collapse(c.node,c.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&n.collapse(r,s)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let r=e.offset;!n&&r<t.childNodes.length;r++){let s=et.get(t.childNodes[r]);s instanceof wt&&(n=s.domAtPos(0))}for(let r=e.offset-1;!n&&r>=0;r--){let s=et.get(t.childNodes[r]);s instanceof wt&&(n=s.domAtPos(s.length))}return n?new ri(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=et.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(n<r.length||r instanceof wt)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,r=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=s-a.breakAfter,u=l-a.length;if(l<e)break;if(u<=e&&(u<e||a.covers(-1))&&(l>e||a.covers(1))&&(!n||a instanceof wt&&!(n instanceof wt&&t>=0)))n=a,r=u;else if(n&&u==e&&l==e&&a instanceof Mr&&Math.abs(t)<2){if(a.deco.startSide<0)break;o&&(n=null)}s=u}return n?n.coordsAt(e-r,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),r=this.children[t];if(!(r instanceof wt))return null;for(;r.children.length;){let{i:a,off:l}=r.childPos(n,1);for(;;a++){if(a==r.children.length)return null;if((r=r.children[a]).length)break}n=l}if(!(r instanceof Un))return null;let s=qt(r.text,n);if(s==n)return null;let o=mo(r.dom,n,s).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==Ot.LTR;for(let u=0,c=0;c<this.children.length;c++){let h=this.children[c],f=u+h.length;if(f>r)break;if(u>=n){let d=h.dom.getBoundingClientRect();if(t.push(d.height),o){let p=h.dom.lastChild,g=p?Va(p):[];if(g.length){let m=g[g.length-1],v=l?m.right-d.left:d.right-m.left;v>a&&(a=v,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=f)}}}u=f+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Ot.RTL:Ot.LTR}measureTextSize(){for(let s of this.children)if(s instanceof wt){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),t,n,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Va(e.firstChild)[0];t=e.getBoundingClientRect().height,n=s?s.width/27:7,r=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new sD(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,r=0;;r++){let s=r==t.viewports.length?null:t.viewports[r],o=s?s.from-1:this.length;if(o>n){let a=(t.lineBlockAt(o).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(qe.replace({widget:new cO(a),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!s)break;n=s.to+1}return qe.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Qu).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),n=!1,r=this.view.state.facet(PD).map((s,o)=>{let a=typeof s=="function";return a&&(n=!0),a?s(this.view):s});for(r.length&&(this.dynamicDecorationMap[e++]=n,t.push(ct.join(r))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(_D))try{if(u(this.view,e.range,e))return!0}catch(c){ji(this.view.state,c,"scroll handler")}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!n)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let s=H1(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;kse(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Ot.LTR)}}function Zse(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}function ID(i,e){let t=i.observer.selectionRange;if(!t.focusNode)return null;let n=nD(t.focusNode,t.focusOffset),r=rD(t.focusNode,t.focusOffset),s=n||r;if(r&&n&&r.node!=n.node){let a=et.get(r.node);if(!a||a instanceof Un&&a.text!=r.node.nodeValue)s=r;else if(i.docView.lastCompositionAfterCursor){let l=et.get(n.node);!l||l instanceof Un&&l.text!=n.node.nodeValue||(s=r)}}if(i.docView.lastCompositionAfterCursor=s!=n,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function jse(i,e,t){let n=ID(i,t);if(!n)return null;let{node:r,from:s,to:o}=n,a=r.nodeValue;if(/[\n\r]/.test(a)||i.state.doc.sliceString(n.from,n.to)!=a)return null;let l=e.invertedDesc,u=new hn(l.mapPos(s),l.mapPos(o),s,o),c=[];for(let h=r.parentNode;;h=h.parentNode){let f=et.get(h);if(f instanceof Qr)c.push({node:h,deco:f.mark});else{if(f instanceof wt||h.nodeName=="DIV"&&h.parentNode==i.contentDOM)return{range:u,text:r,marks:c,line:h};if(h!=i.contentDOM)c.push({node:h,deco:new Tc({inclusive:!0,attributes:Rse(h),tagName:h.tagName.toLowerCase()})});else return null}}}function Gse(i,e){return i.nodeType!=1?0:(e&&i.childNodes[e-1].contentEditable=="false"?1:0)|(e<i.childNodes.length&&i.childNodes[e].contentEditable=="false"?2:0)}let Hse=class{constructor(){this.changes=[]}compareRange(e,t){Rf(e,t,this.changes)}comparePoint(e,t){Rf(e,t,this.changes)}boundChange(e){Rf(e,e,this.changes)}};function Xse(i,e,t){let n=new Hse;return ct.compare(i,e,t,n),n.changes}function zse(i,e){for(let t=i;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function Wse(i,e){let t=!1;return e&&i.iterChangedRanges((n,r)=>{n<e.to&&r>e.from&&(t=!0)}),t}function qse(i,e,t=1){let n=i.charCategorizer(e),r=i.doc.lineAt(e),s=e-r.from;if(r.length==0)return G.cursor(e);s==0?t=1:s==r.length&&(t=-1);let o=s,a=s;t<0?o=qt(r.text,s,!1):a=qt(r.text,s);let l=n(r.text.slice(o,a));for(;o>0;){let u=qt(r.text,o,!1);if(n(r.text.slice(u,o))!=l)break;o=u}for(;a<r.length;){let u=qt(r.text,a);if(n(r.text.slice(a,u))!=l)break;a=u}return G.range(o+r.from,a+r.from)}function Yse(i,e){return e.left>i?e.left-i:Math.max(0,i-e.right)}function Kse(i,e){return e.top>i?e.top-i:Math.max(0,i-e.bottom)}function K0(i,e){return i.top<e.bottom-1&&i.bottom>e.top+1}function h_(i,e){return e<i.top?{top:e,left:i.left,right:i.right,bottom:i.bottom}:i}function f_(i,e){return e>i.bottom?{top:i.top,left:i.left,right:i.right,bottom:e}:i}function gO(i,e,t){let n,r,s,o,a=!1,l,u,c,h;for(let p=i.firstChild;p;p=p.nextSibling){let g=Va(p);for(let m=0;m<g.length;m++){let v=g[m];r&&K0(r,v)&&(v=h_(f_(v,r.bottom),r.top));let O=Yse(e,v),y=Kse(t,v);if(O==0&&y==0)return p.nodeType==3?d_(p,e,t):gO(p,e,t);if(!n||o>y||o==y&&s>O){n=p,r=v,s=O,o=y;let x=y?t<v.top?-1:1:O?e<v.left?-1:1:0;a=!x||(x>0?m<g.length-1:m>0)}O==0?t>v.bottom&&(!c||c.bottom<v.bottom)?(l=p,c=v):t<v.top&&(!h||h.top>v.top)&&(u=p,h=v):c&&K0(c,v)?c=f_(c,v.bottom):h&&K0(h,v)&&(h=h_(h,v.top))}}if(c&&c.bottom>=t?(n=l,r=c):h&&h.top<=t&&(n=u,r=h),!n)return{node:i,offset:0};let f=Math.max(r.left,Math.min(r.right,e));if(n.nodeType==3)return d_(n,f,t);if(a&&n.contentEditable!="false")return gO(n,f,t);let d=Array.prototype.indexOf.call(i.childNodes,n)+(e>=(r.left+r.right)/2?1:0);return{node:i,offset:d}}function d_(i,e,t){let n=i.nodeValue.length,r=-1,s=1e9,o=0;for(let a=0;a<n;a++){let l=mo(i,a,a+1).getClientRects();for(let u=0;u<l.length;u++){let c=l[u];if(c.top==c.bottom)continue;o||(o=e-c.left);let h=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&h<s){let f=e>=(c.left+c.right)/2,d=f;if((re.chrome||re.gecko)&&mo(i,a).getBoundingClientRect().left==c.right&&(d=!f),h<=0)return{node:i,offset:a+(d?1:0)};r=a+(d?1:0),s=h}}}return{node:i,offset:r>-1?r:o>0?i.nodeValue.length:0}}function DD(i,e,t,n=-1){var r,s;let o=i.contentDOM.getBoundingClientRect(),a=o.top+i.viewState.paddingTop,l,{docHeight:u}=i.viewState,{x:c,y:h}=e,f=h-a;if(f<0)return 0;if(f>u)return i.state.doc.length;for(let x=i.viewState.heightOracle.textHeight/2,b=!1;l=i.elementAtHeight(f),l.type!=Hi.Text;)for(;f=n>0?l.bottom+x:l.top-x,!(f>=0&&f<=u);){if(b)return t?null:0;b=!0,n=-n}h=a+f;let d=l.from;if(d<i.viewport.from)return i.viewport.from==0?0:t?null:p_(i,o,l,c,h);if(d>i.viewport.to)return i.viewport.to==i.state.doc.length?i.state.doc.length:t?null:p_(i,o,l,c,h);let p=i.dom.ownerDocument,g=i.root.elementFromPoint?i.root:p,m=g.elementFromPoint(c,h);m&&!i.contentDOM.contains(m)&&(m=null),m||(c=Math.max(o.left+1,Math.min(o.right-1,c)),m=g.elementFromPoint(c,h),m&&!i.contentDOM.contains(m)&&(m=null));let v,O=-1;if(m&&((r=i.docView.nearest(m))===null||r===void 0?void 0:r.isEditable)!=!1){if(p.caretPositionFromPoint){let x=p.caretPositionFromPoint(c,h);x&&({offsetNode:v,offset:O}=x)}else if(p.caretRangeFromPoint){let x=p.caretRangeFromPoint(c,h);x&&({startContainer:v,startOffset:O}=x,(!i.contentDOM.contains(v)||re.safari&&Jse(v,O,c)||re.chrome&&eoe(v,O,c))&&(v=void 0))}v&&(O=Math.min(vr(v),O))}if(!v||!i.docView.dom.contains(v)){let x=wt.find(i.docView,d);if(!x)return f>l.top+l.height/2?l.to:l.from;({node:v,offset:O}=gO(x.dom,c,h))}let y=i.docView.nearest(v);if(!y)return null;if(y.isWidget&&((s=y.dom)===null||s===void 0?void 0:s.nodeType)==1){let x=y.dom.getBoundingClientRect();return e.y<x.top||e.y<=x.bottom&&e.x<=(x.left+x.right)/2?y.posAtStart:y.posAtEnd}else return y.localPosFromDOM(v,O)+y.posAtStart}function p_(i,e,t,n,r){let s=Math.round((n-e.left)*i.defaultCharacterWidth);if(i.lineWrapping&&t.height>i.defaultLineHeight*1.5){let a=i.viewState.heightOracle.textHeight,l=Math.floor((r-t.top-(i.defaultLineHeight-a)*.5)/a);s+=l*i.viewState.heightOracle.lineLength}let o=i.state.sliceDoc(t.from,t.to);return t.from+vse(o,s,i.state.tabSize)}function Jse(i,e,t){let n;if(i.nodeType!=3||e!=(n=i.nodeValue.length))return!1;for(let r=i.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return mo(i,n-1,n).getBoundingClientRect().left>t}function eoe(i,e,t){if(e!=0)return!1;for(let r=i;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let n=i.nodeType==1?i.getBoundingClientRect():mo(i,0,Math.max(i.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function mO(i,e){let t=i.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==Hi.Text))return n}return t}function toe(i,e,t,n){let r=mO(i,e.head),s=!n||r.type!=Hi.Text||!(i.lineWrapping||r.widgetLineBreaks)?null:i.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let o=i.dom.getBoundingClientRect(),a=i.textDirectionAt(r.from),l=i.posAtCoords({x:t==(a==Ot.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(l!=null)return G.cursor(l,t?-1:1)}return G.cursor(t?r.to:r.from,t?-1:1)}function g_(i,e,t,n){let r=i.state.doc.lineAt(e.head),s=i.bidiSpans(r),o=i.textDirectionAt(r.from);for(let a=e,l=null;;){let u=Bse(r,s,o,a,t),c=OD;if(!u){if(r.number==(t?i.state.doc.lines:1))return a;c=`
`,r=i.state.doc.line(r.number+(t?1:-1)),s=i.bidiSpans(r),u=i.visualLineSide(r,!t)}if(l){if(!l(c))return a}else{if(!n)return u;l=n(c)}a=u}}function ioe(i,e,t){let n=i.state.charCategorizer(e),r=n(t);return s=>{let o=n(s);return r==Yt.Space&&(r=o),r==o}}function noe(i,e,t,n){let r=e.head,s=t?1:-1;if(r==(t?i.state.doc.length:0))return G.cursor(r,e.assoc);let o=e.goalColumn,a,l=i.contentDOM.getBoundingClientRect(),u=i.coordsAtPos(r,e.assoc||-1),c=i.documentTop;if(u)o==null&&(o=u.left-l.left),a=s<0?u.top:u.bottom;else{let d=i.viewState.lineBlockAt(r);o==null&&(o=Math.min(l.right-l.left,i.defaultCharacterWidth*(r-d.from))),a=(s<0?d.top:d.bottom)+c}let h=l.left+o,f=n??i.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=a+(f+d)*s,g=DD(i,{x:h,y:p},!1,s);if(p<l.top||p>l.bottom||(s<0?g<r:g>r)){let m=i.docView.coordsForChar(g),v=!m||p<m.top?-1:1;return G.cursor(g,v,void 0,o)}}}function Lf(i,e,t){for(;;){let n=0;for(let r of i)r.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=n||t||(e-s<o-e?-1:1);e=l<0?s:o,n=l}});if(!n)return e}}function J0(i,e,t){let n=Lf(i.state.facet(G1).map(r=>r(i)),t.from,e.head>t.from?-1:1);return n==t.from?t:G.cursor(n,n<t.from?1:-1)}const Jl="";class roe{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Be.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Jl}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let r=e;;){this.findPointBefore(n,r);let s=this.text.length;this.readNode(r);let o=r.nextSibling;if(o==t)break;let a=et.get(r),l=et.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:Rd(r))||Rd(o)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>s)&&this.lineBreak(),r=o}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(a=r.exec(t))&&(s=a.index,o=a[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);n=s+o}}readNode(e){if(e.cmIgnore)return;let t=et.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(soe(e,n.node,n.offset)?t:0))}}function soe(i,e,t){for(;;){if(!e||t<vr(e))return!1;if(e==i)return!0;t=go(e)+1,e=e.parentNode}}class m_{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class ooe{constructor(e,t,n,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let a=s||o?[]:uoe(e),l=new roe(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=coe(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!rO(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),u=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!rO(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),c=e.viewport;if((re.ios||re.chrome)&&e.state.selection.main.empty&&l!=u&&(c.from>0||c.to<e.state.doc.length)){let h=Math.min(l,u),f=Math.max(l,u),d=c.from-h,p=c.to-f;(d==0||d==1||h==0)&&(p==0||p==-1||f==e.state.doc.length)&&(l=0,u=e.state.doc.length)}this.newSel=G.single(u,l)}}}function $D(i,e){let t,{newSel:n}=e,r=i.state.selection.main,s=i.inputState.lastKeyTime>Date.now()-100?i.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=r.from,u=null;(s===8||re.android&&e.text.length<a-o)&&(l=r.to,u="end");let c=loe(i.state.doc.sliceString(o,a,Jl),e.text,l-o,u);c&&(re.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==Jl+Jl&&c.toB--,t={from:o+c.from,to:o+c.toA,insert:Ue.of(e.text.slice(c.from,c.toB).split(Jl))})}else n&&(!i.hasFocus&&i.state.facet(Dr)||n.main.eq(r))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!r.empty&&n&&n.main.empty?t={from:r.from,to:r.to,insert:i.state.doc.slice(r.from,r.to)}:(re.mac||re.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=G.single(n.main.anchor-1,n.main.head-1)),t={from:t.from,to:t.to,insert:Ue.of([t.insert.toString().replace("."," ")])}):t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:i.state.doc.slice(r.from,t.from).append(t.insert).append(i.state.doc.slice(t.to,r.to))}:re.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&i.lineWrapping&&(n&&(n=G.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:Ue.of([" "])}),t)return X1(i,t,n,s);if(n&&!n.main.eq(r)){let o=!1,a="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(o=!0),a=i.inputState.lastSelectionOrigin),i.dispatch({selection:n,scrollIntoView:o,userEvent:a}),!0}else return!1}function X1(i,e,t,n=-1){if(re.ios&&i.inputState.flushIOSKey(e))return!0;let r=i.state.selection.main;if(re.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&i.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&xa(i.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&xa(i.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&xa(i.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();i.inputState.composing>=0&&i.inputState.composing++;let o,a=()=>o||(o=aoe(i,e,t));return i.state.facet(kD).some(l=>l(i,e.from,e.to,s,a))||i.dispatch(a()),!0}function aoe(i,e,t){let n,r=i.state,s=r.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&i.inputState.composing<0){let a=s.from<e.from?r.sliceDoc(s.from,e.from):"",l=s.to>e.to?r.sliceDoc(e.to,s.to):"";n=r.replaceSelection(i.state.toText(a+e.insert.sliceString(0,void 0,i.state.lineBreak)+l))}else{let a=r.changes(e),l=t&&t.main.to<=a.newLength?t.main:void 0;if(r.selection.ranges.length>1&&i.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let u=i.state.sliceDoc(e.from,e.to),c,h=t&&ID(i,t.main.head);if(h){let p=e.insert.length-(e.to-e.from);c={from:h.from,to:h.to-p}}else c=i.state.doc.lineAt(s.head);let f=s.to-e.to,d=s.to-s.from;n=r.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:a,range:l||p.map(a)};let g=p.to-f,m=g-u.length;if(p.to-p.from!=d||i.state.sliceDoc(m,g)!=u||p.to>=c.from&&p.from<=c.to)return{range:p};let v=r.changes({from:m,to:g,insert:e.insert}),O=p.to-s.to;return{changes:v,range:l?G.range(Math.max(0,l.anchor+O),Math.max(0,l.head+O)):p.map(v)}})}else n={changes:a,selection:l&&r.selection.replaceRange(l)}}let o="input.type";return(i.composing||i.inputState.compositionPendingChange&&i.inputState.compositionEndedAt>Date.now()-50)&&(i.inputState.compositionPendingChange=!1,o+=".compose",i.inputState.compositionFirstChange&&(o+=".start",i.inputState.compositionFirstChange=!1)),r.update(n,{userEvent:o,scrollIntoView:!0})}function loe(i,e,t,n){let r=Math.min(i.length,e.length),s=0;for(;s<r&&i.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&i.length==e.length)return null;let o=i.length,a=e.length;for(;o>0&&a>0&&i.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(n=="end"){let l=Math.max(0,s-Math.min(o,a));t-=o+l-s}if(o<s&&i.length<e.length){let l=t<=s&&t>=o?s-t:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=t<=s&&t>=a?s-t:0;s-=l,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function uoe(i){let e=[];if(i.root.activeElement!=i.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:s}=i.observer.selectionRange;return t&&(e.push(new m_(t,n)),(r!=t||s!=n)&&e.push(new m_(r,s))),e}function coe(i,e){if(i.length==0)return null;let t=i[0].pos,n=i.length==2?i[1].pos:t;return t>-1&&n>-1?G.single(t+e,n+e):null}class hoe{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,re.safari&&e.contentDOM.addEventListener("input",()=>null),re.gecko&&_oe(e.contentDOM.ownerDocument)}handleEvent(e){!yoe(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let n=this.handlers[e];if(n){for(let r of n.observers)r(this.view,t);for(let r of n.handlers){if(t.defaultPrevented)break;if(r(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=foe(e),n=this.handlers,r=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,a=n[s];a&&o!=!a.handlers.length&&(r.removeEventListener(s,this.handleEvent),a=null),a||r.addEventListener(s,this.handleEvent,{passive:o})}for(let s in n)s!="scroll"&&!t[s]&&r.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&FD.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),re.android&&re.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return re.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=MD.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||doe.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,xa(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:re.safari&&!re.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function v_(i,e){return(t,n)=>{try{return e.call(i,n,t)}catch(r){ji(t.state,r)}}}function foe(i){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of i){let r=n.spec;if(r&&r.domEventHandlers)for(let s in r.domEventHandlers){let o=r.domEventHandlers[s];o&&t(s).handlers.push(v_(n.value,o))}if(r&&r.domEventObservers)for(let s in r.domEventObservers){let o=r.domEventObservers[s];o&&t(s).observers.push(v_(n.value,o))}}for(let n in Vn)t(n).handlers.push(Vn[n]);for(let n in mn)t(n).observers.push(mn[n]);return e}const MD=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],doe="dthko",FD=[16,17,18,20,91,92,224,225],Lh=6;function Ih(i){return Math.max(0,i)*.7+8}function poe(i,e){return Math.max(Math.abs(i.clientX-e.clientX),Math.abs(i.clientY-e.clientY))}class goe{constructor(e,t,n,r){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=Tse(e.contentDOM),this.atoms=e.state.facet(G1).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Be.allowMultipleSelections)&&moe(e,t),this.dragging=Ooe(e,t)&&BD(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&poe(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,n=0,r=0,s=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=H1(this.view);e.clientX-l.left<=r+Lh?t=-Ih(r-e.clientX):e.clientX+l.right>=o-Lh&&(t=Ih(e.clientX-o)),e.clientY-l.top<=s+Lh?n=-Ih(s-e.clientY):e.clientY+l.bottom>=a-Lh&&(n=Ih(e.clientY-a)),this.setScrollSpeed(t,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let r=e.ranges[n],s=null;if(r.empty){let o=Lf(this.atoms,r.from,0);o!=r.from&&(s=G.cursor(o,-1))}else{let o=Lf(this.atoms,r.from,-1),a=Lf(this.atoms,r.to,1);(o!=r.from||a!=r.to)&&(s=G.range(r.from==r.anchor?o:a,r.from==r.head?o:a))}s&&(t||(t=e.ranges.slice()),t[n]=s)}return t?G.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function moe(i,e){let t=i.state.facet(yD);return t.length?t[0](e):re.mac?e.metaKey:e.ctrlKey}function voe(i,e){let t=i.state.facet(bD);return t.length?t[0](e):re.mac?!e.altKey:!e.ctrlKey}function Ooe(i,e){let{main:t}=i.state.selection;if(t.empty)return!1;let n=Nu(i.root);if(!n||n.rangeCount==0)return!0;let r=n.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function yoe(i,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=i.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=et.get(t))&&n.ignoreEvent(e))return!1;return!0}const Vn=Object.create(null),mn=Object.create(null),ND=re.ie&&re.ie_version<15||re.ios&&re.webkit_version<604;function boe(i){let e=i.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{i.focus(),t.remove(),QD(i,t.value)},50)}function Dp(i,e,t){for(let n of i.facet(e))t=n(t,i);return t}function QD(i,e){e=Dp(i.state,V1,e);let{state:t}=i,n,r=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(vO!=null&&t.selection.ranges.every(l=>l.empty)&&vO==s.toString()){let l=-1;n=t.changeByRange(u=>{let c=t.doc.lineAt(u.from);if(c.from==l)return{range:u};l=c.from;let h=t.toText((o?s.line(r++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:h},range:G.cursor(u.from+h.length)}})}else o?n=t.changeByRange(l=>{let u=s.line(r++);return{changes:{from:l.from,to:l.to,insert:u.text},range:G.cursor(l.from+u.length)}}):n=t.replaceSelection(s);i.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}mn.scroll=i=>{i.inputState.lastScrollTop=i.scrollDOM.scrollTop,i.inputState.lastScrollLeft=i.scrollDOM.scrollLeft};Vn.keydown=(i,e)=>(i.inputState.setSelectionOrigin("select"),e.keyCode==27&&i.inputState.tabFocusMode!=0&&(i.inputState.tabFocusMode=Date.now()+2e3),!1);mn.touchstart=(i,e)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")};mn.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")};Vn.mousedown=(i,e)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of i.state.facet(xD))if(t=n(i,e),t)break;if(!t&&e.button==0&&(t=koe(i,e)),t){let n=!i.hasFocus;i.inputState.startMouseSelection(new goe(i,e,t,n)),n&&i.observer.ignore(()=>{eD(i.contentDOM);let s=i.root.activeElement;s&&!s.contains(i.contentDOM)&&s.blur()});let r=i.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function O_(i,e,t,n){if(n==1)return G.cursor(e,t);if(n==2)return qse(i.state,e,t);{let r=wt.find(i.docView,e),s=i.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,a=r?r.posAtEnd:s.to;return a<i.state.doc.length&&a==s.to&&a++,G.range(o,a)}}let y_=(i,e,t)=>e>=t.top&&e<=t.bottom&&i>=t.left&&i<=t.right;function xoe(i,e,t,n){let r=wt.find(i.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&y_(t,n,o))return-1;let a=r.coordsAt(s,1);return a&&y_(t,n,a)?1:o&&o.bottom>=n?-1:1}function b_(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:xoe(i,t,e.clientX,e.clientY)}}const Soe=re.ie&&re.ie_version<=11;let x_=null,S_=0,k_=0;function BD(i){if(!Soe)return i.detail;let e=x_,t=k_;return x_=i,k_=Date.now(),S_=!e||t>Date.now()-400&&Math.abs(e.clientX-i.clientX)<2&&Math.abs(e.clientY-i.clientY)<2?(S_+1)%3:1}function koe(i,e){let t=b_(i,e),n=BD(e),r=i.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),r=r.map(s.changes))},get(s,o,a){let l=b_(i,s),u,c=O_(i,l.pos,l.bias,n);if(t.pos!=l.pos&&!o){let h=O_(i,t.pos,t.bias,n),f=Math.min(h.from,c.from),d=Math.max(h.to,c.to);c=f<c.from?G.range(f,d):G.range(d,f)}return o?r.replaceRange(r.main.extend(c.from,c.to)):a&&n==1&&r.ranges.length>1&&(u=Toe(r,l.pos))?u:a?r.addRange(c):G.create([c])}}}function Toe(i,e){for(let t=0;t<i.ranges.length;t++){let{from:n,to:r}=i.ranges[t];if(n<=e&&r>=e)return G.create(i.ranges.slice(0,t).concat(i.ranges.slice(t+1)),i.mainIndex==t?0:i.mainIndex-(i.mainIndex>t?1:0))}return null}Vn.dragstart=(i,e)=>{let{selection:{main:t}}=i.state;if(e.target.draggable){let r=i.docView.nearest(e.target);if(r&&r.isWidget){let s=r.posAtStart,o=s+r.length;(s>=t.to||o<=t.from)&&(t=G.range(s,o))}}let{inputState:n}=i;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Dp(i.state,Z1,i.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Vn.dragend=i=>(i.inputState.draggedContent=null,!1);function T_(i,e,t,n){if(t=Dp(i.state,V1,t),!t)return;let r=i.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=i.inputState,o=n&&s&&voe(i,e)?{from:s.from,to:s.to}:null,a={from:r,insert:t},l=i.state.changes(o?[o,a]:a);i.focus(),i.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),i.inputState.draggedContent=null}Vn.drop=(i,e)=>{if(!e.dataTransfer)return!1;if(i.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),r=0,s=()=>{++r==t.length&&T_(i,e,n.filter(o=>o!=null).join(i.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(n[o]=a.result),s()},a.readAsText(t[o])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return T_(i,e,n,!0),!0}return!1};Vn.paste=(i,e)=>{if(i.state.readOnly)return!0;i.observer.flush();let t=ND?null:e.clipboardData;return t?(QD(i,t.getData("text/plain")||t.getData("text/uri-list")),!0):(boe(i),!1)};function Eoe(i,e){let t=i.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),i.focus()},50)}function woe(i){let e=[],t=[],n=!1;for(let r of i.selection.ranges)r.empty||(e.push(i.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:s}of i.selection.ranges){let o=i.doc.lineAt(s);o.number>r&&(e.push(o.text),t.push({from:o.from,to:Math.min(i.doc.length,o.to+1)})),r=o.number}n=!0}return{text:Dp(i,Z1,e.join(i.lineBreak)),ranges:t,linewise:n}}let vO=null;Vn.copy=Vn.cut=(i,e)=>{let{text:t,ranges:n,linewise:r}=woe(i.state);if(!t&&!r)return!1;vO=r?t:null,e.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let s=ND?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(Eoe(i,t),!1)};const UD=Zr.define();function VD(i,e){let t=[];for(let n of i.facet(TD)){let r=n(i,e);r&&t.push(r)}return t?i.update({effects:t,annotations:UD.of(!0)}):null}function ZD(i){setTimeout(()=>{let e=i.hasFocus;if(e!=i.inputState.notifiedFocused){let t=VD(i.state,e);t?i.dispatch(t):i.update([])}},10)}mn.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),ZD(i)};mn.blur=i=>{i.observer.clearSelectionRange(),ZD(i)};mn.compositionstart=mn.compositionupdate=i=>{i.observer.editContext||(i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0))};mn.compositionend=i=>{i.observer.editContext||(i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionPendingKey=!0,i.inputState.compositionPendingChange=i.observer.pendingRecords().length>0,i.inputState.compositionFirstChange=null,re.chrome&&re.android?i.observer.flushSoon():i.inputState.compositionPendingChange?Promise.resolve().then(()=>i.observer.flush()):setTimeout(()=>{i.inputState.composing<0&&i.docView.hasComposition&&i.update([])},50))};mn.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()};Vn.beforeinput=(i,e)=>{var t,n;if(e.inputType=="insertReplacementText"&&i.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let a=o[0],l=i.posAtDOM(a.startContainer,a.startOffset),u=i.posAtDOM(a.endContainer,a.endOffset);return X1(i,{from:l,to:u,insert:i.state.toText(s)},null),!0}}let r;if(re.chrome&&re.android&&(r=MD.find(s=>s.inputType==e.inputType))&&(i.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let s=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}return re.ios&&e.inputType=="deleteContentForward"&&i.observer.flushSoon(),re.safari&&e.inputType=="insertText"&&i.inputState.composing>=0&&setTimeout(()=>mn.compositionend(i,e),20),!1};const E_=new Set;function _oe(i){E_.has(i)||(E_.add(i),i.addEventListener("copy",()=>{}),i.addEventListener("cut",()=>{}))}const w_=["pre-wrap","normal","pre-line","break-spaces"];let Ga=!1;function __(){Ga=!1}class Coe{constructor(e){this.lineWrapping=e,this.doc=Ue.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return w_.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let r=e[n];r<0?n++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,n,r,s,o){let a=w_.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=t,this.charWidth=n,this.textHeight=r,this.lineLength=s,l){this.heightSamples={};for(let u=0;u<o.length;u++){let c=o[u];c<0?u++:this.heightSamples[Math.floor(c*10)]=!0}}return l}}class Aoe{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class or{constructor(e,t,n,r,s){this.from=e,this.length=t,this.top=n,this.height=r,this._content=s}get type(){return typeof this._content=="number"?Hi.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof As?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new or(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var ut=function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i}(ut||(ut={}));const If=.001;class gi{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>If&&(Ga=!0),this.height=e)}replace(e,t,n){return gi.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,r){let s=this,o=n.doc;for(let a=r.length-1;a>=0;a--){let{fromA:l,toA:u,fromB:c,toB:h}=r[a],f=s.lineAt(l,ut.ByPosNoHeight,n.setDoc(t),0,0),d=f.to>=u?f:s.lineAt(u,ut.ByPosNoHeight,n,0,0);for(h+=d.to-u,u=d.to;a>0&&f.from<=r[a-1].toA;)l=r[a-1].fromA,c=r[a-1].fromB,a--,l<f.from&&(f=s.lineAt(l,ut.ByPosNoHeight,n,0,0));c+=f.from-l,l=f.from;let p=z1.build(n.setDoc(o),e,c,h);s=Dd(s,s.replace(l,u,p))}return s.updateHeight(n,0)}static empty(){return new Qi(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,r=0,s=0;for(;;)if(t==n)if(r>s*2){let a=e[t-1];a.break?e.splice(--t,1,a.left,null,a.right):e.splice(--t,1,a.left,a.right),n+=1+a.break,r-=a.size}else if(s>r*2){let a=e[n];a.break?e.splice(n,1,a.left,null,a.right):e.splice(n,1,a.left,a.right),n+=2+a.break,s-=a.size}else break;else if(r<s){let a=e[t++];a&&(r+=a.size)}else{let a=e[--n];a&&(s+=a.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,n++),new Poe(gi.of(e.slice(0,t)),o,gi.of(e.slice(n)))}}function Dd(i,e){return i==e?i:(i.constructor!=e.constructor&&(Ga=!0),e)}gi.prototype.size=1;class jD extends gi{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,r){return new or(r,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,r,s){return this.blockAt(0,n,r,s)}forEachLine(e,t,n,r,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,n,r,s))}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Qi extends jD{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,r){return new or(r,this.length,n,this.height,this.breaks)}replace(e,t,n){let r=n[0];return n.length==1&&(r instanceof Qi||r instanceof zt&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof zt?r=new Qi(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):gi.of(n)}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more?this.setHeight(r.heights[r.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class zt extends gi{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,s=r-n+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:n,lastLine:r,perLine:o,perChar:a}}blockAt(e,t,n,r){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(t,r);if(t.lineWrapping){let u=r+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),c=t.doc.lineAt(u),h=a+c.length*l,f=Math.max(n,e-h/2);return new or(c.from,c.length,f,h,0)}else{let u=Math.max(0,Math.min(o-s,Math.floor((e-n)/a))),{from:c,length:h}=t.doc.line(s+u);return new or(c,h,n+a*u,a,0)}}lineAt(e,t,n,r,s){if(t==ut.ByHeight)return this.blockAt(e,n,r,s);if(t==ut.ByPosNoHeight){let{from:d,to:p}=n.doc.lineAt(e);return new or(d,p-d,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(n,s),u=n.doc.lineAt(e),c=a+u.length*l,h=u.number-o,f=r+a*h+l*(u.from-s-h);return new or(u.from,u.length,Math.max(r,Math.min(f,r+this.height-c)),c,0)}forEachLine(e,t,n,r,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:a,perLine:l,perChar:u}=this.heightMetrics(n,s);for(let c=e,h=r;c<=t;){let f=n.doc.lineAt(c);if(c==e){let p=f.number-a;h+=l*p+u*(e-s-p)}let d=l+u*f.length;o(new or(f.from,f.length,h,d,0)),h+=d,c=f.to+1}}replace(e,t,n){let r=this.length-t;if(r>0){let s=n[n.length-1];s instanceof zt?n[n.length-1]=new zt(s.length+r):n.push(null,new zt(r-1))}if(e>0){let s=n[0];s instanceof zt?n[0]=new zt(e+s.length):n.unshift(new zt(e-1),null)}return gi.of(n)}decomposeLeft(e,t){t.push(new zt(e-1),null)}decomposeRight(e,t){t.push(null,new zt(this.length-e-1))}updateHeight(e,t=0,n=!1,r){let s=t+this.length;if(r&&r.from<=t+this.length&&r.more){let o=[],a=Math.max(t,r.from),l=-1;for(r.from>t&&o.push(new zt(r.from-t-1).updateHeight(e,t));a<=s&&r.more;){let c=e.doc.lineAt(a).length;o.length&&o.push(null);let h=r.heights[r.index++];l==-1?l=h:Math.abs(h-l)>=If&&(l=-2);let f=new Qi(c,h);f.outdated=!1,o.push(f),a+=c+1}a<=s&&o.push(null,new zt(s-a).updateHeight(e,a));let u=gi.of(o);return(l<0||Math.abs(u.height-this.height)>=If||Math.abs(l-this.heightMetrics(e,t).perLine)>=If)&&(Ga=!0),Dd(this,u)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Poe extends gi{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,r){let s=n+this.left.height;return e<s?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,s,r+this.left.length+this.break)}lineAt(e,t,n,r,s){let o=r+this.left.height,a=s+this.left.length+this.break,l=t==ut.ByHeight?e<o:e<a,u=l?this.left.lineAt(e,t,n,r,s):this.right.lineAt(e,t,n,o,a);if(this.break||(l?u.to<a:u.from>a))return u;let c=t==ut.ByPosNoHeight?ut.ByPosNoHeight:ut.ByPos;return l?u.join(this.right.lineAt(a,c,n,o,a)):this.left.lineAt(a,c,n,r,s).join(u)}forEachLine(e,t,n,r,s,o){let a=r+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,n,r,s,o),t>=l&&this.right.forEachLine(e,t,n,a,l,o);else{let u=this.lineAt(l,ut.ByPos,n,r,s);e<u.from&&this.left.forEachLine(e,u.from-1,n,r,s,o),u.to>=e&&u.from<=t&&o(u),t>u.to&&this.right.forEachLine(u.to+1,t,n,a,l,o)}}replace(e,t,n){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of n)s.push(a);if(e>0&&C_(s,o-1),t<this.length){let a=s.length;this.decomposeRight(t,s),C_(s,a)}return gi.of(s)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?gi.of(this.break?[e,null,t]:[e,t]):(this.left=Dd(this.left,e),this.right=Dd(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,r){let{left:s,right:o}=this,a=t+s.length+this.break,l=null;return r&&r.from<=t+s.length&&r.more?l=s=s.updateHeight(e,t,n,r):s.updateHeight(e,t,n),r&&r.from<=a+o.length&&r.more?l=o=o.updateHeight(e,a,n,r):o.updateHeight(e,a,n),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function C_(i,e){let t,n;i[e]==null&&(t=i[e-1])instanceof zt&&(n=i[e+1])instanceof zt&&i.splice(e-1,3,new zt(t.length+1+n.length))}const Roe=5;class z1{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Qi?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Qi(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0,s=n.widget?n.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=t-e;n.block?this.addBlock(new jD(o,r,n)):(o||s||r>=Roe)&&this.addLineDeco(r,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Qi(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new zt(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Qi)return e;let t=new Qi(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let r=this.ensureLine();r.length+=n,r.collapsed+=n,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Qi)&&!this.isCovered?this.nodes.push(new Qi(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let r of this.nodes)r instanceof Qi&&r.updateHeight(this.oracle,n),n+=r?r.length:1;return this.nodes}static build(e,t,n,r){let s=new z1(n,e);return ct.spans(t,n,r,s,0),s.finish(n)}}function Loe(i,e,t){let n=new Ioe;return ct.compare(i,e,t,n,0),n.changes}class Ioe{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&Rf(e,t,this.changes,5)}}function Doe(i,e){let t=i.getBoundingClientRect(),n=i.ownerDocument,r=n.defaultView||window,s=Math.max(0,t.left),o=Math.min(r.innerWidth,t.right),a=Math.max(0,t.top),l=Math.min(r.innerHeight,t.bottom);for(let u=i.parentNode;u&&u!=n.body;)if(u.nodeType==1){let c=u,h=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&h.overflow!="visible"){let f=c.getBoundingClientRect();s=Math.max(s,f.left),o=Math.min(o,f.right),a=Math.max(a,f.top),l=Math.min(u==i.parentNode?r.innerHeight:l,f.bottom)}u=h.position=="absolute"||h.position=="fixed"?c.offsetParent:c.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:a-(t.top+e),bottom:Math.max(a,l)-(t.top+e)}}function $oe(i){let e=i.getBoundingClientRect(),t=i.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function Moe(i,e){let t=i.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class em{constructor(e,t,n,r){this.from=e,this.to=t,this.size=n,this.displaySize=r}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],s=t[n];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e,t){return qe.replace({widget:new Foe(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Foe extends kc{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class A_{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=P_,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ot.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(j1).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new Coe(t),this.stateDeco=e.facet(Qu).filter(n=>typeof n!="function"),this.heightMap=gi.empty().applyChanges(this.stateDeco,Ue.empty,this.heightOracle.setDoc(e.doc),[new hn(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=qe.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let r=n?t.head:t.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new Dh(s,o))}}return this.viewports=e.sort((n,r)=>n.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?P_:new W1(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(eu(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Qu).filter(c=>typeof c!="function");let r=e.changedRanges,s=hn.extendWithRanges(r,Loe(n,this.stateDeco,e?e.changes:Mt.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);__(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Ga)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let u=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(wD)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),r=this.heightOracle,s=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Ot.RTL:Ot.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=t.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let u=0,c=0;if(a.width&&a.height){let{scaleX:x,scaleY:b}=JI(t,a);(x>.005&&Math.abs(this.scaleX-x)>.005||b>.005&&Math.abs(this.scaleY-b)>.005)&&(this.scaleX=x,this.scaleY=b,u|=16,o=l=!0)}let h=(parseInt(n.paddingTop)||0)*this.scaleY,f=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=f)&&(this.paddingTop=h,this.paddingBottom=f,u|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=iD(e.scrollDOM);let p=(this.printing?Moe:Doe)(t,this.paddingTop),g=p.top-this.pixelViewport.top,m=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(v!=this.inView&&(this.inView=v,v&&(l=!0)),!this.inView&&!this.scrollTarget&&!$oe(e.dom))return 0;let O=a.width;if((this.contentDOMWidth!=O||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,u|=16),l){let x=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(x)&&(o=!0),o||r.lineWrapping&&Math.abs(O-this.contentDOMWidth)>r.charWidth){let{lineHeight:b,charWidth:E,textHeight:T}=e.docView.measureTextSize();o=b>0&&r.refresh(s,b,E,T,O/E,x),o&&(e.docView.minWidth=0,u|=16)}g>0&&m>0?c=Math.max(g,m):g<0&&m<0&&(c=Math.min(g,m)),__();for(let b of this.viewports){let E=b.from==this.viewport.from?x:e.docView.measureVisibleLineHeights(b);this.heightMap=(o?gi.empty().applyChanges(this.stateDeco,Ue.empty,this.heightOracle,[new hn(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new Aoe(b.from,E))}Ga&&(u|=2)}let y=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return y&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),u|=this.updateForViewport()),(u&2||y)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new Dh(r.lineAt(o-n*1e3,ut.ByHeight,s,0,0).from,r.lineAt(a+(1-n)*1e3,ut.ByHeight,s,0,0).to);if(t){let{head:u}=t.range;if(u<l.from||u>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=r.lineAt(u,ut.ByPos,s,0,0),f;t.y=="center"?f=(h.top+h.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&u<l.from?f=h.top:f=h.bottom-c,l=new Dh(r.lineAt(f-1e3/2,ut.ByHeight,s,0,0).from,r.lineAt(f+c+1e3/2,ut.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new Dh(this.heightMap.lineAt(n,ut.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,ut.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,ut.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,ut.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||r<=o-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||s>=a+Math.max(10,Math.min(n,250)))&&r>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let r of e)t.touchesRange(r.from,r.to)||n.push(new em(t.mapPos(r.from),t.mapPos(r.to),r.size,r.displaySize));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=Ot.LTR&&!n)return[];let a=[],l=(c,h,f,d)=>{if(h-c<s)return;let p=this.state.selection.main,g=[p.from];p.empty||g.push(p.to);for(let v of g)if(v>c&&v<h){l(c,v-10,f,d),l(v+10,h,f,d);return}let m=Qoe(e,v=>v.from>=f.from&&v.to<=f.to&&Math.abs(v.from-c)<s&&Math.abs(v.to-h)<s&&!g.some(O=>v.from<O&&v.to>O));if(!m){if(h<f.to&&t&&n&&t.visibleRanges.some(y=>y.from<=h&&y.to>=h)){let y=t.moveToLineBoundary(G.cursor(h),!1,!0).head;y>c&&(h=y)}let v=this.gapSize(f,c,h,d),O=n||v<2e6?v:2e6;m=new em(c,h,v,O)}a.push(m)},u=c=>{if(c.length<o||c.type!=Hi.Text)return;let h=Noe(c.from,c.to,this.stateDeco);if(h.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(n){let g=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,m,v;if(f!=null){let O=Mh(h,f),y=((this.visibleBottom-this.visibleTop)/2+g)/c.height;m=O-y,v=O+y}else m=(this.visibleTop-c.top-g)/c.height,v=(this.visibleBottom-c.top+g)/c.height;d=$h(h,m),p=$h(h,v)}else{let g=h.total*this.heightOracle.charWidth,m=r*this.heightOracle.charWidth,v=0;if(g>2e6)for(let E of e)E.from>=c.from&&E.from<c.to&&E.size!=E.displaySize&&E.from*this.heightOracle.charWidth+v<this.pixelViewport.left&&(v=E.size-E.displaySize);let O=this.pixelViewport.left+v,y=this.pixelViewport.right+v,x,b;if(f!=null){let E=Mh(h,f),T=((y-O)/2+m)/g;x=E-T,b=E+T}else x=(O-m)/g,b=(y+m)/g;d=$h(h,x),p=$h(h,b)}d>c.from&&l(c.from,d,c,h),p<c.to&&l(p,c.to,c,h)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(u):u(c);return a}gapSize(e,t,n,r){let s=Mh(r,n)-Mh(r,t);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){em.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=qe.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let n=[];ct.spans(t,this.viewport.from,this.viewport.to,{span(s,o){n.push({from:s,to:o})},point(){}},20);let r=0;if(n.length!=this.visibleRanges.length)r=12;else for(let s=0;s<n.length&&!(r&8);s++){let o=this.visibleRanges[s],a=n[s];(o.from!=a.from||o.to!=a.to)&&(r|=4,e&&e.mapPos(o.from,-1)==a.from&&e.mapPos(o.to,1)==a.to||(r|=8))}return this.visibleRanges=n,r}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||eu(this.heightMap.lineAt(e,ut.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||eu(this.heightMap.lineAt(this.scaler.fromDOM(e),ut.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return eu(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Dh{constructor(e,t){this.from=e,this.to=t}}function Noe(i,e,t){let n=[],r=i,s=0;return ct.spans(t,i,e,{span(){},point(o,a){o>r&&(n.push({from:r,to:o}),s+=o-r),r=a}},20),r<e&&(n.push({from:r,to:e}),s+=e-r),{total:s,ranges:n}}function $h({total:i,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(i*t);for(let r=0;;r++){let{from:s,to:o}=e[r],a=o-s;if(n<=a)return s+n;n-=a}}function Mh(i,e){let t=0;for(let{from:n,to:r}of i.ranges){if(e<=r){t+=e-n;break}t+=r-n}return t/i.total}function Qoe(i,e){for(let t of i)if(e(t))return t}const P_={toDOM(i){return i},fromDOM(i){return i},scale:1,eq(i){return i==this}};class W1{constructor(e,t,n){let r=0,s=0,o=0;this.viewports=n.map(({from:a,to:l})=>{let u=t.lineAt(a,ut.ByPos,e,0,0).top,c=t.lineAt(l,ut.ByPos,e,0,0).bottom;return r+=c-u,{from:a,to:l,top:u,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let t=0,n=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return r+(e-n)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);n=s.bottom,r=s.domBottom}}fromDOM(e){for(let t=0,n=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return n+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);n=s.bottom,r=s.domBottom}}eq(e){return e instanceof W1?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,n)=>t.from==e.viewports[n].from&&t.to==e.viewports[n].to):!1}}function eu(i,e){if(e.scale==1)return i;let t=e.toDOM(i.top),n=e.toDOM(i.bottom);return new or(i.from,i.length,t,n-t,Array.isArray(i._content)?i._content.map(r=>eu(r,e)):i._content)}const Fh=de.define({combine:i=>i.join(" ")}),OO=de.define({combine:i=>i.indexOf(!0)>-1}),yO=_s.newName(),GD=_s.newName(),HD=_s.newName(),XD={"&light":"."+GD,"&dark":"."+HD};function bO(i,e,t){return new _s(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,r=>{if(r=="&")return i;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):i+" "+n}})}const Boe=bO("."+yO,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},XD),Uoe={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},tm=re.ie&&re.ie_version<=11;class Voe{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Ese,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(re.ie&&re.ie_version<=11||re.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(re.chrome&&re.chrome_version<126)&&(this.editContext=new joe(e),e.state.facet(Dr)&&(e.contentDOM.editContext=this.editContext.editContext)),tm&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(Dr)?n.root.activeElement!=this.dom:!Pf(this.dom,r))return;let s=r.anchorNode&&n.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(re.ie&&re.ie_version<=11||re.android&&re.chrome)&&!n.state.selection.main.empty&&r.focusNode&&gu(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Nu(e.root);if(!t)return!1;let n=re.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&Zoe(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let r=Pf(this.dom,n);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&_se(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Uoe),tm&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),tm&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&xa(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),t==-1?{from:t,to:n}=o:(t=Math.min(o.from,t),n=Math.max(o.to,n)))}return{from:t,to:n,typeOver:r}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),r=this.selectionChanged&&Pf(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new ooe(this.view,e,t,n);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,r=$D(this.view,t);return this.view.state==n&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=R_(t,e.previousSibling||e.target.previousSibling,-1),r=R_(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Dr)!=e.state.facet(Dr)&&(e.view.contentDOM.editContext=e.state.facet(Dr)?this.editContext.editContext:null))}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function R_(i,e,t){for(;e;){let n=et.get(e);if(n&&n.parent==i)return n;let r=e.parentNode;e=r!=i.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function L_(i,e){let t=e.startContainer,n=e.startOffset,r=e.endContainer,s=e.endOffset,o=i.docView.domAtPos(i.state.selection.main.anchor);return gu(o.node,o.offset,r,s)&&([t,n,r,s]=[r,s,t,n]),{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:s}}function Zoe(i,e){if(e.getComposedRanges){let r=e.getComposedRanges(i.root)[0];if(r)return L_(i,r)}let t=null;function n(r){r.preventDefault(),r.stopImmediatePropagation(),t=r.getTargetRanges()[0]}return i.contentDOM.addEventListener("beforeinput",n,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",n,!0),t?L_(i,t):null}class joe{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let r=e.state.selection.main,{anchor:s,head:o}=r,a=this.toEditorPos(n.updateRangeStart),l=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:a,drifted:!1});let u={from:a,to:l,insert:Ue.of(n.text.split(`
`))};if(u.from==this.from&&s<this.from?u.from=s:u.to==this.to&&s>this.to&&(u.to=s),u.from==u.to&&!u.insert.length){let c=G.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));c.main.eq(r)||e.dispatch({selection:c,userEvent:"select"});return}if((re.mac||re.android)&&u.from==o-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(u={from:a,to:l,insert:Ue.of([n.text.replace("."," ")])}),this.pendingContextChange=u,!e.state.readOnly){let c=this.to-this.from+(u.to-u.from+u.insert.length);X1(e,u,G.single(this.toEditorPos(n.selectionStart,c),this.toEditorPos(n.selectionEnd,c)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=n=>{let r=[],s=null;for(let o=this.toEditorPos(n.rangeStart),a=this.toEditorPos(n.rangeEnd);o<a;o++){let l=e.coordsForChar(o);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,r.push(s)}t.updateCharacterBounds(n.rangeStart,r)},this.handlers.textformatupdate=n=>{let r=[];for(let s of n.getTextFormats()){let o=s.underlineStyle,a=s.underlineThickness;if(o!="None"&&a!="None"){let l=this.toEditorPos(s.rangeStart),u=this.toEditorPos(s.rangeEnd);if(l<u){let c=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${a=="Thin"?1:2}px`;r.push(qe.mark({attributes:{style:c}}).range(l,u))}}}e.dispatch({effects:CD.of(qe.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)t.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let r=Nu(n.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,n=!1,r=this.pendingContextChange;return e.changes.iterChanges((s,o,a,l,u)=>{if(n)return;let c=u.length-(o-s);if(r&&o>=r.to)if(r.from==s&&r.to==o&&r.insert.eq(u)){r=this.pendingContextChange=null,t+=c,this.to+=c;return}else r=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=c,this.to+=c;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+u.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),u.toString()),this.to+=c}t+=c}),r&&!n&&this.revertPending(e.state),!n}update(e){let t=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(r=>!r.isUserEvent("input.type")&&r.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),r=this.toContextPos(t.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(n,r)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class le{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(r=>r.forEach(s=>n(s,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||wse(e.parent)||document,this.viewState=new A_(e.state||Be.create(e)),e.scrollTo&&e.scrollTo.is(Rh)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Yl).map(r=>new Y0(r));for(let r of this.plugins)r.update(this);this.observer=new Voe(this),this.inputState=new hoe(this),this.inputState.ensureHandlers(this.plugins),this.docView=new c_(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof _t?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,r,s=this.state;for(let f of e){if(f.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=f.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,l=null;e.some(f=>f.annotation(UD))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=VD(s,o),l||(a=1));let u=this.observer.delayedAndroidKey,c=null;if(u?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(Be.phrases)!=this.state.facet(Be.phrases))return this.setState(s);r=Id.create(this,s,e),r.flags|=a;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(h&&(h=h.map(f.changes)),f.scrollIntoView){let{main:d}=f.state.selection;h=new Sa(d.empty?d:G.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of f.effects)d.is(Rh)&&(h=d.value.clip(this.state))}this.viewState.update(r,h),this.bidiCache=$d.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(Kl)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Fh)!=r.state.facet(Fh)&&(this.viewState.mustMeasureContent=!0),(t||n||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!r.empty)for(let f of this.state.facet(pO))try{f(r)}catch(d){ji(this.state,d,"update listener")}(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!$D(this,c)&&u.force&&xa(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new A_(e),this.plugins=e.facet(Yl).map(n=>new Y0(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new c_(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Yl),n=e.state.facet(Yl);if(t!=n){let r=[];for(let s of n){let o=t.indexOf(s);if(o<0)r.push(new Y0(s));else{let a=this.plugins[o];a.mustUpdate=e,r.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(n){ji(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,r=n.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(iD(n))s=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(r);s=d.from,o=d.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];l&4||([this.measureRequests,u]=[u,this.measureRequests]);let c=u.map(d=>{try{return d.read(this)}catch(p){return ji(this.state,p),I_}}),h=Id.create(this,this.state,[]),f=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),f=this.docView.update(h),f&&this.docViewUpdate());for(let d=0;d<u.length;d++)if(c[d]!=I_)try{let p=u[d];p.write&&p.write(c[d],this)}catch(p){ji(this.state,p)}if(f&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){r=r+p,n.scrollTop=r/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let a of this.state.facet(pO))a(t)}get themeClasses(){return yO+" "+(this.state.facet(OO)?HD:GD)+" "+this.state.facet(Fh)}updateAttrs(){let e=D_(this,AD,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Dr)?"true":"false",class:"cm-content",style:`${re.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),D_(this,j1,t);let n=this.observer.ignore(()=>{let r=uO(this.contentDOM,this.contentAttrs,t),s=uO(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let r of n.effects)if(r.is(le.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Kl);let e=this.state.facet(le.cspNonce);_s.mount(this.root,this.styleModules.concat(Boe).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return J0(this,e,g_(this,e,t,n))}moveByGroup(e,t){return J0(this,e,g_(this,e,t,n=>ioe(this,e.head,n)))}visualLineSide(e,t){let n=this.bidiSpans(e),r=this.textDirectionAt(e.from),s=n[t?n.length-1:0];return G.cursor(s.side(t,r)+e.from,s.forward(!t,r)?1:-1)}moveToLineBoundary(e,t,n=!0){return toe(this,e,t,n)}moveVertically(e,t,n){return J0(this,e,noe(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),DD(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[ms.find(s,e-r.from,-1,t)];return Sc(n,o.dir==Ot.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ED)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Goe)return vD(e.length);let t=this.textDirectionAt(e.from),n;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||mD(s.isolates,n=u_(this,e))))return s.order;n||(n=u_(this,e));let r=Qse(e.text,t,n);return this.bidiCache.push(new $d(e.from,e.to,t,n,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||re.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{eD(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Rh.of(new Sa(typeof e=="number"?G.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Rh.of(new Sa(G.cursor(n.from),"start","start",n.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return zi.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return zi.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=_s.newName(),r=[Fh.of(n),Kl.of(bO(`.${n}`,e))];return t&&t.dark&&r.push(OO.of(!0)),r}static baseTheme(e){return Vr.lowest(Kl.of(bO("."+yO,e,XD)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),r=n&&et.get(n)||et.get(e);return((t=r==null?void 0:r.rootView)===null||t===void 0?void 0:t.view)||null}}le.styleModule=Kl;le.inputHandler=kD;le.clipboardInputFilter=V1;le.clipboardOutputFilter=Z1;le.scrollHandler=_D;le.focusChangeEffect=TD;le.perLineTextDirection=ED;le.exceptionSink=SD;le.updateListener=pO;le.editable=Dr;le.mouseSelectionStyle=xD;le.dragMovesSelection=bD;le.clickAddsSelectionRange=yD;le.decorations=Qu;le.outerDecorations=PD;le.atomicRanges=G1;le.bidiIsolatedRanges=RD;le.scrollMargins=LD;le.darkTheme=OO;le.cspNonce=de.define({combine:i=>i.length?i[0]:""});le.contentAttributes=j1;le.editorAttributes=AD;le.lineWrapping=le.contentAttributes.of({class:"cm-lineWrapping"});le.announce=Ve.define();const Goe=4096,I_={};class $d{constructor(e,t,n,r,s,o){this.from=e,this.to=t,this.dir=n,this.isolates=r,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let n=[],r=e.length?e[e.length-1].dir:Ot.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!t.touchesRange(o.from,o.to)&&n.push(new $d(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function D_(i,e,t){for(let n=i.state.facet(e),r=n.length-1;r>=0;r--){let s=n[r],o=typeof s=="function"?s(i):s;o&&lO(o,t)}return t}const Hoe=re.mac?"mac":re.windows?"win":re.linux?"linux":"key";function Xoe(i,e){const t=i.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let r,s,o,a;for(let l=0;l<t.length-1;++l){const u=t[l];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+u)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),a&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function Nh(i,e,t){return e.altKey&&(i="Alt-"+i),e.ctrlKey&&(i="Ctrl-"+i),e.metaKey&&(i="Meta-"+i),t!==!1&&e.shiftKey&&(i="Shift-"+i),i}const zoe=Vr.default(le.domEventHandlers({keydown(i,e){return WD(zD(e.state),i,e,"editor")}})),wc=de.define({enables:zoe}),$_=new WeakMap;function zD(i){let e=i.facet(wc),t=$_.get(e);return t||$_.set(e,t=Yoe(e.reduce((n,r)=>n.concat(r),[]))),t}function Woe(i,e,t){return WD(zD(i.state),e,i,t)}let cs=null;const qoe=4e3;function Yoe(i,e=Hoe){let t=Object.create(null),n=Object.create(null),r=(o,a)=>{let l=n[o];if(l==null)n[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,u,c)=>{var h,f;let d=t[o]||(t[o]=Object.create(null)),p=a.split(/ (?!$)/).map(v=>Xoe(v,e));for(let v=1;v<p.length;v++){let O=p.slice(0,v).join(" ");r(O,!0),d[O]||(d[O]={preventDefault:!0,stopPropagation:!1,run:[y=>{let x=cs={view:y,prefix:O,scope:o};return setTimeout(()=>{cs==x&&(cs=null)},qoe),!0}]})}let g=p.join(" ");r(g,!1);let m=d[g]||(d[g]={preventDefault:!1,stopPropagation:!1,run:((f=(h=d._any)===null||h===void 0?void 0:h.run)===null||f===void 0?void 0:f.slice())||[]});l&&m.run.push(l),u&&(m.preventDefault=!0),c&&(m.stopPropagation=!0)};for(let o of i){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let u of a){let c=t[u]||(t[u]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=o;for(let f in c)c[f].run.push(d=>h(d,xO))}let l=o[e]||o.key;if(l)for(let u of a)s(u,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(u,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return t}let xO=null;function WD(i,e,t,n){xO=e;let r=xse(e),s=ss(r,0),o=Ys(s)==r.length&&r!=" ",a="",l=!1,u=!1,c=!1;cs&&cs.view==t&&cs.scope==n&&(a=cs.prefix+" ",FD.indexOf(e.keyCode)<0&&(u=!0,cs=null));let h=new Set,f=m=>{if(m){for(let v of m.run)if(!h.has(v)&&(h.add(v),v(t)))return m.stopPropagation&&(c=!0),!0;m.preventDefault&&(m.stopPropagation&&(c=!0),u=!0)}return!1},d=i[n],p,g;return d&&(f(d[a+Nh(r,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(re.windows&&e.ctrlKey&&e.altKey)&&(p=Cs[e.keyCode])&&p!=r?(f(d[a+Nh(p,e,!0)])||e.shiftKey&&(g=Fu[e.keyCode])!=r&&g!=p&&f(d[a+Nh(g,e,!1)]))&&(l=!0):o&&e.shiftKey&&f(d[a+Nh(r,e,!0)])&&(l=!0),!l&&f(d._any)&&(l=!0)),u&&(l=!0),l&&c&&e.stopPropagation(),xO=null,l}class _c{constructor(e,t,n,r,s){this.className=e,this.left=t,this.top=n,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let r=e.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let s=qD(e);return[new _c(t,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return Koe(e,t,n)}}function qD(i){let e=i.scrollDOM.getBoundingClientRect();return{left:(i.textDirection==Ot.LTR?e.left:e.right-i.scrollDOM.clientWidth*i.scaleX)-i.scrollDOM.scrollLeft*i.scaleX,top:e.top-i.scrollDOM.scrollTop*i.scaleY}}function M_(i,e,t,n){let r=i.coordsAtPos(e,t*2);if(!r)return n;let s=i.dom.getBoundingClientRect(),o=(r.top+r.bottom)/2,a=i.posAtCoords({x:s.left+1,y:o}),l=i.posAtCoords({x:s.right-1,y:o});return a==null||l==null?n:{from:Math.max(n.from,Math.min(a,l)),to:Math.min(n.to,Math.max(a,l))}}function Koe(i,e,t){if(t.to<=i.viewport.from||t.from>=i.viewport.to)return[];let n=Math.max(t.from,i.viewport.from),r=Math.min(t.to,i.viewport.to),s=i.textDirection==Ot.LTR,o=i.contentDOM,a=o.getBoundingClientRect(),l=qD(i),u=o.querySelector(".cm-line"),c=u&&window.getComputedStyle(u),h=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),f=a.right-(c?parseInt(c.paddingRight):0),d=mO(i,n),p=mO(i,r),g=d.type==Hi.Text?d:null,m=p.type==Hi.Text?p:null;if(g&&(i.lineWrapping||d.widgetLineBreaks)&&(g=M_(i,n,1,g)),m&&(i.lineWrapping||p.widgetLineBreaks)&&(m=M_(i,r,-1,m)),g&&m&&g.from==m.from&&g.to==m.to)return O(y(t.from,t.to,g));{let b=g?y(t.from,null,g):x(d,!1),E=m?y(null,t.to,m):x(p,!0),T=[];return(g||d).to<(m||p).from-(g&&m?1:0)||d.widgetLineBreaks>1&&b.bottom+i.defaultLineHeight/2<E.top?T.push(v(h,b.bottom,f,E.top)):b.bottom<E.top&&i.elementAtHeight((b.bottom+E.top)/2).type==Hi.Text&&(b.bottom=E.top=(b.bottom+E.top)/2),O(b).concat(T).concat(O(E))}function v(b,E,T,_){return new _c(e,b-l.left,E-l.top,T-b,_-E)}function O({top:b,bottom:E,horizontal:T}){let _=[];for(let D=0;D<T.length;D+=2)_.push(v(T[D],b,T[D+1],E));return _}function y(b,E,T){let _=1e9,D=-1e9,A=[];function I(B,Z,j,ie,ne){let z=i.coordsAtPos(B,B==T.to?-2:2),W=i.coordsAtPos(j,j==T.from?2:-2);!z||!W||(_=Math.min(z.top,W.top,_),D=Math.max(z.bottom,W.bottom,D),ne==Ot.LTR?A.push(s&&Z?h:z.left,s&&ie?f:W.right):A.push(!s&&ie?h:W.left,!s&&Z?f:z.right))}let L=b??T.from,$=E??T.to;for(let B of i.visibleRanges)if(B.to>L&&B.from<$)for(let Z=Math.max(B.from,L),j=Math.min(B.to,$);;){let ie=i.state.doc.lineAt(Z);for(let ne of i.bidiSpans(ie)){let z=ne.from+ie.from,W=ne.to+ie.from;if(z>=j)break;W>Z&&I(Math.max(z,Z),b==null&&z<=L,Math.min(W,j),E==null&&W>=$,ne.dir)}if(Z=ie.to+1,Z>=j)break}return A.length==0&&I(L,b==null,$,E==null,i.textDirection),{top:_,bottom:D,horizontal:A}}function x(b,E){let T=a.top+(E?b.top:b.bottom);return{top:T,bottom:T,horizontal:[]}}}function Joe(i,e){return i.constructor==e.constructor&&i.eq(e)}class eae{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Df)!=e.state.facet(Df)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(Df);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!Joe(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[n].constructor&&r.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Df=de.define();function YD(i){return[zi.define(e=>new eae(e,i)),Df.of(i)]}const KD=!(re.ios&&re.webkit&&re.webkit_version<534),Bu=de.define({combine(i){return Lp(i,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function tae(i={}){return[Bu.of(i),iae,nae,rae,wD.of(!0)]}function JD(i){return i.startState.facet(Bu)!=i.state.facet(Bu)}const iae=YD({above:!0,markers(i){let{state:e}=i,t=e.facet(Bu),n=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty?!s||KD:t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=r.empty?r:G.cursor(r.head,r.head>r.anchor?-1:1);for(let l of _c.forRange(i,o,a))n.push(l)}}return n},update(i,e){i.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=JD(i);return t&&F_(i.state,e),i.docChanged||i.selectionSet||t},mount(i,e){F_(e.state,i)},class:"cm-cursorLayer"});function F_(i,e){e.style.animationDuration=i.facet(Bu).cursorBlinkRate+"ms"}const nae=YD({above:!1,markers(i){return i.state.selection.ranges.map(e=>e.empty?[]:_c.forRange(i,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(i,e){return i.docChanged||i.selectionSet||i.viewportChanged||JD(i)},class:"cm-selectionLayer"}),SO={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};KD&&(SO[".cm-line"].caretColor=SO[".cm-content"].caretColor="transparent !important");const rae=Vr.highest(le.theme(SO));class sae extends kc{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),typeof this.content=="string"?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?Va(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),r=Sc(t[0],n.direction!="rtl"),s=parseInt(n.lineHeight);return r.bottom-r.top>s*1.5?{left:r.left,right:r.right,top:r.top,bottom:r.top+s}:r}ignoreEvent(){return!1}}function oae(i){return zi.fromClass(class{constructor(e){this.view=e,this.placeholder=i?qe.set([qe.widget({widget:new sae(i),side:1}).range(0)]):qe.none}get decorations(){return this.view.state.doc.length?qe.none:this.placeholder}},{decorations:e=>e.decorations})}const Dl="-10000px";class aae{constructor(e,t,n,r){this.facet=t,this.createTooltipView=n,this.removeTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=n(o,s))}update(e,t){var n;let r=e.state.facet(this.facet),s=r.filter(l=>l);if(r===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],a=t?[]:null;for(let l=0;l<s.length;l++){let u=s[l],c=-1;if(u){for(let h=0;h<this.tooltips.length;h++){let f=this.tooltips[h];f&&f.create==u.create&&(c=h)}if(c<0)o[l]=this.createTooltipView(u,l?o[l-1]:null),a&&(a[l]=!!u.above);else{let h=o[l]=this.tooltipViews[c];a&&(a[l]=t[c]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return t&&(a.forEach((l,u)=>t[u]=l),t.length=a.length),this.input=r,this.tooltips=s,this.tooltipViews=o,!0}}function lae(i){let e=i.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const im=de.define({combine:i=>{var e,t,n;return{position:re.ios?"absolute":((e=i.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=i.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=i.find(r=>r.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||lae}}}),N_=new WeakMap,e$=zi.fromClass(class{constructor(i){this.view=i,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=i.state.facet(im);this.position=e.position,this.parent=e.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new aae(i,t$,(t,n)=>this.createTooltip(t,n),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(i,this.above);e&&this.observeIntersection();let t=e||i.geometryChanged,n=i.state.facet(im);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(i,e){let t=i.create(this.view),n=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),i.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",t.dom.appendChild(r)}return t.dom.style.position=this.position,t.dom.style.top=Dl,t.dom.style.left="0px",this.container.insertBefore(t.dom,n),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var i,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(i=n.destroy)===null||i===void 0||i.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(re.gecko)t=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==Dl&&s.style.left=="0px"){let o=s.getBoundingClientRect();t=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(t||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(i=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:i,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),r=H1(this.view);return{visible:{left:n.left+r.left,top:n.top+r.top,right:n.right-r.right,bottom:n.bottom-r.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(im).tooltipSpace(this.view),scaleX:i,scaleY:e,makeAbsolute:t}}writeMeasure(i){var e;if(i.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:t,space:n,scaleX:r,scaleY:s}=i,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],u=this.manager.tooltipViews[a],{dom:c}=u,h=i.pos[a],f=i.size[a];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,n.top)||h.top>=Math.min(t.bottom,n.bottom)||h.right<Math.max(t.left,n.left)-.1||h.left>Math.min(t.right,n.right)+.1)){c.style.top=Dl;continue}let d=l.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,g=f.right-f.left,m=(e=N_.get(u))!==null&&e!==void 0?e:f.bottom-f.top,v=u.offset||cae,O=this.view.textDirection==Ot.LTR,y=f.width>n.right-n.left?O?n.left:n.right-f.width:O?Math.max(n.left,Math.min(h.left-(d?14:0)+v.x,n.right-g)):Math.min(Math.max(n.left,h.left-g+(d?14:0)-v.x),n.right-g),x=this.above[a];!l.strictSide&&(x?h.top-m-p-v.y<n.top:h.bottom+m+p+v.y>n.bottom)&&x==n.bottom-h.bottom>h.top-n.top&&(x=this.above[a]=!x);let b=(x?h.top-n.top:n.bottom-h.bottom)-p;if(b<m&&u.resize!==!1){if(b<this.view.defaultLineHeight){c.style.top=Dl;continue}N_.set(u,m),c.style.height=(m=b)/s+"px"}else c.style.height&&(c.style.height="");let E=x?h.top-m-p-v.y:h.bottom+p+v.y,T=y+g;if(u.overlap!==!0)for(let _ of o)_.left<T&&_.right>y&&_.top<E+m&&_.bottom>E&&(E=x?_.top-m-2-p:_.bottom+p+2);if(this.position=="absolute"?(c.style.top=(E-i.parent.top)/s+"px",Q_(c,(y-i.parent.left)/r)):(c.style.top=E/s+"px",Q_(c,y/r)),d){let _=h.left+(O?v.x:-v.x)-(y+14-7);d.style.left=_/r+"px"}u.overlap!==!0&&o.push({left:y,top:E,right:T,bottom:E+m}),c.classList.toggle("cm-tooltip-above",x),c.classList.toggle("cm-tooltip-below",!x),u.positioned&&u.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=Dl}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Q_(i,e){let t=parseInt(i.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(i.style.left=e+"px")}const uae=le.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),cae={x:0,y:0},t$=de.define({enables:[e$,uae]});function i$(i,e){let t=i.plugin(e$);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}const B_=de.define({combine(i){let e,t;for(let n of i)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Md(i,e){let t=i.plugin(n$),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const n$=zi.fromClass(class{constructor(i){this.input=i.state.facet(Fd),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(i));let e=i.state.facet(B_);this.top=new Qh(i,!0,e.topContainer),this.bottom=new Qh(i,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(i){let e=i.state.facet(B_);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Qh(i.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Qh(i.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=i.state.facet(Fd);if(t!=this.input){let n=t.filter(l=>l),r=[],s=[],o=[],a=[];for(let l of n){let u=this.specs.indexOf(l),c;u<0?(c=l(i.view),a.push(c)):(c=this.panels[u],c.update&&c.update(i)),r.push(c),(c.top?s:o).push(c)}this.specs=n,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>le.scrollMargins.of(e=>{let t=e.plugin(i);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Qh{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=U_(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=U_(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function U_(i){let e=i.nextSibling;return i.remove(),e}const Fd=de.define({enables:n$});class Ha extends po{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ha.prototype.elementClass="";Ha.prototype.toDOM=void 0;Ha.prototype.mapMode=fi.TrackBefore;Ha.prototype.startSide=Ha.prototype.endSide=-1;Ha.prototype.point=!0;const r$=1024;let hae=0;class an{constructor(e,t){this.from=e,this.to=t}}class Te{constructor(e={}){this.id=hae++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Pt.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}}Te.closedBy=new Te({deserialize:i=>i.split(" ")});Te.openedBy=new Te({deserialize:i=>i.split(" ")});Te.group=new Te({deserialize:i=>i.split(" ")});Te.isolate=new Te({deserialize:i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}});Te.contextHash=new Te({perNode:!0});Te.lookAhead=new Te({perNode:!0});Te.mounted=new Te({perNode:!0});class Uu{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[Te.mounted.id]}}const fae=Object.create(null);class Pt{constructor(e,t,n,r=0){this.name=e,this.props=t,this.id=n,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):fae,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new Pt(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Te.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let r of n.split(" "))t[r]=e[n];return n=>{for(let r=n.prop(Te.group),s=-1;s<(r?r.length:0);s++){let o=t[s<0?n.name:r[s]];if(o)return o}}}}Pt.none=new Pt("",Object.create(null),0,8);class fl{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let r=null;for(let s of e){let o=s(n);o&&(r||(r=Object.assign({},n.props)),r[o[0].id]=o[1])}t.push(r?new Pt(n.name,r,n.id,n.flags):n)}return new fl(t)}}const Bh=new WeakMap,V_=new WeakMap;var it;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays"})(it||(it={}));class Ie{constructor(e,t,n,r,s){if(this.type=e,this.children=t,this.positions=n,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=Uu.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let r=n.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Nd(this.topNode,e)}cursorAt(e,t=0,n=0){let r=Bh.get(this)||this.topNode,s=new Nd(r);return s.moveTo(e,t),Bh.set(this,s._tree),s}get topNode(){return new si(this,0,0,null)}resolve(e,t=0){let n=Vu(Bh.get(this)||this.topNode,e,t,!1);return Bh.set(this,n),n}resolveInner(e,t=0){let n=Vu(V_.get(this)||this.topNode,e,t,!0);return V_.set(this,n),n}resolveStack(e,t=0){return gae(this,e,t)}iterate(e){let{enter:t,leave:n,from:r=0,to:s=this.length}=e,o=e.mode||0,a=(o&it.IncludeAnonymous)>0;for(let l=this.cursor(o|it.IncludeAnonymous);;){let u=!1;if(l.from<=s&&l.to>=r&&(!a&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&n&&(a||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:K1(Pt.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,r)=>new Ie(this.type,t,n,r,this.propValues),e.makeTree||((t,n,r)=>new Ie(Pt.none,t,n,r)))}static build(e){return mae(e)}}Ie.empty=new Ie(Pt.none,[],[],0);class q1{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new q1(this.buffer,this.index)}}class Ps{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Pt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,n,r,s){let{buffer:o}=this,a=-1;for(let l=e;l!=t&&!(s$(s,r,o[l+1],o[l+2])&&(a=l,n>0));l=o[l+3]);return a}slice(e,t,n){let r=this.buffer,s=new Uint16Array(t-e),o=0;for(let a=e,l=0;a<t;){s[l++]=r[a++],s[l++]=r[a++]-n;let u=s[l++]=r[a++]-n;s[l++]=r[a++]-e,o=Math.max(o,u)}return new Ps(s,o,this.set)}}function s$(i,e,t,n){switch(i){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Vu(i,e,t,n){for(var r;i.from==i.to||(t<1?i.from>=e:i.from>e)||(t>-1?i.to<=e:i.to<e);){let o=!n&&i instanceof si&&i.index<0?null:i.parent;if(!o)return i;i=o}let s=n?0:it.IgnoreOverlays;if(n)for(let o=i,a=o.parent;a;o=a,a=o.parent)o instanceof si&&o.index<0&&((r=a.enter(e,t,s))===null||r===void 0?void 0:r.from)!=o.from&&(i=a);for(;;){let o=i.enter(e,t,s);if(!o)return i;i=o}}class o${cursor(e=0){return new Nd(this,e)}getChild(e,t=null,n=null){let r=Z_(this,e,t,n);return r.length?r[0]:null}getChildren(e,t=null,n=null){return Z_(this,e,t,n)}resolve(e,t=0){return Vu(this,e,t,!1)}resolveInner(e,t=0){return Vu(this,e,t,!0)}matchContext(e){return kO(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let r=t.lastChild;if(!r||r.to!=t.to)break;r.type.isError&&r.from==r.to?(n=t,t=r.prevSibling):t=r}return n}get node(){return this}get next(){return this.parent}}class si extends o${constructor(e,t,n,r){super(),this._tree=e,this.from=t,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,r,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,u=t>0?a.length:-1;e!=u;e+=t){let c=a[e],h=l[e]+o.from;if(s$(r,n,h,h+c.length)){if(c instanceof Ps){if(s&it.ExcludeBuffers)continue;let f=c.findChild(0,c.buffer.length,t,n-h,r);if(f>-1)return new hr(new dae(o,c,e,h),null,f)}else if(s&it.IncludeAnonymous||!c.type.isAnonymous||Y1(c)){let f;if(!(s&it.IgnoreMounts)&&(f=Uu.get(c))&&!f.overlay)return new si(f.tree,h,e,o);let d=new si(c,h,e,o);return s&it.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,r)}}}if(s&it.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let r;if(!(n&it.IgnoreOverlays)&&(r=Uu.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:o,to:a}of r.overlay)if((t>0?o<=s:o<s)&&(t<0?a>=s:a>s))return new si(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Z_(i,e,t,n){let r=i.cursor(),s=[];if(!r.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=r.type.is(t),!r.nextSibling())return s}for(;;){if(n!=null&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return n==null?s:[]}}function kO(i,e,t=e.length-1){for(let n=i;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}class dae{constructor(e,t,n,r){this.parent=e,this.buffer=t,this.index=n,this.start=r}}class hr extends o${get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new hr(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&it.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new hr(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new hr(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new hr(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,r=this.index+4,s=n.buffer[this.index+3];if(s>r){let o=n.buffer[this.index+1];e.push(n.slice(r,s,o)),t.push(0)}return new Ie(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function a$(i){if(!i.length)return null;let e=0,t=i[0];for(let s=1;s<i.length;s++){let o=i[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let n=t instanceof si&&t.index<0?null:t.parent,r=i.slice();return n?r[e]=n:r.splice(e,1),new pae(r,t)}class pae{constructor(e,t){this.heads=e,this.node=t}get next(){return a$(this.heads)}}function gae(i,e,t){let n=i.resolveInner(e,t),r=null;for(let s=n instanceof si?n:n.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(r||(r=[n])).push(o.resolve(e,t)),s=o}else{let o=Uu.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new si(o.tree,o.overlay[0].from+s.from,-1,s);(r||(r=[n])).push(Vu(a,e,t,!1))}}return r?a$(r):n}class Nd{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof si)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=n+r.buffer[e+1],this.to=n+r.buffer[e+2],!0}yield(e){return e?e instanceof si?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&it.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&it.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&it.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(r)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=r)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,o=e<0?-1:n._tree.children.length;s!=o;s+=e){let a=n._tree.children[s];if(this.mode&it.IncludeAnonymous||a instanceof Ps||!a.type.isAnonymous||Y1(a))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,n=s+1;break e}r=this.stack[--s]}for(let r=n;r<this.stack.length;r++)t=new hr(this.buffer,t,this.stack[r]);return this.bufferNode=new hr(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&t&&t(this),r=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,r=!0}}}matchContext(e){if(!this.buffer)return kO(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return kO(this._tree,e,r);let o=n[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function Y1(i){return i.children.some(e=>e instanceof Ps||!e.type.isAnonymous||Y1(e))}function mae(i){var e;let{buffer:t,nodeSet:n,maxBufferLength:r=r$,reused:s=[],minRepeatType:o=n.types.length}=i,a=Array.isArray(t)?new q1(t,t.length):t,l=n.types,u=0,c=0;function h(b,E,T,_,D,A){let{id:I,start:L,end:$,size:B}=a,Z=c,j=u;for(;B<0;)if(a.next(),B==-1){let he=s[I];T.push(he),_.push(L-b);return}else if(B==-3){u=I;return}else if(B==-4){c=I;return}else throw new RangeError(`Unrecognized record size: ${B}`);let ie=l[I],ne,z,W=L-b;if($-L<=r&&(z=m(a.pos-E,D))){let he=new Uint16Array(z.size-z.skip),se=a.pos-z.size,oe=he.length;for(;a.pos>se;)oe=v(z.start,he,oe);ne=new Ps(he,$-z.start,n),W=z.start-b}else{let he=a.pos-B;a.next();let se=[],oe=[],Se=I>=o?I:-1,$e=0,Ke=$;for(;a.pos>he;)Se>=0&&a.id==Se&&a.size>=0?(a.end<=Ke-r&&(p(se,oe,L,$e,a.end,Ke,Se,Z,j),$e=se.length,Ke=a.end),a.next()):A>2500?f(L,he,se,oe):h(L,he,se,oe,Se,A+1);if(Se>=0&&$e>0&&$e<se.length&&p(se,oe,L,$e,L,Ke,Se,Z,j),se.reverse(),oe.reverse(),Se>-1&&$e>0){let kt=d(ie,j);ne=K1(ie,se,oe,0,se.length,0,$-L,kt,kt)}else ne=g(ie,se,oe,$-L,Z-$,j)}T.push(ne),_.push(W)}function f(b,E,T,_){let D=[],A=0,I=-1;for(;a.pos>E;){let{id:L,start:$,end:B,size:Z}=a;if(Z>4)a.next();else{if(I>-1&&$<I)break;I<0&&(I=B-r),D.push(L,$,B),A++,a.next()}}if(A){let L=new Uint16Array(A*4),$=D[D.length-2];for(let B=D.length-3,Z=0;B>=0;B-=3)L[Z++]=D[B],L[Z++]=D[B+1]-$,L[Z++]=D[B+2]-$,L[Z++]=Z;T.push(new Ps(L,D[2]-$,n)),_.push($-b)}}function d(b,E){return(T,_,D)=>{let A=0,I=T.length-1,L,$;if(I>=0&&(L=T[I])instanceof Ie){if(!I&&L.type==b&&L.length==D)return L;($=L.prop(Te.lookAhead))&&(A=_[I]+L.length+$)}return g(b,T,_,D,A,E)}}function p(b,E,T,_,D,A,I,L,$){let B=[],Z=[];for(;b.length>_;)B.push(b.pop()),Z.push(E.pop()+T-D);b.push(g(n.types[I],B,Z,A-D,L-A,$)),E.push(D-T)}function g(b,E,T,_,D,A,I){if(A){let L=[Te.contextHash,A];I=I?[L].concat(I):[L]}if(D>25){let L=[Te.lookAhead,D];I=I?[L].concat(I):[L]}return new Ie(b,E,T,_,I)}function m(b,E){let T=a.fork(),_=0,D=0,A=0,I=T.end-r,L={size:0,start:0,skip:0};e:for(let $=T.pos-b;T.pos>$;){let B=T.size;if(T.id==E&&B>=0){L.size=_,L.start=D,L.skip=A,A+=4,_+=4,T.next();continue}let Z=T.pos-B;if(B<0||Z<$||T.start<I)break;let j=T.id>=o?4:0,ie=T.start;for(T.next();T.pos>Z;){if(T.size<0)if(T.size==-3)j+=4;else break e;else T.id>=o&&(j+=4);T.next()}D=ie,_+=B,A+=j}return(E<0||_==b)&&(L.size=_,L.start=D,L.skip=A),L.size>4?L:void 0}function v(b,E,T){let{id:_,start:D,end:A,size:I}=a;if(a.next(),I>=0&&_<o){let L=T;if(I>4){let $=a.pos-(I-4);for(;a.pos>$;)T=v(b,E,T)}E[--T]=L,E[--T]=A-b,E[--T]=D-b,E[--T]=_}else I==-3?u=_:I==-4&&(c=_);return T}let O=[],y=[];for(;a.pos>0;)h(i.start||0,i.bufferStart||0,O,y,-1,0);let x=(e=i.length)!==null&&e!==void 0?e:O.length?y[0]+O[0].length:0;return new Ie(l[i.topID],O.reverse(),y.reverse(),x)}const j_=new WeakMap;function $f(i,e){if(!i.isAnonymous||e instanceof Ps||e.type!=i)return 1;let t=j_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=i||!(n instanceof Ie)){t=1;break}t+=$f(i,n)}j_.set(e,t)}return t}function K1(i,e,t,n,r,s,o,a,l){let u=0;for(let p=n;p<r;p++)u+=$f(i,e[p]);let c=Math.ceil(u*1.5/8),h=[],f=[];function d(p,g,m,v,O){for(let y=m;y<v;){let x=y,b=g[y],E=$f(i,p[y]);for(y++;y<v;y++){let T=$f(i,p[y]);if(E+T>=c)break;E+=T}if(y==x+1){if(E>c){let T=p[x];d(T.children,T.positions,0,T.children.length,g[x]+O);continue}h.push(p[x])}else{let T=g[y-1]+p[y-1].length-b;h.push(K1(i,p,g,x,y,b,T,null,l))}f.push(b+O-s)}}return d(e,t,n,r,0),(a||l)(h,f,o)}class l${constructor(){this.map=new WeakMap}setBuffer(e,t,n){let r=this.map.get(e);r||this.map.set(e,r=new Map),r.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof hr?this.setBuffer(e.context.buffer,e.index,t):e instanceof si&&this.map.set(e.tree,t)}get(e){return e instanceof hr?this.getBuffer(e.context.buffer,e.index):e instanceof si?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class Fr{constructor(e,t,n,r,s=!1,o=!1){this.from=e,this.to=t,this.tree=n,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let r=[new Fr(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&r.push(s);return r}static applyChanges(e,t,n=128){if(!t.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,u=0;;a++){let c=a<t.length?t[a]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;o&&o.from<h;){let f=o;if(l>=f.from||h<=f.to||u){let d=Math.max(f.from,l)-u,p=Math.min(f.to,h)-u;f=d>=p?null:new Fr(d,p,f.tree,f.offset+u,a>0,!!c)}if(f&&r.push(f),o.to>h)break;o=s<e.length?e[s++]:null}if(!c)break;l=c.toA,u=c.toA-c.toB}return r}}class $p{startParse(e,t,n){return typeof e=="string"&&(e=new vae(e)),n=n?n.length?n.map(r=>new an(r.from,r.to)):[new an(0,0)]:[new an(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let r=this.startParse(e,t,n);for(;;){let s=r.advance();if(s)return s}}}class vae{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function u$(i){return(e,t,n,r)=>new yae(e,i,t,n,r)}class G_{constructor(e,t,n,r,s){this.parser=e,this.parse=t,this.overlay=n,this.target=r,this.from=s}}function H_(i){if(!i.length||i.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(i))}class Oae{constructor(e,t,n,r,s,o,a){this.parser=e,this.predicate=t,this.mounts=n,this.index=r,this.start=s,this.target=o,this.prev=a,this.depth=0,this.ranges=[]}}const TO=new Te({perNode:!0});class yae{constructor(e,t,n,r,s){this.nest=t,this.input=n,this.fragments=r,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let n=this.baseParse.advance();if(!n)return null;if(this.baseParse=null,this.baseTree=n,this.startInner(),this.stoppedAt!=null)for(let r of this.inner)r.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let n=this.baseTree;return this.stoppedAt!=null&&(n=new Ie(n.type,n.children,n.positions,n.length,n.propValues.concat([[TO,this.stoppedAt]]))),n}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[Te.mounted.id]=new Uu(t,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new Sae(this.fragments),t=null,n=null,r=new Nd(new si(this.baseTree,this.ranges[0].from,0,null),it.IncludeAnonymous|it.IgnoreMounts);e:for(let s,o;;){let a=!0,l;if(this.stoppedAt!=null&&r.from>=this.stoppedAt)a=!1;else if(e.hasNode(r)){if(t){let u=t.mounts.find(c=>c.frag.from<=r.from&&c.frag.to>=r.to&&c.mount.overlay);if(u)for(let c of u.mount.overlay){let h=c.from+u.pos,f=c.to+u.pos;h>=r.from&&f<=r.to&&!t.ranges.some(d=>d.from<f&&d.to>h)&&t.ranges.push({from:h,to:f})}}a=!1}else if(n&&(o=bae(n.ranges,r.from,r.to)))a=o!=2;else if(!r.type.isAnonymous&&(s=this.nest(r,this.input))&&(r.from<r.to||!s.overlay)){r.tree||xae(r);let u=e.findMounts(r.from,s.parser);if(typeof s.overlay=="function")t=new Oae(s.parser,s.overlay,u,this.inner.length,r.from,r.tree,t);else{let c=W_(this.ranges,s.overlay||(r.from<r.to?[new an(r.from,r.to)]:[]));c.length&&H_(c),(c.length||!s.overlay)&&this.inner.push(new G_(s.parser,c.length?s.parser.startParse(this.input,q_(u,c),c):s.parser.startParse(""),s.overlay?s.overlay.map(h=>new an(h.from-r.from,h.to-r.from)):null,r.tree,c.length?c[0].from:r.from)),s.overlay?c.length&&(n={ranges:c,depth:0,prev:n}):a=!1}}else if(t&&(l=t.predicate(r))&&(l===!0&&(l=new an(r.from,r.to)),l.from<l.to)){let u=t.ranges.length-1;u>=0&&t.ranges[u].to==l.from?t.ranges[u]={from:t.ranges[u].from,to:l.to}:t.ranges.push(l)}if(a&&r.firstChild())t&&t.depth++,n&&n.depth++;else for(;!r.nextSibling();){if(!r.parent())break e;if(t&&!--t.depth){let u=W_(this.ranges,t.ranges);u.length&&(H_(u),this.inner.splice(t.index,0,new G_(t.parser,t.parser.startParse(this.input,q_(t.mounts,u),u),t.ranges.map(c=>new an(c.from-t.start,c.to-t.start)),t.target,u[0].from))),t=t.prev}n&&!--n.depth&&(n=n.prev)}}}}function bae(i,e,t){for(let n of i){if(n.from>=t)break;if(n.to>e)return n.from<=e&&n.to>=t?2:1}return 0}function X_(i,e,t,n,r,s){if(e<t){let o=i.buffer[e+1];n.push(i.slice(e,t,o)),r.push(o-s)}}function xae(i){let{node:e}=i,t=[],n=e.context.buffer;do t.push(i.index),i.parent();while(!i.tree);let r=i.tree,s=r.children.indexOf(n),o=r.children[s],a=o.buffer,l=[s];function u(c,h,f,d,p,g){let m=t[g],v=[],O=[];X_(o,c,m,v,O,d);let y=a[m+1],x=a[m+2];l.push(v.length);let b=g?u(m+4,a[m+3],o.set.types[a[m]],y,x-y,g-1):e.toTree();return v.push(b),O.push(y-d),X_(o,a[m+3],h,v,O,d),new Ie(f,v,O,p)}r.children[s]=u(0,a.length,Pt.none,0,o.length,t.length-1);for(let c of l){let h=i.tree.children[c],f=i.tree.positions[c];i.yield(new si(h,f+i.from,c,i._tree))}}class z_{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(it.IncludeAnonymous|it.IgnoreMounts)}moveTo(e){let{cursor:t}=this,n=e-this.offset;for(;!this.done&&t.from<n;)t.to>=e&&t.enter(n,1,it.IgnoreOverlays|it.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof Ie)t=t.children[0];else break}return!1}}let Sae=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=(t=n.tree.prop(TO))!==null&&t!==void 0?t:n.to,this.inner=new z_(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(TO))!==null&&e!==void 0?e:t.to,this.inner=new z_(t.tree,-t.offset)}}findMounts(e,t){var n;let r=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let s=this.inner.cursor.node;s;s=s.parent){let o=(n=s.tree)===null||n===void 0?void 0:n.prop(Te.mounted);if(o&&o.parser==t)for(let a=this.fragI;a<this.fragments.length;a++){let l=this.fragments[a];if(l.from>=s.to)break;l.tree==this.curFrag.tree&&r.push({frag:l,pos:s.from-l.offset,mount:o})}}}return r}};function W_(i,e){let t=null,n=e;for(let r=1,s=0;r<i.length;r++){let o=i[r-1].to,a=i[r].from;for(;s<n.length;s++){let l=n[s];if(l.from>=a)break;l.to<=o||(t||(n=t=e.slice()),l.from<o?(t[s]=new an(l.from,o),l.to>a&&t.splice(s+1,0,new an(a,l.to))):l.to>a?t[s--]=new an(a,l.to):t.splice(s--,1))}}return n}function kae(i,e,t,n){let r=0,s=0,o=!1,a=!1,l=-1e9,u=[];for(;;){let c=r==i.length?1e9:o?i[r].to:i[r].from,h=s==e.length?1e9:a?e[s].to:e[s].from;if(o!=a){let f=Math.max(l,t),d=Math.min(c,h,n);f<d&&u.push(new an(f,d))}if(l=Math.min(c,h),l==1e9)break;c==l&&(o?(o=!1,r++):o=!0),h==l&&(a?(a=!1,s++):a=!0)}return u}function q_(i,e){let t=[];for(let{pos:n,mount:r,frag:s}of i){let o=n+(r.overlay?r.overlay[0].from:0),a=o+r.tree.length,l=Math.max(s.from,o),u=Math.min(s.to,a);if(r.overlay){let c=r.overlay.map(f=>new an(f.from+n,f.to+n)),h=kae(e,c,l,u);for(let f=0,d=l;;f++){let p=f==h.length,g=p?u:h[f].from;if(g>d&&t.push(new Fr(d,g,r.tree,-o,s.from>=d||s.openStart,s.to<=g||s.openEnd)),p)break;d=h[f].to}}else t.push(new Fr(l,u,r.tree,-o,s.from>=o||s.openStart,s.to<=a||s.openEnd))}return t}let Tae=0;class Ui{constructor(e,t,n,r){this.name=e,this.set=t,this.base=n,this.modified=r,this.id=Tae++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let n=typeof e=="string"?e:"?";if(e instanceof Ui&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let r=new Ui(n,[],null,[]);if(r.set.push(r),t)for(let s of t.set)r.set.push(s);return r}static defineModifier(e){let t=new Qd(e);return n=>n.modified.indexOf(t)>-1?n:Qd.get(n.base||n,n.modified.concat(t).sort((r,s)=>r.id-s.id))}}let Eae=0;class Qd{constructor(e){this.name=e,this.instances=[],this.id=Eae++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(a=>a.base==e&&wae(t,a.modified));if(n)return n;let r=[],s=new Ui(e.name,r,e,t);for(let a of t)a.instances.push(s);let o=_ae(t);for(let a of e.set)if(!a.modified.length)for(let l of o)r.push(Qd.get(a,l));return s}}function wae(i,e){return i.length==e.length&&i.every((t,n)=>t==e[n])}function _ae(i){let e=[[]];for(let t=0;t<i.length;t++)for(let n=0,r=e.length;n<r;n++)e.push(e[n].concat(i[t]));return e.sort((t,n)=>n.length-t.length)}function dl(i){let e=Object.create(null);for(let t in i){let n=i[t];Array.isArray(n)||(n=[n]);for(let r of t.split(" "))if(r){let s=[],o=2,a=r;for(let h=0;;){if(a=="..."&&h>0&&h+3==r.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!f)throw new RangeError("Invalid path: "+r);if(s.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),h+=f[0].length,h==r.length)break;let d=r[h++];if(h==r.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+r);a=r.slice(h)}let l=s.length-1,u=s[l];if(!u)throw new RangeError("Invalid path: "+r);let c=new Bd(n,o,l>0?s.slice(0,l):null);e[u]=c.sort(e[u])}}return c$.add(e)}const c$=new Te;class Bd{constructor(e,t,n,r){this.tags=e,this.mode=t,this.context=n,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Bd.empty=new Bd([],2,null);function h$(i,e){let t=Object.create(null);for(let s of i)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:n,all:r=null}=e||{};return{style:s=>{let o=r;for(let a of s)for(let l of a.set){let u=t[l.id];if(u){o=o?o+" "+u:u;break}}return o},scope:n}}function Cae(i,e){let t=null;for(let n of i){let r=n.style(e);r&&(t=t?t+" "+r:r)}return t}function Aae(i,e,t,n=0,r=i.length){let s=new Pae(n,Array.isArray(e)?e:[e],t);s.highlightRange(i.cursor(),n,r,"",s.highlighters),s.flush(r)}class Pae{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,r,s){let{type:o,from:a,to:l}=e;if(a>=n||l<=t)return;o.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(o)));let u=r,c=Rae(e)||Bd.empty,h=Cae(s,c.tags);if(h&&(u&&(u+=" "),u+=h,c.mode==1&&(r+=(r?" ":"")+h)),this.startSpan(Math.max(t,a),u),c.opaque)return;let f=e.tree&&e.tree.prop(Te.mounted);if(f&&f.overlay){let d=e.node.enter(f.overlay[0].from+a,1),p=this.highlighters.filter(m=>!m.scope||m.scope(f.tree.type)),g=e.firstChild();for(let m=0,v=a;;m++){let O=m<f.overlay.length?f.overlay[m]:null,y=O?O.from+a:l,x=Math.max(t,v),b=Math.min(n,y);if(x<b&&g)for(;e.from<b&&(this.highlightRange(e,x,b,r,s),this.startSpan(Math.min(b,e.to),u),!(e.to>=y||!e.nextSibling())););if(!O||y>n)break;v=O.to+a,v>t&&(this.highlightRange(d.cursor(),Math.max(t,O.from+a),Math.min(n,v),"",p),this.startSpan(Math.min(n,v),u))}g&&e.parent()}else if(e.firstChild()){f&&(r="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,r,s),this.startSpan(Math.min(n,e.to),u)}while(e.nextSibling());e.parent()}}}function Rae(i){let e=i.type.prop(c$);for(;e&&e.context&&!i.matchContext(e.context);)e=e.next;return e||null}const ee=Ui.define,Uh=ee(),os=ee(),Y_=ee(os),K_=ee(os),as=ee(),Vh=ee(as),nm=ee(as),er=ee(),js=ee(er),Kn=ee(),Jn=ee(),EO=ee(),$l=ee(EO),Zh=ee(),w={comment:Uh,lineComment:ee(Uh),blockComment:ee(Uh),docComment:ee(Uh),name:os,variableName:ee(os),typeName:Y_,tagName:ee(Y_),propertyName:K_,attributeName:ee(K_),className:ee(os),labelName:ee(os),namespace:ee(os),macroName:ee(os),literal:as,string:Vh,docString:ee(Vh),character:ee(Vh),attributeValue:ee(Vh),number:nm,integer:ee(nm),float:ee(nm),bool:ee(as),regexp:ee(as),escape:ee(as),color:ee(as),url:ee(as),keyword:Kn,self:ee(Kn),null:ee(Kn),atom:ee(Kn),unit:ee(Kn),modifier:ee(Kn),operatorKeyword:ee(Kn),controlKeyword:ee(Kn),definitionKeyword:ee(Kn),moduleKeyword:ee(Kn),operator:Jn,derefOperator:ee(Jn),arithmeticOperator:ee(Jn),logicOperator:ee(Jn),bitwiseOperator:ee(Jn),compareOperator:ee(Jn),updateOperator:ee(Jn),definitionOperator:ee(Jn),typeOperator:ee(Jn),controlOperator:ee(Jn),punctuation:EO,separator:ee(EO),bracket:$l,angleBracket:ee($l),squareBracket:ee($l),paren:ee($l),brace:ee($l),content:er,heading:js,heading1:ee(js),heading2:ee(js),heading3:ee(js),heading4:ee(js),heading5:ee(js),heading6:ee(js),contentSeparator:ee(er),list:ee(er),quote:ee(er),emphasis:ee(er),strong:ee(er),link:ee(er),monospace:ee(er),strikethrough:ee(er),inserted:ee(),deleted:ee(),changed:ee(),invalid:ee(),meta:Zh,documentMeta:ee(Zh),annotation:ee(Zh),processingInstruction:ee(Zh),definition:Ui.defineModifier("definition"),constant:Ui.defineModifier("constant"),function:Ui.defineModifier("function"),standard:Ui.defineModifier("standard"),local:Ui.defineModifier("local"),special:Ui.defineModifier("special")};for(let i in w){let e=w[i];e instanceof Ui&&(e.name=i)}h$([{tag:w.link,class:"tok-link"},{tag:w.heading,class:"tok-heading"},{tag:w.emphasis,class:"tok-emphasis"},{tag:w.strong,class:"tok-strong"},{tag:w.keyword,class:"tok-keyword"},{tag:w.atom,class:"tok-atom"},{tag:w.bool,class:"tok-bool"},{tag:w.url,class:"tok-url"},{tag:w.labelName,class:"tok-labelName"},{tag:w.inserted,class:"tok-inserted"},{tag:w.deleted,class:"tok-deleted"},{tag:w.literal,class:"tok-literal"},{tag:w.string,class:"tok-string"},{tag:w.number,class:"tok-number"},{tag:[w.regexp,w.escape,w.special(w.string)],class:"tok-string2"},{tag:w.variableName,class:"tok-variableName"},{tag:w.local(w.variableName),class:"tok-variableName tok-local"},{tag:w.definition(w.variableName),class:"tok-variableName tok-definition"},{tag:w.special(w.variableName),class:"tok-variableName2"},{tag:w.definition(w.propertyName),class:"tok-propertyName tok-definition"},{tag:w.typeName,class:"tok-typeName"},{tag:w.namespace,class:"tok-namespace"},{tag:w.className,class:"tok-className"},{tag:w.macroName,class:"tok-macroName"},{tag:w.propertyName,class:"tok-propertyName"},{tag:w.operator,class:"tok-operator"},{tag:w.comment,class:"tok-comment"},{tag:w.meta,class:"tok-meta"},{tag:w.invalid,class:"tok-invalid"},{tag:w.punctuation,class:"tok-punctuation"}]);var rm;const vs=new Te;function Mp(i){return de.define({combine:i?e=>e.concat(i):void 0})}const J1=new Te;class Gi{constructor(e,t,n=[],r=""){this.data=e,this.name=r,Be.prototype.hasOwnProperty("tree")||Object.defineProperty(Be.prototype,"tree",{get(){return bt(this)}}),this.parser=t,this.extension=[Wa.of(this),Be.languageData.of((s,o,a)=>{let l=J_(s,o,a),u=l.type.prop(vs);if(!u)return[];let c=s.facet(u),h=l.type.prop(J1);if(h){let f=l.resolve(o-l.from,a);for(let d of h)if(d.test(f,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return J_(e,t,n).type.prop(vs)==this.data}findRegions(e){let t=e.facet(Wa);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],r=(s,o)=>{if(s.prop(vs)==this.data){n.push({from:o,to:o+s.length});return}let a=s.prop(Te.mounted);if(a){if(a.tree.prop(vs)==this.data){if(a.overlay)for(let l of a.overlay)n.push({from:l.from+o,to:l.to+o});else n.push({from:o,to:o+s.length});return}else if(a.overlay){let l=n.length;if(r(a.tree,a.overlay[0].from+o),n.length>l)return}}for(let l=0;l<s.children.length;l++){let u=s.children[l];u instanceof Ie&&r(u,s.positions[l]+o)}};return r(bt(e),0),n}get allowsNesting(){return!0}}Gi.setState=Ve.define();function J_(i,e,t){let n=i.facet(Wa),r=bt(i).topNode;if(!n||n.allowsNesting)for(let s=r;s;s=s.enter(e,t,it.ExcludeBuffers))s.type.isTop&&(r=s);return r}class Xa extends Gi{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=Mp(e.languageData);return new Xa(t,e.parser.configure({props:[vs.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new Xa(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function bt(i){let e=i.field(Gi.state,!1);return e?e.tree:Ie.empty}class Lae{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let Ml=null;class Oo{constructor(e,t,n=[],r,s,o,a,l){this.parser=e,this.state=t,this.fragments=n,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new Oo(e,t,[],Ie.empty,0,n,[],null)}startParse(){return this.parser.startParse(new Lae(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ie.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(Fr.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Fr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Ml;Ml=this;try{return e()}finally{Ml=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=eC(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:r,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,c,h,f)=>l.push({fromA:u,toA:c,fromB:h,toB:f})),n=Fr.applyChanges(n,l),r=Ie.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),h=e.mapPos(u.to,-1);c<h&&a.push({from:c,to:h})}}}return new Oo(this.parser,t,n,r,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:r,to:s}=this.skipped[n];r<e.to&&s>e.from&&(this.fragments=eC(this.fragments,r,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends $p{createParse(t,n,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let l=Ml;if(l){for(let u of r)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new Ie(Pt.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Ml}}function eC(i,e,t){return Fr.applyChanges(i,[{fromA:e,toA:t,fromB:e,toB:t}])}class za{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new za(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=Oo.create(e.facet(Wa).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new za(n)}}Gi.state=yn.define({create:za.init,update(i,e){for(let t of e.effects)if(t.is(Gi.setState))return t.value;return e.startState.facet(Wa)!=e.state.facet(Wa)?za.init(e.state):i.apply(e)}});let f$=i=>{let e=setTimeout(()=>i(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(f$=i=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(i,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const sm=typeof navigator<"u"&&(!((rm=navigator.scheduling)===null||rm===void 0)&&rm.isInputPending)?()=>navigator.scheduling.isInputPending():null,Iae=zi.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Gi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Gi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=f$(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:r}}=this.view,s=n.field(Gi.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!sm?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<r&&n.doc.length>r+1e3,l=s.context.work(()=>sm&&sm()||Date.now()>o,r+(a?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Gi.setState.of(new za(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>ji(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Wa=de.define({combine(i){return i.length?i[0]:null},enables:i=>[Gi.state,Iae,le.contentAttributes.compute([i],e=>{let t=e.facet(i);return t&&t.name?{"data-language":t.name}:{}})]});class qa{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}class N{constructor(e,t,n,r,s,o=void 0){this.name=e,this.alias=t,this.extensions=n,this.filename=r,this.loadFunc=s,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:n}=e;if(!t){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(n)}return new N(e.name,(e.alias||[]).concat(e.name).map(r=>r.toLowerCase()),e.extensions||[],e.filename,t,n)}static matchFilename(e,t){for(let r of e)if(r.filename&&r.filename.test(t))return r;let n=/\.([^.]+)$/.exec(t);if(n){for(let r of e)if(r.extensions.indexOf(n[1])>-1)return r}return null}static matchLanguageName(e,t,n=!0){t=t.toLowerCase();for(let r of e)if(r.alias.some(s=>s==t))return r;if(n)for(let r of e)for(let s of r.alias){let o=t.indexOf(s);if(o>-1&&(s.length>2||!/\w/.test(t[o-1])&&!/\w/.test(t[o+s.length])))return r}return null}}const Dae=de.define(),pl=de.define({combine:i=>{if(!i.length)return"  ";let e=i[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return e}});function yo(i){let e=i.facet(pl);return e.charCodeAt(0)==9?i.tabSize*e.length:e.length}function Ud(i,e){let t="",n=i.tabSize,r=i.facet(pl)[0];if(r=="	"){for(;e>=n;)t+="	",e-=n;r=" "}for(let s=0;s<e;s++)t+=r;return t}function d$(i,e){i instanceof Be&&(i=new Fp(i));for(let n of i.state.facet(Dae)){let r=n(i,e);if(r!==void 0)return r}let t=bt(i.state);return t.length>=e?$ae(i,t,e):null}class Fp{constructor(e,t={}){this.state=e,this.options=t,this.unit=yo(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=n.from&&r<=n.to?s&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(e,t);return n.slice(e-r,Math.min(n.length,e+100-r))}column(e,t=1){let{text:n,from:r}=this.lineAt(e,t),s=this.countColumn(n,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e,t=e.length){return Nr(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:r}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const gl=new Te;function $ae(i,e,t){let n=e.resolveStack(t),r=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(r!=n.node){let s=[];for(let o=r;o&&!(o.from==n.node.from&&o.type==n.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)n={node:s[o],next:n}}return p$(n,i,t)}function p$(i,e,t){for(let n=i;n;n=n.next){let r=Fae(n.node);if(r)return r(eb.create(e,t,n))}return 0}function Mae(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function Fae(i){let e=i.type.prop(gl);if(e)return e;let t=i.firstChild,n;if(t&&(n=t.type.prop(Te.closedBy))){let r=i.lastChild,s=r&&n.indexOf(r.name)>-1;return o=>g$(o,!0,1,void 0,s&&!Mae(o)?r.from:void 0)}return i.parent==null?Nae:null}function Nae(){return 0}class eb extends Fp{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new eb(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(Qae(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return p$(this.context.next,this.base,this.pos)}}function Qae(i,e){for(let t=e;t;t=t.parent)if(i==t)return!0;return!1}function Bae(i){let e=i.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let r=i.options.simulateBreak,s=i.state.doc.lineAt(t.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let a=t.to;;){let l=e.childAfter(a);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let u=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+u}}a=l.to}}function Uae({closing:i,align:e=!0,units:t=1}){return n=>g$(n,e,t,i)}function g$(i,e,t,n,r){let s=i.textAfter,o=s.match(/^\s*/)[0].length,a=n&&s.slice(o,o+n.length)==n||r==i.pos+o,l=e?Bae(i):null;return l?a?i.column(l.from):i.column(l.to):i.baseIndent+(a?0:i.unit*t)}const Vae=i=>i.baseIndent;function Mf({except:i,units:e=1}={}){return t=>{let n=i&&i.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const Zae=de.define(),Cc=new Te;function m$(i){let e=i.firstChild,t=i.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?i.to:t.from}:null}class ml{constructor(e,t){this.specs=e;let n;function r(a){let l=_s.newName();return(n||(n=Object.create(null)))["."+l]=a,l}const s=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,o=t.scope;this.scope=o instanceof Gi?a=>a.prop(vs)==o.data:o?a=>a==o:void 0,this.style=h$(e.map(a=>({tag:a.tag,class:a.class||r(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=n?new _s(n):null,this.themeType=t.themeType}static define(e,t){return new ml(e,t||{})}}const wO=de.define(),jae=de.define({combine(i){return i.length?[i[0]]:null}});function om(i){let e=i.facet(wO);return e.length?e:i.facet(jae)}function v$(i,e){let t=[Hae],n;return i instanceof ml&&(i.module&&t.push(le.styleModule.of(i.module)),n=i.themeType),n?t.push(wO.computeN([le.darkTheme],r=>r.facet(le.darkTheme)==(n=="dark")?[i]:[])):t.push(wO.of(i)),t}class Gae{constructor(e){this.markCache=Object.create(null),this.tree=bt(e.state),this.decorations=this.buildDeco(e,om(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=bt(e.state),n=om(e.state),r=n!=om(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!r&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return qe.none;let n=new Ua;for(let{from:r,to:s}of e.visibleRanges)Aae(this.tree,t,(o,a,l)=>{n.add(o,a,this.markCache[l]||(this.markCache[l]=qe.mark({class:l})))},r,s);return n.finish()}}const Hae=Vr.high(zi.fromClass(Gae,{decorations:i=>i.decorations}));w.meta,w.link,w.heading,w.emphasis,w.strong,w.strikethrough,w.keyword,w.atom,w.bool,w.url,w.contentSeparator,w.labelName,w.literal,w.inserted,w.string,w.deleted,w.regexp,w.escape,w.string,w.variableName,w.variableName,w.typeName,w.namespace,w.className,w.variableName,w.macroName,w.propertyName,w.comment,w.invalid;const Xae=1e4,zae="()[]{}",O$=new Te;function _O(i,e,t){let n=i.prop(e<0?Te.openedBy:Te.closedBy);if(n)return n;if(i.name.length==1){let r=t.indexOf(i.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function CO(i){let e=i.type.prop(O$);return e?e(i.node):i}function pa(i,e,t,n={}){let r=n.maxScanDistance||Xae,s=n.brackets||zae,o=bt(i),a=o.resolveInner(e,t);for(let l=a;l;l=l.parent){let u=_O(l.type,t,s);if(u&&l.from<l.to){let c=CO(l);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return Wae(i,e,t,l,c,u,s)}}return qae(i,e,t,o,a.type,r,s)}function Wae(i,e,t,n,r,s,o){let a=n.parent,l={from:r.from,to:r.to},u=0,c=a==null?void 0:a.cursor();if(c&&(t<0?c.childBefore(n.from):c.childAfter(n.to)))do if(t<0?c.to<=n.from:c.from>=n.to){if(u==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let h=CO(c);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(_O(c.type,t,o))u++;else if(_O(c.type,-t,o)){if(u==0){let h=CO(c);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}u--}}while(t<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function qae(i,e,t,n,r,s,o){let a=t<0?i.sliceDoc(e-1,e):i.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=t>0)return null;let u={from:t<0?e-1:e,to:t>0?e+1:e},c=i.doc.iterRange(e,t>0?i.doc.length:0),h=0;for(let f=0;!c.next().done&&f<=s;){let d=c.value;t<0&&(f+=d.length);let p=e+f*t;for(let g=t>0?0:d.length-1,m=t>0?d.length:-1;g!=m;g+=t){let v=o.indexOf(d[g]);if(!(v<0||n.resolveInner(p+g,1).type!=r))if(v%2==0==t>0)h++;else{if(h==1)return{start:u,end:{from:p+g,to:p+g+1},matched:v>>1==l>>1};h--}}t>0&&(f+=d.length)}return c.done?{start:u,matched:!1}:null}function tC(i,e,t,n=0,r=0){e==null&&(e=i.search(/[^\s\u00a0]/),e==-1&&(e=i.length));let s=r;for(let o=n;o<e;o++)i.charCodeAt(o)==9?s+=t-s%t:s++;return s}class y${constructor(e,t,n,r){this.string=e,this.tabSize=t,this.indentUnit=n,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),n;if(typeof e=="string"?n=t==e:n=t&&(e instanceof RegExp?e.test(t):e(t)),n)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=tC(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:tC(this.string,null,this.tabSize)}match(e,t,n){if(typeof e=="string"){let r=o=>n?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function Yae(i){return{name:i.name||"",token:i.token,blankLine:i.blankLine||(()=>{}),startState:i.startState||(()=>!0),copyState:i.copyState||Kae,indent:i.indent||(()=>null),languageData:i.languageData||{},tokenTable:i.tokenTable||nb}}function Kae(i){if(typeof i!="object")return i;let e={};for(let t in i){let n=i[t];e[t]=n instanceof Array?n.slice():n}return e}const iC=new WeakMap;class tb extends Gi{constructor(e){let t=Mp(e.languageData),n=Yae(e),r,s=new class extends $p{createParse(o,a,l){return new ele(r,o,a,l)}};super(t,s,[],e.name),this.topNode=nle(t,this),r=this,this.streamParser=n,this.stateAfter=new Te({perNode:!0}),this.tokenTable=e.tokenTable?new k$(n.tokenTable):ile}static define(e){return new tb(e)}getIndent(e){let t,{overrideIndentation:n}=e.options;n&&(t=iC.get(e.state),t!=null&&t<e.pos-1e4&&(t=void 0));let r=ib(this,e.node.tree,e.node.from,e.node.from,t??e.pos),s,o;if(r?(o=r.state,s=r.pos+1):(o=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(;s<e.pos;){let l=e.state.doc.lineAt(s),u=Math.min(e.pos,l.to);if(l.length){let c=n?n(l.from):-1,h=new y$(l.text,e.state.tabSize,e.unit,c<0?void 0:c);for(;h.pos<u-l.from;)x$(this.streamParser.token,h,o)}else this.streamParser.blankLine(o,e.unit);if(u==e.pos)break;s=l.to+1}let a=e.lineAt(e.pos);return n&&t==null&&iC.set(e.state,a.from),this.streamParser.indent(o,/^\s*(.*)/.exec(a.text)[1],e)}get allowsNesting(){return!1}}function ib(i,e,t,n,r){let s=t>=n&&t+e.length<=r&&e.prop(i.stateAfter);if(s)return{state:i.streamParser.copyState(s),pos:t+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=t+e.positions[o],u=a instanceof Ie&&l<r&&ib(i,a,l,n,r);if(u)return u}return null}function b$(i,e,t,n,r){if(r&&t<=0&&n>=e.length)return e;!r&&t==0&&e.type==i.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],a=e.children[s],l;if(o<n&&a instanceof Ie){if(!(l=b$(i,a,t-o,n-o,r)))break;return r?new Ie(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}function Jae(i,e,t,n,r){for(let s of e){let o=s.from+(s.openStart?25:0),a=s.to-(s.openEnd?25:0),l=o<=t&&a>t&&ib(i,s.tree,0-s.offset,t,a),u;if(l&&l.pos<=n&&(u=b$(i,s.tree,t+s.offset,l.pos+s.offset,!1)))return{state:l.state,tree:u}}return{state:i.streamParser.startState(r?yo(r):4),tree:Ie.empty}}let ele=class{constructor(e,t,n,r){this.lang=e,this.input=t,this.fragments=n,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=Oo.get(),o=r[0].from,{state:a,tree:l}=Jae(e,n,o,this.to,s==null?void 0:s.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let u=0;u<l.children.length;u++)this.chunks.push(l.children[u]),this.chunkPos.push(l.positions[u]);s&&this.parsedPos<s.viewport.from-1e5&&r.some(u=>u.from<=s.viewport.from&&u.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(yo(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=Oo.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(t,this.chunkStart+2048);for(e&&(n=Math.min(n,e.viewport.to));this.parsedPos<n;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let n=t.indexOf(`
`);n>-1&&(t=t.slice(0,n))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),n=e+t.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=n||(t=t.slice(0,s-(n-t.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,a=this.lineAfter(o);t+=a,n=o+a.length}return{line:t,end:n}}skipGapsTo(e,t,n){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+t;if(n>0?r>s:r>=s)break;let o=this.ranges[++this.rangeIndex].from;t+=o-r}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,n,r){let s=4;if(this.ranges.length>1){r=this.skipGapsTo(t,r,1),t+=r;let a=this.chunk.length;r=this.skipGapsTo(n,r,-1),n+=r,s+=this.chunk.length-a}let o=this.chunk.length-4;return s==4&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==t?this.chunk[o+2]=n:this.chunk.push(e,t,n,s),r}parseLine(e){let{line:t,end:n}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new y$(t,e?e.state.tabSize:4,e?yo(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=x$(s.token,o,this.state);if(a&&(r=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,r)),o.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Ie.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:tle,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Ie(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Ie(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function x$(i,e,t){e.start=e.pos;for(let n=0;n<10;n++){let r=i(e,t);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const nb=Object.create(null),Zu=[Pt.none],tle=new fl(Zu),nC=[],rC=Object.create(null),S$=Object.create(null);for(let[i,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])S$[i]=T$(nb,e);class k${constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),S$)}resolve(e){return e?this.table[e]||(this.table[e]=T$(this.extra,e)):0}}const ile=new k$(nb);function am(i,e){nC.indexOf(i)>-1||(nC.push(i),console.warn(e))}function T$(i,e){let t=[];for(let a of e.split(" ")){let l=[];for(let u of a.split(".")){let c=i[u]||w[u];c?typeof c=="function"?l.length?l=l.map(c):am(u,`Modifier ${u} used at start of tag`):l.length?am(u,`Tag ${u} used as modifier`):l=Array.isArray(c)?c:[c]:am(u,`Unknown highlighting tag ${u}`)}for(let u of l)t.push(u)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),r=n+" "+t.map(a=>a.id),s=rC[r];if(s)return s.id;let o=rC[r]=Pt.define({id:Zu.length,name:n,props:[dl({[n]:t})]});return Zu.push(o),o.id}function nle(i,e){let t=Pt.define({id:Zu.length,name:"Document",props:[vs.add(()=>i),gl.add(()=>n=>e.getIndent(n))],top:!0});return Zu.push(t),t}Ot.RTL,Ot.LTR;const rle=i=>{let{state:e}=i,t=e.doc.lineAt(e.selection.main.from),n=sb(i.state,t.from);return n.line?sle(i):n.block?ale(i):!1};function rb(i,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let r=i(e,t);return r?(n(t.update(r)),!0):!1}}const sle=rb(cle,0),ole=rb(E$,0),ale=rb((i,e)=>E$(i,e,ule(e)),0);function sb(i,e){let t=i.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const Fl=50;function lle(i,{open:e,close:t},n,r){let s=i.sliceDoc(n-Fl,n),o=i.sliceDoc(r,r+Fl),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,u=s.length-a;if(s.slice(u-e.length,u)==e&&o.slice(l,l+t.length)==t)return{open:{pos:n-a,margin:a&&1},close:{pos:r+l,margin:l&&1}};let c,h;r-n<=2*Fl?c=h=i.sliceDoc(n,r):(c=i.sliceDoc(n,n+Fl),h=i.sliceDoc(r-Fl,r));let f=/^\s*/.exec(c)[0].length,d=/\s*$/.exec(h)[0].length,p=h.length-d-t.length;return c.slice(f,f+e.length)==e&&h.slice(p,p+t.length)==t?{open:{pos:n+f+e.length,margin:/\s/.test(c.charAt(f+e.length))?1:0},close:{pos:r-d-t.length,margin:/\s/.test(h.charAt(p-1))?1:0}}:null}function ule(i){let e=[];for(let t of i.selection.ranges){let n=i.doc.lineAt(t.from),r=t.to<=n.to?n:i.doc.lineAt(t.to);r.from>n.from&&r.from==t.to&&(r=t.to==n.to+1?n:i.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=r.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:r.to})}return e}function E$(i,e,t=e.selection.ranges){let n=t.map(s=>sb(e,s.from).block);if(!n.every(s=>s))return null;let r=t.map((s,o)=>lle(e,n[o],s.from,s.to));if(i!=2&&!r.every(s=>s))return{changes:e.changes(t.map((s,o)=>r[o]?[]:[{from:s.from,insert:n[o].open+" "},{from:s.to,insert:" "+n[o].close}]))};if(i!=1&&r.some(s=>s)){let s=[];for(let o=0,a;o<r.length;o++)if(a=r[o]){let l=n[o],{open:u,close:c}=a;s.push({from:u.pos-l.open.length,to:u.pos+u.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function cle(i,e,t=e.selection.ranges){let n=[],r=-1;for(let{from:s,to:o}of t){let a=n.length,l=1e9,u=sb(e,s).line;if(u){for(let c=s;c<=o;){let h=e.doc.lineAt(c);if(h.from>r&&(s==o||o>h.from)){r=h.from;let f=/^\s*/.exec(h.text)[0].length,d=f==h.length,p=h.text.slice(f,f+u.length)==u?f:-1;f<h.text.length&&f<l&&(l=f),n.push({line:h,comment:p,token:u,indent:f,empty:d,single:!1})}c=h.to+1}if(l<1e9)for(let c=a;c<n.length;c++)n[c].indent<n[c].line.text.length&&(n[c].indent=l);n.length==a+1&&(n[a].single=!0)}}if(i!=2&&n.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:u,empty:c,single:h}of n)(h||!c)&&s.push({from:a.from+u,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(i!=1&&n.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of n)if(a>=0){let u=o.from+a,c=u+l.length;o.text[c-o.from]==" "&&c++,s.push({from:u,to:c})}return{changes:s}}return null}const AO=Zr.define(),hle=Zr.define(),fle=de.define(),w$=de.define({combine(i){return Lp(i,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,r)=>e(n,r)||t(n,r)})}}),_$=yn.define({create(){return fr.empty},update(i,e){let t=e.state.facet(w$),n=e.annotation(AO);if(n){let l=Ti.fromTransaction(e,n.selection),u=n.side,c=u==0?i.undone:i.done;return l?c=Zd(c,c.length,t.minDepth,l):c=A$(c,e.startState.selection),new fr(u==0?n.rest:c,u==0?c:n.rest)}let r=e.annotation(hle);if((r=="full"||r=="before")&&(i=i.isolate()),e.annotation(_t.addToHistory)===!1)return e.changes.empty?i:i.addMapping(e.changes.desc);let s=Ti.fromTransaction(e),o=e.annotation(_t.time),a=e.annotation(_t.userEvent);return s?i=i.addChanges(s,o,a,t,e):e.selection&&(i=i.addSelection(e.startState.selection,o,a,t.newGroupDelay)),(r=="full"||r=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(e=>e.toJSON()),undone:i.undone.map(e=>e.toJSON())}},fromJSON(i){return new fr(i.done.map(Ti.fromJSON),i.undone.map(Ti.fromJSON))}});function sC(i={}){return[_$,w$.of(i),le.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?ob:e.inputType=="historyRedo"?Vd:null;return n?(e.preventDefault(),n(t)):!1}})]}function Np(i,e){return function({state:t,dispatch:n}){if(!e&&t.readOnly)return!1;let r=t.field(_$,!1);if(!r)return!1;let s=r.pop(i,t,e);return s?(n(s),!0):!1}}const ob=Np(0,!1),Vd=Np(1,!1),dle=Np(0,!0),ple=Np(1,!0);class Ti{constructor(e,t,n,r,s){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new Ti(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new Ti(e.changes&&Mt.fromJSON(e.changes),[],e.mapped&&gr.fromJSON(e.mapped),e.startSelection&&G.fromJSON(e.startSelection),e.selectionsAfter.map(G.fromJSON))}static fromTransaction(e,t){let n=ln;for(let r of e.startState.facet(fle)){let s=r(e);s.length&&(n=n.concat(s))}return!n.length&&e.changes.empty?null:new Ti(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,ln)}static selection(e){return new Ti(void 0,ln,void 0,void 0,e)}}function Zd(i,e,t,n){let r=e+1>t+20?e-t-1:0,s=i.slice(r,e);return s.push(n),s}function gle(i,e){let t=[],n=!1;return i.iterChangedRanges((r,s)=>t.push(r,s)),e.iterChangedRanges((r,s,o,a)=>{for(let l=0;l<t.length;){let u=t[l++],c=t[l++];a>=u&&o<=c&&(n=!0)}}),n}function mle(i,e){return i.ranges.length==e.ranges.length&&i.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length===0}function C$(i,e){return i.length?e.length?i.concat(e):i:e}const ln=[],vle=200;function A$(i,e){if(i.length){let t=i[i.length-1],n=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-vle));return n.length&&n[n.length-1].eq(e)?i:(n.push(e),Zd(i,i.length-1,1e9,t.setSelAfter(n)))}else return[Ti.selection([e])]}function Ole(i){let e=i[i.length-1],t=i.slice();return t[i.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function lm(i,e){if(!i.length)return i;let t=i.length,n=ln;for(;t;){let r=yle(i[t-1],e,n);if(r.changes&&!r.changes.empty||r.effects.length){let s=i.slice(0,t);return s[t-1]=r,s}else e=r.mapped,t--,n=r.selectionsAfter}return n.length?[Ti.selection(n)]:ln}function yle(i,e,t){let n=C$(i.selectionsAfter.length?i.selectionsAfter.map(a=>a.map(e)):ln,t);if(!i.changes)return Ti.selection(n);let r=i.changes.map(e),s=e.mapDesc(i.changes,!0),o=i.mapped?i.mapped.composeDesc(s):s;return new Ti(r,Ve.mapEffects(i.effects,e),o,i.startSelection.map(s),n)}const ble=/^(input\.type|delete)($|\.)/;class fr{constructor(e,t,n=0,r=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=r}isolate(){return this.prevTime?new fr(this.done,this.undone):this}addChanges(e,t,n,r,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!n||ble.test(n))&&(!a.selectionsAfter.length&&t-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,gle(a.changes,e.changes))||n=="input.type.compose")?o=Zd(o,o.length-1,r.minDepth,new Ti(e.changes.compose(a.changes),C$(Ve.mapEffects(e.effects,a.changes),a.effects),a.mapped,a.startSelection,ln)):o=Zd(o,o.length,r.minDepth,e),new fr(o,ln,t,n)}addSelection(e,t,n,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:ln;return s.length>0&&t-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&mle(s[s.length-1],e)?this:new fr(A$(this.done,e),this.undone,t,n)}addMapping(e){return new fr(lm(this.done,e),lm(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1],o=s.selectionsAfter[0]||t.selection;if(n&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:AO.of({side:e,rest:Ole(r),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let a=r.length==1?ln:r.slice(0,r.length-1);return s.mapped&&(a=lm(a,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:AO.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}fr.empty=new fr(ln,ln);const xle=[{key:"Mod-z",run:ob,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Vd,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Vd,preventDefault:!0},{key:"Mod-u",run:dle,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:ple,preventDefault:!0}];function vl(i,e){return G.create(i.ranges.map(e),i.mainIndex)}function kr(i,e){return i.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Xn({state:i,dispatch:e},t){let n=vl(i.selection,t);return n.eq(i.selection,!0)?!1:(e(kr(i,n)),!0)}function Qp(i,e){return G.cursor(e?i.to:i.from)}function P$(i,e){return Xn(i,t=>t.empty?i.moveByChar(t,e):Qp(t,e))}function oi(i){return i.textDirectionAt(i.state.selection.main.head)==Ot.LTR}const R$=i=>P$(i,!oi(i)),L$=i=>P$(i,oi(i));function I$(i,e){return Xn(i,t=>t.empty?i.moveByGroup(t,e):Qp(t,e))}const Sle=i=>I$(i,!oi(i)),kle=i=>I$(i,oi(i));function Tle(i,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(i.sliceDoc(e.from,e.to)))||e.firstChild}function Bp(i,e,t){let n=bt(i).resolveInner(e.head),r=t?Te.closedBy:Te.openedBy;for(let l=e.head;;){let u=t?n.childAfter(l):n.childBefore(l);if(!u)break;Tle(i,u,r)?n=u:l=t?u.to:u.from}let s=n.type.prop(r),o,a;return s&&(o=t?pa(i,n.from,1):pa(i,n.to,-1))&&o.matched?a=t?o.end.to:o.end.from:a=t?n.to:n.from,G.cursor(a,t?-1:1)}const Ele=i=>Xn(i,e=>Bp(i.state,e,!oi(i))),wle=i=>Xn(i,e=>Bp(i.state,e,oi(i)));function D$(i,e){return Xn(i,t=>{if(!t.empty)return Qp(t,e);let n=i.moveVertically(t,e);return n.head!=t.head?n:i.moveToLineBoundary(t,e)})}const $$=i=>D$(i,!1),M$=i=>D$(i,!0);function F$(i){let e=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,t=0,n=0,r;if(e){for(let s of i.state.facet(le.scrollMargins)){let o=s(i);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(n=Math.max(o==null?void 0:o.bottom,n))}r=i.scrollDOM.clientHeight-t-n}else r=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(i.defaultLineHeight,r-5)}}function N$(i,e){let t=F$(i),{state:n}=i,r=vl(n.selection,o=>o.empty?i.moveVertically(o,e,t.height):Qp(o,e));if(r.eq(n.selection))return!1;let s;if(t.selfScroll){let o=i.coordsAtPos(n.selection.main.head),a=i.scrollDOM.getBoundingClientRect(),l=a.top+t.marginTop,u=a.bottom-t.marginBottom;o&&o.top>l&&o.bottom<u&&(s=le.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-l}))}return i.dispatch(kr(n,r),{effects:s}),!0}const oC=i=>N$(i,!1),PO=i=>N$(i,!0);function Ns(i,e,t){let n=i.lineBlockAt(e.head),r=i.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?n.to:n.from)&&(r=i.moveToLineBoundary(e,t,!1)),!t&&r.head==n.from&&n.length){let s=/^\s*/.exec(i.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;s&&e.head!=n.from+s&&(r=G.cursor(n.from+s))}return r}const _le=i=>Xn(i,e=>Ns(i,e,!0)),Cle=i=>Xn(i,e=>Ns(i,e,!1)),Ale=i=>Xn(i,e=>Ns(i,e,!oi(i))),Ple=i=>Xn(i,e=>Ns(i,e,oi(i))),Rle=i=>Xn(i,e=>G.cursor(i.lineBlockAt(e.head).from,1)),Lle=i=>Xn(i,e=>G.cursor(i.lineBlockAt(e.head).to,-1));function Ile(i,e,t){let n=!1,r=vl(i.selection,s=>{let o=pa(i,s.head,-1)||pa(i,s.head,1)||s.head>0&&pa(i,s.head-1,1)||s.head<i.doc.length&&pa(i,s.head+1,-1);if(!o||!o.end)return s;n=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return G.cursor(a)});return n?(e(kr(i,r)),!0):!1}const Dle=({state:i,dispatch:e})=>Ile(i,e);function bn(i,e){let t=vl(i.state.selection,n=>{let r=e(n);return G.range(n.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return t.eq(i.state.selection)?!1:(i.dispatch(kr(i.state,t)),!0)}function Q$(i,e){return bn(i,t=>i.moveByChar(t,e))}const B$=i=>Q$(i,!oi(i)),U$=i=>Q$(i,oi(i));function V$(i,e){return bn(i,t=>i.moveByGroup(t,e))}const $le=i=>V$(i,!oi(i)),Mle=i=>V$(i,oi(i)),Fle=i=>bn(i,e=>Bp(i.state,e,!oi(i))),Nle=i=>bn(i,e=>Bp(i.state,e,oi(i)));function Z$(i,e){return bn(i,t=>i.moveVertically(t,e))}const j$=i=>Z$(i,!1),G$=i=>Z$(i,!0);function H$(i,e){return bn(i,t=>i.moveVertically(t,e,F$(i).height))}const aC=i=>H$(i,!1),lC=i=>H$(i,!0),Qle=i=>bn(i,e=>Ns(i,e,!0)),Ble=i=>bn(i,e=>Ns(i,e,!1)),Ule=i=>bn(i,e=>Ns(i,e,!oi(i))),Vle=i=>bn(i,e=>Ns(i,e,oi(i))),Zle=i=>bn(i,e=>G.cursor(i.lineBlockAt(e.head).from)),jle=i=>bn(i,e=>G.cursor(i.lineBlockAt(e.head).to)),uC=({state:i,dispatch:e})=>(e(kr(i,{anchor:0})),!0),cC=({state:i,dispatch:e})=>(e(kr(i,{anchor:i.doc.length})),!0),hC=({state:i,dispatch:e})=>(e(kr(i,{anchor:i.selection.main.anchor,head:0})),!0),fC=({state:i,dispatch:e})=>(e(kr(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),Gle=({state:i,dispatch:e})=>(e(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),Hle=({state:i,dispatch:e})=>{let t=Up(i).map(({from:n,to:r})=>G.range(n,Math.min(r+1,i.doc.length)));return e(i.update({selection:G.create(t),userEvent:"select"})),!0},Xle=({state:i,dispatch:e})=>{let t=vl(i.selection,n=>{let r=bt(i),s=r.resolveStack(n.from,1);if(n.empty){let o=r.resolveStack(n.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:a}=o;if((a.from<n.from&&a.to>=n.to||a.to>n.to&&a.from<=n.from)&&o.next)return G.range(a.to,a.from)}return n});return t.eq(i.selection)?!1:(e(kr(i,t)),!0)},zle=({state:i,dispatch:e})=>{let t=i.selection,n=null;return t.ranges.length>1?n=G.create([t.main]):t.main.empty||(n=G.create([G.cursor(t.main.head)])),n?(e(kr(i,n)),!0):!1};function Ac(i,e){if(i.state.readOnly)return!1;let t="delete.selection",{state:n}=i,r=n.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(s);l<o?(t="delete.backward",l=jh(i,l,!1)):l>o&&(t="delete.forward",l=jh(i,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=jh(i,o,!1),a=jh(i,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:G.cursor(o,o<s.head?-1:1)}});return r.changes.empty?!1:(i.dispatch(n.update(r,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?le.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function jh(i,e,t){if(i instanceof le)for(let n of i.state.facet(le.atomicRanges).map(r=>r(i)))n.between(e,e,(r,s)=>{r<e&&s>e&&(e=t?s:r)});return e}const X$=(i,e,t)=>Ac(i,n=>{let r=n.from,{state:s}=i,o=s.doc.lineAt(r),a,l;if(t&&!e&&r>o.from&&r<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,r-o.from))){if(a[a.length-1]=="	")return r-1;let u=Nr(a,s.tabSize),c=u%yo(s)||yo(s);for(let h=0;h<c&&a[a.length-1-h]==" ";h++)r--;l=r}else l=qt(o.text,r-o.from,e,e)+o.from,l==r&&o.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,r-o.from))&&(l=qt(o.text,l-o.from,!1,!1)+o.from);return l}),RO=i=>X$(i,!1,!0),z$=i=>X$(i,!0,!1),W$=(i,e)=>Ac(i,t=>{let n=t.head,{state:r}=i,s=r.doc.lineAt(n),o=r.charCategorizer(n);for(let a=null;;){if(n==(e?s.to:s.from)){n==t.head&&s.number!=(e?r.doc.lines:1)&&(n+=e?1:-1);break}let l=qt(s.text,n-s.from,e)+s.from,u=s.text.slice(Math.min(n,l)-s.from,Math.max(n,l)-s.from),c=o(u);if(a!=null&&c!=a)break;(u!=" "||n!=t.head)&&(a=c),n=l}return n}),q$=i=>W$(i,!1),Wle=i=>W$(i,!0),qle=i=>Ac(i,e=>{let t=i.lineBlockAt(e.head).to;return e.head<t?t:Math.min(i.state.doc.length,e.head+1)}),Yle=i=>Ac(i,e=>{let t=i.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),Kle=i=>Ac(i,e=>{let t=i.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(i.state.doc.length,e.head+1)}),Jle=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:Ue.of(["",""])},range:G.cursor(n.from)}));return e(i.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},eue=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>{if(!n.empty||n.from==0||n.from==i.doc.length)return{range:n};let r=n.from,s=i.doc.lineAt(r),o=r==s.from?r-1:qt(s.text,r-s.from,!1)+s.from,a=r==s.to?r+1:qt(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:i.doc.slice(r,a).append(i.doc.slice(o,r))},range:G.cursor(a)}});return t.changes.empty?!1:(e(i.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Up(i){let e=[],t=-1;for(let n of i.selection.ranges){let r=i.doc.lineAt(n.from),s=i.doc.lineAt(n.to);if(!n.empty&&n.to==s.from&&(s=i.doc.lineAt(n.to-1)),t>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(n)}else e.push({from:r.from,to:s.to,ranges:[n]});t=s.number+1}return e}function Y$(i,e,t){if(i.readOnly)return!1;let n=[],r=[];for(let s of Up(i)){if(t?s.to==i.doc.length:s.from==0)continue;let o=i.doc.lineAt(t?s.to+1:s.from-1),a=o.length+1;if(t){n.push({from:s.to,to:o.to},{from:s.from,insert:o.text+i.lineBreak});for(let l of s.ranges)r.push(G.range(Math.min(i.doc.length,l.anchor+a),Math.min(i.doc.length,l.head+a)))}else{n.push({from:o.from,to:s.from},{from:s.to,insert:i.lineBreak+o.text});for(let l of s.ranges)r.push(G.range(l.anchor-a,l.head-a))}}return n.length?(e(i.update({changes:n,scrollIntoView:!0,selection:G.create(r,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const tue=({state:i,dispatch:e})=>Y$(i,e,!1),iue=({state:i,dispatch:e})=>Y$(i,e,!0);function K$(i,e,t){if(i.readOnly)return!1;let n=[];for(let r of Up(i))t?n.push({from:r.from,insert:i.doc.slice(r.from,r.to)+i.lineBreak}):n.push({from:r.to,insert:i.lineBreak+i.doc.slice(r.from,r.to)});return e(i.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const nue=({state:i,dispatch:e})=>K$(i,e,!1),rue=({state:i,dispatch:e})=>K$(i,e,!0),J$=i=>{if(i.state.readOnly)return!1;let{state:e}=i,t=e.changes(Up(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),n=vl(e.selection,r=>{let s;if(i.lineWrapping){let o=i.lineBlockAt(r.head),a=i.coordsAtPos(r.head,r.assoc||1);a&&(s=o.bottom+i.documentTop-a.bottom+i.defaultLineHeight/2)}return i.moveVertically(r,!0,s)}).map(t);return i.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function sue(i,e){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=bt(i).resolveInner(e),n=t.childBefore(e),r=t.childAfter(e),s;return n&&r&&n.to<=e&&r.from>=e&&(s=n.type.prop(Te.closedBy))&&s.indexOf(r.name)>-1&&i.doc.lineAt(n.to).from==i.doc.lineAt(r.from).from&&!/\S/.test(i.sliceDoc(n.to,r.from))?{from:n.to,to:r.from}:null}const dC=e3(!1),oue=e3(!0);function e3(i){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(r=>{let{from:s,to:o}=r,a=e.doc.lineAt(s),l=!i&&s==o&&sue(e,s);i&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let u=new Fp(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=d$(u,s);for(c==null&&(c=Nr(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let h=["",Ud(e,c)];return l&&h.push(Ud(e,u.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:Ue.of(h)},range:G.cursor(s+1+h[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function ab(i,e){let t=-1;return i.changeByRange(n=>{let r=[];for(let o=n.from;o<=n.to;){let a=i.doc.lineAt(o);a.number>t&&(n.empty||n.to>a.from)&&(e(a,r,n),t=a.number),o=a.to+1}let s=i.changes(r);return{changes:r,range:G.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}const aue=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=Object.create(null),n=new Fp(i,{overrideIndentation:s=>{let o=t[s];return o??-1}}),r=ab(i,(s,o,a)=>{let l=d$(n,s.from);if(l==null)return;/\S/.test(s.text)||(l=0);let u=/^\s*/.exec(s.text)[0],c=Ud(i,l);(u!=c||a.from<s.from+u.length)&&(t[s.from]=l,o.push({from:s.from,to:s.from+u.length,insert:c}))});return r.changes.empty||e(i.update(r,{userEvent:"indent"})),!0},t3=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(ab(i,(t,n)=>{n.push({from:t.from,insert:i.facet(pl)})}),{userEvent:"input.indent"})),!0),i3=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(ab(i,(t,n)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let s=Nr(r,i.tabSize),o=0,a=Ud(i,Math.max(0,s-yo(i)));for(;o<r.length&&o<a.length&&r.charCodeAt(o)==a.charCodeAt(o);)o++;n.push({from:t.from+o,to:t.from+r.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),lue=i=>(i.setTabFocusMode(),!0),uue=[{key:"Ctrl-b",run:R$,shift:B$,preventDefault:!0},{key:"Ctrl-f",run:L$,shift:U$},{key:"Ctrl-p",run:$$,shift:j$},{key:"Ctrl-n",run:M$,shift:G$},{key:"Ctrl-a",run:Rle,shift:Zle},{key:"Ctrl-e",run:Lle,shift:jle},{key:"Ctrl-d",run:z$},{key:"Ctrl-h",run:RO},{key:"Ctrl-k",run:qle},{key:"Ctrl-Alt-h",run:q$},{key:"Ctrl-o",run:Jle},{key:"Ctrl-t",run:eue},{key:"Ctrl-v",run:PO}],cue=[{key:"ArrowLeft",run:R$,shift:B$,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Sle,shift:$le,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Ale,shift:Ule,preventDefault:!0},{key:"ArrowRight",run:L$,shift:U$,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:kle,shift:Mle,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Ple,shift:Vle,preventDefault:!0},{key:"ArrowUp",run:$$,shift:j$,preventDefault:!0},{mac:"Cmd-ArrowUp",run:uC,shift:hC},{mac:"Ctrl-ArrowUp",run:oC,shift:aC},{key:"ArrowDown",run:M$,shift:G$,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cC,shift:fC},{mac:"Ctrl-ArrowDown",run:PO,shift:lC},{key:"PageUp",run:oC,shift:aC},{key:"PageDown",run:PO,shift:lC},{key:"Home",run:Cle,shift:Ble,preventDefault:!0},{key:"Mod-Home",run:uC,shift:hC},{key:"End",run:_le,shift:Qle,preventDefault:!0},{key:"Mod-End",run:cC,shift:fC},{key:"Enter",run:dC,shift:dC},{key:"Mod-a",run:Gle},{key:"Backspace",run:RO,shift:RO},{key:"Delete",run:z$},{key:"Mod-Backspace",mac:"Alt-Backspace",run:q$},{key:"Mod-Delete",mac:"Alt-Delete",run:Wle},{mac:"Mod-Backspace",run:Yle},{mac:"Mod-Delete",run:Kle}].concat(uue.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),hue=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Ele,shift:Fle},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:wle,shift:Nle},{key:"Alt-ArrowUp",run:tue},{key:"Shift-Alt-ArrowUp",run:nue},{key:"Alt-ArrowDown",run:iue},{key:"Shift-Alt-ArrowDown",run:rue},{key:"Escape",run:zle},{key:"Mod-Enter",run:oue},{key:"Alt-l",mac:"Ctrl-l",run:Hle},{key:"Mod-i",run:Xle,preventDefault:!0},{key:"Mod-[",run:i3},{key:"Mod-]",run:t3},{key:"Mod-Alt-\\",run:aue},{key:"Shift-Mod-k",run:J$},{key:"Shift-Mod-\\",run:Dle},{key:"Mod-/",run:rle},{key:"Alt-A",run:ole},{key:"Ctrl-m",mac:"Shift-Alt-m",run:lue}].concat(cue),fue={key:"Tab",run:t3,shift:i3};function Ht(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];typeof r=="string"?i.setAttribute(n,r):r!=null&&(i[n]=r)}e++}for(;e<arguments.length;e++)n3(i,arguments[e]);return i}function n3(i,e){if(typeof e=="string")i.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)i.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)n3(i,e[t]);else throw new RangeError("Unsupported child node: "+e)}const pC=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i;class ju{constructor(e,t,n=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,r),this.bufferStart=n,this.normalize=s?a=>s(pC(a)):pC,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ss(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=QI(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Ys(e);let r=this.normalize(t);if(r.length)for(let s=0,o=n;;s++){let a=r.charCodeAt(s),l=this.match(a,o,this.bufferPos+this.bufferStart);if(s==r.length-1){if(l)return this.value=l,this;break}o==n&&s<t.length&&t.charCodeAt(s)==a&&o++}}}match(e,t,n){let r=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[s+1],to:n}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:t,to:n}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(ju.prototype[Symbol.iterator]=function(){return this});const r3={from:-1,to:-1,match:/.*/.exec("")},lb="gm"+(/x/.unicode==null?"":"u");class s3{constructor(e,t,n,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=r3,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new o3(e,t,n,r,s);this.re=new RegExp(t,lb+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=jd(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,r=n+t[0].length;if(this.matchPos=jd(this.text,r+(n==r?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const um=new WeakMap;class ka{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let r=um.get(e);if(!r||r.from>=n||r.to<=t){let a=new ka(t,e.sliceString(t,n));return um.set(e,a),a}if(r.from==t&&r.to==n)return r;let{text:s,from:o}=r;return o>t&&(s=e.sliceString(t,o)+s,o=t),r.to<n&&(s+=e.sliceString(r.to,n)),um.set(e,new ka(o,s)),new ka(t,s.slice(t-o,n-o))}}class o3{constructor(e,t,n,r,s){this.text=e,this.to=s,this.done=!1,this.value=r3,this.matchPos=jd(e,r),this.re=new RegExp(t,lb+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=ka.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,r=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this.matchPos=jd(this.text,r+(n==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=ka.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(s3.prototype[Symbol.iterator]=o3.prototype[Symbol.iterator]=function(){return this});function due(i){try{return new RegExp(i,lb),!0}catch{return!1}}function jd(i,e){if(e>=i.length)return e;let t=i.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}function LO(i){let e=String(i.state.doc.lineAt(i.state.selection.main.head).number),t=Ht("input",{class:"cm-textfield",name:"line",value:e}),n=Ht("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),i.dispatch({effects:vu.of(!1)}),i.focus()):s.keyCode==13&&(s.preventDefault(),r())},onsubmit:s=>{s.preventDefault(),r()}},Ht("label",i.state.phrase("Go to line"),": ",t)," ",Ht("button",{class:"cm-button",type:"submit"},i.state.phrase("go")),Ht("button",{name:"close",onclick:()=>{i.dispatch({effects:vu.of(!1)}),i.focus()},"aria-label":i.state.phrase("close"),type:"button"},[""]));function r(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:o}=i,a=o.doc.lineAt(o.selection.main.head),[,l,u,c,h]=s,f=c?+c.slice(1):0,d=u?+u:a.number;if(u&&h){let m=d/100;l&&(m=m*(l=="-"?-1:1)+a.number/o.doc.lines),d=Math.round(o.doc.lines*m)}else u&&l&&(d=d*(l=="-"?-1:1)+a.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,d))),g=G.cursor(p.from+Math.max(0,Math.min(f,p.length)));i.dispatch({effects:[vu.of(!1),le.scrollIntoView(g.from,{y:"center"})],selection:g}),i.focus()}return{dom:n}}const vu=Ve.define(),gC=yn.define({create(){return!0},update(i,e){for(let t of e.effects)t.is(vu)&&(i=t.value);return i},provide:i=>Fd.from(i,e=>e?LO:null)}),pue=i=>{let e=Md(i,LO);if(!e){let t=[vu.of(!0)];i.state.field(gC,!1)==null&&t.push(Ve.appendConfig.of([gC,gue])),i.dispatch({effects:t}),e=Md(i,LO)}return e&&e.dom.querySelector("input").select(),!0},gue=le.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),mue=({state:i,dispatch:e})=>{let{selection:t}=i,n=G.create(t.ranges.map(r=>i.wordAt(r.head)||G.cursor(r.head)),t.mainIndex);return n.eq(t)?!1:(e(i.update({selection:n})),!0)};function vue(i,e){let{main:t,ranges:n}=i.selection,r=i.wordAt(t.head),s=r&&r.from==t.from&&r.to==t.to;for(let o=!1,a=new ju(i.doc,e,n[n.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new ju(i.doc,e,0,Math.max(0,n[n.length-1].from-1)),o=!0}else{if(o&&n.some(l=>l.from==a.value.from))continue;if(s){let l=i.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const Oue=({state:i,dispatch:e})=>{let{ranges:t}=i.selection;if(t.some(s=>s.from===s.to))return mue({state:i,dispatch:e});let n=i.sliceDoc(t[0].from,t[0].to);if(i.selection.ranges.some(s=>i.sliceDoc(s.from,s.to)!=n))return!1;let r=vue(i,n);return r?(e(i.update({selection:i.selection.addRange(G.range(r.from,r.to),!1),effects:le.scrollIntoView(r.to)})),!0):!1},Ol=de.define({combine(i){return Lp(i,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Pue(e),scrollToMatch:e=>le.scrollIntoView(e)})}});class a3{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||due(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Sue(this):new bue(this)}getCursor(e,t=0,n){let r=e.doc?e:Be.create({doc:e});return n==null&&(n=r.doc.length),this.regexp?ra(this,r,t,n):na(this,r,t,n)}}class l3{constructor(e){this.spec=e}}function na(i,e,t,n){return new ju(e.doc,i.unquoted,t,n,i.caseSensitive?void 0:r=>r.toLowerCase(),i.wholeWord?yue(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function yue(i,e){return(t,n,r,s)=>((s>t||s+r.length<n)&&(s=Math.max(0,t-2),r=i.sliceString(s,Math.min(i.length,n+2))),(e(Gd(r,t-s))!=Yt.Word||e(Hd(r,t-s))!=Yt.Word)&&(e(Hd(r,n-s))!=Yt.Word||e(Gd(r,n-s))!=Yt.Word))}class bue extends l3{constructor(e){super(e)}nextMatch(e,t,n){let r=na(this.spec,e,n,e.doc.length).nextOverlapping();if(r.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);r=na(this.spec,e,0,s).nextOverlapping()}return r.done||r.value.from==t&&r.value.to==n?null:r.value}prevMatchInRange(e,t,n){for(let r=n;;){let s=Math.max(t,r-1e4-this.spec.unquoted.length),o=na(this.spec,e,s,r),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==t)return null;r-=1e4}}prevMatch(e,t,n){let r=this.prevMatchInRange(e,0,t);return r||(r=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),r&&(r.from!=t||r.to!=n)?r:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=na(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let s=na(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function ra(i,e,t,n){return new s3(e.doc,i.search,{ignoreCase:!i.caseSensitive,test:i.wholeWord?xue(e.charCategorizer(e.selection.main.head)):void 0},t,n)}function Gd(i,e){return i.slice(qt(i,e,!1),e)}function Hd(i,e){return i.slice(e,qt(i,e))}function xue(i){return(e,t,n)=>!n[0].length||(i(Gd(n.input,n.index))!=Yt.Word||i(Hd(n.input,n.index))!=Yt.Word)&&(i(Hd(n.input,n.index+n[0].length))!=Yt.Word||i(Gd(n.input,n.index+n[0].length))!=Yt.Word)}class Sue extends l3{nextMatch(e,t,n){let r=ra(this.spec,e,n,e.doc.length).next();return r.done&&(r=ra(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=1;;r++){let s=Math.max(t,n-r*1e4),o=ra(this.spec,e,s,n),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==t||a.from>s+10))return a;if(s==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let r=n.length;r>0;r--){let s=+n.slice(0,r);if(s>0&&s<e.match.length)return e.match[s]+n.slice(r)}return t})}matchAll(e,t){let n=ra(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let s=ra(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const Gu=Ve.define(),ub=Ve.define(),ks=yn.define({create(i){return new cm(IO(i).create(),null)},update(i,e){for(let t of e.effects)t.is(Gu)?i=new cm(t.value.create(),i.panel):t.is(ub)&&(i=new cm(i.query,t.value?cb:null));return i},provide:i=>Fd.from(i,e=>e.panel)});class cm{constructor(e,t){this.query=e,this.panel=t}}const kue=qe.mark({class:"cm-searchMatch"}),Tue=qe.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Eue=zi.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(ks))}update(i){let e=i.state.field(ks);(e!=i.startState.field(ks)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:i,panel:e}){if(!e||!i.spec.valid)return qe.none;let{view:t}=this,n=new Ua;for(let r=0,s=t.visibleRanges,o=s.length;r<o;r++){let{from:a,to:l}=s[r];for(;r<o-1&&l>s[r+1].from-2*250;)l=s[++r].to;i.highlight(t.state,a,l,(u,c)=>{let h=t.state.selection.ranges.some(f=>f.from==u&&f.to==c);n.add(u,c,h?Tue:kue)})}return n.finish()}},{decorations:i=>i.decorations});function Pc(i){return e=>{let t=e.state.field(ks,!1);return t&&t.query.spec.valid?i(e,t):h3(e)}}const Xd=Pc((i,{query:e})=>{let{to:t}=i.state.selection.main,n=e.nextMatch(i.state,t,t);if(!n)return!1;let r=G.single(n.from,n.to),s=i.state.facet(Ol);return i.dispatch({selection:r,effects:[hb(i,n),s.scrollToMatch(r.main,i)],userEvent:"select.search"}),c3(i),!0}),zd=Pc((i,{query:e})=>{let{state:t}=i,{from:n}=t.selection.main,r=e.prevMatch(t,n,n);if(!r)return!1;let s=G.single(r.from,r.to),o=i.state.facet(Ol);return i.dispatch({selection:s,effects:[hb(i,r),o.scrollToMatch(s.main,i)],userEvent:"select.search"}),c3(i),!0}),wue=Pc((i,{query:e})=>{let t=e.matchAll(i.state,1e3);return!t||!t.length?!1:(i.dispatch({selection:G.create(t.map(n=>G.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),_ue=({state:i,dispatch:e})=>{let t=i.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:r}=t.main,s=[],o=0;for(let a=new ju(i.doc,i.sliceDoc(n,r));!a.next().done;){if(s.length>1e3)return!1;a.value.from==n&&(o=s.length),s.push(G.range(a.value.from,a.value.to))}return e(i.update({selection:G.create(s,o),userEvent:"select.search.matches"})),!0},mC=Pc((i,{query:e})=>{let{state:t}=i,{from:n,to:r}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,n,n);if(!s)return!1;let o=s,a=[],l,u,c=[];if(o.from==n&&o.to==r&&(u=t.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:u}),o=e.nextMatch(t,o.from,o.to),c.push(le.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+"."))),o){let h=a.length==0||a[0].from>=s.to?0:s.to-s.from-u.length;l=G.single(o.from-h,o.to-h),c.push(hb(i,o)),c.push(t.facet(Ol).scrollToMatch(l.main,i))}return i.dispatch({changes:a,selection:l,effects:c,userEvent:"input.replace"}),!0}),Cue=Pc((i,{query:e})=>{if(i.state.readOnly)return!1;let t=e.matchAll(i.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!t.length)return!1;let n=i.state.phrase("replaced $ matches",t.length)+".";return i.dispatch({changes:t,effects:le.announce.of(n),userEvent:"input.replace.all"}),!0});function cb(i){return i.state.facet(Ol).createPanel(i)}function IO(i,e){var t,n,r,s,o;let a=i.selection.main,l=a.empty||a.to>a.from+100?"":i.sliceDoc(a.from,a.to);if(e&&!l)return e;let u=i.facet(Ol);return new a3({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:u.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:u.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:u.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:u.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:u.wholeWord})}function u3(i){let e=Md(i,cb);return e&&e.dom.querySelector("[main-field]")}function c3(i){let e=u3(i);e&&e==i.root.activeElement&&e.select()}const h3=i=>{let e=i.state.field(ks,!1);if(e&&e.panel){let t=u3(i);if(t&&t!=i.root.activeElement){let n=IO(i.state,e.query.spec);n.valid&&i.dispatch({effects:Gu.of(n)}),t.focus(),t.select()}}else i.dispatch({effects:[ub.of(!0),e?Gu.of(IO(i.state,e.query.spec)):Ve.appendConfig.of(Lue)]});return!0},f3=i=>{let e=i.state.field(ks,!1);if(!e||!e.panel)return!1;let t=Md(i,cb);return t&&t.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:ub.of(!1)}),!0},Aue=[{key:"Mod-f",run:h3,scope:"editor search-panel"},{key:"F3",run:Xd,shift:zd,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Xd,shift:zd,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:f3,scope:"editor search-panel"},{key:"Mod-Shift-l",run:_ue},{key:"Mod-Alt-g",run:pue},{key:"Mod-d",run:Oue,preventDefault:!0}];class Pue{constructor(e){this.view=e;let t=this.query=e.state.field(ks).query.spec;this.commit=this.commit.bind(this),this.searchField=Ht("input",{value:t.search,placeholder:Ri(e,"Find"),"aria-label":Ri(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Ht("input",{value:t.replace,placeholder:Ri(e,"Replace"),"aria-label":Ri(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Ht("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Ht("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Ht("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(r,s,o){return Ht("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=Ht("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,n("next",()=>Xd(e),[Ri(e,"next")]),n("prev",()=>zd(e),[Ri(e,"previous")]),n("select",()=>wue(e),[Ri(e,"all")]),Ht("label",null,[this.caseField,Ri(e,"match case")]),Ht("label",null,[this.reField,Ri(e,"regexp")]),Ht("label",null,[this.wordField,Ri(e,"by word")]),...e.state.readOnly?[]:[Ht("br"),this.replaceField,n("replace",()=>mC(e),[Ri(e,"replace")]),n("replaceAll",()=>Cue(e),[Ri(e,"replace all")])],Ht("button",{name:"close",onclick:()=>f3(e),"aria-label":Ri(e,"close"),type:"button"},[""])])}commit(){let e=new a3({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Gu.of(e)}))}keydown(e){Woe(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?zd:Xd)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),mC(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(Gu)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Ol).top}}function Ri(i,e){return i.state.phrase(e)}const Gh=30,Hh=/[\s\.,:;?!]/;function hb(i,{from:e,to:t}){let n=i.state.doc.lineAt(e),r=i.state.doc.lineAt(t).to,s=Math.max(n.from,e-Gh),o=Math.min(r,t+Gh),a=i.state.sliceDoc(s,o);if(s!=n.from){for(let l=0;l<Gh;l++)if(!Hh.test(a[l+1])&&Hh.test(a[l])){a=a.slice(l);break}}if(o!=r){for(let l=a.length-1;l>a.length-Gh;l--)if(!Hh.test(a[l-1])&&Hh.test(a[l])){a=a.slice(0,l);break}}return le.announce.of(`${i.state.phrase("current match")}. ${a} ${i.state.phrase("on line")} ${n.number}.`)}const Rue=le.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Lue=[ks,Vr.low(Eue),Rue];class fb{constructor(e,t,n,r){this.state=e,this.pos=t,this.explicit=n,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=bt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),r=t.text.slice(n-t.from,this.pos-t.from),s=r.search(p3(e,!1));return s<0?null:{from:n+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function vC(i){let e=Object.keys(i).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Iue(i){let e=Object.create(null),t=Object.create(null);for(let{label:r}of i){e[r[0]]=!0;for(let s=1;s<r.length;s++)t[r[s]]=!0}let n=vC(e)+vC(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function d3(i){let e=i.map(r=>typeof r=="string"?{label:r}:r),[t,n]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:Iue(e);return r=>{let s=r.matchBefore(n);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:t}:null}}function Due(i,e){return t=>{for(let n=bt(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(i.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}class OC{constructor(e,t,n,r){this.completion=e,this.source=t,this.match=n,this.score=r}}function uo(i){return i.selection.main.from}function p3(i,e){var t;let{source:n}=i,r=e&&n[0]!="^",s=n[n.length-1]!="$";return!r&&!s?i:new RegExp(`${r?"^":""}(?:${n})${s?"$":""}`,(t=i.flags)!==null&&t!==void 0?t:i.ignoreCase?"i":"")}const db=Zr.define();function $ue(i,e,t,n){let{main:r}=i.selection,s=t-r.from,o=n-r.from;return Object.assign(Object.assign({},i.changeByRange(a=>{if(a!=r&&t!=n&&i.sliceDoc(a.from+s,a.from+o)!=i.sliceDoc(t,n))return{range:a};let l=i.toText(e);return{changes:{from:a.from+s,to:n==r.from?a.to:a.from+o,insert:l},range:G.cursor(a.from+s+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const yC=new WeakMap;function Mue(i){if(!Array.isArray(i))return i;let e=yC.get(i);return e||yC.set(i,e=d3(i)),e}const Wd=Ve.define(),Hu=Ve.define();class Fue{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=ss(e,t),r=Ys(n);this.chars.push(n);let s=e.slice(t,t+r),o=s.toUpperCase();this.folded.push(ss(o==s?s.toLowerCase():o,0)),t+=r}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:r,precise:s,byWord:o}=this;if(t.length==1){let O=ss(e,0),y=Ys(O),x=y==e.length?0:-100;if(O!=t[0])if(O==n[0])x+=-200;else return null;return this.ret(x,[0,y])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,u=0;if(a<0){for(let O=0,y=Math.min(e.length,200);O<y&&u<l;){let x=ss(e,O);(x==t[u]||x==n[u])&&(r[u++]=O),O+=Ys(x)}if(u<l)return null}let c=0,h=0,f=!1,d=0,p=-1,g=-1,m=/[a-z]/.test(e),v=!0;for(let O=0,y=Math.min(e.length,200),x=0;O<y&&h<l;){let b=ss(e,O);a<0&&(c<l&&b==t[c]&&(s[c++]=O),d<l&&(b==t[d]||b==n[d]?(d==0&&(p=O),g=O+1,d++):d=0));let E,T=b<255?b>=48&&b<=57||b>=97&&b<=122?2:b>=65&&b<=90?1:0:(E=QI(b))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!O||T==1&&m||x==0&&T!=0)&&(t[h]==b||n[h]==b&&(f=!0)?o[h++]=O:o.length&&(v=!1)),x=T,O+=Ys(b)}return h==l&&o[0]==0&&v?this.result(-100+(f?-200:0),o,e):d==l&&p==0?this.ret(-200-e.length+(g==e.length?0:-100),[0,g]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):d==l?this.ret(-900-e.length,[p,g]):h==l?this.result(-100+(f?-200:0)+-700+(v?0:-1100),o,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,n){let r=[],s=0;for(let o of t){let a=o+(this.astral?Ys(ss(n,o)):1);s&&r[s-1]==o?r[s-1]=a:(r[s++]=o,r[s++]=a)}return this.ret(e-n.length,r)}}class Nue{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const jt=de.define({combine(i){return Lp(i,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Que,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>bC(e(n),t(n)),optionClass:(e,t)=>n=>bC(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function bC(i,e){return i?e?i+" "+e:i:e}function Que(i,e,t,n,r,s){let o=i.textDirection==Ot.RTL,a=o,l=!1,u="top",c,h,f=e.left-r.left,d=r.right-e.right,p=n.right-n.left,g=n.bottom-n.top;if(a&&f<Math.min(p,d)?a=!1:!a&&d<Math.min(p,f)&&(a=!0),p<=(a?f:d))c=Math.max(r.top,Math.min(t.top,r.bottom-g))-e.top,h=Math.min(400,a?f:d);else{l=!0,h=Math.min(400,(o?e.right:r.right-e.left)-30);let O=r.bottom-e.bottom;O>=g||O>e.top?c=t.bottom-e.top:(u="bottom",c=e.bottom-t.top)}let m=(e.bottom-e.top)/s.offsetHeight,v=(e.right-e.left)/s.offsetWidth;return{style:`${u}: ${c/m}px; max-width: ${h/v}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function Bue(i){let e=i.addToOptions.slice();return i.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,r,s){let o=document.createElement("span");o.className="cm-completionLabel";let a=t.displayLabel||t.label,l=0;for(let u=0;u<s.length;){let c=s[u++],h=s[u++];c>l&&o.appendChild(document.createTextNode(a.slice(l,c)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(a.slice(c,h))),f.className="cm-completionMatchedText",l=h}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function hm(i,e,t){if(i<=t)return{from:0,to:i};if(e<0&&(e=0),e<=i>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let n=Math.floor((i-e)/t);return{from:i-(n+1)*t,to:i-n*t}}class Uue{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let r=e.state.field(t),{options:s,selected:o}=r.open,a=e.state.facet(jt);this.optionContent=Bue(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=hm(s.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:u}=e.state.field(t).open;for(let c=l.target,h;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(h=/-(\d+)$/.exec(c.id))&&+h[1]<u.length){this.applyCompletion(e,u[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(jt).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Hu.of(null)})}),this.showOptions(s,r.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=r){let{options:s,selected:o,disabled:a}=n.open;(!r.open||r.open.options!=s)&&(this.range=hm(s.length,o,e.state.facet(jt).maxRenderedOptions),this.showOptions(s,n.id)),this.updateSel(),a!=((t=r.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=hm(t.options.length,t.selected,this.view.state.facet(jt).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:r}=n;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(n);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,n)}).catch(o=>ji(this.view.state,o,"completion info")):this.addInfoPane(s,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:s}=e;n.appendChild(r),this.infoDestroy=s||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,r=this.range.from;n;n=n.nextSibling,r++)n.nodeName!="LI"||!n.id?r--:r==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&Zue(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return r.top>Math.min(s.bottom,t.bottom)-10||r.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(jt).positionInfo(this.view,t,r,n,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions")),r.addEventListener("mousedown",o=>{o.target==r&&o.preventDefault()});let s=null;for(let o=n.from;o<n.to;o++){let{completion:a,match:l}=e[o],{section:u}=a;if(u){let f=typeof u=="string"?u:u.name;if(f!=s&&(o>n.from||n.from==0))if(s=f,typeof u!="string"&&u.header)r.appendChild(u.header(u));else{let d=r.appendChild(document.createElement("completion-section"));d.textContent=f}}const c=r.appendChild(document.createElement("li"));c.id=t+"-"+o,c.setAttribute("role","option");let h=this.optionClass(a);h&&(c.className=h);for(let f of this.optionContent){let d=f(a,this.view.state,this.view,l);d&&c.appendChild(d)}}return n.from&&r.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Vue(i,e){return t=>new Uue(t,i,e)}function Zue(i,e){let t=i.getBoundingClientRect(),n=e.getBoundingClientRect(),r=t.height/i.offsetHeight;n.top<t.top?i.scrollTop-=(t.top-n.top)/r:n.bottom>t.bottom&&(i.scrollTop+=(n.bottom-t.bottom)/r)}function xC(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function jue(i,e){let t=[],n=null,r=u=>{t.push(u);let{section:c}=u.completion;if(c){n||(n=[]);let h=typeof c=="string"?c:c.name;n.some(f=>f.name==h)||n.push(typeof c=="string"?{name:h}:c)}},s=e.facet(jt);for(let u of i)if(u.hasResult()){let c=u.result.getMatch;if(u.result.filter===!1)for(let h of u.result.options)r(new OC(h,u.source,c?c(h):[],1e9-t.length));else{let h=e.sliceDoc(u.from,u.to),f,d=s.filterStrict?new Nue(h):new Fue(h);for(let p of u.result.options)if(f=d.match(p.label)){let g=p.displayLabel?c?c(p,f.matched):[]:f.matched;r(new OC(p,u.source,g,f.score+(p.boost||0)))}}}if(n){let u=Object.create(null),c=0,h=(f,d)=>{var p,g;return((p=f.rank)!==null&&p!==void 0?p:1e9)-((g=d.rank)!==null&&g!==void 0?g:1e9)||(f.name<d.name?-1:1)};for(let f of n.sort(h))c-=1e5,u[f.name]=c;for(let f of t){let{section:d}=f.completion;d&&(f.score+=u[typeof d=="string"?d:d.name])}}let o=[],a=null,l=s.compareCompletions;for(let u of t.sort((c,h)=>h.score-c.score||l(c.completion,h.completion))){let c=u.completion;!a||a.label!=c.label||a.detail!=c.detail||a.type!=null&&c.type!=null&&a.type!=c.type||a.apply!=c.apply||a.boost!=c.boost?o.push(u):xC(u.completion)>xC(a)&&(o[o.length-1]=u),a=u.completion}return o}class ga{constructor(e,t,n,r,s,o){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new ga(this.options,SC(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,r,s,o){if(r&&!o&&e.some(u=>u.isPending))return r.setDisabled();let a=jue(e,t);if(!a.length)return r&&e.some(u=>u.isPending)?r.setDisabled():null;let l=t.facet(jt).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let u=r.options[r.selected].completion;for(let c=0;c<a.length;c++)if(a[c].completion==u){l=c;break}}return new ga(a,SC(n,l),{pos:e.reduce((u,c)=>c.hasResult()?Math.min(u,c.from):u,1e8),create:que,above:s.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new ga(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new ga(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class qd{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new qd(zue,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(jt),s=(n.override||t.languageDataAt("autocomplete",uo(t)).map(Mue)).map(l=>(this.active.find(c=>c.source==l)||new un(l,this.active.some(c=>c.state!=0)?1:0)).update(e,n));s.length==this.active.length&&s.every((l,u)=>l==this.active[u])&&(s=this.active);let o=this.open,a=e.effects.some(l=>l.is(pb));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!Gue(s,this.active)||a?o=ga.build(s,t,this.id,o,n,a):o&&o.disabled&&!s.some(l=>l.isPending)&&(o=null),!o&&s.every(l=>!l.isPending)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new un(l.source,0):l));for(let l of e.effects)l.is(m3)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new qd(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Hue:Xue}}function Gue(i,e){if(i==e)return!0;for(let t=0,n=0;;){for(;t<i.length&&!i[t].hasResult();)t++;for(;n<e.length&&!e[n].hasResult();)n++;let r=t==i.length,s=n==e.length;if(r||s)return r==s;if(i[t++].result!=e[n++].result)return!1}}const Hue={"aria-autocomplete":"list"},Xue={};function SC(i,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return e>-1&&(t["aria-activedescendant"]=i+"-"+e),t}const zue=[];function g3(i,e){if(i.isUserEvent("input.complete")){let n=i.annotation(db);if(n&&e.activateOnCompletion(n))return 12}let t=i.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:i.isUserEvent("delete.backward")?2:i.selection?8:i.docChanged?16:0}class un{constructor(e,t,n=!1){this.source=e,this.state=t,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let n=g3(e,t),r=this;(n&8||n&16&&this.touches(e))&&(r=new un(r.source,0)),n&4&&r.state==0&&(r=new un(this.source,1)),r=r.updateFor(e,n);for(let s of e.effects)if(s.is(Wd))r=new un(r.source,1,s.value);else if(s.is(Hu))r=new un(r.source,0);else if(s.is(pb))for(let o of s.value)o.source==r.source&&(r=o);return r}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(uo(e.state))}}class Ta extends un{constructor(e,t,n,r,s,o){super(e,3,t),this.limit=n,this.result=r,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,t){var n;if(!(t&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=uo(e.state);if(a>o||!r||t&2&&(uo(e.startState)==this.from||a<this.limit))return new un(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return Wue(r.validFor,e.state,s,o)?new Ta(this.source,this.explicit,l,r,s,o):r.update&&(r=r.update(r,s,o,new fb(e.state,a,!1)))?new Ta(this.source,this.explicit,l,r,r.from,(n=r.to)!==null&&n!==void 0?n:uo(e.state)):new un(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Ta(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new un(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Wue(i,e,t,n){if(!i)return!1;let r=e.sliceDoc(t,n);return typeof i=="function"?i(r,t,n,e):p3(i,!0).test(r)}const pb=Ve.define({map(i,e){return i.map(t=>t.map(e))}}),m3=Ve.define(),ki=yn.define({create(){return qd.start()},update(i,e){return i.update(e)},provide:i=>[t$.from(i,e=>e.tooltip),le.contentAttributes.from(i,e=>e.attrs)]});function gb(i,e){const t=e.completion.apply||e.completion.label;let n=i.state.field(ki).active.find(r=>r.source==e.source);return n instanceof Ta?(typeof t=="string"?i.dispatch(Object.assign(Object.assign({},$ue(i.state,t,n.from,n.to)),{annotations:db.of(e.completion)})):t(i,e.completion,n.from,n.to),!0):!1}const que=Vue(ki,gb);function Xh(i,e="option"){return t=>{let n=t.state.field(ki,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(jt).interactionDelay)return!1;let r=1,s;e=="page"&&(s=i$(t,n.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,a=n.open.selected>-1?n.open.selected+r*(i?1:-1):i?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),t.dispatch({effects:m3.of(a)}),!0}}const Yue=i=>{let e=i.state.field(ki,!1);return i.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<i.state.facet(jt).interactionDelay?!1:gb(i,e.open.options[e.open.selected])},kC=i=>i.state.field(ki,!1)?(i.dispatch({effects:Wd.of(!0)}),!0):!1,Kue=i=>{let e=i.state.field(ki,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(i.dispatch({effects:Hu.of(null)}),!0)};class Jue{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const ece=50,tce=1e3,ice=zi.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of i.state.field(ki).active)e.isPending&&this.startQuery(e)}update(i){let e=i.state.field(ki),t=i.state.facet(jt);if(!i.selectionSet&&!i.docChanged&&i.startState.field(ki)==e)return;let n=i.transactions.some(s=>{let o=g3(s,t);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(n||o.context.abortOnDocChange&&i.docChanged||o.updates.length+i.transactions.length>ece&&Date.now()-o.time>tce){for(let a of o.context.abortListeners)try{a()}catch(l){ji(this.view.state,l)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...i.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),i.transactions.some(s=>s.effects.some(o=>o.is(Wd)))&&(this.pendingStart=!0);let r=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let s of i.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:i}=this.view,e=i.field(ki);for(let t of e.active)t.isPending&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(jt).updateSyncTime))}startQuery(i){let{state:e}=this.view,t=uo(e),n=new fb(e,t,i.explicit,this.view),r=new Jue(i,n);this.running.push(r),Promise.resolve(i.source(n)).then(s=>{r.context.aborted||(r.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:Hu.of(null)}),ji(this.view.state,s)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(jt).updateSyncTime))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(jt),n=this.view.state.field(ki);for(let r=0;r<this.running.length;r++){let s=this.running[r];if(s.done===void 0)continue;if(this.running.splice(r--,1),s.done){let a=uo(s.updates.length?s.updates[0].startState:this.view.state),l=Math.min(a,s.done.from+(s.active.explicit?0:1)),u=new Ta(s.active.source,s.active.explicit,l,s.done,s.done.from,(i=s.done.to)!==null&&i!==void 0?i:a);for(let c of s.updates)u=u.update(c,t);if(u.hasResult()){e.push(u);continue}}let o=n.active.find(a=>a.source==s.active.source);if(o&&o.isPending)if(s.done==null){let a=new un(s.active.source,0);for(let l of s.updates)a=a.update(l,t);a.isPending||e.push(a)}else this.startQuery(o)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:pb.of(e)})}},{eventHandlers:{blur(i){let e=this.view.state.field(ki,!1);if(e&&e.tooltip&&this.view.state.facet(jt).closeOnBlur){let t=e.open&&i$(this.view,e.open.tooltip);(!t||!t.dom.contains(i.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Hu.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Wd.of(!1)}),20),this.composing=0}}}),nce=typeof navigator=="object"&&/Win/.test(navigator.platform),rce=Vr.highest(le.domEventHandlers({keydown(i,e){let t=e.state.field(ki,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||i.key.length>1||i.ctrlKey&&!(nce&&i.altKey)||i.metaKey)return!1;let n=t.open.options[t.open.selected],r=t.active.find(o=>o.source==n.source),s=n.completion.commitCharacters||r.result.commitCharacters;return s&&s.indexOf(i.key)>-1&&gb(e,n),!1}})),v3=le.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class sce{constructor(e,t,n,r){this.field=e,this.line=t,this.from=n,this.to=r}}class mb{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,fi.TrackDel),n=e.mapPos(this.to,1,fi.TrackDel);return t==null||n==null?null:new mb(this.field,t,n)}}class vb{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],r=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let l of this.lines){if(n.length){let u=o,c=/^\t*/.exec(l)[0].length;for(let h=0;h<c;h++)u+=e.facet(pl);r.push(t+u.length-c),l=u+l.slice(c)}n.push(l),t+=l.length+1}let a=this.fieldPositions.map(l=>new mb(l.field,r[l.line]+l.from,r[l.line]+l.to));return{text:n,ranges:a}}static parse(e){let t=[],n=[],r=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let a=s[1]?+s[1]:null,l=s[2]||s[3]||"",u=-1,c=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<t.length;h++)(a!=null?t[h].seq==a:c&&t[h].name==c)&&(u=h);if(u<0){let h=0;for(;h<t.length&&(a==null||t[h].seq!=null&&t[h].seq<a);)h++;t.splice(h,0,{seq:a,name:c}),u=h;for(let f of r)f.field>=u&&f.field++}r.push(new sce(u,n.length,s.index,s.index+c.length)),o=o.slice(0,s.index)+l+o.slice(s.index+s[0].length)}o=o.replace(/\\([{}])/g,(a,l,u)=>{for(let c of r)c.line==n.length&&c.from>u&&(c.from--,c.to--);return l}),n.push(o)}return new vb(n,r)}}let oce=qe.widget({widget:new class extends kc{toDOM(){let i=document.createElement("span");return i.className="cm-snippetFieldPosition",i}ignoreEvent(){return!1}}}),ace=qe.mark({class:"cm-snippetField"});class yl{constructor(e,t){this.ranges=e,this.active=t,this.deco=qe.set(e.map(n=>(n.from==n.to?oce:ace).range(n.from,n.to)))}map(e){let t=[];for(let n of this.ranges){let r=n.map(e);if(!r)return null;t.push(r)}return new yl(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(n=>n.field==this.active&&n.from<=t.from&&n.to>=t.to))}}const Rc=Ve.define({map(i,e){return i&&i.map(e)}}),lce=Ve.define(),Xu=yn.define({create(){return null},update(i,e){for(let t of e.effects){if(t.is(Rc))return t.value;if(t.is(lce)&&i)return new yl(i.ranges,t.value)}return i&&e.docChanged&&(i=i.map(e.changes)),i&&e.selection&&!i.selectionInsideField(e.selection)&&(i=null),i},provide:i=>le.decorations.from(i,e=>e?e.deco:qe.none)});function Ob(i,e){return G.create(i.filter(t=>t.field==e).map(t=>G.range(t.from,t.to)))}function uce(i){let e=vb.parse(i);return(t,n,r,s)=>{let{text:o,ranges:a}=e.instantiate(t.state,r),{main:l}=t.state.selection,u={changes:{from:r,to:s==l.from?l.to:s,insert:Ue.of(o)},scrollIntoView:!0,annotations:n?[db.of(n),_t.userEvent.of("input.complete")]:void 0};if(a.length&&(u.selection=Ob(a,0)),a.some(c=>c.field>0)){let c=new yl(a,0),h=u.effects=[Rc.of(c)];t.state.field(Xu,!1)===void 0&&h.push(Ve.appendConfig.of([Xu,pce,gce,v3]))}t.dispatch(t.state.update(u))}}function O3(i){return({state:e,dispatch:t})=>{let n=e.field(Xu,!1);if(!n||i<0&&n.active==0)return!1;let r=n.active+i,s=i>0&&!n.ranges.some(o=>o.field==r+i);return t(e.update({selection:Ob(n.ranges,r),effects:Rc.of(s?null:new yl(n.ranges,r)),scrollIntoView:!0})),!0}}const cce=({state:i,dispatch:e})=>i.field(Xu,!1)?(e(i.update({effects:Rc.of(null)})),!0):!1,hce=O3(1),fce=O3(-1),dce=[{key:"Tab",run:hce,shift:fce},{key:"Escape",run:cce}],TC=de.define({combine(i){return i.length?i[0]:dce}}),pce=Vr.highest(wc.compute([TC],i=>i.facet(TC)));function bi(i,e){return Object.assign(Object.assign({},e),{apply:uce(i)})}const gce=le.domEventHandlers({mousedown(i,e){let t=e.state.field(Xu,!1),n;if(!t||(n=e.posAtCoords({x:i.clientX,y:i.clientY}))==null)return!1;let r=t.ranges.find(s=>s.from<=n&&s.to>=n);return!r||r.field==t.active?!1:(e.dispatch({selection:Ob(t.ranges,r.field),effects:Rc.of(t.ranges.some(s=>s.field>r.field)?new yl(t.ranges,r.field):null),scrollIntoView:!0}),!0)}}),y3=new class extends po{};y3.startSide=1;y3.endSide=-1;function mce(i={}){return[rce,ki,jt.of(i),ice,Oce,v3]}const vce=[{key:"Ctrl-Space",run:kC},{mac:"Alt-`",run:kC},{key:"Escape",run:Kue},{key:"ArrowDown",run:Xh(!0)},{key:"ArrowUp",run:Xh(!1)},{key:"PageDown",run:Xh(!0,"page")},{key:"PageUp",run:Xh(!1,"page")},{key:"Enter",run:Yue}],Oce=Vr.highest(wc.computeN([jt],i=>i.facet(jt).defaultKeymap?[vce]:[]));function H(i){return new qa(tb.define(i))}function qr(i){return U(()=>import("./index-BV772zJi.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(e=>e.sql({dialect:e[i]}))}const yce=[N.of({name:"C",extensions:["c","h","ino"],load(){return U(()=>import("./index-DfCcxtoI.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.cpp())}}),N.of({name:"C++",alias:["cpp"],extensions:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],load(){return U(()=>import("./index-DfCcxtoI.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.cpp())}}),N.of({name:"CQL",alias:["cassandra"],extensions:["cql"],load(){return qr("Cassandra")}}),N.of({name:"CSS",extensions:["css"],load(){return U(()=>Promise.resolve().then(()=>cfe),void 0).then(i=>i.css())}}),N.of({name:"Go",extensions:["go"],load(){return U(()=>import("./index-B1v9C8kk.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.go())}}),N.of({name:"HTML",alias:["xhtml"],extensions:["html","htm","handlebars","hbs"],load(){return U(()=>Promise.resolve().then(()=>ide),void 0).then(i=>i.html())}}),N.of({name:"Java",extensions:["java"],load(){return U(()=>import("./index-CFxGOiqx.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.java())}}),N.of({name:"JavaScript",alias:["ecmascript","js","node"],extensions:["js","mjs","cjs"],load(){return U(()=>Promise.resolve().then(()=>qh),void 0).then(i=>i.javascript())}}),N.of({name:"JSON",alias:["json5"],extensions:["json","map"],load(){return U(()=>import("./index-Dby_OWeB.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.json())}}),N.of({name:"JSX",extensions:["jsx"],load(){return U(()=>Promise.resolve().then(()=>qh),void 0).then(i=>i.javascript({jsx:!0}))}}),N.of({name:"LESS",extensions:["less"],load(){return U(()=>import("./index-C0EE-4CF.js"),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.less())}}),N.of({name:"Liquid",extensions:["liquid"],load(){return U(()=>import("./index-TEEz0Elb.js"),__vite__mapDeps([21,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.liquid())}}),N.of({name:"MariaDB SQL",load(){return qr("MariaSQL")}}),N.of({name:"Markdown",extensions:["md","markdown","mkd"],load(){return U(()=>Promise.resolve().then(()=>fde),void 0).then(i=>i.markdown())}}),N.of({name:"MS SQL",load(){return qr("MSSQL")}}),N.of({name:"MySQL",load(){return qr("MySQL")}}),N.of({name:"PHP",extensions:["php","php3","php4","php5","php7","phtml"],load(){return U(()=>import("./index-DV0vrAiY.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.php())}}),N.of({name:"PLSQL",extensions:["pls"],load(){return qr("PLSQL")}}),N.of({name:"PostgreSQL",load(){return qr("PostgreSQL")}}),N.of({name:"Python",extensions:["BUILD","bzl","py","pyw"],filename:/^(BUCK|BUILD)$/,load(){return U(()=>import("./index-BZDiOY4b.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.python())}}),N.of({name:"Rust",extensions:["rs"],load(){return U(()=>import("./index-GenGkzJh.js"),__vite__mapDeps([24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.rust())}}),N.of({name:"Sass",extensions:["sass"],load(){return U(()=>import("./index-C_7fShQY.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.sass({indented:!0}))}}),N.of({name:"SCSS",extensions:["scss"],load(){return U(()=>import("./index-C_7fShQY.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.sass())}}),N.of({name:"SQL",extensions:["sql"],load(){return qr("StandardSQL")}}),N.of({name:"SQLite",load(){return qr("SQLite")}}),N.of({name:"TSX",extensions:["tsx"],load(){return U(()=>Promise.resolve().then(()=>qh),void 0).then(i=>i.javascript({jsx:!0,typescript:!0}))}}),N.of({name:"TypeScript",alias:["ts"],extensions:["ts","mts","cts"],load(){return U(()=>Promise.resolve().then(()=>qh),void 0).then(i=>i.javascript({typescript:!0}))}}),N.of({name:"WebAssembly",extensions:["wat","wast"],load(){return U(()=>import("./index-DZsJf65D.js"),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.wast())}}),N.of({name:"XML",alias:["rss","wsdl","xsd"],extensions:["xml","xsl","xsd","svg"],load(){return U(()=>import("./index-CFKiZ7gP.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.xml())}}),N.of({name:"YAML",alias:["yml"],extensions:["yaml","yml"],load(){return U(()=>import("./index-DirDo6j1.js"),__vite__mapDeps([28,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.yaml())}}),N.of({name:"APL",extensions:["dyalog","apl"],load(){return U(()=>import("./apl-B4CMkyY2.js"),[]).then(i=>H(i.apl))}}),N.of({name:"PGP",alias:["asciiarmor"],extensions:["asc","pgp","sig"],load(){return U(()=>import("./asciiarmor-Df11BRmG.js"),[]).then(i=>H(i.asciiArmor))}}),N.of({name:"ASN.1",extensions:["asn","asn1"],load(){return U(()=>import("./asn1-CGOzndHr.js"),[]).then(i=>H(i.asn1({})))}}),N.of({name:"Asterisk",filename:/^extensions\.conf$/i,load(){return U(()=>import("./asterisk-B-8jnY81.js"),[]).then(i=>H(i.asterisk))}}),N.of({name:"Brainfuck",extensions:["b","bf"],load(){return U(()=>import("./brainfuck-C4LP7Hcl.js"),[]).then(i=>H(i.brainfuck))}}),N.of({name:"Cobol",extensions:["cob","cpy"],load(){return U(()=>import("./cobol-XrqhtCFE.js"),[]).then(i=>H(i.cobol))}}),N.of({name:"C#",alias:["csharp","cs"],extensions:["cs"],load(){return U(()=>import("./clike-wD8xDpL-.js"),[]).then(i=>H(i.csharp))}}),N.of({name:"Clojure",extensions:["clj","cljc","cljx"],load(){return U(()=>import("./clojure-BMjYHr_A.js"),[]).then(i=>H(i.clojure))}}),N.of({name:"ClojureScript",extensions:["cljs"],load(){return U(()=>import("./clojure-BMjYHr_A.js"),[]).then(i=>H(i.clojure))}}),N.of({name:"Closure Stylesheets (GSS)",extensions:["gss"],load(){return U(()=>import("./css-BnMrqG3P.js"),[]).then(i=>H(i.gss))}}),N.of({name:"CMake",extensions:["cmake","cmake.in"],filename:/^CMakeLists\.txt$/,load(){return U(()=>import("./cmake-BQqOBYOt.js"),[]).then(i=>H(i.cmake))}}),N.of({name:"CoffeeScript",alias:["coffee","coffee-script"],extensions:["coffee"],load(){return U(()=>import("./coffeescript-S37ZYGWr.js"),[]).then(i=>H(i.coffeeScript))}}),N.of({name:"Common Lisp",alias:["lisp"],extensions:["cl","lisp","el"],load(){return U(()=>import("./commonlisp-DBKNyK5s.js"),[]).then(i=>H(i.commonLisp))}}),N.of({name:"Cypher",extensions:["cyp","cypher"],load(){return U(()=>import("./cypher-C_CwsFkJ.js"),[]).then(i=>H(i.cypher))}}),N.of({name:"Cython",extensions:["pyx","pxd","pxi"],load(){return U(()=>import("./python-BuPzkPfP.js"),[]).then(i=>H(i.cython))}}),N.of({name:"Crystal",extensions:["cr"],load(){return U(()=>import("./crystal-SjHAIU92.js"),[]).then(i=>H(i.crystal))}}),N.of({name:"D",extensions:["d"],load(){return U(()=>import("./d-pRatUO7H.js"),[]).then(i=>H(i.d))}}),N.of({name:"Dart",extensions:["dart"],load(){return U(()=>import("./clike-wD8xDpL-.js"),[]).then(i=>H(i.dart))}}),N.of({name:"diff",extensions:["diff","patch"],load(){return U(()=>import("./diff-DbItnlRl.js"),[]).then(i=>H(i.diff))}}),N.of({name:"Dockerfile",filename:/^Dockerfile$/,load(){return U(()=>import("./dockerfile-CfugagWn.js"),__vite__mapDeps([29,30])).then(i=>H(i.dockerFile))}}),N.of({name:"DTD",extensions:["dtd"],load(){return U(()=>import("./dtd-DF_7sFjM.js"),[]).then(i=>H(i.dtd))}}),N.of({name:"Dylan",extensions:["dylan","dyl","intr"],load(){return U(()=>import("./dylan-DwRh75JA.js"),[]).then(i=>H(i.dylan))}}),N.of({name:"EBNF",load(){return U(()=>import("./ebnf-CDyGwa7X.js"),[]).then(i=>H(i.ebnf))}}),N.of({name:"ECL",extensions:["ecl"],load(){return U(()=>import("./ecl-Cabwm37j.js"),[]).then(i=>H(i.ecl))}}),N.of({name:"edn",extensions:["edn"],load(){return U(()=>import("./clojure-BMjYHr_A.js"),[]).then(i=>H(i.clojure))}}),N.of({name:"Eiffel",extensions:["e"],load(){return U(()=>import("./eiffel-CnydiIhH.js"),[]).then(i=>H(i.eiffel))}}),N.of({name:"Elm",extensions:["elm"],load(){return U(()=>import("./elm-vLlmbW-K.js"),[]).then(i=>H(i.elm))}}),N.of({name:"Erlang",extensions:["erl"],load(){return U(()=>import("./erlang-BNw1qcRV.js"),[]).then(i=>H(i.erlang))}}),N.of({name:"Esper",load(){return U(()=>import("./sql-C4g8LzGK.js"),[]).then(i=>H(i.esper))}}),N.of({name:"Factor",extensions:["factor"],load(){return U(()=>import("./factor-DhWEB9Tq.js"),__vite__mapDeps([31,30])).then(i=>H(i.factor))}}),N.of({name:"FCL",load(){return U(()=>import("./fcl-Kvtd6kyn.js"),[]).then(i=>H(i.fcl))}}),N.of({name:"Forth",extensions:["forth","fth","4th"],load(){return U(()=>import("./forth-Ffai-XNe.js"),[]).then(i=>H(i.forth))}}),N.of({name:"Fortran",extensions:["f","for","f77","f90","f95"],load(){return U(()=>import("./fortran-DYz_wnZ1.js"),[]).then(i=>H(i.fortran))}}),N.of({name:"F#",alias:["fsharp"],extensions:["fs"],load(){return U(()=>import("./mllike-C_8OmSiT.js"),[]).then(i=>H(i.fSharp))}}),N.of({name:"Gas",extensions:["s"],load(){return U(()=>import("./gas-Bneqetm1.js"),[]).then(i=>H(i.gas))}}),N.of({name:"Gherkin",extensions:["feature"],load(){return U(()=>import("./gherkin-heZmZLOM.js"),[]).then(i=>H(i.gherkin))}}),N.of({name:"Groovy",extensions:["groovy","gradle"],filename:/^Jenkinsfile$/,load(){return U(()=>import("./groovy-D9Dt4D0W.js"),[]).then(i=>H(i.groovy))}}),N.of({name:"Haskell",extensions:["hs"],load(){return U(()=>import("./haskell-BWDZoCOh.js"),[]).then(i=>H(i.haskell))}}),N.of({name:"Haxe",extensions:["hx"],load(){return U(()=>import("./haxe-pv4rovob.js"),[]).then(i=>H(i.haxe))}}),N.of({name:"HXML",extensions:["hxml"],load(){return U(()=>import("./haxe-pv4rovob.js"),[]).then(i=>H(i.hxml))}}),N.of({name:"HTTP",load(){return U(()=>import("./http-DBlCnlav.js"),[]).then(i=>H(i.http))}}),N.of({name:"IDL",extensions:["pro"],load(){return U(()=>import("./idl-BEugSyMb.js"),[]).then(i=>H(i.idl))}}),N.of({name:"JSON-LD",alias:["jsonld"],extensions:["jsonld"],load(){return U(()=>import("./javascript-iSgyE4tI.js"),[]).then(i=>H(i.jsonld))}}),N.of({name:"Jinja2",extensions:["j2","jinja","jinja2"],load(){return U(()=>import("./jinja2-C4DGRd-O.js"),[]).then(i=>H(i.jinja2))}}),N.of({name:"Julia",extensions:["jl"],load(){return U(()=>import("./julia-DuME0IfC.js"),[]).then(i=>H(i.julia))}}),N.of({name:"Kotlin",extensions:["kt","kts"],load(){return U(()=>import("./clike-wD8xDpL-.js"),[]).then(i=>H(i.kotlin))}}),N.of({name:"LiveScript",alias:["ls"],extensions:["ls"],load(){return U(()=>import("./livescript-k3uCVVjK.js"),[]).then(i=>H(i.liveScript))}}),N.of({name:"Lua",extensions:["lua"],load(){return U(()=>import("./lua-BgMRiT3U.js"),[]).then(i=>H(i.lua))}}),N.of({name:"mIRC",extensions:["mrc"],load(){return U(()=>import("./mirc-CjQqDB4T.js"),[]).then(i=>H(i.mirc))}}),N.of({name:"Mathematica",extensions:["m","nb","wl","wls"],load(){return U(()=>import("./mathematica-DTrFuWx2.js"),[]).then(i=>H(i.mathematica))}}),N.of({name:"Modelica",extensions:["mo"],load(){return U(()=>import("./modelica-Dc1JOy9r.js"),[]).then(i=>H(i.modelica))}}),N.of({name:"MUMPS",extensions:["mps"],load(){return U(()=>import("./mumps-BT43cFF4.js"),[]).then(i=>H(i.mumps))}}),N.of({name:"Mbox",extensions:["mbox"],load(){return U(()=>import("./mbox-CNhZ1qSd.js"),[]).then(i=>H(i.mbox))}}),N.of({name:"Nginx",filename:/nginx.*\.conf$/i,load(){return U(()=>import("./nginx-DdIZxoE0.js"),[]).then(i=>H(i.nginx))}}),N.of({name:"NSIS",extensions:["nsh","nsi"],load(){return U(()=>import("./nsis-BORQDQLj.js"),__vite__mapDeps([32,30])).then(i=>H(i.nsis))}}),N.of({name:"NTriples",extensions:["nt","nq"],load(){return U(()=>import("./ntriples-BfvgReVJ.js"),[]).then(i=>H(i.ntriples))}}),N.of({name:"Objective-C",alias:["objective-c","objc"],extensions:["m"],load(){return U(()=>import("./clike-wD8xDpL-.js"),[]).then(i=>H(i.objectiveC))}}),N.of({name:"Objective-C++",alias:["objective-c++","objc++"],extensions:["mm"],load(){return U(()=>import("./clike-wD8xDpL-.js"),[]).then(i=>H(i.objectiveCpp))}}),N.of({name:"OCaml",extensions:["ml","mli","mll","mly"],load(){return U(()=>import("./mllike-C_8OmSiT.js"),[]).then(i=>H(i.oCaml))}}),N.of({name:"Octave",extensions:["m"],load(){return U(()=>import("./octave-Ck1zUtKM.js"),[]).then(i=>H(i.octave))}}),N.of({name:"Oz",extensions:["oz"],load(){return U(()=>import("./oz-BzwKVEFT.js"),[]).then(i=>H(i.oz))}}),N.of({name:"Pascal",extensions:["p","pas"],load(){return U(()=>import("./pascal--L3eBynH.js"),[]).then(i=>H(i.pascal))}}),N.of({name:"Perl",extensions:["pl","pm"],load(){return U(()=>import("./perl-CdXCOZ3F.js"),[]).then(i=>H(i.perl))}}),N.of({name:"Pig",extensions:["pig"],load(){return U(()=>import("./pig-CevX1Tat.js"),[]).then(i=>H(i.pig))}}),N.of({name:"PowerShell",extensions:["ps1","psd1","psm1"],load(){return U(()=>import("./powershell-CFHJl5sT.js"),[]).then(i=>H(i.powerShell))}}),N.of({name:"Properties files",alias:["ini","properties"],extensions:["properties","ini","in"],load(){return U(()=>import("./properties-C78fOPTZ.js"),[]).then(i=>H(i.properties))}}),N.of({name:"ProtoBuf",extensions:["proto"],load(){return U(()=>import("./protobuf-ChK-085T.js"),[]).then(i=>H(i.protobuf))}}),N.of({name:"Pug",alias:["jade"],extensions:["pug","jade"],load(){return U(()=>import("./pug-BmUsPMDj.js"),__vite__mapDeps([33,34])).then(i=>H(i.pug))}}),N.of({name:"Puppet",extensions:["pp"],load(){return U(()=>import("./puppet-DMA9R1ak.js"),[]).then(i=>H(i.puppet))}}),N.of({name:"Q",extensions:["q"],load(){return U(()=>import("./q-ZnEupP5q.js"),[]).then(i=>H(i.q))}}),N.of({name:"R",alias:["rscript"],extensions:["r","R"],load(){return U(()=>import("./r-DUYO_cvP.js"),[]).then(i=>H(i.r))}}),N.of({name:"RPM Changes",load(){return U(()=>import("./rpm-CTu-6PCP.js"),[]).then(i=>H(i.rpmChanges))}}),N.of({name:"RPM Spec",extensions:["spec"],load(){return U(()=>import("./rpm-CTu-6PCP.js"),[]).then(i=>H(i.rpmSpec))}}),N.of({name:"Ruby",alias:["jruby","macruby","rake","rb","rbx"],extensions:["rb"],filename:/^(Gemfile|Rakefile)$/,load(){return U(()=>import("./ruby-B2Rjki9n.js"),[]).then(i=>H(i.ruby))}}),N.of({name:"SAS",extensions:["sas"],load(){return U(()=>import("./sas-B4kiWyti.js"),[]).then(i=>H(i.sas))}}),N.of({name:"Scala",extensions:["scala"],load(){return U(()=>import("./clike-wD8xDpL-.js"),[]).then(i=>H(i.scala))}}),N.of({name:"Scheme",extensions:["scm","ss"],load(){return U(()=>import("./scheme-C41bIUwD.js"),[]).then(i=>H(i.scheme))}}),N.of({name:"Shell",alias:["bash","sh","zsh"],extensions:["sh","ksh","bash"],filename:/^PKGBUILD$/,load(){return U(()=>import("./shell-CjFT_Tl9.js"),[]).then(i=>H(i.shell))}}),N.of({name:"Sieve",extensions:["siv","sieve"],load(){return U(()=>import("./sieve-C3Gn_uJK.js"),[]).then(i=>H(i.sieve))}}),N.of({name:"Smalltalk",extensions:["st"],load(){return U(()=>import("./smalltalk-CnHTOXQT.js"),[]).then(i=>H(i.smalltalk))}}),N.of({name:"Solr",load(){return U(()=>import("./solr-DehyRSwq.js"),[]).then(i=>H(i.solr))}}),N.of({name:"SML",extensions:["sml","sig","fun","smackspec"],load(){return U(()=>import("./mllike-C_8OmSiT.js"),[]).then(i=>H(i.sml))}}),N.of({name:"SPARQL",alias:["sparul"],extensions:["rq","sparql"],load(){return U(()=>import("./sparql-DkYu6x3z.js"),[]).then(i=>H(i.sparql))}}),N.of({name:"Spreadsheet",alias:["excel","formula"],load(){return U(()=>import("./spreadsheet-BCZA_wO0.js"),[]).then(i=>H(i.spreadsheet))}}),N.of({name:"Squirrel",extensions:["nut"],load(){return U(()=>import("./clike-wD8xDpL-.js"),[]).then(i=>H(i.squirrel))}}),N.of({name:"Stylus",extensions:["styl"],load(){return U(()=>import("./stylus-BdAi1jBa.js"),[]).then(i=>H(i.stylus))}}),N.of({name:"Swift",extensions:["swift"],load(){return U(()=>import("./swift-BzpIVaGY.js"),[]).then(i=>H(i.swift))}}),N.of({name:"sTeX",load(){return U(()=>import("./stex-C3f8Ysf7.js"),[]).then(i=>H(i.stex))}}),N.of({name:"LaTeX",alias:["tex"],extensions:["text","ltx","tex"],load(){return U(()=>import("./stex-C3f8Ysf7.js"),[]).then(i=>H(i.stex))}}),N.of({name:"SystemVerilog",extensions:["v","sv","svh"],load(){return U(()=>import("./verilog-C6RDOZhf.js"),[]).then(i=>H(i.verilog))}}),N.of({name:"Tcl",extensions:["tcl"],load(){return U(()=>import("./tcl-DVfN8rqt.js"),[]).then(i=>H(i.tcl))}}),N.of({name:"Textile",extensions:["textile"],load(){return U(()=>import("./textile-CnDTJFAw.js"),[]).then(i=>H(i.textile))}}),N.of({name:"TiddlyWiki",load(){return U(()=>import("./tiddlywiki-DO-Gjzrf.js"),[]).then(i=>H(i.tiddlyWiki))}}),N.of({name:"Tiki wiki",load(){return U(()=>import("./tiki-DGYXhP31.js"),[]).then(i=>H(i.tiki))}}),N.of({name:"TOML",extensions:["toml"],load(){return U(()=>import("./toml-BXUEaScT.js"),[]).then(i=>H(i.toml))}}),N.of({name:"Troff",extensions:["1","2","3","4","5","6","7","8","9"],load(){return U(()=>import("./troff-wAsdV37c.js"),[]).then(i=>H(i.troff))}}),N.of({name:"TTCN",extensions:["ttcn","ttcn3","ttcnpp"],load(){return U(()=>import("./ttcn-CiGrtVSZ.js"),[]).then(i=>H(i.ttcn))}}),N.of({name:"TTCN_CFG",extensions:["cfg"],load(){return U(()=>import("./ttcn-cfg-BIkV9KBc.js"),[]).then(i=>H(i.ttcnCfg))}}),N.of({name:"Turtle",extensions:["ttl"],load(){return U(()=>import("./turtle-B1tBg_DP.js"),[]).then(i=>H(i.turtle))}}),N.of({name:"Web IDL",extensions:["webidl"],load(){return U(()=>import("./webidl-ZXfAyPTL.js"),[]).then(i=>H(i.webIDL))}}),N.of({name:"VB.NET",extensions:["vb"],load(){return U(()=>import("./vb-CmGdzxic.js"),[]).then(i=>H(i.vb))}}),N.of({name:"VBScript",extensions:["vbs"],load(){return U(()=>import("./vbscript-BuJXcnF6.js"),[]).then(i=>H(i.vbScript))}}),N.of({name:"Velocity",extensions:["vtl"],load(){return U(()=>import("./velocity-D8B20fx6.js"),[]).then(i=>H(i.velocity))}}),N.of({name:"Verilog",extensions:["v"],load(){return U(()=>import("./verilog-C6RDOZhf.js"),[]).then(i=>H(i.verilog))}}),N.of({name:"VHDL",extensions:["vhd","vhdl"],load(){return U(()=>import("./vhdl-lSbBsy5d.js"),[]).then(i=>H(i.vhdl))}}),N.of({name:"XQuery",extensions:["xy","xquery"],load(){return U(()=>import("./xquery-CQfU5ijd.js"),[]).then(i=>H(i.xQuery))}}),N.of({name:"Yacas",extensions:["ys"],load(){return U(()=>import("./yacas-BJ4BC0dw.js"),[]).then(i=>H(i.yacas))}}),N.of({name:"Z80",extensions:["z80"],load(){return U(()=>import("./z80-Hz9HOZM7.js"),[]).then(i=>H(i.z80))}}),N.of({name:"MscGen",extensions:["mscgen","mscin","msc"],load(){return U(()=>import("./mscgen-BA5vi2Kp.js"),[]).then(i=>H(i.mscgen))}}),N.of({name:"X",extensions:["xu"],load(){return U(()=>import("./mscgen-BA5vi2Kp.js"),[]).then(i=>H(i.xu))}}),N.of({name:"MsGenny",extensions:["msgenny"],load(){return U(()=>import("./mscgen-BA5vi2Kp.js"),[]).then(i=>H(i.msgenny))}}),N.of({name:"Vue",extensions:["vue"],load(){return U(()=>import("./index-1yibg0MA.js"),__vite__mapDeps([35,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.vue())}}),N.of({name:"Angular Template",load(){return U(()=>import("./index-DAfT05qg.js"),__vite__mapDeps([36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(i=>i.angular())}})];class Yd{static create(e,t,n,r,s){let o=r+(r<<8)+e+(t<<4)|0;return new Yd(e,t,n,o,s,[],[])}constructor(e,t,n,r,s,o,a){this.type=e,this.value=t,this.from=n,this.hash=r,this.end=s,this.children=o,this.positions=a,this.hashProp=[[Te.contextHash,r]]}addChild(e,t){e.prop(Te.contextHash)!=this.hash&&(e=new Ie(e.type,e.children,e.positions,e.length,this.hashProp)),this.children.push(e),this.positions.push(t)}toTree(e,t=this.end){let n=this.children.length-1;return n>=0&&(t=Math.max(t,this.positions[n]+this.children[n].length+this.from)),new Ie(e.types[this.type],this.children,this.positions,t-this.from).balance({makeTree:(r,s,o)=>new Ie(Pt.none,r,s,o,this.hashProp)})}}var J;(function(i){i[i.Document=1]="Document",i[i.CodeBlock=2]="CodeBlock",i[i.FencedCode=3]="FencedCode",i[i.Blockquote=4]="Blockquote",i[i.HorizontalRule=5]="HorizontalRule",i[i.BulletList=6]="BulletList",i[i.OrderedList=7]="OrderedList",i[i.ListItem=8]="ListItem",i[i.ATXHeading1=9]="ATXHeading1",i[i.ATXHeading2=10]="ATXHeading2",i[i.ATXHeading3=11]="ATXHeading3",i[i.ATXHeading4=12]="ATXHeading4",i[i.ATXHeading5=13]="ATXHeading5",i[i.ATXHeading6=14]="ATXHeading6",i[i.SetextHeading1=15]="SetextHeading1",i[i.SetextHeading2=16]="SetextHeading2",i[i.HTMLBlock=17]="HTMLBlock",i[i.LinkReference=18]="LinkReference",i[i.Paragraph=19]="Paragraph",i[i.CommentBlock=20]="CommentBlock",i[i.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",i[i.Escape=22]="Escape",i[i.Entity=23]="Entity",i[i.HardBreak=24]="HardBreak",i[i.Emphasis=25]="Emphasis",i[i.StrongEmphasis=26]="StrongEmphasis",i[i.Link=27]="Link",i[i.Image=28]="Image",i[i.InlineCode=29]="InlineCode",i[i.HTMLTag=30]="HTMLTag",i[i.Comment=31]="Comment",i[i.ProcessingInstruction=32]="ProcessingInstruction",i[i.Autolink=33]="Autolink",i[i.HeaderMark=34]="HeaderMark",i[i.QuoteMark=35]="QuoteMark",i[i.ListMark=36]="ListMark",i[i.LinkMark=37]="LinkMark",i[i.EmphasisMark=38]="EmphasisMark",i[i.CodeMark=39]="CodeMark",i[i.CodeText=40]="CodeText",i[i.CodeInfo=41]="CodeInfo",i[i.LinkTitle=42]="LinkTitle",i[i.LinkLabel=43]="LinkLabel",i[i.URL=44]="URL"})(J||(J={}));class bce{constructor(e,t){this.start=e,this.content=t,this.marks=[],this.parsers=[]}}class xce{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent),this.pos=e,this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return Ou(this.text,e)}reset(e){for(this.text=e,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(e){this.basePos=e,this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e,this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e,t=0,n=0){for(let r=t;r<e;r++)n+=this.text.charCodeAt(r)==9?4-n%4:1;return n}findColumn(e){let t=0;for(let n=0;t<this.text.length&&n<e;t++)n+=this.text.charCodeAt(t)==9?4-n%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}}function EC(i,e,t){if(t.pos==t.text.length||i!=e.block&&t.indent>=e.stack[t.depth+1].value+t.baseIndent)return!0;if(t.indent>=t.baseIndent+4)return!1;let n=(i.type==J.OrderedList?xb:bb)(t,e,!1);return n>0&&(i.type!=J.BulletList||yb(t,e,!1)<0)&&t.text.charCodeAt(t.pos+n-1)==i.value}const b3={[J.Blockquote](i,e,t){return t.next!=62?!1:(t.markers.push(Ne(J.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1)),t.moveBase(t.pos+(xn(t.text.charCodeAt(t.pos+1))?2:1)),i.end=e.lineStart+t.text.length,!0)},[J.ListItem](i,e,t){return t.indent<t.baseIndent+i.value&&t.next>-1?!1:(t.moveBaseColumn(t.baseIndent+i.value),!0)},[J.OrderedList]:EC,[J.BulletList]:EC,[J.Document](){return!0}};function xn(i){return i==32||i==9||i==10||i==13}function Ou(i,e=0){for(;e<i.length&&xn(i.charCodeAt(e));)e++;return e}function wC(i,e,t){for(;e>t&&xn(i.charCodeAt(e-1));)e--;return e}function x3(i){if(i.next!=96&&i.next!=126)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==i.next;)e++;if(e<i.pos+3)return-1;if(i.next==96){for(let t=e;t<i.text.length;t++)if(i.text.charCodeAt(t)==96)return-1}return e}function S3(i){return i.next!=62?-1:i.text.charCodeAt(i.pos+1)==32?2:1}function yb(i,e,t){if(i.next!=42&&i.next!=45&&i.next!=95)return-1;let n=1;for(let r=i.pos+1;r<i.text.length;r++){let s=i.text.charCodeAt(r);if(s==i.next)n++;else if(!xn(s))return-1}return t&&i.next==45&&E3(i)>-1&&i.depth==e.stack.length&&e.parser.leafBlockParsers.indexOf(A3.SetextHeading)>-1||n<3?-1:1}function k3(i,e){for(let t=i.stack.length-1;t>=0;t--)if(i.stack[t].type==e)return!0;return!1}function bb(i,e,t){return(i.next==45||i.next==43||i.next==42)&&(i.pos==i.text.length-1||xn(i.text.charCodeAt(i.pos+1)))&&(!t||k3(e,J.BulletList)||i.skipSpace(i.pos+2)<i.text.length)?1:-1}function xb(i,e,t){let n=i.pos,r=i.next;for(;r>=48&&r<=57;){n++;if(n==i.text.length)return-1;r=i.text.charCodeAt(n)}return n==i.pos||n>i.pos+9||r!=46&&r!=41||n<i.text.length-1&&!xn(i.text.charCodeAt(n+1))||t&&!k3(e,J.OrderedList)&&(i.skipSpace(n+1)==i.text.length||n>i.pos+1||i.next!=49)?-1:n+1-i.pos}function T3(i){if(i.next!=35)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==35;)e++;if(e<i.text.length&&i.text.charCodeAt(e)!=32)return-1;let t=e-i.pos;return t>6?-1:t}function E3(i){if(i.next!=45&&i.next!=61||i.indent>=i.baseIndent+4)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==i.next;)e++;let t=e;for(;e<i.text.length&&xn(i.text.charCodeAt(e));)e++;return e==i.text.length?t:-1}const DO=/^[ \t]*$/,w3=/-->/,_3=/\?>/,$O=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,w3],[/^\s*<\?/,_3],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,DO],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,DO]];function C3(i,e,t){if(i.next!=60)return-1;let n=i.text.slice(i.pos);for(let r=0,s=$O.length-(t?1:0);r<s;r++)if($O[r][0].test(n))return r;return-1}function _C(i,e){let t=i.countIndent(e,i.pos,i.indent),n=i.countIndent(i.skipSpace(e),e,t);return n>=t+5?t+1:n}function Gs(i,e,t){let n=i.length-1;n>=0&&i[n].to==e&&i[n].type==J.CodeText?i[n].to=t:i.push(Ne(J.CodeText,e,t))}const zh={LinkReference:void 0,IndentedCode(i,e){let t=e.baseIndent+4;if(e.indent<t)return!1;let n=e.findColumn(t),r=i.lineStart+n,s=i.lineStart+e.text.length,o=[],a=[];for(Gs(o,r,s);i.nextLine()&&e.depth>=i.stack.length;)if(e.pos==e.text.length){Gs(a,i.lineStart-1,i.lineStart);for(let l of e.markers)a.push(l)}else{if(e.indent<t)break;{if(a.length){for(let u of a)u.type==J.CodeText?Gs(o,u.from,u.to):o.push(u);a=[]}Gs(o,i.lineStart-1,i.lineStart);for(let u of e.markers)o.push(u);s=i.lineStart+e.text.length;let l=i.lineStart+e.findColumn(e.baseIndent+4);l<s&&Gs(o,l,s)}}return a.length&&(a=a.filter(l=>l.type!=J.CodeText),a.length&&(e.markers=a.concat(e.markers))),i.addNode(i.buffer.writeElements(o,-r).finish(J.CodeBlock,s-r),r),!0},FencedCode(i,e){let t=x3(e);if(t<0)return!1;let n=i.lineStart+e.pos,r=e.next,s=t-e.pos,o=e.skipSpace(t),a=wC(e.text,e.text.length,o),l=[Ne(J.CodeMark,n,n+s)];o<a&&l.push(Ne(J.CodeInfo,i.lineStart+o,i.lineStart+a));for(let u=!0;i.nextLine()&&e.depth>=i.stack.length;u=!1){let c=e.pos;if(e.indent-e.baseIndent<4)for(;c<e.text.length&&e.text.charCodeAt(c)==r;)c++;if(c-e.pos>=s&&e.skipSpace(c)==e.text.length){for(let h of e.markers)l.push(h);l.push(Ne(J.CodeMark,i.lineStart+e.pos,i.lineStart+c)),i.nextLine();break}else{u||Gs(l,i.lineStart-1,i.lineStart);for(let d of e.markers)l.push(d);let h=i.lineStart+e.basePos,f=i.lineStart+e.text.length;h<f&&Gs(l,h,f)}}return i.addNode(i.buffer.writeElements(l,-n).finish(J.FencedCode,i.prevLineEnd()-n),n),!0},Blockquote(i,e){let t=S3(e);return t<0?!1:(i.startContext(J.Blockquote,e.pos),i.addNode(J.QuoteMark,i.lineStart+e.pos,i.lineStart+e.pos+1),e.moveBase(e.pos+t),null)},HorizontalRule(i,e){if(yb(e,i,!1)<0)return!1;let t=i.lineStart+e.pos;return i.nextLine(),i.addNode(J.HorizontalRule,t),!0},BulletList(i,e){let t=bb(e,i,!1);if(t<0)return!1;i.block.type!=J.BulletList&&i.startContext(J.BulletList,e.basePos,e.next);let n=_C(e,e.pos+1);return i.startContext(J.ListItem,e.basePos,n-e.baseIndent),i.addNode(J.ListMark,i.lineStart+e.pos,i.lineStart+e.pos+t),e.moveBaseColumn(n),null},OrderedList(i,e){let t=xb(e,i,!1);if(t<0)return!1;i.block.type!=J.OrderedList&&i.startContext(J.OrderedList,e.basePos,e.text.charCodeAt(e.pos+t-1));let n=_C(e,e.pos+t);return i.startContext(J.ListItem,e.basePos,n-e.baseIndent),i.addNode(J.ListMark,i.lineStart+e.pos,i.lineStart+e.pos+t),e.moveBaseColumn(n),null},ATXHeading(i,e){let t=T3(e);if(t<0)return!1;let n=e.pos,r=i.lineStart+n,s=wC(e.text,e.text.length,n),o=s;for(;o>n&&e.text.charCodeAt(o-1)==e.next;)o--;(o==s||o==n||!xn(e.text.charCodeAt(o-1)))&&(o=e.text.length);let a=i.buffer.write(J.HeaderMark,0,t).writeElements(i.parser.parseInline(e.text.slice(n+t+1,o),r+t+1),-r);o<e.text.length&&a.write(J.HeaderMark,o-n,s-n);let l=a.finish(J.ATXHeading1-1+t,e.text.length-n);return i.nextLine(),i.addNode(l,r),!0},HTMLBlock(i,e){let t=C3(e,i,!1);if(t<0)return!1;let n=i.lineStart+e.pos,r=$O[t][1],s=[],o=r!=DO;for(;!r.test(e.text)&&i.nextLine();){if(e.depth<i.stack.length){o=!1;break}for(let u of e.markers)s.push(u)}o&&i.nextLine();let a=r==w3?J.CommentBlock:r==_3?J.ProcessingInstructionBlock:J.HTMLBlock,l=i.prevLineEnd();return i.addNode(i.buffer.writeElements(s,-n).finish(a,l-n),n),!0},SetextHeading:void 0};class Sce{constructor(e){this.stage=0,this.elts=[],this.pos=0,this.start=e.start,this.advance(e.content)}nextLine(e,t,n){if(this.stage==-1)return!1;let r=n.content+`
`+t.scrub(),s=this.advance(r);return s>-1&&s<r.length?this.complete(e,n,s):!1}finish(e,t){return(this.stage==2||this.stage==3)&&Ou(t.content,this.pos)==t.content.length?this.complete(e,t,t.content.length):!1}complete(e,t,n){return e.addLeafElement(t,Ne(J.LinkReference,this.start,this.start+n,this.elts)),!0}nextStage(e){return e?(this.pos=e.to-this.start,this.elts.push(e),this.stage++,!0):(e===!1&&(this.stage=-1),!1)}advance(e){for(;;){if(this.stage==-1)return-1;if(this.stage==0){if(!this.nextStage(N3(e,this.pos,this.start,!0)))return-1;if(e.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(Ne(J.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else if(this.stage==1){if(!this.nextStage(M3(e,Ou(e,this.pos),this.start)))return-1}else if(this.stage==2){let t=Ou(e,this.pos),n=0;if(t>this.pos){let r=F3(e,t,this.start);if(r){let s=fm(e,r.to-this.start);s>0&&(this.nextStage(r),n=s)}}return n||(n=fm(e,this.pos)),n>0&&n<e.length?n:-1}else return fm(e,this.pos)}}}function fm(i,e){for(;e<i.length;e++){let t=i.charCodeAt(e);if(t==10)break;if(!xn(t))return-1}return e}class kce{nextLine(e,t,n){let r=t.depth<e.stack.length?-1:E3(t),s=t.next;if(r<0)return!1;let o=Ne(J.HeaderMark,e.lineStart+t.pos,e.lineStart+r);return e.nextLine(),e.addLeafElement(n,Ne(s==61?J.SetextHeading1:J.SetextHeading2,n.start,e.prevLineEnd(),[...e.parser.parseInline(n.content,n.start),o])),!0}finish(){return!1}}const A3={LinkReference(i,e){return e.content.charCodeAt(0)==91?new Sce(e):null},SetextHeading(){return new kce}},Tce=[(i,e)=>T3(e)>=0,(i,e)=>x3(e)>=0,(i,e)=>S3(e)>=0,(i,e)=>bb(e,i,!0)>=0,(i,e)=>xb(e,i,!0)>=0,(i,e)=>yb(e,i,!0)>=0,(i,e)=>C3(e,i,!0)>=0],Ece={text:"",end:0};class wce{constructor(e,t,n,r){this.parser=e,this.input=t,this.ranges=r,this.line=new xce,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=r[r.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=r[0].from,this.block=Yd.create(J.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=n.length?new Pce(n,t):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(let n=0;;){let r=e.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;n<e.markers.length&&(!r||e.markers[n].from<r.end);){let s=e.markers[n++];this.addNode(s.type,s.from,s.to)}if(!r)break;this.finishContext()}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let n of this.parser.blockParsers)if(n){let r=n(this,e);if(r!=!1){if(r==!0)return null;e.forward();continue e}}break}let t=new bce(this.lineStart+e.pos,e.text.slice(e.pos));for(let n of this.parser.leafBlockParsers)if(n){let r=n(this,t);r&&t.parsers.push(r)}e:for(;this.nextLine()&&e.pos!=e.text.length;){if(e.indent<e.baseIndent+4){for(let n of this.parser.endLeafBlock)if(n(this,e,t))break e}for(let n of t.parsers)if(n.nextLine(this,e,t))return null;t.content+=`
`+e.scrub();for(let n of e.markers)t.marks.push(n)}return this.finishLeaf(t),null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let t=this.fragments.takeNodes(this);return t?(this.absoluteLineStart+=t,this.lineStart=Q3(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0):!1}get depth(){return this.stack.length}parentType(e=this.depth-1){return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}peekLine(){return this.scanLine(this.absoluteLineEnd+1).text}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(e){let t=Ece;if(t.end=e,e>=this.to)t.text="";else if(t.text=this.lineChunkAt(e),t.end+=t.text.length,this.ranges.length>1){let n=this.absoluteLineStart,r=this.rangeI;for(;this.ranges[r].to<t.end;){r++;let s=this.ranges[r].from,o=this.lineChunkAt(s);t.end=s+o.length,t.text=t.text.slice(0,this.ranges[r-1].to-n)+o,n=t.end-t.text.length}}return t}readLine(){let{line:e}=this,{text:t,end:n}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=n,e.reset(t);e.depth<this.stack.length;e.depth++){let r=this.stack[e.depth],s=this.parser.skipContextMarkup[r.type];if(!s)throw new Error("Unhandled block context "+J[r.type]);if(!s(r,this,e))break;e.forward()}}lineChunkAt(e){let t=this.input.chunk(e),n;if(this.input.lineChunks)n=t==`
`?"":t;else{let r=t.indexOf(`
`);n=r<0?t:t.slice(0,r)}return e+n.length>this.to?n.slice(0,this.to-e):n}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t,n=0){this.block=Yd.create(e,n,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(e,t,n=0){this.startContext(this.parser.getNodeType(e),t,n)}addNode(e,t,n){typeof e=="number"&&(e=new Ie(this.parser.nodeSet.types[e],Ya,Ya,(n??this.prevLineEnd())-t)),this.block.addChild(e,t-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(NO(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop(),t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from),this.block=t}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?P3(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let n of e.parsers)if(n.finish(this,e))return;let t=NO(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(J.Paragraph,e.content.length),e.start)}elt(e,t,n,r){return typeof e=="string"?Ne(this.parser.getNodeType(e),t,n,r):new I3(e,t)}get buffer(){return new L3(this.parser.nodeSet)}}function P3(i,e,t,n,r){let s=i[e].to,o=[],a=[],l=t.from+n;function u(c,h){for(;h?c>=s:c>s;){let f=i[e+1].from-s;n+=f,c+=f,e++,s=i[e].to}}for(let c=t.firstChild;c;c=c.nextSibling){u(c.from+n,!0);let h=c.from+n,f,d=r.get(c.tree);d?f=d:c.to+n>s?(f=P3(i,e,c,n,r),u(c.to+n,!1)):f=c.toTree(),o.push(f),a.push(h-l)}return u(t.to+n,!1),new Ie(t.type,o,a,t.to+n-l,t.tree?t.tree.propValues:void 0)}class Vp extends $p{constructor(e,t,n,r,s,o,a,l,u){super(),this.nodeSet=e,this.blockParsers=t,this.leafBlockParsers=n,this.blockNames=r,this.endLeafBlock=s,this.skipContextMarkup=o,this.inlineParsers=a,this.inlineNames=l,this.wrappers=u,this.nodeTypes=Object.create(null);for(let c of e.types)this.nodeTypes[c.name]=c.id}createParse(e,t,n){let r=new wce(this,e,t,n);for(let s of this.wrappers)r=s(r,e,t,n);return r}configure(e){let t=MO(e);if(!t)return this;let{nodeSet:n,skipContextMarkup:r}=this,s=this.blockParsers.slice(),o=this.leafBlockParsers.slice(),a=this.blockNames.slice(),l=this.inlineParsers.slice(),u=this.inlineNames.slice(),c=this.endLeafBlock.slice(),h=this.wrappers;if(Nl(t.defineNodes)){r=Object.assign({},r);let f=n.types.slice(),d;for(let p of t.defineNodes){let{name:g,block:m,composite:v,style:O}=typeof p=="string"?{name:p}:p;if(f.some(b=>b.name==g))continue;v&&(r[f.length]=(b,E,T)=>v(E,T,b.value));let y=f.length,x=v?["Block","BlockContext"]:m?y>=J.ATXHeading1&&y<=J.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;f.push(Pt.define({id:y,name:g,props:x&&[[Te.group,x]]})),O&&(d||(d={}),Array.isArray(O)||O instanceof Ui?d[g]=O:Object.assign(d,O))}n=new fl(f),d&&(n=n.extend(dl(d)))}if(Nl(t.props)&&(n=n.extend(...t.props)),Nl(t.remove))for(let f of t.remove){let d=this.blockNames.indexOf(f),p=this.inlineNames.indexOf(f);d>-1&&(s[d]=o[d]=void 0),p>-1&&(l[p]=void 0)}if(Nl(t.parseBlock))for(let f of t.parseBlock){let d=a.indexOf(f.name);if(d>-1)s[d]=f.parse,o[d]=f.leaf;else{let p=f.before?Wh(a,f.before):f.after?Wh(a,f.after)+1:a.length-1;s.splice(p,0,f.parse),o.splice(p,0,f.leaf),a.splice(p,0,f.name)}f.endLeaf&&c.push(f.endLeaf)}if(Nl(t.parseInline))for(let f of t.parseInline){let d=u.indexOf(f.name);if(d>-1)l[d]=f.parse;else{let p=f.before?Wh(u,f.before):f.after?Wh(u,f.after)+1:u.length-1;l.splice(p,0,f.parse),u.splice(p,0,f.name)}}return t.wrap&&(h=h.concat(t.wrap)),new Vp(n,s,o,a,c,r,l,u,h)}getNodeType(e){let t=this.nodeTypes[e];if(t==null)throw new RangeError(`Unknown node type '${e}'`);return t}parseInline(e,t){let n=new Cce(this,e,t);e:for(let r=t;r<n.end;){let s=n.char(r);for(let o of this.inlineParsers)if(o){let a=o(n,s,r);if(a>=0){r=a;continue e}}r++}return n.resolveMarkers(0)}}function Nl(i){return i!=null&&i.length>0}function MO(i){if(!Array.isArray(i))return i;if(i.length==0)return null;let e=MO(i[0]);if(i.length==1)return e;let t=MO(i.slice(1));if(!t||!e)return e||t;let n=(o,a)=>(o||Ya).concat(a||Ya),r=e.wrap,s=t.wrap;return{props:n(e.props,t.props),defineNodes:n(e.defineNodes,t.defineNodes),parseBlock:n(e.parseBlock,t.parseBlock),parseInline:n(e.parseInline,t.parseInline),remove:n(e.remove,t.remove),wrap:r?s?(o,a,l,u)=>r(s(o,a,l,u),a,l,u):r:s}}function Wh(i,e){let t=i.indexOf(e);if(t<0)throw new RangeError(`Position specified relative to unknown parser ${e}`);return t}let R3=[Pt.none];for(let i=1,e;e=J[i];i++)R3[i]=Pt.define({id:i,name:e,props:i>=J.Escape?[]:[[Te.group,i in b3?["Block","BlockContext"]:["Block","LeafBlock"]]],top:e=="Document"});const Ya=[];class L3{constructor(e){this.nodeSet=e,this.content=[],this.nodes=[]}write(e,t,n,r=0){return this.content.push(e,t,n,4+r*4),this}writeElements(e,t=0){for(let n of e)n.writeTo(this,t);return this}finish(e,t){return Ie.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})}}let zu=class{constructor(e,t,n,r=Ya){this.type=e,this.from=t,this.to=n,this.children=r}writeTo(e,t){let n=e.content.length;e.writeElements(this.children,t),e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-n)}toTree(e){return new L3(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class I3{constructor(e,t){this.tree=e,this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return Ya}writeTo(e,t){e.nodes.push(this.tree),e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}}function Ne(i,e,t,n){return new zu(i,e,t,n)}const D3={resolve:"Emphasis",mark:"EmphasisMark"},$3={resolve:"Emphasis",mark:"EmphasisMark"},sa={},FO={};class nn{constructor(e,t,n,r){this.type=e,this.from=t,this.to=n,this.side=r}}const CC="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let Wu=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{Wu=new RegExp("[\\p{S}|\\p{P}]","u")}catch{}const dm={Escape(i,e,t){if(e!=92||t==i.end-1)return-1;let n=i.char(t+1);for(let r=0;r<CC.length;r++)if(CC.charCodeAt(r)==n)return i.append(Ne(J.Escape,t,t+2));return-1},Entity(i,e,t){if(e!=38)return-1;let n=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(i.slice(t+1,t+31));return n?i.append(Ne(J.Entity,t,t+1+n[0].length)):-1},InlineCode(i,e,t){if(e!=96||t&&i.char(t-1)==96)return-1;let n=t+1;for(;n<i.end&&i.char(n)==96;)n++;let r=n-t,s=0;for(;n<i.end;n++)if(i.char(n)==96){if(s++,s==r&&i.char(n+1)!=96)return i.append(Ne(J.InlineCode,t,n+1,[Ne(J.CodeMark,t,t+r),Ne(J.CodeMark,n+1-r,n+1)]))}else s=0;return-1},HTMLTag(i,e,t){if(e!=60||t==i.end-1)return-1;let n=i.slice(t+1,i.end),r=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(n);if(r)return i.append(Ne(J.Autolink,t,t+1+r[0].length,[Ne(J.LinkMark,t,t+1),Ne(J.URL,t+1,t+r[0].length),Ne(J.LinkMark,t+r[0].length,t+1+r[0].length)]));let s=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(n);if(s)return i.append(Ne(J.Comment,t,t+1+s[0].length));let o=/^\?[^]*?\?>/.exec(n);if(o)return i.append(Ne(J.ProcessingInstruction,t,t+1+o[0].length));let a=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(n);return a?i.append(Ne(J.HTMLTag,t,t+1+a[0].length)):-1},Emphasis(i,e,t){if(e!=95&&e!=42)return-1;let n=t+1;for(;i.char(n)==e;)n++;let r=i.slice(t-1,t),s=i.slice(n,n+1),o=Wu.test(r),a=Wu.test(s),l=/\s|^$/.test(r),u=/\s|^$/.test(s),c=!u&&(!a||l||o),h=!l&&(!o||u||a),f=c&&(e==42||!h||o),d=h&&(e==42||!c||a);return i.append(new nn(e==95?D3:$3,t,n,(f?1:0)|(d?2:0)))},HardBreak(i,e,t){if(e==92&&i.char(t+1)==10)return i.append(Ne(J.HardBreak,t,t+2));if(e==32){let n=t+1;for(;i.char(n)==32;)n++;if(i.char(n)==10&&n>=t+2)return i.append(Ne(J.HardBreak,t,n+1))}return-1},Link(i,e,t){return e==91?i.append(new nn(sa,t,t+1,1)):-1},Image(i,e,t){return e==33&&i.char(t+1)==91?i.append(new nn(FO,t,t+2,1)):-1},LinkEnd(i,e,t){if(e!=93)return-1;for(let n=i.parts.length-1;n>=0;n--){let r=i.parts[n];if(r instanceof nn&&(r.type==sa||r.type==FO)){if(!r.side||i.skipSpace(r.to)==t&&!/[(\[]/.test(i.slice(t+1,t+2)))return i.parts[n]=null,-1;let s=i.takeContent(n),o=i.parts[n]=_ce(i,s,r.type==sa?J.Link:J.Image,r.from,t+1);if(r.type==sa)for(let a=0;a<n;a++){let l=i.parts[a];l instanceof nn&&l.type==sa&&(l.side=0)}return o.to}}return-1}};function _ce(i,e,t,n,r){let{text:s}=i,o=i.char(r),a=r;if(e.unshift(Ne(J.LinkMark,n,n+(t==J.Image?2:1))),e.push(Ne(J.LinkMark,r-1,r)),o==40){let l=i.skipSpace(r+1),u=M3(s,l-i.offset,i.offset),c;u&&(l=i.skipSpace(u.to),l!=u.to&&(c=F3(s,l-i.offset,i.offset),c&&(l=i.skipSpace(c.to)))),i.char(l)==41&&(e.push(Ne(J.LinkMark,r,r+1)),a=l+1,u&&e.push(u),c&&e.push(c),e.push(Ne(J.LinkMark,l,a)))}else if(o==91){let l=N3(s,r-i.offset,i.offset,!1);l&&(e.push(l),a=l.to)}return Ne(t,n,a,e)}function M3(i,e,t){if(i.charCodeAt(e)==60){for(let r=e+1;r<i.length;r++){let s=i.charCodeAt(r);if(s==62)return Ne(J.URL,e+t,r+1+t);if(s==60||s==10)return!1}return null}else{let r=0,s=e;for(let o=!1;s<i.length;s++){let a=i.charCodeAt(s);if(xn(a))break;if(o)o=!1;else if(a==40)r++;else if(a==41){if(!r)break;r--}else a==92&&(o=!0)}return s>e?Ne(J.URL,e+t,s+t):s==i.length?null:!1}}function F3(i,e,t){let n=i.charCodeAt(e);if(n!=39&&n!=34&&n!=40)return!1;let r=n==40?41:n;for(let s=e+1,o=!1;s<i.length;s++){let a=i.charCodeAt(s);if(o)o=!1;else{if(a==r)return Ne(J.LinkTitle,e+t,s+1+t);a==92&&(o=!0)}}return null}function N3(i,e,t,n){for(let r=!1,s=e+1,o=Math.min(i.length,s+999);s<o;s++){let a=i.charCodeAt(s);if(r)r=!1;else{if(a==93)return n?!1:Ne(J.LinkLabel,e+t,s+1+t);if(n&&!xn(a)&&(n=!1),a==91)return!1;a==92&&(r=!0)}}return null}class Cce{constructor(e,t,n){this.parser=e,this.text=t,this.offset=n,this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){return this.parts.push(e),e.to}addDelimiter(e,t,n,r,s){return this.append(new nn(e,t,n,(r?1:0)|(s?2:0)))}get hasOpenLink(){for(let e=this.parts.length-1;e>=0;e--){let t=this.parts[e];if(t instanceof nn&&(t.type==sa||t.type==FO))return!0}return!1}addElement(e){return this.append(e)}resolveMarkers(e){for(let n=e;n<this.parts.length;n++){let r=this.parts[n];if(!(r instanceof nn&&r.type.resolve&&r.side&2))continue;let s=r.type==D3||r.type==$3,o=r.to-r.from,a,l=n-1;for(;l>=e;l--){let g=this.parts[l];if(g instanceof nn&&g.side&1&&g.type==r.type&&!(s&&(r.side&1||g.side&2)&&(g.to-g.from+o)%3==0&&((g.to-g.from)%3||o%3))){a=g;break}}if(!a)continue;let u=r.type.resolve,c=[],h=a.from,f=r.to;if(s){let g=Math.min(2,a.to-a.from,o);h=a.to-g,f=r.from+g,u=g==1?"Emphasis":"StrongEmphasis"}a.type.mark&&c.push(this.elt(a.type.mark,h,a.to));for(let g=l+1;g<n;g++)this.parts[g]instanceof zu&&c.push(this.parts[g]),this.parts[g]=null;r.type.mark&&c.push(this.elt(r.type.mark,r.from,f));let d=this.elt(u,h,f,c);this.parts[l]=s&&a.from!=h?new nn(a.type,a.from,h,a.side):null,(this.parts[n]=s&&r.to!=f?new nn(r.type,f,r.to,r.side):null)?this.parts.splice(n,0,d):this.parts[n]=d}let t=[];for(let n=e;n<this.parts.length;n++){let r=this.parts[n];r instanceof zu&&t.push(r)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let n=this.parts[t];if(n instanceof nn&&n.type==e)return t}return null}takeContent(e){let t=this.resolveMarkers(e);return this.parts.length=e,t}skipSpace(e){return Ou(this.text,e-this.offset)+this.offset}elt(e,t,n,r){return typeof e=="string"?Ne(this.parser.getNodeType(e),t,n,r):new I3(e,t)}}function NO(i,e){if(!e.length)return i;if(!i.length)return e;let t=i.slice(),n=0;for(let r of e){for(;n<t.length&&t[n].to<r.to;)n++;if(n<t.length&&t[n].from<r.from){let s=t[n];s instanceof zu&&(t[n]=new zu(s.type,s.from,s.to,NO(s.children,[r])))}else t.splice(n++,0,r)}return t}const Ace=[J.CodeBlock,J.ListItem,J.OrderedList,J.BulletList];let Pce=class{constructor(e,t){this.fragments=e,this.input=t,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(e,t){for(;this.fragment&&this.fragment.to<=e;)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return!1;if(this.fragmentEnd<0){let s=this.fragment.to;for(;s>0&&this.input.read(s-1,s)!=`
`;)s--;this.fragmentEnd=s?s-1:0}let n=this.cursor;n||(n=this.cursor=this.fragment.tree.cursor(),n.firstChild());let r=e+this.fragment.offset;for(;n.to<=r;)if(!n.parent())return!1;for(;;){if(n.from>=r)return this.fragment.from<=t;if(!n.childAfter(r))return!1}}matches(e){let t=this.cursor.tree;return t&&t.prop(Te.contextHash)==e}takeNodes(e){let t=this.cursor,n=this.fragment.offset,r=this.fragmentEnd-(this.fragment.openEnd?1:0),s=e.absoluteLineStart,o=s,a=e.block.children.length,l=o,u=a;for(;;){if(t.to-n>r){if(t.type.isAnonymous&&t.firstChild())continue;break}let c=Q3(t.from-n,e.ranges);if(t.to-n<=e.ranges[e.rangeI].to)e.addNode(t.tree,c);else{let h=new Ie(e.parser.nodeSet.types[J.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(h,t.tree),e.addNode(h,c)}if(t.type.is("Block")&&(Ace.indexOf(t.type.id)<0?(o=t.to-n,a=e.block.children.length):(o=l,a=u,l=t.to-n,u=e.block.children.length)),!t.nextSibling())break}for(;e.block.children.length>a;)e.block.children.pop(),e.block.positions.pop();return o-s}};function Q3(i,e){let t=i;for(let n=1;n<e.length;n++){let r=e[n-1].to,s=e[n].from;r<i&&(t-=s-r)}return t}const Rce=dl({"Blockquote/...":w.quote,HorizontalRule:w.contentSeparator,"ATXHeading1/... SetextHeading1/...":w.heading1,"ATXHeading2/... SetextHeading2/...":w.heading2,"ATXHeading3/...":w.heading3,"ATXHeading4/...":w.heading4,"ATXHeading5/...":w.heading5,"ATXHeading6/...":w.heading6,"Comment CommentBlock":w.comment,Escape:w.escape,Entity:w.character,"Emphasis/...":w.emphasis,"StrongEmphasis/...":w.strong,"Link/... Image/...":w.link,"OrderedList/... BulletList/...":w.list,"BlockQuote/...":w.quote,"InlineCode CodeText":w.monospace,"URL Autolink":w.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":w.processingInstruction,"CodeInfo LinkLabel":w.labelName,LinkTitle:w.string,Paragraph:w.content}),Lce=new Vp(new fl(R3).extend(Rce),Object.keys(zh).map(i=>zh[i]),Object.keys(zh).map(i=>A3[i]),Object.keys(zh),Tce,b3,Object.keys(dm).map(i=>dm[i]),Object.keys(dm),[]);function Ice(i,e,t){let n=[];for(let r=i.firstChild,s=e;;r=r.nextSibling){let o=r?r.from:t;if(o>s&&n.push({from:s,to:o}),!r)break;s=r.to}return n}function Dce(i){let{codeParser:e,htmlParser:t}=i;return{wrap:u$((r,s)=>{let o=r.type.id;if(e&&(o==J.CodeBlock||o==J.FencedCode)){let a="";if(o==J.FencedCode){let u=r.node.getChild(J.CodeInfo);u&&(a=s.read(u.from,u.to))}let l=e(a);if(l)return{parser:l,overlay:u=>u.type.id==J.CodeText}}else if(t&&(o==J.HTMLBlock||o==J.HTMLTag))return{parser:t,overlay:Ice(r.node,r.from,r.to)};return null})}}const $ce={resolve:"Strikethrough",mark:"StrikethroughMark"},Mce={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":w.strikethrough}},{name:"StrikethroughMark",style:w.processingInstruction}],parseInline:[{name:"Strikethrough",parse(i,e,t){if(e!=126||i.char(t+1)!=126||i.char(t+2)==126)return-1;let n=i.slice(t-1,t),r=i.slice(t+2,t+3),s=/\s|^$/.test(n),o=/\s|^$/.test(r),a=Wu.test(n),l=Wu.test(r);return i.addDelimiter($ce,t,t+2,!o&&(!l||s||a),!s&&(!a||o||l))},after:"Emphasis"}]};function yu(i,e,t=0,n,r=0){let s=0,o=!0,a=-1,l=-1,u=!1,c=()=>{n.push(i.elt("TableCell",r+a,r+l,i.parser.parseInline(e.slice(a,l),r+a)))};for(let h=t;h<e.length;h++){let f=e.charCodeAt(h);f==124&&!u?((!o||a>-1)&&s++,o=!1,n&&(a>-1&&c(),n.push(i.elt("TableDelimiter",h+r,h+r+1))),a=l=-1):(u||f!=32&&f!=9)&&(a<0&&(a=h),l=h+1),u=!u&&f==92}return a>-1&&(s++,n&&c()),s}function AC(i,e){for(let t=e;t<i.length;t++){let n=i.charCodeAt(t);if(n==124)return!0;n==92&&t++}return!1}const B3=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class PC{constructor(){this.rows=null}nextLine(e,t,n){if(this.rows==null){this.rows=!1;let r;if((t.next==45||t.next==58||t.next==124)&&B3.test(r=t.text.slice(t.pos))){let s=[];yu(e,n.content,0,s,n.start)==yu(e,r,t.pos)&&(this.rows=[e.elt("TableHeader",n.start,n.start+n.content.length,s),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)])}}else if(this.rows){let r=[];yu(e,t.text,t.pos,r,e.lineStart),this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,r))}return!1}finish(e,t){return this.rows?(e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows)),!0):!1}}const Fce={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":w.heading}},"TableRow",{name:"TableCell",style:w.content},{name:"TableDelimiter",style:w.processingInstruction}],parseBlock:[{name:"Table",leaf(i,e){return AC(e.content,0)?new PC:null},endLeaf(i,e,t){if(t.parsers.some(r=>r instanceof PC)||!AC(e.text,e.basePos))return!1;let n=i.peekLine();return B3.test(n)&&yu(i,e.text,e.basePos)==yu(i,n,e.basePos)},before:"SetextHeading"}]};class Nce{nextLine(){return!1}finish(e,t){return e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,[e.elt("TaskMarker",t.start,t.start+3),...e.parser.parseInline(t.content.slice(3),t.start+3)])),!0}}const Qce={defineNodes:[{name:"Task",block:!0,style:w.list},{name:"TaskMarker",style:w.atom}],parseBlock:[{name:"TaskList",leaf(i,e){return/^\[[ xX]\][ \t]/.test(e.content)&&i.parentType().name=="ListItem"?new Nce:null},after:"SetextHeading"}]},RC=/(www\.)|(https?:\/\/)|([\w.+-]{1,100}@)|(mailto:|xmpp:)/gy,LC=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy,Bce=/[\w-]+\.[\w-]+($|\/)/,IC=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy,DC=/\/[a-zA-Z\d@.]+/gy;function $C(i,e,t,n){let r=0;for(let s=e;s<t;s++)i[s]==n&&r++;return r}function Uce(i,e){LC.lastIndex=e;let t=LC.exec(i);if(!t||Bce.exec(t[0])[0].indexOf("_")>-1)return-1;let n=e+t[0].length;for(;;){let r=i[n-1],s;if(/[?!.,:*_~]/.test(r)||r==")"&&$C(i,e,n,")")>$C(i,e,n,"("))n--;else if(r==";"&&(s=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(i.slice(e,n))))n=e+s.index;else break}return n}function MC(i,e){IC.lastIndex=e;let t=IC.exec(i);if(!t)return-1;let n=t[0][t[0].length-1];return n=="_"||n=="-"?-1:e+t[0].length-(n=="."?1:0)}const Vce={parseInline:[{name:"Autolink",parse(i,e,t){let n=t-i.offset;if(n&&/\w/.test(i.text[n-1]))return-1;RC.lastIndex=n;let r=RC.exec(i.text),s=-1;if(!r)return-1;if(r[1]||r[2]){if(s=Uce(i.text,n+r[0].length),s>-1&&i.hasOpenLink){let o=/([^\[\]]|\[[^\]]*\])*/.exec(i.text.slice(n,s));s=n+o[0].length}}else r[3]?s=MC(i.text,n):(s=MC(i.text,n+r[0].length),s>-1&&r[0]=="xmpp:"&&(DC.lastIndex=s,r=DC.exec(i.text),r&&(s=r.index+r[0].length)));return s<0?-1:(i.addElement(i.elt("URL",t,s+i.offset)),s+i.offset)}}]},Zce=[Fce,Qce,Mce,Vce];function U3(i,e,t){return(n,r,s)=>{if(r!=i||n.char(s+1)==i)return-1;let o=[n.elt(t,s,s+1)];for(let a=s+1;a<n.end;a++){let l=n.char(a);if(l==i)return n.addElement(n.elt(e,s,a+1,o.concat(n.elt(t,a,a+1))));if(l==92&&o.push(n.elt("Escape",a,a+++2)),xn(l))break}return-1}}const jce={defineNodes:[{name:"Superscript",style:w.special(w.content)},{name:"SuperscriptMark",style:w.processingInstruction}],parseInline:[{name:"Superscript",parse:U3(94,"Superscript","SuperscriptMark")}]},Gce={defineNodes:[{name:"Subscript",style:w.special(w.content)},{name:"SubscriptMark",style:w.processingInstruction}],parseInline:[{name:"Subscript",parse:U3(126,"Subscript","SubscriptMark")}]},Hce={defineNodes:[{name:"Emoji",style:w.character}],parseInline:[{name:"Emoji",parse(i,e,t){let n;return e!=58||!(n=/^[a-zA-Z_0-9]+:/.exec(i.slice(t+1,i.end)))?-1:i.addElement(i.elt("Emoji",t,t+1+n[0].length))}}]};var FC={};class Kd{constructor(e,t,n,r,s,o,a,l,u,c=0,h){this.p=e,this.stack=t,this.state=n,this.reducePos=r,this.pos=s,this.score=o,this.buffer=a,this.bufferBase=l,this.curContext=u,this.lookAhead=c,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let r=e.parser.context;return new Kd(e,[],t,n,n,0,[],0,r?new NC(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,r=e&65535,{parser:s}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let a=s.dynamicPrecedence(r);if(a&&(this.score+=a),n==0){this.pushState(s.getGoto(this.state,r,!0),this.reducePos),r<s.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(r,this.reducePos);return}let l=this.stack.length-(n-1)*3-(e&262144?6:0),u=l?this.stack[l-2]:this.p.ranges[0].from,c=this.reducePos-u;c>=2e3&&!(!((t=this.p.parser.nodeSet.types[r])===null||t===void 0)&&t.isAnonymous)&&(u==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=u,this.p.lastBigReductionSize=c));let h=l?this.stack[l-1]:0,f=this.bufferBase+this.buffer.length-h;if(r<s.minRepeatTerm||e&131072){let d=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,u,d,f+4,!0)}if(e&262144)this.state=this.stack[l];else{let d=this.stack[l-3];this.state=s.getGoto(d,r,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(r,u)}storeNode(e,t,n,r=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,a=this.buffer.length;if(a==0&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(t==n)return;if(o.buffer[a-2]>=t){o.buffer[a-2]=n;return}}}if(!s||this.pos==n)this.buffer.push(e,t,n,r);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let a=!1;for(let l=o;l>0&&this.buffer[l-2]>n;l-=4)if(this.buffer[l-1]>=0){a=!0;break}if(a)for(;o>0&&this.buffer[o-2]>n;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,r>4&&(r-=4)}this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=n,this.buffer[o+3]=r}}shift(e,t,n,r){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=r,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,r,4);else{let s=e,{parser:o}=this.p;(r>this.pos||t<=o.maxNode)&&(this.pos=r,o.stateFlag(s,1)||(this.reducePos=r)),this.pushState(s,n),this.shiftContext(t,n),t<=o.maxNode&&this.buffer.push(t,n,r,4)}}apply(e,t,n,r){e&65536?this.reduce(e):this.shift(e,t,n,r)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(n,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new Kd(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new Xce(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(n==0)return!1;if(!(n&65536))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let r=[];for(let s=0,o;s<t.length;s+=2)(o=t[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&r.push(t[s],o);if(this.stack.length<120)for(let s=0;r.length<8&&s<t.length;s+=2){let o=t[s+1];r.some((a,l)=>l&1&&a==o)||r.push(t[s],o)}t=r}let n=[];for(let r=0;r<t.length&&n.length<4;r+=2){let s=t[r+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[r],this.pos),o.reducePos=this.pos,o.score-=200,n.push(o)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let n=t>>19,r=t&65535,s=this.stack.length-n*3;if(s<0||e.getGoto(this.stack[s],r,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(r,s)=>{if(!t.includes(r))return t.push(r),e.allActions(r,o=>{if(!(o&393216))if(o&65536){let a=(o>>19)-s;if(a>1){let l=o&65535,u=this.stack.length-a*3;if(u>=0&&e.getGoto(this.stack[u],l,!1)>=0)return a<<19|65536|l}}else{let a=n(o,s+1);if(a!=null)return a}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new NC(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class NC{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class Xce{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r}}class Jd{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Jd(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Jd(this.stack,this.pos,this.index)}}function tu(i,e=Uint16Array){if(typeof i!="string")return i;let t=null;for(let n=0,r=0;n<i.length;){let s=0;for(;;){let o=i.charCodeAt(n++),a=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,a=!0),s+=l,a)break;s*=46}t?t[r++]=s:t=new e(s)}return t}class Ff{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const QC=new Ff;class zce{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=QC,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,r=this.rangeIndex,s=this.pos+e;for(;s<n.from;){if(!r)return null;let o=this.ranges[--r];s-=n.from-o.to,n=o}for(;t<0?s>n.to:s>=n.to;){if(r==this.ranges.length-1)return null;let o=this.ranges[++r];s+=o.from-n.to,n=o}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,r;if(t>=0&&t<this.chunk.length)n=this.pos+e,r=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(n=s,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let o=this.rangeIndex,a=this.range;for(;a.to<=n;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-n)),r=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),r}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=QC,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(n+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return n}}class Ea{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;V3(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}Ea.prototype.contextual=Ea.prototype.fallback=Ea.prototype.extend=!1;class ep{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data=typeof e=="string"?tu(e):e}token(e,t){let n=e.pos,r=0;for(;;){let s=e.next<0,o=e.resolveOffset(1,1);if(V3(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(s||r++,o==null)break;e.reset(o,e.token)}r&&(e.reset(n,e.token),e.acceptToken(this.elseToken,r))}}ep.prototype.contextual=Ea.prototype.fallback=Ea.prototype.extend=!1;class Sn{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function V3(i,e,t,n,r,s){let o=0,a=1<<n,{dialect:l}=t.p.parser;e:for(;a&i[o];){let u=i[o+1];for(let d=o+3;d<u;d+=2)if((i[d+1]&a)>0){let p=i[d];if(l.allows(p)&&(e.token.value==-1||e.token.value==p||Wce(p,e.token.value,r,s))){e.acceptToken(p);break}}let c=e.next,h=0,f=i[o+2];if(e.next<0&&f>h&&i[u+f*3-3]==65535){o=i[u+f*3-1];continue e}for(;h<f;){let d=h+f>>1,p=u+d+(d<<1),g=i[p],m=i[p+1]||65536;if(c<g)f=d;else if(c>=m)h=d+1;else{o=i[p+2],e.advance();continue e}}break}}function BC(i,e,t){for(let n=e,r;(r=i[n])!=65535;n++)if(r==t)return n-e;return-1}function Wce(i,e,t,n){let r=BC(t,n,e);return r<0||BC(t,n,i)<r}const Li=typeof process<"u"&&FC&&/\bparse\b/.test(FC.LOG);let pm=null;function UC(i,e,t){let n=i.cursor(it.IncludeAnonymous);for(n.moveTo(e);;)if(!(t<0?n.childBefore(e):n.childAfter(e)))for(;;){if((t<0?n.to<e:n.from>e)&&!n.type.isError)return t<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(i.length,Math.max(n.from+1,e+25));if(t<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return t<0?0:i.length}}class qce{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?UC(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?UC(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],r=this.index[t];if(r==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=n.children[r],o=this.start[t]+n.positions[r];if(o>e)return this.nextStart=o,null;if(s instanceof Ie){if(o==e){if(o<this.safeFrom)return null;let a=o+s.length;if(a<=this.safeTo){let l=s.prop(Te.lookAhead);if(!l||a+l<this.fragment.to)return s}}this.index[t]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+s.length}}}class Yce{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new Ff)}getActions(e){let t=0,n=null,{parser:r}=e.p,{tokenizers:s}=r,o=r.stateSlot(e.state,3),a=e.curContext?e.curContext.hash:0,l=0;for(let u=0;u<s.length;u++){if(!(1<<u&o))continue;let c=s[u],h=this.tokens[u];if(!(n&&!c.fallback)&&((c.contextual||h.start!=e.pos||h.mask!=o||h.context!=a)&&(this.updateCachedToken(h,c,e),h.mask=o,h.context=a),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let f=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!c.extend&&(n=h,t>f))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!n&&e.pos==this.stream.end&&(n=new Ff,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Ff,{pos:n,p:r}=e;return t.start=n,t.end=Math.min(n+1,r.stream.end),t.value=n==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,n){let r=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(r,e),n),e.value>-1){let{parser:s}=n.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==e.value){let a=s.specializers[o](this.stream.read(e.start,e.end),n);if(a>=0&&n.p.parser.dialect.allows(a>>1)){a&1?e.extended=a>>1:e.value=a>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,t,n,r){for(let s=0;s<r;s+=3)if(this.actions[s]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=n,r}addActions(e,t,n,r){let{state:s}=e,{parser:o}=e.p,{data:a}=o;for(let l=0;l<2;l++)for(let u=o.stateSlot(s,l?2:1);;u+=3){if(a[u]==65535)if(a[u+1]==1)u=Lr(a,u+2);else{r==0&&a[u+1]==2&&(r=this.putAction(Lr(a,u+2),t,n,r));break}a[u]==t&&(r=this.putAction(Lr(a,u+1),t,n,r))}return r}}class Kce{constructor(e,t,n,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new zce(t,r),this.tokens=new Yce(e,this.stream),this.topTerm=e.top[1];let{from:s}=r[0];this.stacks=[Kd.start(this,e.top[0],s)],this.fragments=n.length&&this.stream.end-s>e.bufferLength*4?new qce(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],r,s;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let a=e[o];for(;;){if(this.tokens.mainToken=null,a.pos>t)n.push(a);else{if(this.advanceStack(a,n,e))continue;{r||(r=[],s=[]),r.push(a);let l=this.tokens.getMainToken(a);s.push(l.value,l.end)}}break}}if(!n.length){let o=r&&ehe(r);if(o)return Li&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw Li&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&r){let o=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,s,n);if(o)return Li&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(n.length>o)for(n.sort((a,l)=>l.score-a.score);n.length>o;)n.pop();n.some(a=>a.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let o=0;o<n.length-1;o++){let a=n[o];for(let l=o+1;l<n.length;l++){let u=n[l];if(a.sameState(u)||a.buffer.length>500&&u.buffer.length>500)if((a.score-u.score||a.buffer.length-u.buffer.length)>0)n.splice(l--,1);else{n.splice(o--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let o=1;o<n.length;o++)n[o].pos<this.minStackPos&&(this.minStackPos=n[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let r=e.pos,{parser:s}=this,o=Li?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let u=e.curContext&&e.curContext.tracker.strict,c=u?e.curContext.hash:0;for(let h=this.fragments.nodeAt(r);h;){let f=this.parser.nodeSet.types[h.type.id]==h.type?s.getGoto(e.state,h.type.id):-1;if(f>-1&&h.length&&(!u||(h.prop(Te.contextHash)||0)==c))return e.useNode(h,f),Li&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(h.type.id)})`),!0;if(!(h instanceof Ie)||h.children.length==0||h.positions[0]>0)break;let d=h.children[0];if(d instanceof Ie&&h.positions[0]==0)h=d;else break}}let a=s.stateSlot(e.state,4);if(a>0)return e.reduce(a),Li&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(a&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let u=0;u<l.length;){let c=l[u++],h=l[u++],f=l[u++],d=u==l.length||!n,p=d?e:e.split(),g=this.tokens.mainToken;if(p.apply(c,h,g?g.start:p.pos,f),Li&&console.log(o+this.stackID(p)+` (via ${c&65536?`reduce of ${s.getName(c&65535)}`:"shift"} for ${s.getName(h)} @ ${r}${p==e?"":", split"})`),d)return!0;p.pos>r?t.push(p):n.push(p)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return VC(e,t),!0}}runRecovery(e,t,n){let r=null,s=!1;for(let o=0;o<e.length;o++){let a=e[o],l=t[o<<1],u=t[(o<<1)+1],c=Li?this.stackID(a)+" -> ":"";if(a.deadEnd&&(s||(s=!0,a.restart(),Li&&console.log(c+this.stackID(a)+" (restarted)"),this.advanceFully(a,n))))continue;let h=a.split(),f=c;for(let d=0;h.forceReduce()&&d<10&&(Li&&console.log(f+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,n));d++)Li&&(f=this.stackID(h)+" -> ");for(let d of a.recoverByInsert(l))Li&&console.log(c+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,n);this.stream.end>a.pos?(u==a.pos&&(u++,l=0),a.recoverByDelete(l,u),Li&&console.log(c+this.stackID(a)+` (via recover-delete ${this.parser.getName(l)})`),VC(a,n)):(!r||r.score<a.score)&&(r=a)}return r}stackToTree(e){return e.close(),Ie.build({buffer:Jd.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(pm||(pm=new WeakMap)).get(e);return t||pm.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function VC(i,e){for(let t=0;t<e.length;t++){let n=e[t];if(n.pos==i.pos&&n.sameState(i)){e[t].score<i.score&&(e[t]=i);return}}e.push(i)}class Jce{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}const gm=i=>i;class Z3{constructor(e){this.start=e.start,this.shift=e.shift||gm,this.reduce=e.reduce||gm,this.reuse=e.reuse||gm,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class Ka extends $p{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let a=0;a<e.repeatNodeCount;a++)t.push("");let n=Object.keys(e.topRules).map(a=>e.topRules[a][1]),r=[];for(let a=0;a<t.length;a++)r.push([]);function s(a,l,u){r[a].push([l,l.deserialize(String(u))])}if(e.nodeProps)for(let a of e.nodeProps){let l=a[0];typeof l=="string"&&(l=Te[l]);for(let u=1;u<a.length;){let c=a[u++];if(c>=0)s(c,l,a[u++]);else{let h=a[u+-c];for(let f=-c;f>0;f--)s(a[u++],l,h);u++}}}this.nodeSet=new fl(t.map((a,l)=>Pt.define({name:l>=this.minRepeatTerm?void 0:a,id:l,props:r[l],top:n.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=r$;let o=tu(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(ZC),this.states=tu(e.states,Uint32Array),this.data=tu(e.stateData),this.goto=tu(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(a=>typeof a=="number"?new Ea(o,a):a),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let r=new Kce(this,e,t,n);for(let s of this.wrappers)r=s(r,e,t,n);return r}getGoto(e,t,n=!1){let r=this.goto;if(t>=r[0])return-1;for(let s=r[t+1];;){let o=r[s++],a=o&1,l=r[s++];if(a&&n)return l;for(let u=s+(o>>1);s<u;s++)if(r[s]==e)return l;if(a)return-1}}hasAction(e,t){let n=this.data;for(let r=0;r<2;r++)for(let s=this.stateSlot(e,r?2:1),o;;s+=3){if((o=n[s])==65535)if(n[s+1]==1)o=n[s=Lr(n,s+2)];else{if(n[s+1]==2)return Lr(n,s+2);break}if(o==t||o==0)return Lr(n,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,n=>n==t?!0:null)}allActions(e,t){let n=this.stateSlot(e,4),r=n?t(n):void 0;for(let s=this.stateSlot(e,1);r==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Lr(this.data,s+2);else break;r=t(Lr(this.data,s+1))}return r}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Lr(this.data,n+2);else break;if(!(this.data[n+2]&1)){let r=this.data[n+1];t.some((s,o)=>o&1&&s==r)||t.push(this.data[n],r)}}return t}configure(e){let t=Object.assign(Object.create(Ka.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(n=>{let r=e.tokenizers.find(s=>s.from==n);return r?r.to:n})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,r)=>{let s=e.specializers.find(a=>a.from==n.external);if(!s)return n;let o=Object.assign(Object.assign({},n),{external:s.to});return t.specializers[r]=ZC(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let s of e.split(" ")){let o=t.indexOf(s);o>=0&&(n[o]=!0)}let r=null;for(let s=0;s<t.length;s++)if(!n[s])for(let o=this.dialects[t[s]],a;(a=this.data[o++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[a]=1;return new Jce(e,n,r)}static deserialize(e){return new Ka(e)}}function Lr(i,e){return i[e]|i[e+1]<<16}function ehe(i){let e=null;for(let t of i){let n=t.p.stoppedAt;(t.pos==t.p.stream.end||n!=null&&t.pos>n)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function ZC(i){if(i.external){let e=i.extend?1:0;return(t,n)=>i.external(t,n)<<1|e}return i.get}const the=54,ihe=1,nhe=55,rhe=2,she=56,ohe=3,jC=4,ahe=5,tp=6,j3=7,G3=8,H3=9,X3=10,lhe=11,uhe=12,che=13,mm=57,hhe=14,GC=58,z3=20,fhe=22,W3=23,dhe=24,QO=26,q3=27,phe=28,ghe=31,mhe=34,vhe=36,Ohe=37,yhe=0,bhe=1,xhe={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},She={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},HC={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function khe(i){return i==45||i==46||i==58||i>=65&&i<=90||i==95||i>=97&&i<=122||i>=161}function Y3(i){return i==9||i==10||i==13||i==32}let XC=null,zC=null,WC=0;function BO(i,e){let t=i.pos+e;if(WC==t&&zC==i)return XC;let n=i.peek(e);for(;Y3(n);)n=i.peek(++e);let r="";for(;khe(n);)r+=String.fromCharCode(n),n=i.peek(++e);return zC=i,WC=t,XC=r?r.toLowerCase():n==The||n==Ehe?void 0:null}const K3=60,ip=62,Sb=47,The=63,Ehe=33,whe=45;function qC(i,e){this.name=i,this.parent=e}const _he=[tp,X3,j3,G3,H3],Che=new Z3({start:null,shift(i,e,t,n){return _he.indexOf(e)>-1?new qC(BO(n,1)||"",i):i},reduce(i,e){return e==z3&&i?i.parent:i},reuse(i,e,t,n){let r=e.type.id;return r==tp||r==vhe?new qC(BO(n,1)||"",i):i},strict:!1}),Ahe=new Sn((i,e)=>{if(i.next!=K3){i.next<0&&e.context&&i.acceptToken(mm);return}i.advance();let t=i.next==Sb;t&&i.advance();let n=BO(i,0);if(n===void 0)return;if(!n)return i.acceptToken(t?hhe:tp);let r=e.context?e.context.name:null;if(t){if(n==r)return i.acceptToken(lhe);if(r&&She[r])return i.acceptToken(mm,-2);if(e.dialectEnabled(yhe))return i.acceptToken(uhe);for(let s=e.context;s;s=s.parent)if(s.name==n)return;i.acceptToken(che)}else{if(n=="script")return i.acceptToken(j3);if(n=="style")return i.acceptToken(G3);if(n=="textarea")return i.acceptToken(H3);if(xhe.hasOwnProperty(n))return i.acceptToken(X3);r&&HC[r]&&HC[r][n]?i.acceptToken(mm,-1):i.acceptToken(tp)}},{contextual:!0}),Phe=new Sn(i=>{for(let e=0,t=0;;t++){if(i.next<0){t&&i.acceptToken(GC);break}if(i.next==whe)e++;else if(i.next==ip&&e>=2){t>=3&&i.acceptToken(GC,-2);break}else e=0;i.advance()}});function Rhe(i){for(;i;i=i.parent)if(i.name=="svg"||i.name=="math")return!0;return!1}const Lhe=new Sn((i,e)=>{if(i.next==Sb&&i.peek(1)==ip){let t=e.dialectEnabled(bhe)||Rhe(e.context);i.acceptToken(t?ahe:jC,2)}else i.next==ip&&i.acceptToken(jC,1)});function kb(i,e,t){let n=2+i.length;return new Sn(r=>{for(let s=0,o=0,a=0;;a++){if(r.next<0){a&&r.acceptToken(e);break}if(s==0&&r.next==K3||s==1&&r.next==Sb||s>=2&&s<n&&r.next==i.charCodeAt(s-2))s++,o++;else if((s==2||s==n)&&Y3(r.next))o++;else if(s==n&&r.next==ip){a>o?r.acceptToken(e,-o):r.acceptToken(t,-(o-2));break}else if((r.next==10||r.next==13)&&a){r.acceptToken(e,1);break}else s=o=0;r.advance()}})}const Ihe=kb("script",the,ihe),Dhe=kb("style",nhe,rhe),$he=kb("textarea",she,ohe),Mhe=dl({"Text RawText":w.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":w.angleBracket,TagName:w.tagName,"MismatchedCloseTag/TagName":[w.tagName,w.invalid],AttributeName:w.attributeName,"AttributeValue UnquotedAttributeValue":w.attributeValue,Is:w.definitionOperator,"EntityReference CharacterReference":w.character,Comment:w.blockComment,ProcessingInst:w.processingInstruction,DoctypeDecl:w.documentMeta}),Fhe=Ka.deserialize({version:14,states:",xOVO!rOOO!WQ#tO'#CqO!]Q#tO'#CzO!bQ#tO'#C}O!gQ#tO'#DQO!lQ#tO'#DSO!qOaO'#CpO!|ObO'#CpO#XOdO'#CpO$eO!rO'#CpOOO`'#Cp'#CpO$lO$fO'#DTO$tQ#tO'#DVO$yQ#tO'#DWOOO`'#Dk'#DkOOO`'#DY'#DYQVO!rOOO%OQ&rO,59]O%ZQ&rO,59fO%fQ&rO,59iO%qQ&rO,59lO%|Q&rO,59nOOOa'#D^'#D^O&XOaO'#CxO&dOaO,59[OOOb'#D_'#D_O&lObO'#C{O&wObO,59[OOOd'#D`'#D`O'POdO'#DOO'[OdO,59[OOO`'#Da'#DaO'dO!rO,59[O'kQ#tO'#DROOO`,59[,59[OOOp'#Db'#DbO'pO$fO,59oOOO`,59o,59oO'xQ#|O,59qO'}Q#|O,59rOOO`-E7W-E7WO(SQ&rO'#CsOOQW'#DZ'#DZO(bQ&rO1G.wOOOa1G.w1G.wOOO`1G/Y1G/YO(mQ&rO1G/QOOOb1G/Q1G/QO(xQ&rO1G/TOOOd1G/T1G/TO)TQ&rO1G/WOOO`1G/W1G/WO)`Q&rO1G/YOOOa-E7[-E7[O)kQ#tO'#CyOOO`1G.v1G.vOOOb-E7]-E7]O)pQ#tO'#C|OOOd-E7^-E7^O)uQ#tO'#DPOOO`-E7_-E7_O)zQ#|O,59mOOOp-E7`-E7`OOO`1G/Z1G/ZOOO`1G/]1G/]OOO`1G/^1G/^O*PQ,UO,59_OOQW-E7X-E7XOOOa7+$c7+$cOOO`7+$t7+$tOOOb7+$l7+$lOOOd7+$o7+$oOOO`7+$r7+$rO*[Q#|O,59eO*aQ#|O,59hO*fQ#|O,59kOOO`1G/X1G/XO*kO7[O'#CvO*|OMhO'#CvOOQW1G.y1G.yOOO`1G/P1G/POOO`1G/S1G/SOOO`1G/V1G/VOOOO'#D['#D[O+_O7[O,59bOOQW,59b,59bOOOO'#D]'#D]O+pOMhO,59bOOOO-E7Y-E7YOOQW1G.|1G.|OOOO-E7Z-E7Z",stateData:",]~O!^OS~OUSOVPOWQOXROYTO[]O][O^^O`^Oa^Ob^Oc^Ox^O{_O!dZO~OfaO~OfbO~OfcO~OfdO~OfeO~O!WfOPlP!ZlP~O!XiOQoP!ZoP~O!YlORrP!ZrP~OUSOVPOWQOXROYTOZqO[]O][O^^O`^Oa^Ob^Oc^Ox^O!dZO~O!ZrO~P#dO![sO!euO~OfvO~OfwO~OS|OT}OhyO~OS!POT}OhyO~OS!ROT}OhyO~OS!TOT}OhyO~OS}OT}OhyO~O!WfOPlX!ZlX~OP!WO!Z!XO~O!XiOQoX!ZoX~OQ!ZO!Z!XO~O!YlORrX!ZrX~OR!]O!Z!XO~O!Z!XO~P#dOf!_O~O![sO!e!aO~OS!bO~OS!cO~Oi!dOSgXTgXhgX~OS!fOT!gOhyO~OS!hOT!gOhyO~OS!iOT!gOhyO~OS!jOT!gOhyO~OS!gOT!gOhyO~Of!kO~Of!lO~Of!mO~OS!nO~Ok!qO!`!oO!b!pO~OS!rO~OS!sO~OS!tO~Oa!uOb!uOc!uO!`!wO!a!uO~Oa!xOb!xOc!xO!b!wO!c!xO~Oa!uOb!uOc!uO!`!{O!a!uO~Oa!xOb!xOc!xO!b!{O!c!xO~OT~bac!dx{!d~",goto:"%p!`PPPPPPPPPPPPPPPPPPPP!a!gP!mPP!yP!|#P#S#Y#]#`#f#i#l#r#x!aP!a!aP$O$U$l$r$x%O%U%[%bPPPPPPPP%hX^OX`pXUOX`pezabcde{!O!Q!S!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ!ObQ!QcQ!SdQ!UeZ!e{!O!Q!S!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:" StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:67,context:Che,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,21,30,33,36,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,29,32,35,37,"OpenTag"],["group",-9,14,17,18,19,20,39,40,41,42,"Entity",16,"Entity TextContent",-3,28,31,34,"TextContent Entity"],["isolate",-11,21,29,30,32,33,35,36,37,38,41,42,"ltr",-3,26,27,39,""]],propSources:[Mhe],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|c`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bX`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UV`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pT`POv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!cpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({W`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!a`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!a`!cpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYkWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]``P!a`!cp!^^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebhSkWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXhSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vchS`P!a`!cpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!`h`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WihSkWc!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zbkWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOa!R!R7tP;=`<%l7S!Z8OYkWa!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{ihSkWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbhSkWa!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QchSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXhSa!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TakWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOb!R!RAwP;=`<%lAY!ZBRYkWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbhSkWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbhSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXhSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!bx`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYlhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_khS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_X`P!a`!cp!eQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZhSfQ`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!a`!cpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!a`!cp!dPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!a`!cpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!a`!cpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!a`!cpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!a`!cpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!a`!cpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!a`!cpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!a`!cpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!cpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO{PP!-nP;=`<%l!-Sq!-xS!cp{POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!a`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!a`{POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!a`!cp{POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!a`!cpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!a`!cpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!a`!cpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!a`!cpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!a`!cpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!a`!cpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!cpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOxPP!7TP;=`<%l!6Vq!7]V!cpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!cpxPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!a`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!a`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!a`xPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!a`!cpxPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXiS`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[Ihe,Dhe,$he,Lhe,Ahe,Phe,0,1,2,3,4,5],topRules:{Document:[0,15]},dialects:{noMatch:0,selfClosing:509},tokenPrec:511});function J3(i,e){let t=Object.create(null);for(let n of i.getChildren(W3)){let r=n.getChild(dhe),s=n.getChild(QO)||n.getChild(q3);r&&(t[e.read(r.from,r.to)]=s?s.type.id==QO?e.read(s.from+1,s.to-1):e.read(s.from,s.to):"")}return t}function YC(i,e){let t=i.getChild(fhe);return t?e.read(t.from,t.to):" "}function vm(i,e,t){let n;for(let r of t)if(!r.attrs||r.attrs(n||(n=J3(i.node.parent.firstChild,e))))return{parser:r.parser};return null}function e6(i=[],e=[]){let t=[],n=[],r=[],s=[];for(let a of i)(a.tag=="script"?t:a.tag=="style"?n:a.tag=="textarea"?r:s).push(a);let o=e.length?Object.create(null):null;for(let a of e)(o[a.name]||(o[a.name]=[])).push(a);return u$((a,l)=>{let u=a.type.id;if(u==phe)return vm(a,l,t);if(u==ghe)return vm(a,l,n);if(u==mhe)return vm(a,l,r);if(u==z3&&s.length){let c=a.node,h=c.firstChild,f=h&&YC(h,l),d;if(f){for(let p of s)if(p.tag==f&&(!p.attrs||p.attrs(d||(d=J3(h,l))))){let g=c.lastChild,m=g.type.id==Ohe?g.from:c.to;if(m>h.to)return{parser:p.parser,overlay:[{from:h.to,to:m}]}}}}if(o&&u==W3){let c=a.node,h;if(h=c.firstChild){let f=o[l.read(h.from,h.to)];if(f)for(let d of f){if(d.tagName&&d.tagName!=YC(c.parent,l))continue;let p=c.lastChild;if(p.type.id==QO){let g=p.from+1,m=p.lastChild,v=p.to-(m&&m.isError?0:1);if(v>g)return{parser:d.parser,overlay:[{from:g,to:v}]}}else if(p.type.id==q3)return{parser:d.parser,overlay:[{from:p.from,to:p.to}]}}}}return null})}const Nhe=100,KC=1,Qhe=101,Bhe=102,JC=2,t6=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],Uhe=58,Vhe=40,i6=95,Zhe=91,Nf=45,jhe=46,Ghe=35,Hhe=37,Xhe=38,zhe=92,Whe=10;function qu(i){return i>=65&&i<=90||i>=97&&i<=122||i>=161}function n6(i){return i>=48&&i<=57}const qhe=new Sn((i,e)=>{for(let t=!1,n=0,r=0;;r++){let{next:s}=i;if(qu(s)||s==Nf||s==i6||t&&n6(s))!t&&(s!=Nf||r>0)&&(t=!0),n===r&&s==Nf&&n++,i.advance();else if(s==zhe&&i.peek(1)!=Whe)i.advance(),i.next>-1&&i.advance(),t=!0;else{t&&i.acceptToken(s==Vhe?Qhe:n==2&&e.canShift(JC)?JC:Bhe);break}}}),Yhe=new Sn(i=>{if(t6.includes(i.peek(-1))){let{next:e}=i;(qu(e)||e==i6||e==Ghe||e==jhe||e==Zhe||e==Uhe&&qu(i.peek(1))||e==Nf||e==Xhe)&&i.acceptToken(Nhe)}}),Khe=new Sn(i=>{if(!t6.includes(i.peek(-1))){let{next:e}=i;if(e==Hhe&&(i.advance(),i.acceptToken(KC)),qu(e)){do i.advance();while(qu(i.next)||n6(i.next));i.acceptToken(KC)}}}),Jhe=dl({"AtKeyword import charset namespace keyframes media supports":w.definitionKeyword,"from to selector":w.keyword,NamespaceName:w.namespace,KeyframeName:w.labelName,KeyframeRangeName:w.operatorKeyword,TagName:w.tagName,ClassName:w.className,PseudoClassName:w.constant(w.className),IdName:w.labelName,"FeatureName PropertyName":w.propertyName,AttributeName:w.attributeName,NumberLiteral:w.number,KeywordQuery:w.keyword,UnaryQueryOp:w.operatorKeyword,"CallTag ValueName":w.atom,VariableName:w.variableName,Callee:w.operatorKeyword,Unit:w.unit,"UniversalSelector NestingSelector":w.definitionOperator,MatchOp:w.compareOperator,"ChildOp SiblingOp, LogicOp":w.logicOperator,BinOp:w.arithmeticOperator,Important:w.modifier,Comment:w.blockComment,ColorLiteral:w.color,"ParenthesizedContent StringLiteral":w.string,":":w.punctuation,"PseudoOp #":w.derefOperator,"; ,":w.separator,"( )":w.paren,"[ ]":w.squareBracket,"{ }":w.brace}),efe={__proto__:null,lang:34,"nth-child":34,"nth-last-child":34,"nth-of-type":34,"nth-last-of-type":34,dir:34,"host-context":34,url:62,"url-prefix":62,domain:62,regexp:62,selector:140},tfe={__proto__:null,"@import":120,"@media":144,"@charset":148,"@namespace":152,"@keyframes":158,"@supports":170},ife={__proto__:null,not:134,only:134},nfe=Ka.deserialize({version:14,states:":jQYQ[OOO#_Q[OOP#fOWOOOOQP'#Cd'#CdOOQP'#Cc'#CcO#kQ[O'#CfO$_QXO'#CaO$fQ[O'#CiO$qQ[O'#DUO$vQ[O'#DXOOQP'#En'#EnO${QdO'#DhO%jQ[O'#DuO${QdO'#DwO%{Q[O'#DyO&WQ[O'#D|O&`Q[O'#ESO&nQ[O'#EUOOQS'#Em'#EmOOQS'#EX'#EXQYQ[OOO&uQXO'#CdO'jQWO'#DdO'oQWO'#EsO'zQ[O'#EsQOQWOOP(UO#tO'#C_POOO)C@])C@]OOQP'#Ch'#ChOOQP,59Q,59QO#kQ[O,59QO(aQ[O'#E]O({QWO,58{O)TQ[O,59TO$qQ[O,59pO$vQ[O,59sO(aQ[O,59vO(aQ[O,59xO(aQ[O,59yO)`Q[O'#DcOOQS,58{,58{OOQP'#Cl'#ClOOQO'#DS'#DSOOQP,59T,59TO)gQWO,59TO)lQWO,59TOOQP'#DW'#DWOOQP,59p,59pOOQO'#DY'#DYO)qQ`O,59sOOQS'#Cq'#CqO${QdO'#CrO)yQvO'#CtO+ZQtO,5:SOOQO'#Cy'#CyO)lQWO'#CxO+oQWO'#CzO+tQ[O'#DPOOQS'#Ep'#EpOOQO'#Dk'#DkO+|Q[O'#DrO,[QWO'#EtO&`Q[O'#DpO,jQWO'#DsOOQO'#Eu'#EuO)OQWO,5:aO,oQpO,5:cOOQS'#D{'#D{O,wQWO,5:eO,|Q[O,5:eOOQO'#EO'#EOO-UQWO,5:hO-ZQWO,5:nO-cQWO,5:pOOQS-E8V-E8VO-kQdO,5:OO-{Q[O'#E_O.YQWO,5;_O.YQWO,5;_POOO'#EW'#EWP.eO#tO,58yPOOO,58y,58yOOQP1G.l1G.lO/[QXO,5:wOOQO-E8Z-E8ZOOQS1G.g1G.gOOQP1G.o1G.oO)gQWO1G.oO)lQWO1G.oOOQP1G/[1G/[O/iQ`O1G/_O0SQXO1G/bO0jQXO1G/dO1QQXO1G/eO1hQWO,59}O1mQ[O'#DTO1tQdO'#CpOOQP1G/_1G/_O${QdO1G/_O1{QpO,59^OOQS,59`,59`O${QdO,59bO2TQWO1G/nOOQS,59d,59dO2YQ!bO,59fOOQS'#DQ'#DQOOQS'#EZ'#EZO2eQ[O,59kOOQS,59k,59kO2mQWO'#DkO2xQWO,5:WO2}QWO,5:^O&`Q[O,5:YO&`Q[O'#E`O3VQWO,5;`O3bQWO,5:[O(aQ[O,5:_OOQS1G/{1G/{OOQS1G/}1G/}OOQS1G0P1G0PO3sQWO1G0PO3xQdO'#EPOOQS1G0S1G0SOOQS1G0Y1G0YOOQS1G0[1G0[O4TQtO1G/jOOQO1G/j1G/jOOQO,5:y,5:yO4kQ[O,5:yOOQO-E8]-E8]O4xQWO1G0yPOOO-E8U-E8UPOOO1G.e1G.eOOQP7+$Z7+$ZOOQP7+$y7+$yO${QdO7+$yOOQS1G/i1G/iO5TQXO'#ErO5[QWO,59oO5aQtO'#EYO6XQdO'#EoO6cQWO,59[O6hQpO7+$yOOQS1G.x1G.xOOQS1G.|1G.|OOQS7+%Y7+%YOOQS1G/Q1G/QO6pQWO1G/QOOQS-E8X-E8XOOQS1G/V1G/VO${QdO1G/rOOQO1G/x1G/xOOQO1G/t1G/tO6uQWO,5:zOOQO-E8^-E8^O7TQXO1G/yOOQS7+%k7+%kO7[QYO'#CtOOQO'#ER'#ERO7gQ`O'#EQOOQO'#EQ'#EQO7rQWO'#EaO7zQdO,5:kOOQS,5:k,5:kO8VQtO'#E^O${QdO'#E^O9WQdO7+%UOOQO7+%U7+%UOOQO1G0e1G0eO9kQpO<<HeO9sQWO,5;^OOQP1G/Z1G/ZOOQS-E8W-E8WO${QdO'#E[O9{QWO,5;ZOOQT1G.v1G.vOOQP<<He<<HeOOQS7+$l7+$lO:TQdO7+%^OOQO7+%e7+%eOOQO,5:l,5:lO3{QdO'#EbO7rQWO,5:{OOQS,5:{,5:{OOQS-E8_-E8_OOQS1G0V1G0VO:[QtO,5:xOOQS-E8[-E8[OOQO<<Hp<<HpOOQPAN>PAN>PO;]QdO,5:vOOQO-E8Y-E8YOOQO<<Hx<<HxOOQO,5:|,5:|OOQO-E8`-E8`OOQS1G0g1G0g",stateData:";o~O#[OS#]QQ~OUYOXYOZTO^VO_VOrXOyWO!]aO!^ZO!j[O!l]O!n^O!q_O!w`O#YRO~OQfOUYOXYOZTO^VO_VOrXOyWO!]aO!^ZO!j[O!l]O!n^O!q_O!w`O#YeO~O#V#gP~P!ZO#]jO~O#YlO~OZnO^qO_qOrsOuoOyrO!PtO!SvO#WuO~O!UwO~P#pOa}O#XzO#YyO~O#Y!OO~O#Y!QO~OQ![Oc!TOg![Oi![Oo!YOr!ZO#X!WO#Y!SO#e!UO~Oc!^O!e!`O!h!aO#Y!]O!U#hP~Oi!fOo!YO#Y!eO~Oi!hO#Y!hO~Oc!^O!e!`O!h!aO#Y!]O~O!Z#hP~P%jOZWX^WX^!XX_WXrWXuWXyWX!PWX!SWX!UWX#WWX~O^!mO~O!Z!nO#V#gX!T#gX~O#V#gX!T#gX~P!ZO#^!qO#_!qO#`!sO~OUYOXYOZTO^VO_VOrXOyWO#YRO~OuoO!UwO~Oa!zO#XzO#YyO~O!T#gP~P!ZOc#RO~Oc#SO~Oq#TO}#UO~OP#WOchXkhX!ZhX!ehX!hhX#YhXbhXQhXghXihXohXrhXuhX!YhX#VhX#XhX#ehXqhX!ThX~Oc!^Ok#XO!e!`O!h!aO#Y!]O!Z#hP~Oc#[O~Oq#`O#Y#]O~Oc!^O!e!`O!h!aO#Y#aO~Ou#eO!c#dO!U#hX!Z#hX~Oc#hO~Ok#XO!Z#jO~O!Z#kO~Oi#lOo!YO~O!U#mO~O!UwO!c#dO~O!UwO!Z#pO~O!Y#rO!Z!Wa#V!Wa!T!Wa~P${O!Z#RX#V#RX!T#RX~P!ZO!Z!nO#V#ga!T#ga~O#^!qO#_!qO#`#xO~OZnO^qO_qOrsOyrO!PtO!SvO#WuO~Ou#Pa!U#Pab#Pa~P.pOq#zO}#{O~OZnO^qO_qOrsOyrO~Ou!Oi!P!Oi!S!Oi!U!Oi#W!Oib!Oi~P/qOu!Qi!P!Qi!S!Qi!U!Qi#W!Qib!Qi~P/qOu!Ri!P!Ri!S!Ri!U!Ri#W!Rib!Ri~P/qO!T#|O~Ob#fP~P(aOb#cP~P${Ob$TOk#XO~O!Z$VO~Ob$WOi$XOp$XO~Oq$ZO#Y#]O~O^!aXb!_X!c!_X~O^$[O~Ob$]O!c#dO~Ou#eO!U#ha!Z#ha~O!c#dOu!da!U!da!Z!dab!da~O!Z$bO~O!T$iO#Y$dO#e$cO~Ok#XOu$kO!Y$mO!Z!Wi#V!Wi!T!Wi~P${O!Z#Ra#V#Ra!T#Ra~P!ZO!Z!nO#V#gi!T#gi~Ob#fX~P#pOb$qO~Ok#XOQ!|Xb!|Xc!|Xg!|Xi!|Xo!|Xr!|Xu!|X#X!|X#Y!|X#e!|X~Ou$sOb#cX~P${Ob$uO~Ok#XOq$vO~Ob$wO~O!c#dOu#Sa!U#Sa!Z#Sa~Ob$yO~P.pOP#WOuhX!UhX~O#e$cOu!tX!U!tX~Ou${O!UwO~O!T%PO#Y$dO#e$cO~Ok#XOQ#QXc#QXg#QXi#QXo#QXr#QXu#QX!Y#QX!Z#QX#V#QX#X#QX#Y#QX#e#QX!T#QX~Ou$kO!Y%SO!Z!Wq#V!Wq!T!Wq~P${Ok#XOq%TO~OuoOb#fa~Ou$sOb#ca~Ob%WO~P${Ok#XOQ#Qac#Qag#Qai#Qao#Qar#Qau#Qa!Y#Qa!Z#Qa#V#Qa#X#Qa#Y#Qa#e#Qa!T#Qa~Ob#Oau#Oa~P${O#[p#]#ek!S#e~",goto:"-g#jPPP#kP#nP#w$WP#wP$g#wPP$mPPP$s$|$|P%`P$|P$|%z&^PPPP$|&vP&z'Q#wP'W#w'^P#wP#w#wPPP'd'y(WPP#nPP(_(_(i(_P(_P(_(_P#nP#nP#nP(l#nP(o(r(u(|#nP#nP)R)X)h)v)|*S*^*d*n*t*zPPPPPPPPPP+Q+Z+v+yP,o,r,x-RRkQ_bOPdhw!n#tkYOPdhotuvw!n#R#h#tkSOPdhotuvw!n#R#h#tQmTR!tnQ{VR!xqQ!x}Q#Z!XR#y!zq![Z]!T!m#S#U#X#q#{$Q$[$k$l$s$x%Up![Z]!T!m#S#U#X#q#{$Q$[$k$l$s$x%UU$f#m$h${R$z$eq!XZ]!T!m#S#U#X#q#{$Q$[$k$l$s$x%Up![Z]!T!m#S#U#X#q#{$Q$[$k$l$s$x%UQ!f^R#l!gT#^!Z#_Q|VR!yqQ!x|R#y!yQ!PWR!{rQ!RXR!|sQxUQ!wpQ#i!cQ#o!jQ#p!kQ$}$gR%Z$|SgPwQ!phQ#s!nR$n#tZfPhw!n#ta!b[`a!V!^!`#d#eR#b!^R!g^R!i_R#n!iS$g#m$hR%X${V$e#m$h${Q!rjR#w!rQdOShPwU!ldh#tR#t!nQ$Q#SU$r$Q$x%UQ$x$[R%U$sQ#_!ZR$Y#_Q$t$QR%V$tQpUS!vp$pR$p#}Q$l#qR%R$lQ!ogS#u!o#vR#v!pQ#f!_R$`#fQ$h#mR%O$hQ$|$gR%Y$|_cOPdhw!n#t^UOPdhw!n#tQ!uoQ!}tQ#OuQ#PvQ#}#RR$a#hR$R#SQ!VZQ!d]Q#V!TQ#q!m[$P#S$Q$[$s$x%UQ$S#UQ$U#XS$j#q$lQ$o#{R%Q$kR$O#RQiPR#QwQ!c[Q!kaR#Y!VU!_[a!VQ!j`Q#c!^Q#g!`Q$^#dR$_#e",nodeNames:" Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector . ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent ] [ LineNames LineName , PseudoClassName ArgList IdSelector # IdName AttributeSelector AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports AtRule Styles",maxTerm:117,nodeProps:[["isolate",-2,3,25,""],["openedBy",18,"(",33,"[",51,"{"],["closedBy",19,")",34,"]",52,"}"]],propSources:[Jhe],skippedNodes:[0,3,88],repeatNodeCount:11,tokenData:"J^~R!^OX$}X^%u^p$}pq%uqr)Xrs.Rst/utu6duv$}vw7^wx7oxy9^yz9oz{9t{|:_|}?Q}!O?c!O!P@Q!P!Q@i!Q![Ab![!]B]!]!^CX!^!_$}!_!`Cj!`!aC{!a!b$}!b!cDw!c!}$}!}#OFa#O#P$}#P#QFr#Q#R6d#R#T$}#T#UGT#U#c$}#c#dHf#d#o$}#o#pH{#p#q6d#q#rI^#r#sIo#s#y$}#y#z%u#z$f$}$f$g%u$g#BY$}#BY#BZ%u#BZ$IS$}$IS$I_%u$I_$I|$}$I|$JO%u$JO$JT$}$JT$JU%u$JU$KV$}$KV$KW%u$KW&FU$}&FU&FV%u&FV;'S$};'S;=`JW<%lO$}`%QSOy%^z;'S%^;'S;=`%o<%lO%^`%cSp`Oy%^z;'S%^;'S;=`%o<%lO%^`%rP;=`<%l%^~%zh#[~OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^~'mh#[~p`OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^l)[UOy%^z#]%^#]#^)n#^;'S%^;'S;=`%o<%lO%^l)sUp`Oy%^z#a%^#a#b*V#b;'S%^;'S;=`%o<%lO%^l*[Up`Oy%^z#d%^#d#e*n#e;'S%^;'S;=`%o<%lO%^l*sUp`Oy%^z#c%^#c#d+V#d;'S%^;'S;=`%o<%lO%^l+[Up`Oy%^z#f%^#f#g+n#g;'S%^;'S;=`%o<%lO%^l+sUp`Oy%^z#h%^#h#i,V#i;'S%^;'S;=`%o<%lO%^l,[Up`Oy%^z#T%^#T#U,n#U;'S%^;'S;=`%o<%lO%^l,sUp`Oy%^z#b%^#b#c-V#c;'S%^;'S;=`%o<%lO%^l-[Up`Oy%^z#h%^#h#i-n#i;'S%^;'S;=`%o<%lO%^l-uS!Y[p`Oy%^z;'S%^;'S;=`%o<%lO%^~.UWOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o<%lO.R~.sOi~~.vRO;'S.R;'S;=`/P;=`O.R~/SXOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o;=`<%l.R<%lO.R~/rP;=`<%l.Rn/zYyQOy%^z!Q%^!Q![0j![!c%^!c!i0j!i#T%^#T#Z0j#Z;'S%^;'S;=`%o<%lO%^l0oYp`Oy%^z!Q%^!Q![1_![!c%^!c!i1_!i#T%^#T#Z1_#Z;'S%^;'S;=`%o<%lO%^l1dYp`Oy%^z!Q%^!Q![2S![!c%^!c!i2S!i#T%^#T#Z2S#Z;'S%^;'S;=`%o<%lO%^l2ZYg[p`Oy%^z!Q%^!Q![2y![!c%^!c!i2y!i#T%^#T#Z2y#Z;'S%^;'S;=`%o<%lO%^l3QYg[p`Oy%^z!Q%^!Q![3p![!c%^!c!i3p!i#T%^#T#Z3p#Z;'S%^;'S;=`%o<%lO%^l3uYp`Oy%^z!Q%^!Q![4e![!c%^!c!i4e!i#T%^#T#Z4e#Z;'S%^;'S;=`%o<%lO%^l4lYg[p`Oy%^z!Q%^!Q![5[![!c%^!c!i5[!i#T%^#T#Z5[#Z;'S%^;'S;=`%o<%lO%^l5aYp`Oy%^z!Q%^!Q![6P![!c%^!c!i6P!i#T%^#T#Z6P#Z;'S%^;'S;=`%o<%lO%^l6WSg[p`Oy%^z;'S%^;'S;=`%o<%lO%^d6gUOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^d7QS}Sp`Oy%^z;'S%^;'S;=`%o<%lO%^b7cSXQOy%^z;'S%^;'S;=`%o<%lO%^~7rWOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W<%lO7o~8_RO;'S7o;'S;=`8h;=`O7o~8kXOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W;=`<%l7o<%lO7o~9ZP;=`<%l7on9cSc^Oy%^z;'S%^;'S;=`%o<%lO%^~9tOb~n9{UUQkWOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^n:fWkW!SQOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^l;TUp`Oy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^l;nYp`#e[Oy%^z!Q%^!Q![;g![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^l<cYp`Oy%^z{%^{|=R|}%^}!O=R!O!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=WUp`Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=qUp`#e[Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l>[[p`#e[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^n?VSu^Oy%^z;'S%^;'S;=`%o<%lO%^l?hWkWOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^n@VUZQOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^~@nTkWOy%^z{@}{;'S%^;'S;=`%o<%lO%^~AUSp`#]~Oy%^z;'S%^;'S;=`%o<%lO%^lAg[#e[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^bBbU^QOy%^z![%^![!]Bt!];'S%^;'S;=`%o<%lO%^bB{S_Qp`Oy%^z;'S%^;'S;=`%o<%lO%^nC^S!Z^Oy%^z;'S%^;'S;=`%o<%lO%^dCoS}SOy%^z;'S%^;'S;=`%o<%lO%^bDQU!PQOy%^z!`%^!`!aDd!a;'S%^;'S;=`%o<%lO%^bDkS!PQp`Oy%^z;'S%^;'S;=`%o<%lO%^bDzWOy%^z!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bEk[!]Qp`Oy%^z}%^}!OEd!O!Q%^!Q![Ed![!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^nFfSr^Oy%^z;'S%^;'S;=`%o<%lO%^nFwSq^Oy%^z;'S%^;'S;=`%o<%lO%^bGWUOy%^z#b%^#b#cGj#c;'S%^;'S;=`%o<%lO%^bGoUp`Oy%^z#W%^#W#XHR#X;'S%^;'S;=`%o<%lO%^bHYS!cQp`Oy%^z;'S%^;'S;=`%o<%lO%^bHiUOy%^z#f%^#f#gHR#g;'S%^;'S;=`%o<%lO%^fIQS!UUOy%^z;'S%^;'S;=`%o<%lO%^nIcS!T^Oy%^z;'S%^;'S;=`%o<%lO%^fItU!SQOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^`JZP;=`<%l$}",tokenizers:[Yhe,Khe,qhe,1,2,3,4,new ep("m~RRYZ[z{a~~g~aO#_~~dP!P!Qg~lO#`~~",28,106)],topRules:{StyleSheet:[0,4],Styles:[1,87]},specialized:[{term:101,get:i=>efe[i]||-1},{term:59,get:i=>tfe[i]||-1},{term:102,get:i=>ife[i]||-1}],tokenPrec:1219});let Om=null;function ym(){if(!Om&&typeof document=="object"&&document.body){let{style:i}=document.body,e=[],t=new Set;for(let n in i)n!="cssText"&&n!="cssFloat"&&typeof i[n]=="string"&&(/[A-Z]/.test(n)&&(n=n.replace(/[A-Z]/g,r=>"-"+r.toLowerCase())),t.has(n)||(e.push(n),t.add(n)));Om=e.sort().map(n=>({type:"property",label:n,apply:n+": "}))}return Om||[]}const e2=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(i=>({type:"class",label:i})),t2=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(i=>({type:"keyword",label:i})).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(i=>({type:"constant",label:i}))),rfe=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(i=>({type:"type",label:i})),sfe=["@charset","@color-profile","@container","@counter-style","@font-face","@font-feature-values","@font-palette-values","@import","@keyframes","@layer","@media","@namespace","@page","@position-try","@property","@scope","@starting-style","@supports","@view-transition"].map(i=>({type:"keyword",label:i})),_r=/^(\w[\w-]*|-\w[\w-]*|)$/,ofe=/^-(-[\w-]*)?$/;function afe(i,e){var t;if((i.name=="("||i.type.isError)&&(i=i.parent||i),i.name!="ArgList")return!1;let n=(t=i.parent)===null||t===void 0?void 0:t.firstChild;return(n==null?void 0:n.name)!="Callee"?!1:e.sliceString(n.from,n.to)=="var"}const i2=new l$,lfe=["Declaration"];function ufe(i){for(let e=i;;){if(e.type.isTop)return e;if(!(e=e.parent))return i}}function r6(i,e,t){if(e.to-e.from>4096){let n=i2.get(e);if(n)return n;let r=[],s=new Set,o=e.cursor(it.IncludeAnonymous);if(o.firstChild())do for(let a of r6(i,o.node,t))s.has(a.label)||(s.add(a.label),r.push(a));while(o.nextSibling());return i2.set(e,r),r}else{let n=[],r=new Set;return e.cursor().iterate(s=>{var o;if(t(s)&&s.matchContext(lfe)&&((o=s.node.nextSibling)===null||o===void 0?void 0:o.name)==":"){let a=i.sliceString(s.from,s.to);r.has(a)||(r.add(a),n.push({label:a,type:"variable"}))}}),n}}const s6=i=>e=>{let{state:t,pos:n}=e,r=bt(t).resolveInner(n,-1),s=r.type.isError&&r.from==r.to-1&&t.doc.sliceString(r.from,r.to)=="-";if(r.name=="PropertyName"||(s||r.name=="TagName")&&/^(Block|Styles)$/.test(r.resolve(r.to).name))return{from:r.from,options:ym(),validFor:_r};if(r.name=="ValueName")return{from:r.from,options:t2,validFor:_r};if(r.name=="PseudoClassName")return{from:r.from,options:e2,validFor:_r};if(i(r)||(e.explicit||s)&&afe(r,t.doc))return{from:i(r)||s?r.from:n,options:r6(t.doc,ufe(r),i),validFor:ofe};if(r.name=="TagName"){for(let{parent:l}=r;l;l=l.parent)if(l.name=="Block")return{from:r.from,options:ym(),validFor:_r};return{from:r.from,options:rfe,validFor:_r}}if(r.name=="AtKeyword")return{from:r.from,options:sfe,validFor:_r};if(!e.explicit)return null;let o=r.resolve(n),a=o.childBefore(n);return a&&a.name==":"&&o.name=="PseudoClassSelector"?{from:n,options:e2,validFor:_r}:a&&a.name==":"&&o.name=="Declaration"||o.name=="ArgList"?{from:n,options:t2,validFor:_r}:o.name=="Block"||o.name=="Styles"?{from:n,options:ym(),validFor:_r}:null},o6=s6(i=>i.name=="VariableName"),Yu=Xa.define({name:"css",parser:nfe.configure({props:[gl.add({Declaration:Mf()}),Cc.add({"Block KeyframeList":m$})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function a6(){return new qa(Yu,Yu.data.of({autocomplete:o6}))}const cfe=Object.freeze(Object.defineProperty({__proto__:null,css:a6,cssCompletionSource:o6,cssLanguage:Yu,defineCSSCompletionSource:s6},Symbol.toStringTag,{value:"Module"})),hfe=314,ffe=315,n2=1,dfe=2,pfe=3,gfe=4,mfe=316,vfe=318,Ofe=319,yfe=5,bfe=6,xfe=0,UO=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],l6=125,Sfe=59,VO=47,kfe=42,Tfe=43,Efe=45,wfe=60,_fe=44,Cfe=63,Afe=46,Pfe=91,Rfe=new Z3({start:!1,shift(i,e){return e==yfe||e==bfe||e==vfe?i:e==Ofe},strict:!1}),Lfe=new Sn((i,e)=>{let{next:t}=i;(t==l6||t==-1||e.context)&&i.acceptToken(mfe)},{contextual:!0,fallback:!0}),Ife=new Sn((i,e)=>{let{next:t}=i,n;UO.indexOf(t)>-1||t==VO&&((n=i.peek(1))==VO||n==kfe)||t!=l6&&t!=Sfe&&t!=-1&&!e.context&&i.acceptToken(hfe)},{contextual:!0}),Dfe=new Sn((i,e)=>{i.next==Pfe&&!e.context&&i.acceptToken(ffe)},{contextual:!0}),$fe=new Sn((i,e)=>{let{next:t}=i;if(t==Tfe||t==Efe){if(i.advance(),t==i.next){i.advance();let n=!e.context&&e.canShift(n2);i.acceptToken(n?n2:dfe)}}else t==Cfe&&i.peek(1)==Afe&&(i.advance(),i.advance(),(i.next<48||i.next>57)&&i.acceptToken(pfe))},{contextual:!0});function bm(i,e){return i>=65&&i<=90||i>=97&&i<=122||i==95||i>=192||!e&&i>=48&&i<=57}const Mfe=new Sn((i,e)=>{if(i.next!=wfe||!e.dialectEnabled(xfe)||(i.advance(),i.next==VO))return;let t=0;for(;UO.indexOf(i.next)>-1;)i.advance(),t++;if(bm(i.next,!0)){for(i.advance(),t++;bm(i.next,!1);)i.advance(),t++;for(;UO.indexOf(i.next)>-1;)i.advance(),t++;if(i.next==_fe)return;for(let n=0;;n++){if(n==7){if(!bm(i.next,!0))return;break}if(i.next!="extends".charCodeAt(n))break;i.advance(),t++}}i.acceptToken(gfe,-t)}),Ffe=dl({"get set async static":w.modifier,"for while do if else switch try catch finally return throw break continue default case":w.controlKeyword,"in of await yield void typeof delete instanceof":w.operatorKeyword,"let var const using function class extends":w.definitionKeyword,"import export from":w.moduleKeyword,"with debugger as new":w.keyword,TemplateString:w.special(w.string),super:w.atom,BooleanLiteral:w.bool,this:w.self,null:w.null,Star:w.modifier,VariableName:w.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":w.function(w.variableName),VariableDefinition:w.definition(w.variableName),Label:w.labelName,PropertyName:w.propertyName,PrivatePropertyName:w.special(w.propertyName),"CallExpression/MemberExpression/PropertyName":w.function(w.propertyName),"FunctionDeclaration/VariableDefinition":w.function(w.definition(w.variableName)),"ClassDeclaration/VariableDefinition":w.definition(w.className),"NewExpression/VariableName":w.className,PropertyDefinition:w.definition(w.propertyName),PrivatePropertyDefinition:w.definition(w.special(w.propertyName)),UpdateOp:w.updateOperator,"LineComment Hashbang":w.lineComment,BlockComment:w.blockComment,Number:w.number,String:w.string,Escape:w.escape,ArithOp:w.arithmeticOperator,LogicOp:w.logicOperator,BitOp:w.bitwiseOperator,CompareOp:w.compareOperator,RegExp:w.regexp,Equals:w.definitionOperator,Arrow:w.function(w.punctuation),": Spread":w.punctuation,"( )":w.paren,"[ ]":w.squareBracket,"{ }":w.brace,"InterpolationStart InterpolationEnd":w.special(w.brace),".":w.derefOperator,", ;":w.separator,"@":w.meta,TypeName:w.typeName,TypeDefinition:w.definition(w.typeName),"type enum interface implements namespace module declare":w.definitionKeyword,"abstract global Privacy readonly override":w.modifier,"is keyof unique infer asserts":w.operatorKeyword,JSXAttributeValue:w.attributeValue,JSXText:w.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":w.angleBracket,"JSXIdentifier JSXNameSpacedName":w.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":w.attributeName,"JSXBuiltin/JSXIdentifier":w.standard(w.tagName)}),Nfe={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,const:52,extends:56,this:60,true:68,false:68,null:80,void:84,typeof:88,super:104,new:138,delete:150,yield:159,await:163,class:168,public:231,private:231,protected:231,readonly:233,instanceof:252,satisfies:255,in:256,import:290,keyof:347,unique:351,infer:357,asserts:393,is:395,abstract:415,implements:417,type:419,let:422,var:424,using:427,interface:433,enum:437,namespace:443,module:445,declare:449,global:453,for:472,of:481,while:484,with:488,do:492,if:496,else:498,switch:502,case:508,try:514,catch:518,finally:522,return:526,throw:530,break:534,continue:538,debugger:542},Qfe={__proto__:null,async:125,get:127,set:129,declare:191,public:193,private:193,protected:193,static:195,abstract:197,override:199,readonly:205,accessor:207,new:399},Bfe={__proto__:null,"<":189},Ufe=Ka.deserialize({version:14,states:"$EOQ%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#D_O.QQlO'#DeO.bQlO'#DpO%[QlO'#DxO0fQlO'#EQOOQ!0Lf'#EY'#EYO1PQ`O'#EVOOQO'#En'#EnOOQO'#Ij'#IjO1XQ`O'#GrO1dQ`O'#EmO1iQ`O'#EmO3hQ!0MxO'#JpO6[Q!0MxO'#JqO6uQ`O'#F[O6zQ,UO'#FsOOQ!0Lf'#Fe'#FeO7VO7dO'#FeO7eQMhO'#F{O9UQ`O'#FzOOQ!0Lf'#Jq'#JqOOQ!0Lb'#Jp'#JpO9ZQ`O'#GvOOQ['#K]'#K]O9fQ`O'#IWO9kQ!0LrO'#IXOOQ['#J^'#J^OOQ['#I]'#I]Q`QlOOQ`QlOOO9sQ!L^O'#DtO9zQlO'#D|O:RQlO'#EOO9aQ`O'#GrO:YQMhO'#CoO:hQ`O'#ElO:sQ`O'#EwO:xQMhO'#FdO;gQ`O'#GrOOQO'#K^'#K^O;lQ`O'#K^O;zQ`O'#GzO;zQ`O'#G{O;zQ`O'#G}O9aQ`O'#HQO<qQ`O'#HTO>YQ`O'#CeO>jQ`O'#HaO>rQ`O'#HgO>rQ`O'#HiO`QlO'#HkO>rQ`O'#HmO>rQ`O'#HpO>wQ`O'#HvO>|Q!0LsO'#H|O%[QlO'#IOO?XQ!0LsO'#IQO?dQ!0LsO'#ISO9kQ!0LrO'#IUO?oQ!0MxO'#CiO@qQpO'#DjQOQ`OOO%[QlO'#EOOAXQ`O'#ERO:YQMhO'#ElOAdQ`O'#ElOAoQ!bO'#FdOOQ['#Cg'#CgOOQ!0Lb'#Do'#DoOOQ!0Lb'#Jt'#JtO%[QlO'#JtOOQO'#Jw'#JwOOQO'#If'#IfOBoQpO'#EeOOQ!0Lb'#Ed'#EdOOQ!0Lb'#J{'#J{OCkQ!0MSO'#EeOCuQpO'#EUOOQO'#Jv'#JvODZQpO'#JwOEhQpO'#EUOCuQpO'#EePEuO&2DjO'#CbPOOO)CD{)CD{OOOO'#I^'#I^OFQO#tO,59UOOQ!0Lh,59U,59UOOOO'#I_'#I_OF`O&jO,59UOFnQ!L^O'#DaOOOO'#Ia'#IaOFuO#@ItO,59yOOQ!0Lf,59y,59yOGTQlO'#IbOGhQ`O'#JrOIgQ!fO'#JrO+}QlO'#JrOInQ`O,5:POJUQ`O'#EnOJcQ`O'#KROJnQ`O'#KQOJnQ`O'#KQOJvQ`O,5;[OJ{Q`O'#KPOOQ!0Ln,5:[,5:[OKSQlO,5:[OMQQ!0MxO,5:dOMqQ`O,5:lON[Q!0LrO'#KOONcQ`O'#J}O9ZQ`O'#J}ONwQ`O'#J}O! PQ`O,5;ZO! UQ`O'#J}O!#ZQ!fO'#JqOOQ!0Lh'#Ci'#CiO%[QlO'#EQO!#yQ!fO,5:qOOQS'#Jx'#JxOOQO-E<h-E<hO9aQ`O,5=^O!$aQ`O,5=^O!$fQlO,5;XO!&iQMhO'#EiO!(SQ`O,5;XO!(XQlO'#DwO!(cQpO,5;bO!(kQpO,5;bO%[QlO,5;bOOQ['#FS'#FSOOQ['#FU'#FUO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cOOQ['#FY'#FYO!(yQlO,5;sOOQ!0Lf,5;x,5;xOOQ!0Lf,5;y,5;yOOQ!0Lf,5;{,5;{O%[QlO'#InO!*|Q!0LrO,5<hO%[QlO,5;cO!&iQMhO,5;cO!+kQMhO,5;cO!-]QMhO'#E[O%[QlO,5;vOOQ!0Lf,5;z,5;zO!-dQ,UO'#FiO!.aQ,UO'#KVO!-{Q,UO'#KVO!.hQ,UO'#KVOOQO'#KV'#KVO!.|Q,UO,5<ROOOW,5<_,5<_O!/_QlO'#FuOOOW'#Im'#ImO7VO7dO,5<PO!/fQ,UO'#FwOOQ!0Lf,5<P,5<PO!0VQ$IUO'#CwOOQ!0Lh'#C{'#C{O!0jO#@ItO'#DPO!1WQMjO,5<dO!1_Q`O,5<gO!2zQ(CWO'#GWO!3XQ`O'#GXO!3^Q`O'#GXO!4|Q(CWO'#G]O!6RQpO'#GaOOQO'#Gm'#GmO!+rQMhO'#GlOOQO'#Go'#GoO!+rQMhO'#GnO!6tQ$IUO'#JjOOQ!0Lh'#Jj'#JjO!7OQ`O'#JiO!7^Q`O'#JhO!7fQ`O'#CuOOQ!0Lh'#Cy'#CyO!7qQ`O'#C{OOQ!0Lh'#DT'#DTOOQ!0Lh'#DV'#DVO1SQ`O'#DXO!+rQMhO'#GOO!+rQMhO'#GQO!7vQ`O'#GSO!7{Q`O'#GTO!3^Q`O'#GZO!+rQMhO'#G`O;zQ`O'#JiO!8QQ`O'#EoO!8oQ`O,5<fOOQ!0Lb'#Cr'#CrO!8wQ`O'#EpO!9qQpO'#EqOOQ!0Lb'#KP'#KPO!9xQ!0LrO'#K_O9kQ!0LrO,5=bO`QlO,5>rOOQ['#Jf'#JfOOQ[,5>s,5>sOOQ[-E<Z-E<ZO!;wQ!0MxO,5:`O!9lQpO,5:^O!>bQ!0MxO,5:hO%[QlO,5:hO!@xQ!0MxO,5:jOOQO,5@x,5@xO!AiQMhO,5=^O!AwQ!0LrO'#JgO9UQ`O'#JgO!BYQ!0LrO,59ZO!BeQpO,59ZO!BmQMhO,59ZO:YQMhO,59ZO!BxQ`O,5;XO!CQQ`O'#H`O!CfQ`O'#KbO%[QlO,5;|O!9lQpO,5<OO!CnQ`O,5=yO!CsQ`O,5=yO!CxQ`O,5=yO9kQ!0LrO,5=yO;zQ`O,5=iOOQO'#Cw'#CwO!DWQpO,5=fO!D`QMhO,5=gO!DkQ`O,5=iO!DpQ!bO,5=lO!DxQ`O'#K^O>wQ`O'#HVO9aQ`O'#HXO!D}Q`O'#HXO:YQMhO'#HZO!ESQ`O'#HZOOQ[,5=o,5=oO!EXQ`O'#H[O!EjQ`O'#CoO!EoQ`O,59PO!EyQ`O,59PO!HOQlO,59POOQ[,59P,59PO!H`Q!0LrO,59PO%[QlO,59PO!JkQlO'#HcOOQ['#Hd'#HdOOQ['#He'#HeO`QlO,5={O!KRQ`O,5={O`QlO,5>RO`QlO,5>TO!KWQ`O,5>VO`QlO,5>XO!K]Q`O,5>[O!KbQlO,5>bOOQ[,5>h,5>hO%[QlO,5>hO9kQ!0LrO,5>jOOQ[,5>l,5>lO# lQ`O,5>lOOQ[,5>n,5>nO# lQ`O,5>nOOQ[,5>p,5>pO#!YQpO'#D]O%[QlO'#JtO#!{QpO'#JtO##VQpO'#DkO##hQpO'#DkO#%yQlO'#DkO#&QQ`O'#JsO#&YQ`O,5:UO#&_Q`O'#ErO#&mQ`O'#KSO#&uQ`O,5;]O#&zQpO'#DkO#'XQpO'#ETOOQ!0Lf,5:m,5:mO%[QlO,5:mO#'`Q`O,5:mO>wQ`O,5;WO!BeQpO,5;WO!BmQMhO,5;WO:YQMhO,5;WO#'hQ`O,5@`O#'mQ07dO,5:qOOQO-E<d-E<dO#(sQ!0MSO,5;POCuQpO,5:pO#(}QpO,5:pOCuQpO,5;PO!BYQ!0LrO,5:pOOQ!0Lb'#Eh'#EhOOQO,5;P,5;PO%[QlO,5;PO#)[Q!0LrO,5;PO#)gQ!0LrO,5;PO!BeQpO,5:pOOQO,5;V,5;VO#)uQ!0LrO,5;PPOOO'#I['#I[P#*ZO&2DjO,58|POOO,58|,58|OOOO-E<[-E<[OOQ!0Lh1G.p1G.pOOOO-E<]-E<]OOOO,59{,59{O#*fQ!bO,59{OOOO-E<_-E<_OOQ!0Lf1G/e1G/eO#*kQ!fO,5>|O+}QlO,5>|OOQO,5?S,5?SO#*uQlO'#IbOOQO-E<`-E<`O#+SQ`O,5@^O#+[Q!fO,5@^O#+cQ`O,5@lOOQ!0Lf1G/k1G/kO%[QlO,5@mO#+kQ`O'#IhOOQO-E<f-E<fO#+cQ`O,5@lOOQ!0Lb1G0v1G0vOOQ!0Ln1G/v1G/vOOQ!0Ln1G0W1G0WO%[QlO,5@jO#,PQ!0LrO,5@jO#,bQ!0LrO,5@jO#,iQ`O,5@iO9ZQ`O,5@iO#,qQ`O,5@iO#-PQ`O'#IkO#,iQ`O,5@iOOQ!0Lb1G0u1G0uO!(cQpO,5:sO!(nQpO,5:sOOQS,5:u,5:uO#-qQdO,5:uO#-yQMhO1G2xO9aQ`O1G2xOOQ!0Lf1G0s1G0sO#.XQ!0MxO1G0sO#/^Q!0MvO,5;TOOQ!0Lh'#GV'#GVO#/zQ!0MzO'#JjO!$fQlO1G0sO#2VQ!fO'#JuO%[QlO'#JuO#2aQ`O,5:cOOQ!0Lh'#D]'#D]OOQ!0Lf1G0|1G0|O%[QlO1G0|OOQ!0Lf1G1e1G1eO#2fQ`O1G0|O#4zQ!0MxO1G0}O#5RQ!0MxO1G0}O#7iQ!0MxO1G0}O#7pQ!0MxO1G0}O#:WQ!0MxO1G0}O#<nQ!0MxO1G0}O#<uQ!0MxO1G0}O#<|Q!0MxO1G0}O#?dQ!0MxO1G0}O#?kQ!0MxO1G0}O#AxQ?MtO'#CiO#CsQ?MtO1G1_O#CzQ?MtO'#JqO#D_Q!0MxO,5?YOOQ!0Lb-E<l-E<lO#FlQ!0MxO1G0}O#GiQ!0MzO1G0}OOQ!0Lf1G0}1G0}O#HlQMjO'#JzO#HvQ`O,5:vO#H{Q!0MxO1G1bO#IoQ,UO,5<VO#IwQ,UO,5<WO#JPQ,UO'#FnO#JhQ`O'#FmOOQO'#KW'#KWOOQO'#Il'#IlO#JmQ,UO1G1mOOQ!0Lf1G1m1G1mOOOW1G1x1G1xO#KOQ?MtO'#JpO#KYQ`O,5<aO!(yQlO,5<aOOOW-E<k-E<kOOQ!0Lf1G1k1G1kO#K_QpO'#KVOOQ!0Lf,5<c,5<cO#KgQpO,5<cO#KlQMhO'#DROOOO'#I`'#I`O#KsO#@ItO,59kOOQ!0Lh,59k,59kO%[QlO1G2OO!7{Q`O'#IpO#LOQ`O,5<yOOQ!0Lh,5<v,5<vO!+rQMhO'#IsO#LlQMjO,5=WO!+rQMhO'#IuO#M_QMjO,5=YO!&iQMhO,5=[OOQO1G2R1G2RO#MiQ!dO'#CrO#M|Q(CWO'#EpO$ RQpO'#GaO$ iQ!dO,5<rO$ pQ`O'#KYO9ZQ`O'#KYO$!OQ`O,5<tO!+rQMhO,5<sO$!TQ`O'#GYO$!fQ`O,5<sO$!kQ!dO'#GVO$!xQ!dO'#KZO$#SQ`O'#KZO!&iQMhO'#KZO$#XQ`O,5<wO$#^QlO'#JtO$#hQpO'#GbO##hQpO'#GbO$#yQ`O'#GfO!3^Q`O'#GjO$$OQ!0LrO'#IrO$$ZQpO,5<{OOQ!0Lp,5<{,5<{O$$bQpO'#GbO$$oQpO'#GcO$%QQpO'#GcO$%VQMjO,5=WO$%gQMjO,5=YOOQ!0Lh,5=],5=]O!+rQMhO,5@TO!+rQMhO,5@TO$%wQ`O'#IwO$&VQ`O,5@SO$&_Q`O,59aOOQ!0Lh,59g,59gO$'UQ$IYO,59sOOQ!0Lh'#Jn'#JnO$'wQMjO,5<jO$(jQMjO,5<lO@iQ`O,5<nOOQ!0Lh,5<o,5<oO$(tQ`O,5<uO$(yQMjO,5<zO$)ZQ`O,5@TO$)iQ`O'#J}O!$fQlO1G2QO$)nQ`O1G2QO9ZQ`O'#KQO9ZQ`O'#ErO%[QlO'#ErO9ZQ`O'#IyO$)sQ!0LrO,5@yOOQ[1G2|1G2|OOQ[1G4^1G4^OOQ!0Lf1G/z1G/zOOQ!0Lf1G/x1G/xO$+uQ!0MxO1G0SOOQ[1G2x1G2xO!&iQMhO1G2xO%[QlO1G2xO#-|Q`O1G2xO$-yQMhO'#EiOOQ!0Lb,5@R,5@RO$.WQ!0LrO,5@ROOQ[1G.u1G.uO!BYQ!0LrO1G.uO!BeQpO1G.uO!BmQMhO1G.uO$.iQ`O1G0sO$.nQ`O'#CiO$.yQ`O'#KcO$/RQ`O,5=zO$/WQ`O'#KcO$/]Q`O'#KcO$/kQ`O'#JPO$/yQ`O,5@|O$0RQ!fO1G1hOOQ!0Lf1G1j1G1jO9aQ`O1G3eO@iQ`O1G3eO$0YQ`O1G3eO$0_Q`O1G3eOOQ[1G3e1G3eO!DkQ`O1G3TO!&iQMhO1G3QO$0dQ`O1G3QOOQ[1G3R1G3RO!&iQMhO1G3RO$0iQ`O1G3RO$0qQpO'#HPOOQ[1G3T1G3TO!5|QpO'#I{O!DpQ!bO1G3WOOQ[1G3W1G3WOOQ[,5=q,5=qO$0yQMhO,5=sO9aQ`O,5=sO$#yQ`O,5=uO9UQ`O,5=uO!BeQpO,5=uO!BmQMhO,5=uO:YQMhO,5=uO$1XQ`O'#KaO$1dQ`O,5=vOOQ[1G.k1G.kO$1iQ!0LrO1G.kO@iQ`O1G.kO$1tQ`O1G.kO9kQ!0LrO1G.kO$3|Q!fO,5AOO$4ZQ`O,5AOO9ZQ`O,5AOO$4fQlO,5=}O$4mQ`O,5=}OOQ[1G3g1G3gO`QlO1G3gOOQ[1G3m1G3mOOQ[1G3o1G3oO>rQ`O1G3qO$4rQlO1G3sO$8vQlO'#HrOOQ[1G3v1G3vO$9TQ`O'#HxO>wQ`O'#HzOOQ[1G3|1G3|O$9]QlO1G3|O9kQ!0LrO1G4SOOQ[1G4U1G4UOOQ!0Lb'#G^'#G^O9kQ!0LrO1G4WO9kQ!0LrO1G4YO$=dQ`O,5@`O!(yQlO,5;^O9ZQ`O,5;^O>wQ`O,5:VO!(yQlO,5:VO!BeQpO,5:VO$=iQ?MtO,5:VOOQO,5;^,5;^O$=sQpO'#IcO$>ZQ`O,5@_OOQ!0Lf1G/p1G/pO$>cQpO'#IiO$>mQ`O,5@nOOQ!0Lb1G0w1G0wO##hQpO,5:VOOQO'#Ie'#IeO$>uQpO,5:oOOQ!0Ln,5:o,5:oO#'cQ`O1G0XOOQ!0Lf1G0X1G0XO%[QlO1G0XOOQ!0Lf1G0r1G0rO>wQ`O1G0rO!BeQpO1G0rO!BmQMhO1G0rOOQ!0Lb1G5z1G5zO!BYQ!0LrO1G0[OOQO1G0k1G0kO%[QlO1G0kO$>|Q!0LrO1G0kO$?XQ!0LrO1G0kO!BeQpO1G0[OCuQpO1G0[O$?gQ!0LrO1G0kOOQO1G0[1G0[O$?{Q!0MxO1G0kPOOO-E<Y-E<YPOOO1G.h1G.hOOOO1G/g1G/gO$@VQ!bO,5<hO$@_Q!fO1G4hOOQO1G4n1G4nO%[QlO,5>|O$@iQ`O1G5xO$@qQ`O1G6WO$@yQ!fO1G6XO9ZQ`O,5?SO$ATQ!0MxO1G6UO%[QlO1G6UO$AeQ!0LrO1G6UO$AvQ`O1G6TO$AvQ`O1G6TO9ZQ`O1G6TO$BOQ`O,5?VO9ZQ`O,5?VOOQO,5?V,5?VO$BdQ`O,5?VO$)iQ`O,5?VOOQO-E<i-E<iOOQS1G0_1G0_OOQS1G0a1G0aO#-tQ`O1G0aOOQ[7+(d7+(dO!&iQMhO7+(dO%[QlO7+(dO$BrQ`O7+(dO$B}QMhO7+(dO$C]Q!0MzO,5=WO$EhQ!0MzO,5=YO$GsQ!0MzO,5=WO$JUQ!0MzO,5=YO$LgQ!0MzO,59sO$NlQ!0MzO,5<jO%!wQ!0MzO,5<lO%%SQ!0MzO,5<zOOQ!0Lf7+&_7+&_O%'eQ!0MxO7+&_O%(XQlO'#IdO%(fQ`O,5@aO%(nQ!fO,5@aOOQ!0Lf1G/}1G/}O%(xQ`O7+&hOOQ!0Lf7+&h7+&hO%(}Q?MtO,5:dO%[QlO7+&yO%)XQ?MtO,5:`O%)fQ?MtO,5:hO%)pQ?MtO,5:jO%)zQMhO'#IgO%*UQ`O,5@fOOQ!0Lh1G0b1G0bOOQO1G1q1G1qOOQO1G1r1G1rO%*^Q!jO,5<YO!(yQlO,5<XOOQO-E<j-E<jOOQ!0Lf7+'X7+'XOOOW7+'d7+'dOOOW1G1{1G1{O%*iQ`O1G1{OOQ!0Lf1G1}1G1}OOOO,59m,59mO%*nQ!dO,59mOOOO-E<^-E<^OOQ!0Lh1G/V1G/VO%*uQ!0MxO7+'jOOQ!0Lh,5?[,5?[O%+iQMhO1G2eP%+pQ`O'#IpPOQ!0Lh-E<n-E<nO%,^QMjO,5?_OOQ!0Lh-E<q-E<qO%-PQMjO,5?aOOQ!0Lh-E<s-E<sO%-ZQ!dO1G2vO%-bQ!dO'#CrO%-xQMhO'#KQO$#^QlO'#JtOOQ!0Lh1G2^1G2^O%.PQ`O'#IoO%.eQ`O,5@tO%.eQ`O,5@tO%.mQ`O,5@tO%.xQ`O,5@tOOQO1G2`1G2`O%/WQMjO1G2_O!+rQMhO1G2_O%/hQ(CWO'#IqO%/uQ`O,5@uO!&iQMhO,5@uO%/}Q!dO,5@uOOQ!0Lh1G2c1G2cO%2_Q!fO'#CiO%2iQ`O,5=OOOQ!0Lb,5<|,5<|O%2qQpO,5<|OOQ!0Lb,5<},5<}OCfQ`O,5<|O%2|QpO,5<|OOQ!0Lb,5=Q,5=QO$)iQ`O,5=UOOQO,5?^,5?^OOQO-E<p-E<pOOQ!0Lp1G2g1G2gO##hQpO,5<|O$#^QlO,5=OO%3[Q`O,5<}O%3gQpO,5<}O!+rQMhO'#IsO%4aQMjO1G2rO!+rQMhO'#IuO%5SQMjO1G2tO%5^QMjO1G5oO%5hQMjO1G5oOOQO,5?c,5?cOOQO-E<u-E<uOOQO1G.{1G.{O!9lQpO,59uO%[QlO,59uOOQ!0Lh,5<i,5<iO%5uQ`O1G2YO!+rQMhO1G2aO!+rQMhO1G5oO!+rQMhO1G5oO%5zQ!0MxO7+'lOOQ!0Lf7+'l7+'lO!$fQlO7+'lO%6nQ`O,5;^OOQ!0Lb,5?e,5?eOOQ!0Lb-E<w-E<wO%6sQ!dO'#K[O#'cQ`O7+(dO4UQ!fO7+(dO$BuQ`O7+(dO%6}Q!0MvO'#CiO%7nQ!0LrO,5=RO%8PQ!0MvO,5=RO%8dQ`O,5=ROOQ!0Lb1G5m1G5mOOQ[7+$a7+$aO!BYQ!0LrO7+$aO!BeQpO7+$aO!$fQlO7+&_O%8lQ`O'#JOO%9TQ`O,5@}OOQO1G3f1G3fO9aQ`O,5@}O%9TQ`O,5@}O%9]Q`O,5@}OOQO,5?k,5?kOOQO-E<}-E<}OOQ!0Lf7+'S7+'SO%9bQ`O7+)PO9kQ!0LrO7+)PO9aQ`O7+)PO@iQ`O7+)POOQ[7+(o7+(oO%9gQ!0MvO7+(lO!&iQMhO7+(lO!DfQ`O7+(mOOQ[7+(m7+(mO!&iQMhO7+(mO%9qQ`O'#K`O%9|Q`O,5=kOOQO,5?g,5?gOOQO-E<y-E<yOOQ[7+(r7+(rO%;`QpO'#HYOOQ[1G3_1G3_O!&iQMhO1G3_O%[QlO1G3_O%;gQ`O1G3_O%;rQMhO1G3_O9kQ!0LrO1G3aO$#yQ`O1G3aO9UQ`O1G3aO!BeQpO1G3aO!BmQMhO1G3aO%<QQ`O'#I}O%<fQ`O,5@{O%<nQpO,5@{OOQ!0Lb1G3b1G3bOOQ[7+$V7+$VO@iQ`O7+$VO9kQ!0LrO7+$VO%<yQ`O7+$VO%[QlO1G6jO%[QlO1G6kO%=OQ!0LrO1G6jO%=YQlO1G3iO%=aQ`O1G3iO%=fQlO1G3iOOQ[7+)R7+)RO9kQ!0LrO7+)]O`QlO7+)_OOQ['#Kf'#KfOOQ['#JQ'#JQO%=mQlO,5>^OOQ[,5>^,5>^O%[QlO'#HsO%=zQ`O'#HuOOQ[,5>d,5>dO9ZQ`O,5>dOOQ[,5>f,5>fOOQ[7+)h7+)hOOQ[7+)n7+)nOOQ[7+)r7+)rOOQ[7+)t7+)tO%>PQpO1G5zO%>kQ?MtO1G0xO%>uQ`O1G0xOOQO1G/q1G/qO%?QQ?MtO1G/qO>wQ`O1G/qO!(yQlO'#DkOOQO,5>},5>}OOQO-E<a-E<aOOQO,5?T,5?TOOQO-E<g-E<gO!BeQpO1G/qOOQO-E<c-E<cOOQ!0Ln1G0Z1G0ZOOQ!0Lf7+%s7+%sO#'cQ`O7+%sOOQ!0Lf7+&^7+&^O>wQ`O7+&^O!BeQpO7+&^OOQO7+%v7+%vO$?{Q!0MxO7+&VOOQO7+&V7+&VO%[QlO7+&VO%?[Q!0LrO7+&VO!BYQ!0LrO7+%vO!BeQpO7+%vO%?gQ!0LrO7+&VO%?uQ!0MxO7++pO%[QlO7++pO%@VQ`O7++oO%@VQ`O7++oOOQO1G4q1G4qO9ZQ`O1G4qO%@_Q`O1G4qOOQS7+%{7+%{O#'cQ`O<<LOO4UQ!fO<<LOO%@mQ`O<<LOOOQ[<<LO<<LOO!&iQMhO<<LOO%[QlO<<LOO%@uQ`O<<LOO%AQQ!0MzO,5?_O%C]Q!0MzO,5?aO%EhQ!0MzO1G2_O%GyQ!0MzO1G2rO%JUQ!0MzO1G2tO%LaQ!fO,5?OO%[QlO,5?OOOQO-E<b-E<bO%LkQ`O1G5{OOQ!0Lf<<JS<<JSO%LsQ?MtO1G0sO%NzQ?MtO1G0}O& RQ?MtO1G0}O&#SQ?MtO1G0}O&#ZQ?MtO1G0}O&%[Q?MtO1G0}O&']Q?MtO1G0}O&'dQ?MtO1G0}O&'kQ?MtO1G0}O&)lQ?MtO1G0}O&)sQ?MtO1G0}O&)zQ!0MxO<<JeO&+rQ?MtO1G0}O&,oQ?MvO1G0}O&-rQ?MvO'#JjO&/xQ?MtO1G1bO&0VQ?MtO1G0SO&0aQMjO,5?ROOQO-E<e-E<eO!(yQlO'#FpOOQO'#KX'#KXOOQO1G1t1G1tO&0kQ`O1G1sO&0pQ?MtO,5?YOOOW7+'g7+'gOOOO1G/X1G/XO&0zQ!dO1G4vOOQ!0Lh7+(P7+(PP!&iQMhO,5?[O!+rQMhO7+(bO&1RQ`O,5?ZO9ZQ`O,5?ZOOQO-E<m-E<mO&1aQ`O1G6`O&1aQ`O1G6`O&1iQ`O1G6`O&1tQMjO7+'yO&2UQ!dO,5?]O&2`Q`O,5?]O!&iQMhO,5?]OOQO-E<o-E<oO&2eQ!dO1G6aO&2oQ`O1G6aO&2wQ`O1G2jO!&iQMhO1G2jOOQ!0Lb1G2h1G2hOOQ!0Lb1G2i1G2iO%2qQpO1G2hO!BeQpO1G2hOCfQ`O1G2hOOQ!0Lb1G2p1G2pO&2|QpO1G2hO&3[Q`O1G2jO$)iQ`O1G2iOCfQ`O1G2iO$#^QlO1G2jO&3dQ`O1G2iO&4WQMjO,5?_OOQ!0Lh-E<r-E<rO&4yQMjO,5?aOOQ!0Lh-E<t-E<tO!+rQMhO7++ZOOQ!0Lh1G/a1G/aO&5TQ`O1G/aOOQ!0Lh7+'t7+'tO&5YQMjO7+'{O&5jQMjO7++ZO&5tQMjO7++ZO&6RQ!0MxO<<KWOOQ!0Lf<<KW<<KWO&6uQ`O1G0xO!&iQMhO'#IxO&6zQ`O,5@vO&8|Q!fO<<LOO!&iQMhO1G2mO&9TQ!0LrO1G2mOOQ[<<G{<<G{O!BYQ!0LrO<<G{O&9fQ!0MxO<<IyOOQ!0Lf<<Iy<<IyOOQO,5?j,5?jO&:YQ`O,5?jO&:_Q`O,5?jOOQO-E<|-E<|O&:mQ`O1G6iO&:mQ`O1G6iO9aQ`O1G6iO@iQ`O<<LkOOQ[<<Lk<<LkO&:uQ`O<<LkO9kQ!0LrO<<LkOOQ[<<LW<<LWO%9gQ!0MvO<<LWOOQ[<<LX<<LXO!DfQ`O<<LXO&:zQpO'#IzO&;VQ`O,5@zO!(yQlO,5@zOOQ[1G3V1G3VOOQO'#I|'#I|O9kQ!0LrO'#I|O&;_QpO,5=tOOQ[,5=t,5=tO&;fQpO'#EeO&;mQpO'#GdO&;rQ`O7+(yO&;wQ`O7+(yOOQ[7+(y7+(yO!&iQMhO7+(yO%[QlO7+(yO&<PQ`O7+(yOOQ[7+({7+({O9kQ!0LrO7+({O$#yQ`O7+({O9UQ`O7+({O!BeQpO7+({O&<[Q`O,5?iOOQO-E<{-E<{OOQO'#H]'#H]O&<gQ`O1G6gO9kQ!0LrO<<GqOOQ[<<Gq<<GqO@iQ`O<<GqO&<oQ`O7+,UO&<tQ`O7+,VO%[QlO7+,UO%[QlO7+,VOOQ[7+)T7+)TO&<yQ`O7+)TO&=OQlO7+)TO&=VQ`O7+)TOOQ[<<Lw<<LwOOQ[<<Ly<<LyOOQ[-E=O-E=OOOQ[1G3x1G3xO&=[Q`O,5>_OOQ[,5>a,5>aO&=aQ`O1G4OO9ZQ`O7+&dO!(yQlO7+&dOOQO7+%]7+%]O&=fQ?MtO1G6XO>wQ`O7+%]OOQ!0Lf<<I_<<I_OOQ!0Lf<<Ix<<IxO>wQ`O<<IxOOQO<<Iq<<IqO$?{Q!0MxO<<IqO%[QlO<<IqOOQO<<Ib<<IbO!BYQ!0LrO<<IbO&=pQ!0LrO<<IqO&={Q!0MxO<= [O&>]Q`O<= ZOOQO7+*]7+*]O9ZQ`O7+*]OOQ[ANAjANAjO&>eQ!fOANAjO!&iQMhOANAjO#'cQ`OANAjO4UQ!fOANAjO&>lQ`OANAjO%[QlOANAjO&>tQ!0MzO7+'yO&AVQ!0MzO,5?_O&CbQ!0MzO,5?aO&EmQ!0MzO7+'{O&HOQ!fO1G4jO&HYQ?MtO7+&_O&J^Q?MvO,5=WO&LeQ?MvO,5=YO&LuQ?MvO,5=WO&MVQ?MvO,5=YO&MgQ?MvO,59sO' mQ?MvO,5<jO'#pQ?MvO,5<lO'&UQ?MvO,5<zO''zQ?MtO7+'jO'(XQ?MtO7+'lO'(fQ`O,5<[OOQO7+'_7+'_OOQ!0Lh7+*b7+*bO'(kQMjO<<K|OOQO1G4u1G4uO'(rQ`O1G4uO'(}Q`O1G4uO')]Q`O7++zO')]Q`O7++zO!&iQMhO1G4wO')eQ!dO1G4wO')oQ`O7++{O')wQ`O7+(UO'*SQ!dO7+(UOOQ!0Lb7+(S7+(SOOQ!0Lb7+(T7+(TO!BeQpO7+(SOCfQ`O7+(SO'*^Q`O7+(UO!&iQMhO7+(UO$)iQ`O7+(TO'*cQ`O7+(UOCfQ`O7+(TO'*kQMjO<<NuOOQ!0Lh7+${7+${O!+rQMhO<<NuO'*uQ!dO,5?dOOQO-E<v-E<vO'+PQ!0MvO7+(XO!&iQMhO7+(XOOQ[AN=gAN=gO9aQ`O1G5UOOQO1G5U1G5UO'+aQ`O1G5UO'+fQ`O7+,TO'+fQ`O7+,TO9kQ!0LrOANBVO@iQ`OANBVOOQ[ANBVANBVOOQ[ANArANArOOQ[ANAsANAsO'+nQ`O,5?fOOQO-E<x-E<xO'+yQ?MtO1G6fOOQO,5?h,5?hOOQO-E<z-E<zOOQ[1G3`1G3`O',TQ`O,5=OOOQ[<<Le<<LeO!&iQMhO<<LeO&;rQ`O<<LeO',YQ`O<<LeO%[QlO<<LeOOQ[<<Lg<<LgO9kQ!0LrO<<LgO$#yQ`O<<LgO9UQ`O<<LgO',bQpO1G5TO',mQ`O7+,ROOQ[AN=]AN=]O9kQ!0LrOAN=]OOQ[<= p<= pOOQ[<= q<= qO',uQ`O<= pO',zQ`O<= qOOQ[<<Lo<<LoO'-PQ`O<<LoO'-UQlO<<LoOOQ[1G3y1G3yO>wQ`O7+)jO'-]Q`O<<JOO'-hQ?MtO<<JOOOQO<<Hw<<HwOOQ!0LfAN?dAN?dOOQOAN?]AN?]O$?{Q!0MxOAN?]OOQOAN>|AN>|O%[QlOAN?]OOQO<<Mw<<MwOOQ[G27UG27UO!&iQMhOG27UO#'cQ`OG27UO'-rQ!fOG27UO4UQ!fOG27UO'-yQ`OG27UO'.RQ?MtO<<JeO'.`Q?MvO1G2_O'0UQ?MvO,5?_O'2XQ?MvO,5?aO'4[Q?MvO1G2rO'6_Q?MvO1G2tO'8bQ?MtO<<KWO'8oQ?MtO<<IyOOQO1G1v1G1vO!+rQMhOANAhOOQO7+*a7+*aO'8|Q`O7+*aO'9XQ`O<= fO'9aQ!dO7+*cOOQ!0Lb<<Kp<<KpO$)iQ`O<<KpOCfQ`O<<KpO'9kQ`O<<KpO!&iQMhO<<KpOOQ!0Lb<<Kn<<KnO!BeQpO<<KnO'9vQ!dO<<KpOOQ!0Lb<<Ko<<KoO':QQ`O<<KpO!&iQMhO<<KpO$)iQ`O<<KoO':VQMjOANDaO':aQ!0MvO<<KsOOQO7+*p7+*pO9aQ`O7+*pO':qQ`O<= oOOQ[G27qG27qO9kQ!0LrOG27qO!(yQlO1G5QO':yQ`O7+,QO';RQ`O1G2jO&;rQ`OANBPOOQ[ANBPANBPO!&iQMhOANBPO';WQ`OANBPOOQ[ANBRANBRO9kQ!0LrOANBRO$#yQ`OANBROOQO'#H^'#H^OOQO7+*o7+*oOOQ[G22wG22wOOQ[ANE[ANE[OOQ[ANE]ANE]OOQ[ANBZANBZO';`Q`OANBZOOQ[<<MU<<MUO!(yQlOAN?jOOQOG24wG24wO$?{Q!0MxOG24wO#'cQ`OLD,pOOQ[LD,pLD,pO!&iQMhOLD,pO';eQ!fOLD,pO';lQ?MvO7+'yO'=bQ?MvO,5?_O'?eQ?MvO,5?aO'AhQ?MvO7+'{O'C^QMjOG27SOOQO<<M{<<M{OOQ!0LbANA[ANA[O$)iQ`OANA[OCfQ`OANA[O'CnQ!dOANA[OOQ!0LbANAYANAYO'CuQ`OANA[O!&iQMhOANA[O'DQQ!dOANA[OOQ!0LbANAZANAZOOQO<<N[<<N[OOQ[LD-]LD-]O'D[Q?MtO7+*lOOQO'#Ge'#GeOOQ[G27kG27kO&;rQ`OG27kO!&iQMhOG27kOOQ[G27mG27mO9kQ!0LrOG27mOOQ[G27uG27uO'DfQ?MtOG25UOOQOLD*cLD*cOOQ[!$(![!$(![O#'cQ`O!$(![O!&iQMhO!$(![O'DpQ!0MzOG27SOOQ!0LbG26vG26vO$)iQ`OG26vO'GRQ`OG26vOCfQ`OG26vO'G^Q!dOG26vO!&iQMhOG26vOOQ[LD-VLD-VO&;rQ`OLD-VOOQ[LD-XLD-XOOQ[!)9Ev!)9EvO#'cQ`O!)9EvOOQ!0LbLD,bLD,bO$)iQ`OLD,bOCfQ`OLD,bO'GeQ`OLD,bO'GpQ!dOLD,bOOQ[!$(!q!$(!qOOQ[!.K;b!.K;bO'GwQ?MvOG27SOOQ!0Lb!$( |!$( |O$)iQ`O!$( |OCfQ`O!$( |O'ImQ`O!$( |OOQ!0Lb!)9Eh!)9EhO$)iQ`O!)9EhOCfQ`O!)9EhOOQ!0Lb!.K;S!.K;SO$)iQ`O!.K;SOOQ!0Lb!4/0n!4/0nO!(yQlO'#DxO1PQ`O'#EVO'IxQ!fO'#JpO'JPQ!L^O'#DtO'JWQlO'#D|O'J_Q!fO'#CiO'LuQ!fO'#CiO!(yQlO'#EOO'MVQlO,5;XO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO'#InO( YQ`O,5<hO!(yQlO,5;cO( bQMhO,5;cO(!{QMhO,5;cO!(yQlO,5;vO!&iQMhO'#GlO( bQMhO'#GlO!&iQMhO'#GnO( bQMhO'#GnO1SQ`O'#DXO1SQ`O'#DXO!&iQMhO'#GOO( bQMhO'#GOO!&iQMhO'#GQO( bQMhO'#GQO!&iQMhO'#G`O( bQMhO'#G`O!(yQlO,5:hO(#SQpO'#D]O(#^QpO'#JtO!(yQlO,5@mO'MVQlO1G0sO(#hQ?MtO'#CiO!(yQlO1G2OO!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO(#rQ!dO'#CrO!&iQMhO,5<sO( bQMhO,5<sO'MVQlO1G2QO!(yQlO7+&yO!&iQMhO1G2_O( bQMhO1G2_O!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO!&iQMhO1G2aO( bQMhO1G2aO'MVQlO7+'lO'MVQlO7+&_O!&iQMhOANAhO( bQMhOANAhO($VQ`O'#EmO($[Q`O'#EmO($dQ`O'#F[O($iQ`O'#EwO($nQ`O'#KRO($yQ`O'#KPO(%UQ`O,5;XO(%ZQMjO,5<dO(%bQ`O'#GXO(%gQ`O'#GXO(%lQ`O,5<fO(%tQ`O,5;XO(%|Q?MtO1G1_O(&TQ`O,5<sO(&YQ`O,5<sO(&_Q`O,5<uO(&dQ`O,5<uO(&iQ`O1G2QO(&nQ`O1G0sO(&sQMjO<<K|O(&zQMjO<<K|O7eQMhO'#F{O9UQ`O'#FzOAdQ`O'#ElO!(yQlO,5;sO!3^Q`O'#GXO!3^Q`O'#GXO!3^Q`O'#GZO!3^Q`O'#GZO!+rQMhO7+(bO!+rQMhO7+(bO%-ZQ!dO1G2vO%-ZQ!dO1G2vO!&iQMhO,5=[O!&iQMhO,5=[",stateData:"((P~O'zOS'{OSTOS'|RQ~OPYOQYOSfOY!VOaqOdzOeyOj!POnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!swO!vxO!z]O$V|O$miO%g}O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO&U!WO&[!XO&^!YO&`!ZO&b![O&e!]O&k!^O&q!_O&s!`O&u!aO&w!bO&y!cO(RSO(TTO(WUO(_VO(m[O~OWtO~P`OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa!wOq!nO!Q!oO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!xO#U!pO#V!pO#Y!zO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O'|!{O~OP]XR]X[]Xa]Xp]X!O]X!Q]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X'x]X(_]X(p]X(w]X(x]X~O!e%QX~P(qO_!}O(T#PO(U!}O(V#PO~O_#QO(V#PO(W#PO(X#QO~Ov#SO!S#TO(`#TO(a#VO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R;{O(TTO(WUO(_VO(m[O~O!Y#ZO!Z#WO!W(fP!W(tP~P+}O![#cO~P`OPYOQYOSfOd!jOe!iOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(TTO(WUO(_VO(m[O~On#mO!Y#iO!z]O#g#lO#h#iO(R;|O!i(qP~P.iO!j#oO(R#nO~O!v#sO!z]O%g#tO~O#i#uO~O!e#vO#i#uO~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z$_O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa(dX'x(dX'u(dX!i(dX!W(dX!](dX%h(dX!e(dX~P1qO#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX!](eX%h(eX~Oa(eX'x(eX'u(eX!W(eX!i(eXt(eX!e(eX~P4UO#^$eO~O$[$hO$^$gO$e$mO~OSfO!]$nO$h$oO$j$qO~Oh%VOj%cOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R$sO(TTO(WUO(_$uO(w$}O(x%POg([P~O!j%dO~O!Q%gO!]%hO(R%fO~O!e%lO~Oa%mO'x%mO~O!O%qO~P%[O(S!lO~P%[O%m%uO~P%[Oh%VO!j%dO(R%fO(S!lO~Oe%|O!j%dO(R%fO~O#t$RO~O!O&RO!]&OO!j&QO%i&UO(R%fO(S!lO(TTO(WUO`)UP~O!v#sO~O%r&WO!Q)QX!])QX(R)QX~O(R&XO~Oj!PO!s&^O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO~Od&cOe&bO!v&`O%g&aO%z&_O~P<POd&fOeyOj!PO!]&eO!s&^O!vxO!z]O%g}O%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO~Ob&iO#^&lO%i&gO(S!lO~P=UO!j&mO!s&qO~O!j#oO~O!]XO~Oa%mO'v&yO'x%mO~Oa%mO'v&|O'x%mO~Oa%mO'v'OO'x%mO~O'u]X!W]Xt]X!i]X&Y]X!]]X%h]X!e]X~P(qO!`']O!a'UO!b'UO(S!lO(TTO(WUO~Oq'SO!Q'RO!Y'VO(c'QO![(gP![(vP~P@]Ol'`O!]'^O(R%fO~Oe'eO!j%dO(R%fO~O!O&RO!j&QO~Oq!nO!Q!oO!z;wO#R!pO#S!pO#U!pO#V!pO(S!lO(TTO(WUO(c!mO(m!sO~O!`'kO!a'jO!b'jO#T!pO#Y'lO#Z'lO~PAwOa%mOh%VO!e#vO!j%dO'x%mO(p'nO~O!n'rO#^'pO~PCVOq!nO!Q!oO(TTO(WUO(c!mO(m!sO~O!]XOq(kX!Q(kX!`(kX!a(kX!b(kX!z(kX#R(kX#S(kX#T(kX#U(kX#V(kX#Y(kX#Z(kX(S(kX(T(kX(W(kX(c(kX(m(kX~O!a'jO!b'jO(S!lO~PCuO'}'vO(O'vO(P'xO~O_!}O(T'zO(U!}O(V'zO~O_#QO(V'zO(W'zO(X#QO~Ot'|O~P%[Ov#SO!S#TO(`#TO(a(PO~O!Y(RO!W'UX!W'[X!Z'UX!Z'[X~P+}O!Z(TO!W(fX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z(TO!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~O!W(fX~PGpO!W(YO~O!W(sX!Z(sX!e(sX!i(sX(p(sX~O#^(sX#i#bX![(sX~PIsO#^(ZO!W(uX!Z(uX~O!Z([O!W(tX~O!W(_O~O#^$eO~PIsO![(`O~P`OR#zO!O#yO!Q#{O!j#xO(_VOP!la[!lap!la!Z!la!n!la#P!la#l!la#m!la#n!la#o!la#p!la#q!la#r!la#s!la#t!la#u!la#w!la#y!la#z!la(p!la(w!la(x!la~Oa!la'x!la'u!la!W!la!i!lat!la!]!la%h!la!e!la~PKZO!i(aO~O!e#vO#^(bO(p'nO!Z(rXa(rX'x(rX~O!i(rX~PMvO!Q%gO!]%hO!z]O#g(gO#h(fO(R%fO~O!Z(hO!i(qX~O!i(jO~O!Q%gO!]%hO#h(fO(R%fO~OP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O!e#vO!i(eX~P! dOR(lO!O(kO!j#xO#Q$dO!z!ya!Q!ya~O!v!ya%g!ya!]!ya#g!ya#h!ya(R!ya~P!#eO!v(pO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~O#i(vO~O!Y(xO!i(iP~P%[O(c(zO(m[O~O!Q(|O!j#xO(c(zO(m[O~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z$_Oa$pa'x$pa'u$pa!i$pa!W$pa!]$pa%h$pa!e$pa~Oj)bO~P!&iOh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Og(nP~P!+rO!O)gO!e)fO!]$]X$Y$]X$[$]X$^$]X$e$]X~O!e)fO!](yX$Y(yX$[(yX$^(yX$e(yX~O!O)gO~P!-{O!O)gO!](yX$Y(yX$[(yX$^(yX$e(yX~O!])iO$Y)mO$[)hO$^)hO$e)nO~O!Y)qO~P!(yO$[$hO$^$gO$e)uO~Ol$yX!O$yX#Q$yX'w$yX(w$yX(x$yX~OgkXg$yXlkX!ZkX#^kX~P!/qOv)wO(`)xO(a)zO~Ol*TO!O)|O'w)}O(w$}O(x%PO~Og){O~P!0uOg*UO~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q*WO!]*XO!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~O!Y*[O(R*VO!i(|P~P!1dO#i*^O~O!j*_O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R*aO(TTO(WUO(_$uO(w$}O(x%PO~O!Y*dO!W(}P~P!3cOp*pOq!nO!Q*fO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO(c!mO~O![*mO~P!5WO#Q$dOl(^X!O(^X'w(^X(w(^X(x(^X!Z(^X#^(^X~Og(^X#}(^X~P!6YOl*uO#^*tOg(]X!Z(]X~O!Z*vOg([X~Oj%cO(R&XOg([P~Oq*yO~O!j+OO~O(R(tO~On+TO!Q%gO!Y#iO!]%hO!z]O#g#lO#h#iO(R%fO!i(qP~O!e#vO#i+UO~O!Q%gO!Y+WO!Z([O!]%hO(R%fO!W(tP~Oq'YO!Q+YO!Y+XO(TTO(WUO(c(zO~O![(vP~P!9]O!Z+ZOa)RX'x)RX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa!ha!Z!ha'x!ha'u!ha!W!ha!i!hat!ha!]!ha%h!ha!e!ha~P!:TOR#zO!O#yO!Q#{O!j#xO(_VOP!pa[!pap!pa!Z!pa!n!pa#P!pa#l!pa#m!pa#n!pa#o!pa#p!pa#q!pa#r!pa#s!pa#t!pa#u!pa#w!pa#y!pa#z!pa(p!pa(w!pa(x!pa~Oa!pa'x!pa'u!pa!W!pa!i!pat!pa!]!pa%h!pa!e!pa~P!<kOR#zO!O#yO!Q#{O!j#xO(_VOP!ra[!rap!ra!Z!ra!n!ra#P!ra#l!ra#m!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#w!ra#y!ra#z!ra(p!ra(w!ra(x!ra~Oa!ra'x!ra'u!ra!W!ra!i!rat!ra!]!ra%h!ra!e!ra~P!?ROh%VOl+dO!]'^O%h+cO~O!e+fOa(ZX!](ZX'x(ZX!Z(ZX~Oa%mO!]XO'x%mO~Oh%VO!j%dO~Oh%VO!j%dO(R%fO~O!e#vO#i(vO~Ob+qO%i+rO(R+nO(TTO(WUO![)VP~O!Z+sO`)UX~O[+wO~O`+xO~O!]&OO(R%fO(S!lO`)UP~Oh%VO#^+}O~Oh%VOl,QO!]$|O~O!],SO~O!O,UO!]XO~O%m%uO~O!v,ZO~Oe,`O~Ob,aO(R#nO(TTO(WUO![)TP~Oe%|O~O%i!QO(R&XO~P=UO[,fO`,eO~OPYOQYOSfOdzOeyOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!guO!jZO!mYO!nYO!oYO!qvO!vxO!z]O$miO%g}O(TTO(WUO(_VO(m[O~O!]!eO!s!gO$V!kO(R!dO~P!FRO`,eOa%mO'x%mO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa,kOj!OO!swO%k!OO%l!OO%m!OO~P!HkO!j&mO~O&[,qO~O!],sO~O&m,uO&o,vOP&jaQ&jaS&jaY&jaa&jad&jae&jaj&jan&jap&jaq&jar&jax&jaz&ja|&ja!Q&ja!U&ja!V&ja!]&ja!g&ja!j&ja!m&ja!n&ja!o&ja!q&ja!s&ja!v&ja!z&ja$V&ja$m&ja%g&ja%i&ja%k&ja%l&ja%m&ja%p&ja%r&ja%u&ja%v&ja%x&ja&U&ja&[&ja&^&ja&`&ja&b&ja&e&ja&k&ja&q&ja&s&ja&u&ja&w&ja&y&ja'u&ja(R&ja(T&ja(W&ja(_&ja(m&ja![&ja&c&jab&ja&h&ja~O(R,{O~Oh!cX!Z!PX![!PX!e!PX!e!cX!j!cX#^!PX~O!Z!cX![!cX~P# qO!e-QO#^-POh(hX!Z#fX![#fX!e(hX!j(hX~O!Z(hX![(hX~P#!dOh%VO!e-SO!j%dO!Z!_X![!_X~Oq!nO!Q!oO(TTO(WUO(c!mO~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(TTO(WUO(_VO(m[O~O(R<rO~P##yO!Z-WO![(gX~O![-YO~O!e-QO#^-PO!Z#fX![#fX~O!Z-ZO![(vX~O![-]O~O!a-^O!b-^O(S!lO~P##hO![-aO~P'_Ol-dO!]'^O~O!W-iO~Oq!ya!`!ya!a!ya!b!ya#R!ya#S!ya#T!ya#U!ya#V!ya#Y!ya#Z!ya(S!ya(T!ya(W!ya(c!ya(m!ya~P!#eO!n-nO#^-lO~PCVO!a-pO!b-pO(S!lO~PCuOa%mO#^-lO'x%mO~Oa%mO!e#vO#^-lO'x%mO~Oa%mO!e#vO!n-nO#^-lO'x%mO(p'nO~O'}'vO(O'vO(P-uO~Ot-vO~O!W'Ua!Z'Ua~P!:TO!Y-zO!W'UX!Z'UX~P%[O!Z(TO!W(fa~O!W(fa~PGpO!Z([O!W(ta~O!Q%gO!Y.OO!]%hO(R%fO!W'[X!Z'[X~O#^.QO!Z(ra!i(raa(ra'x(ra~O!e#vO~P#,PO!Z(hO!i(qa~O!Q%gO!]%hO#h.UO(R%fO~On.ZO!Q%gO!Y.WO!]%hO!z]O#g.YO#h.WO(R%fO!Z'_X!i'_X~OR._O!j#xO~Oh%VOl.bO!]'^O%h.aO~Oa#ai!Z#ai'x#ai'u#ai!W#ai!i#ait#ai!]#ai%h#ai!e#ai~P!:TOl=|O!O)|O'w)}O(w$}O(x%PO~O#i#]aa#]a#^#]a'x#]a!Z#]a!i#]a!]#]a!W#]a~P#.{O#i(^XP(^XR(^X[(^Xa(^Xp(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X'x(^X(_(^X(p(^X!i(^X!W(^X'u(^Xt(^X!](^X%h(^X!e(^X~P!6YO!Z.oO!i(iX~P!:TO!i.rO~O!W.tO~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kia#kip#ki!Z#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#l#ki~P#2kO#l$OO~P#2kOP$[OR#zOp$aO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO[#kia#ki!Z#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#p#ki~P#5YO#p$QO~P#5YOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO(_VOa#ki!Z#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#u#ki~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO(_VO(x#}Oa#ki!Z#ki#y#ki#z#ki'x#ki(p#ki(w#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#w$UO~P#:_O#w#ki~P#:_O#u$SO~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO(_VO(w#|O(x#}Oa#ki!Z#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#y#ki~P#=TO#y$WO~P#=TOP]XR]X[]Xp]X!O]X!Q]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X!Z]X![]X~O#}]X~P#?rOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO#y<XO#z<YO(_VO(p$YO(w#|O(x#}O~O#}.vO~P#BPO#Q$dO#^<`O$P<`O#}(eX![(eX~P! dOa'ba!Z'ba'x'ba'u'ba!i'ba!W'bat'ba!]'ba%h'ba!e'ba~P!:TO[#kia#kip#ki!Z#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO(w#ki(x#ki~P#EROl=|O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P#ERO!Z.zOg(nX~P!0uOg.|O~Oa$Oi!Z$Oi'x$Oi'u$Oi!W$Oi!i$Oit$Oi!]$Oi%h$Oi!e$Oi~P!:TO$[.}O$^.}O~O$[/OO$^/OO~O!e)fO#^/PO!]$bX$Y$bX$[$bX$^$bX$e$bX~O!Y/QO~O!])iO$Y/SO$[)hO$^)hO$e/TO~O!Z<ZO![(dX~P#BPO![/UO~O!e)fO$e(yX~O$e/WO~Ot/XO~P!&iOv)wO(`)xO(a/[O~O!Q/_O~O(w$}Ol%`a!O%`a'w%`a(x%`a!Z%`a#^%`a~Og%`a#}%`a~P#LTO(x%POl%ba!O%ba'w%ba(w%ba!Z%ba#^%ba~Og%ba#}%ba~P#LvO!ZfX!efX!ifX!i$yX(pfX~P!/qO!Y/hO!Z([O(R/gO!W(tP!W(}P~P!1dOp*pO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO~Oq<oO!Q/iO!Y+XO![*mO(c<nO![(vP~P#NaO!i/jO~P#.{O!Z/kO!e#vO(p'nO!i(|X~O!i/pO~O!Q%gO!Y*[O!]%hO(R%fO!i(|P~O#i/rO~O!W$yX!Z$yX!e%QX~P!/qO!Z/sO!W(}X~P#.{O!e/uO~O!W/wO~OnkO(R/xO~P.iOh%VOp/}O!e#vO!j%dO(p'nO~O!e+fO~Oa%mO!Z0RO'x%mO~O![0TO~P!5WO!a0UO!b0UO(S!lO~P##hOq!nO!Q0VO(TTO(WUO(c!mO~O#Y0XO~Og%`a!Z%`a#^%`a#}%`a~P!0uOg%ba!Z%ba#^%ba#}%ba~P!0uOj%cO(R&XOg'kX!Z'kX~O!Z*vOg([a~Og0bO~OR0cO!O0cO!Q0dO#Q$dOl{a'w{a(w{a(x{a!Z{a#^{a~Og{a#}{a~P$&dO!O)|O'w)}Ol$ra(w$ra(x$ra!Z$ra#^$ra~Og$ra#}$ra~P$'`O!O)|O'w)}Ol$ta(w$ta(x$ta!Z$ta#^$ta~Og$ta#}$ta~P$(RO#i0gO~Og%Sa!Z%Sa#^%Sa#}%Sa~P!0uOl0iO#^0hOg(]a!Z(]a~O!e#vO~O#i0lO~O!Z+ZOa)Ra'x)Ra~OR#zO!O#yO!Q#{O!j#xO(_VOP!pi[!pip!pi!Z!pi!n!pi#P!pi#l!pi#m!pi#n!pi#o!pi#p!pi#q!pi#r!pi#s!pi#t!pi#u!pi#w!pi#y!pi#z!pi(p!pi(w!pi(x!pi~Oa!pi'x!pi'u!pi!W!pi!i!pit!pi!]!pi%h!pi!e!pi~P$*OOh%VOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~On0vO%[0wO(R0tO~P$,fO!e+fOa(Za!](Za'x(Za!Z(Za~O#i0|O~O[]X!ZfX![fX~O!Z0}O![)VX~O![1PO~O[1QO~Ob1SO(R+nO(TTO(WUO~O!]&OO(R%fO`'sX!Z'sX~O!Z+sO`)Ua~O!i1VO~P!:TO[1YO~O`1ZO~O#^1^O~Ol1aO!]$|O~O(c(zO![)SP~Oh%VOl1jO!]1gO%h1iO~O[1tO!Z1rO![)TX~O![1uO~O`1wOa%mO'x%mO~O(R#nO(TTO(WUO~O#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O#t1zO&Y1{Oa(eX~P$2PO#^$eO#t1zO&Y1{O~Oa1}O~P%[Oa2PO~O&c2SOP&aiQ&aiS&aiY&aia&aid&aie&aij&ain&aip&aiq&air&aix&aiz&ai|&ai!Q&ai!U&ai!V&ai!]&ai!g&ai!j&ai!m&ai!n&ai!o&ai!q&ai!s&ai!v&ai!z&ai$V&ai$m&ai%g&ai%i&ai%k&ai%l&ai%m&ai%p&ai%r&ai%u&ai%v&ai%x&ai&U&ai&[&ai&^&ai&`&ai&b&ai&e&ai&k&ai&q&ai&s&ai&u&ai&w&ai&y&ai'u&ai(R&ai(T&ai(W&ai(_&ai(m&ai![&aib&ai&h&ai~Ob2YO![2WO&h2XO~P`O!]XO!j2[O~O&o,vOP&jiQ&jiS&jiY&jia&jid&jie&jij&jin&jip&jiq&jir&jix&jiz&ji|&ji!Q&ji!U&ji!V&ji!]&ji!g&ji!j&ji!m&ji!n&ji!o&ji!q&ji!s&ji!v&ji!z&ji$V&ji$m&ji%g&ji%i&ji%k&ji%l&ji%m&ji%p&ji%r&ji%u&ji%v&ji%x&ji&U&ji&[&ji&^&ji&`&ji&b&ji&e&ji&k&ji&q&ji&s&ji&u&ji&w&ji&y&ji'u&ji(R&ji(T&ji(W&ji(_&ji(m&ji![&ji&c&jib&ji&h&ji~O!W2bO~O!Z!_a![!_a~P#BPOq!nO!Q!oO!Y2hO(c!mO!Z'VX!['VX~P@]O!Z-WO![(ga~O!Z']X![']X~P!9]O!Z-ZO![(va~O![2oO~P'_Oa%mO#^2xO'x%mO~Oa%mO!e#vO#^2xO'x%mO~Oa%mO!e#vO!n2|O#^2xO'x%mO(p'nO~Oa%mO'x%mO~P!:TO!Z$_Ot$pa~O!W'Ui!Z'Ui~P!:TO!Z(TO!W(fi~O!Z([O!W(ti~O!W(ui!Z(ui~P!:TO!Z(ri!i(ria(ri'x(ri~P!:TO#^3OO!Z(ri!i(ria(ri'x(ri~O!Z(hO!i(qi~O!Q%gO!]%hO!z]O#g3TO#h3SO(R%fO~O!Q%gO!]%hO#h3SO(R%fO~Ol3[O!]'^O%h3ZO~Oh%VOl3[O!]'^O%h3ZO~O#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`at%`a!]%`a%h%`a!e%`a~P#LTO#i%baP%baR%ba[%baa%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%bat%ba!]%ba%h%ba!e%ba~P#LvO#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!Z%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`a#^%`at%`a!]%`a%h%`a!e%`a~P#.{O#i%baP%baR%ba[%baa%bap%ba!Q%ba!Z%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%ba#^%bat%ba!]%ba%h%ba!e%ba~P#.{O#i{aP{a[{aa{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a'x{a(_{a(p{a!i{a!W{a'u{at{a!]{a%h{a!e{a~P$&dO#i$raP$raR$ra[$raa$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra'x$ra(_$ra(p$ra!i$ra!W$ra'u$rat$ra!]$ra%h$ra!e$ra~P$'`O#i$taP$taR$ta[$taa$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta'x$ta(_$ta(p$ta!i$ta!W$ta'u$tat$ta!]$ta%h$ta!e$ta~P$(RO#i%SaP%SaR%Sa[%Saa%Sap%Sa!Q%Sa!Z%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa'x%Sa(_%Sa(p%Sa!i%Sa!W%Sa'u%Sa#^%Sat%Sa!]%Sa%h%Sa!e%Sa~P#.{Oa#aq!Z#aq'x#aq'u#aq!W#aq!i#aqt#aq!]#aq%h#aq!e#aq~P!:TO!Y3dO!Z'WX!i'WX~P%[O!Z.oO!i(ia~O!Z.oO!i(ia~P!:TO!W3gO~O#}!la![!la~PKZO#}!ha!Z!ha![!ha~P#BPO#}!pa![!pa~P!<kO#}!ra![!ra~P!?ROg'ZX!Z'ZX~P!+rO!Z.zOg(na~OSfO!]3{O$c3|O~O![4QO~Ot4RO~P#.{Oa$lq!Z$lq'x$lq'u$lq!W$lq!i$lqt$lq!]$lq%h$lq!e$lq~P!:TO!W4TO~P!&iO!Q4UO~O!O)|O'w)}O(x%POl'ga(w'ga!Z'ga#^'ga~Og'ga#}'ga~P%+uO!O)|O'w)}Ol'ia(w'ia(x'ia!Z'ia#^'ia~Og'ia#}'ia~P%,hO(p$YO~P#.{O!WfX!W$yX!ZfX!Z$yX!e%QX#^fX~P!/qO(R<xO~P!1dO!Q%gO!Y4XO!]%hO(R%fO!Z'cX!i'cX~O!Z/kO!i(|a~O!Z/kO!e#vO!i(|a~O!Z/kO!e#vO(p'nO!i(|a~Og${i!Z${i#^${i#}${i~P!0uO!Y4aO!W'eX!Z'eX~P!3cO!Z/sO!W(}a~O!Z/sO!W(}a~P#.{OP]XR]X[]Xp]X!O]X!Q]X!W]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!e%XX#t%XX~P%0XO!e#vO#t4fO~Oh%VO!e#vO!j%dO~Oh%VOp4kO!j%dO(p'nO~Op4pO!e#vO(p'nO~Oq!nO!Q4qO(TTO(WUO(c!mO~O(w$}Ol%`i!O%`i'w%`i(x%`i!Z%`i#^%`i~Og%`i#}%`i~P%3xO(x%POl%bi!O%bi'w%bi(w%bi!Z%bi#^%bi~Og%bi#}%bi~P%4kOg(]i!Z(]i~P!0uO#^4wOg(]i!Z(]i~P!0uO!i4zO~Oa$nq!Z$nq'x$nq'u$nq!W$nq!i$nqt$nq!]$nq%h$nq!e$nq~P!:TO!W5QO~O!Z5RO!])OX~P#.{Oa]Xa$yX!]]X!]$yX%]]X'x]X'x$yX!Z]X!Z$yX~P!/qO%]5UOa%Za!]%Za'x%Za!Z%Za~OlmX!OmX'wmX(wmX(xmX~P%7nOn5VO(R#nO~Ob5]O%i5^O(R+nO(TTO(WUO!Z'rX!['rX~O!Z0}O![)Va~O[5bO~O`5cO~Oa%mO'x%mO~P#.{O!Z5kO#^5mO![)SX~O![5nO~Op5tOq!nO!Q*fO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!pO#U!pO#V!pO#Y5sO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O![5rO~P%:ROl5yO!]1gO%h5xO~Oh%VOl5yO!]1gO%h5xO~Ob6QO(R#nO(TTO(WUO!Z'qX!['qX~O!Z1rO![)Ta~O(TTO(WUO(c6SO~O`6WO~O#t6ZO&Y6[O~PMvO!i6]O~P%[Oa6_O~Oa6_O~P%[Ob2YO![6dO&h2XO~P`O!e6fO~O!e6hOh(hi!Z(hi![(hi!e(hi!j(hip(hi(p(hi~O!Z#fi![#fi~P#BPO#^6iO!Z#fi![#fi~O!Z!_i![!_i~P#BPOa%mO#^6rO'x%mO~Oa%mO!e#vO#^6rO'x%mO~O!Z(rq!i(rqa(rq'x(rq~P!:TO!Z(hO!i(qq~O!Q%gO!]%hO#h6yO(R%fO~O!]'^O%h6|O~Ol7QO!]'^O%h6|O~O#i'gaP'gaR'ga['gaa'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga'x'ga(_'ga(p'ga!i'ga!W'ga'u'gat'ga!]'ga%h'ga!e'ga~P%+uO#i'iaP'iaR'ia['iaa'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia'x'ia(_'ia(p'ia!i'ia!W'ia'u'iat'ia!]'ia%h'ia!e'ia~P%,hO#i${iP${iR${i[${ia${ip${i!Q${i!Z${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i'x${i(_${i(p${i!i${i!W${i'u${i#^${it${i!]${i%h${i!e${i~P#.{O#i%`iP%`iR%`i[%`ia%`ip%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i'x%`i(_%`i(p%`i!i%`i!W%`i'u%`it%`i!]%`i%h%`i!e%`i~P%3xO#i%biP%biR%bi[%bia%bip%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi'x%bi(_%bi(p%bi!i%bi!W%bi'u%bit%bi!]%bi%h%bi!e%bi~P%4kO!Z'Wa!i'Wa~P!:TO!Z.oO!i(ii~O#}#ai!Z#ai![#ai~P#BPOP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kip#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#l#ki~P%MQO#l<PO~P%MQOP$[OR#zOp<]O!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO[#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#p#ki~P& YO#p<RO~P& YOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO(_VO#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#u#ki~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO(_VO(x#}O#y#ki#z#ki#}#ki(p#ki(w#ki!Z#ki![#ki~O#w<VO~P&%cO#w#ki~P&%cO#u<TO~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO(_VO(w#|O(x#}O#z#ki#}#ki(p#ki!Z#ki![#ki~O#y#ki~P&'rO#y<XO~P&'rOa#{y!Z#{y'x#{y'u#{y!W#{y!i#{yt#{y!]#{y%h#{y!e#{y~P!:TO[#kip#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki!Z#ki![#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO(w#ki(x#ki~P&*nOl=}O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P&*nO#Q$dOP(^XR(^X[(^Xl(^Xp(^X!O(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X#}(^X'w(^X(_(^X(p(^X(w(^X(x(^X!Z(^X![(^X~O#}$Oi!Z$Oi![$Oi~P#BPO#}!pi![!pi~P$*OOg'Za!Z'Za~P!0uO![7dO~O!Z'ba!['ba~P#BPO!W7eO~P#.{O!e#vO(p'nO!Z'ca!i'ca~O!Z/kO!i(|i~O!Z/kO!e#vO!i(|i~Og${q!Z${q#^${q#}${q~P!0uO!W'ea!Z'ea~P#.{O!e7lO~O!Z/sO!W(}i~P#.{O!Z/sO!W(}i~O!W7oO~Oh%VOp7tO!j%dO(p'nO~O!e#vO#t7vO~Op7yO!e#vO(p'nO~O!O)|O'w)}O(x%POl'ha(w'ha!Z'ha#^'ha~Og'ha#}'ha~P&3oO!O)|O'w)}Ol'ja(w'ja(x'ja!Z'ja#^'ja~Og'ja#}'ja~P&4bO!W7{O~Og$}q!Z$}q#^$}q#}$}q~P!0uOg(]q!Z(]q~P!0uO#^7|Og(]q!Z(]q~P!0uOa$ny!Z$ny'x$ny'u$ny!W$ny!i$nyt$ny!]$ny%h$ny!e$ny~P!:TO!e6hO~O!Z5RO!])Oa~O!]'^OP$SaR$Sa[$Sap$Sa!O$Sa!Q$Sa!Z$Sa!j$Sa!n$Sa#P$Sa#l$Sa#m$Sa#n$Sa#o$Sa#p$Sa#q$Sa#r$Sa#s$Sa#t$Sa#u$Sa#w$Sa#y$Sa#z$Sa(_$Sa(p$Sa(w$Sa(x$Sa~O%h6|O~P&7SO%]8QOa%Zi!]%Zi'x%Zi!Z%Zi~Oa#ay!Z#ay'x#ay'u#ay!W#ay!i#ayt#ay!]#ay%h#ay!e#ay~P!:TO[8SO~Ob8UO(R+nO(TTO(WUO~O!Z0}O![)Vi~O`8YO~O(c(zO!Z'nX!['nX~O!Z5kO![)Sa~O![8cO~P%:RO(m!sO~P$$oO#Y8dO~O!]1gO~O!]1gO%h8fO~Ol8iO!]1gO%h8fO~O[8nO!Z'qa!['qa~O!Z1rO![)Ti~O!i8rO~O!i8sO~O!i8vO~O!i8vO~P%[Oa8xO~O!e8yO~O!i8zO~O!Z(ui![(ui~P#BPOa%mO#^9SO'x%mO~O!Z(ry!i(rya(ry'x(ry~P!:TO!Z(hO!i(qy~O%h9VO~P&7SO!]'^O%h9VO~O#i${qP${qR${q[${qa${qp${q!Q${q!Z${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q'x${q(_${q(p${q!i${q!W${q'u${q#^${qt${q!]${q%h${q!e${q~P#.{O#i'haP'haR'ha['haa'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha'x'ha(_'ha(p'ha!i'ha!W'ha'u'hat'ha!]'ha%h'ha!e'ha~P&3oO#i'jaP'jaR'ja['jaa'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja'x'ja(_'ja(p'ja!i'ja!W'ja'u'jat'ja!]'ja%h'ja!e'ja~P&4bO#i$}qP$}qR$}q[$}qa$}qp$}q!Q$}q!Z$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q'x$}q(_$}q(p$}q!i$}q!W$}q'u$}q#^$}qt$}q!]$}q%h$}q!e$}q~P#.{O!Z'Wi!i'Wi~P!:TO#}#aq!Z#aq![#aq~P#BPO(w$}OP%`aR%`a[%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a#}%`a(_%`a(p%`a!Z%`a![%`a~Ol%`a!O%`a'w%`a(x%`a~P&HgO(x%POP%baR%ba[%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba#}%ba(_%ba(p%ba!Z%ba![%ba~Ol%ba!O%ba'w%ba(w%ba~P&JnOl=}O!O)|O'w)}O(x%PO~P&HgOl=}O!O)|O'w)}O(w$}O~P&JnOR0cO!O0cO!Q0dO#Q$dOP{a[{al{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a#}{a'w{a(_{a(p{a(w{a(x{a!Z{a![{a~O!O)|O'w)}OP$raR$ra[$ral$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra#}$ra(_$ra(p$ra(w$ra(x$ra!Z$ra![$ra~O!O)|O'w)}OP$taR$ta[$tal$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta#}$ta(_$ta(p$ta(w$ta(x$ta!Z$ta![$ta~Ol=}O!O)|O'w)}O(w$}O(x%PO~OP%SaR%Sa[%Sap%Sa!Q%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa#}%Sa(_%Sa(p%Sa!Z%Sa![%Sa~P'%sO#}$lq!Z$lq![$lq~P#BPO#}$nq!Z$nq![$nq~P#BPO![9dO~O#}9eO~P!0uO!e#vO!Z'ci!i'ci~O!e#vO(p'nO!Z'ci!i'ci~O!Z/kO!i(|q~O!W'ei!Z'ei~P#.{O!Z/sO!W(}q~Op9lO!e#vO(p'nO~O[9nO!W9mO~P#.{O!W9mO~O!e#vO#t9tO~Og(]y!Z(]y~P!0uO!Z'la!]'la~P#.{Oa%Zq!]%Zq'x%Zq!Z%Zq~P#.{O[9yO~O!Z0}O![)Vq~O#^9}O!Z'na!['na~O!Z5kO![)Si~P#BPO!Q:PO~O!]1gO%h:SO~O(TTO(WUO(c:XO~O!Z1rO![)Tq~O!i:[O~O!i:]O~O!i:^O~O!i:^O~P%[O#^:aO!Z#fy![#fy~O!Z#fy![#fy~P#BPO%h:fO~P&7SO!]'^O%h:fO~O#}#{y!Z#{y![#{y~P#BPOP${iR${i[${ip${i!Q${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i#}${i(_${i(p${i!Z${i![${i~P'%sO!O)|O'w)}O(x%POP'gaR'ga['gal'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga#}'ga(_'ga(p'ga(w'ga!Z'ga!['ga~O!O)|O'w)}OP'iaR'ia['ial'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia#}'ia(_'ia(p'ia(w'ia(x'ia!Z'ia!['ia~O(w$}OP%`iR%`i[%`il%`ip%`i!O%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i#}%`i'w%`i(_%`i(p%`i(x%`i!Z%`i![%`i~O(x%POP%biR%bi[%bil%bip%bi!O%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi#}%bi'w%bi(_%bi(p%bi(w%bi!Z%bi![%bi~O#}$ny!Z$ny![$ny~P#BPO#}#ay!Z#ay![#ay~P#BPO!e#vO!Z'cq!i'cq~O!Z/kO!i(|y~O!W'eq!Z'eq~P#.{Op:pO!e#vO(p'nO~O[:tO!W:sO~P#.{O!W:sO~Og(]!R!Z(]!R~P!0uOa%Zy!]%Zy'x%Zy!Z%Zy~P#.{O!Z0}O![)Vy~O!Z5kO![)Sq~O(R:zO~O!]1gO%h:}O~O!i;QO~O%h;VO~P&7SOP${qR${q[${qp${q!Q${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q#}${q(_${q(p${q!Z${q![${q~P'%sO!O)|O'w)}O(x%POP'haR'ha['hal'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha#}'ha(_'ha(p'ha(w'ha!Z'ha!['ha~O!O)|O'w)}OP'jaR'ja['jal'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja#}'ja(_'ja(p'ja(w'ja(x'ja!Z'ja!['ja~OP$}qR$}q[$}qp$}q!Q$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q#}$}q(_$}q(p$}q!Z$}q![$}q~P'%sOg%d!Z!Z%d!Z#^%d!Z#}%d!Z~P!0uO!W;ZO~P#.{Op;[O!e#vO(p'nO~O[;^O!W;ZO~P#.{O!Z'nq!['nq~P#BPO!Z#f!Z![#f!Z~P#BPO#i%d!ZP%d!ZR%d!Z[%d!Za%d!Zp%d!Z!Q%d!Z!Z%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z'x%d!Z(_%d!Z(p%d!Z!i%d!Z!W%d!Z'u%d!Z#^%d!Zt%d!Z!]%d!Z%h%d!Z!e%d!Z~P#.{Op;fO!e#vO(p'nO~O!W;gO~P#.{Op;nO!e#vO(p'nO~O!W;oO~P#.{OP%d!ZR%d!Z[%d!Zp%d!Z!Q%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z#}%d!Z(_%d!Z(p%d!Z!Z%d!Z![%d!Z~P'%sOp;rO!e#vO(p'nO~Ot(dX~P1qO!O%qO~P!(yO(S!lO~P!(yO!WfX!ZfX#^fX~P%0XOP]XR]X[]Xp]X!O]X!Q]X!Z]X!ZfX!j]X!n]X#P]X#Q]X#^]X#^fX#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!efX!i]X!ifX(pfX~P'JlOP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]XO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z<ZO![$pa~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<fO!Q${O!]$|O!g=wO!j$xO#h<lO$V%_O$s<hO$u<jO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Oj)bO~P( bOp!cX(p!cX~P# qOp(hX(p(hX~P#!dO![]X![fX~P'JlO!WfX!W$yX!ZfX!Z$yX#^fX~P!/qO#i<OO~O!e#vO#i<OO~O#^<`O~O#t<SO~O#^<pO!Z(uX![(uX~O#^<`O!Z(sX![(sX~O#i<qO~Og<sO~P!0uO#i<yO~O#i<zO~O!e#vO#i<{O~O!e#vO#i<qO~O#}<|O~P#BPO#i<}O~O#i=OO~O#i=TO~O#i=UO~O#i=VO~O#i=WO~O#}=XO~P!0uO#}=YO~P!0uO#Q#R#S#U#V#Y#g#h#s$m$s$u$x%[%]%g%h%i%p%r%u%v%x%z~'|T#m!V'z(S#nq#l#op!O'{$['{(R$^(c~",goto:"$8f)ZPPPPPP)[PP)_P)pP+Q/VPPPP6aPP6wPP<oP@cP@yP@yPPP@yPCRP@yP@yP@yPCVPC[PCyPHsPPPHwPPPPHwKzPPPLQLrPHwPHwPP! QHwPPPHwPHwP!#XHwP!&o!'t!'}P!(q!(u!(q!,SPPPPPPP!,s!'tPP!-T!.uP!2RHwHw!2W!5d!:Q!:Q!>PPPP!>XHwPPPPPPPPPP!AhP!BuPPHw!DWPHwPHwHwHwHwHwPHw!EjP!HtP!KzP!LO!LY!L^!L^P!HqP!Lb!LbP# hP# lHwPHw# r#$wCV@yP@yP@y@yP#&U@y@y#(h@y#+`@y#-l@y@y#.[#0p#0p#0u#1O#0p#1ZPP#0pP@y#1s@y#5r@y@y6aPPP#9wPPP#:b#:bP#:bP#:x#:bPP#;OP#:uP#:u#;c#:u#;}#<T#<W)_#<Z)_P#<b#<b#<bP)_P)_P)_P)_PP)_P#<h#<kP#<k)_P#<oP#<rP)_P)_P)_P)_P)_P)_)_PP#<x#=O#=Z#=a#=g#=m#=s#>R#>X#>c#>i#>s#>y#?Z#?a#@R#@e#@k#@q#AP#Af#CZ#Ci#Cp#E[#Ej#G[#Gj#Gp#Gv#G|#HW#H^#Hd#Hn#IQ#IWPPPPPPPPPPP#I^PPPPPPP#JR#MY#Nr#Ny$ RPPP$&mP$&v$)o$0Y$0]$0`$1_$1b$1i$1qP$1w$1zP$2h$2l$3d$4r$4w$5_PP$5d$5j$5n$5q$5u$5y$6u$7^$7u$7y$7|$8P$8V$8Y$8^$8bR!|RoqOXst!Z#d%l&p&r&s&u,n,s2S2VY!vQ'^-`1g5qQ%svQ%{yQ&S|Q&h!VS'U!e-WQ'd!iS'j!r!yU*h$|*X*lQ+l%|Q+y&UQ,_&bQ-^']Q-h'eQ-p'kQ0U*nQ1q,`R<m;z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9SS#q];w!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU*{%[<e<fQ+q&OQ,a&eQ,h&mQ0r+dQ0u+fQ1S+rQ1y,fQ3W.bQ5V0wQ5]0}Q6Q1rQ7O3[Q8U5^R9Y7Q'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s!S!nQ!r!v!y!z$|'U']'^'j'k'l*h*l*n*o-W-^-`-p0U0X1g5q5s%[$ti#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q&V|Q'S!eS'Y%h-ZQ+q&OQ,a&eQ0f+OQ1S+rQ1X+xQ1x,eQ1y,fQ5]0}Q5f1ZQ6Q1rQ6T1tQ6U1wQ8U5^Q8X5cQ8q6WQ9|8YQ:Y8nR<o*XrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR,c&i&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=r=s[#]WZ#W#Z'V(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ%vxQ%zyS&P|&UQ&]!TQ'a!hQ'c!iQ(o#sS+k%{%|Q+o&OQ,Y&`Q,^&bS-g'd'eQ.d(pQ0{+lQ1R+rQ1T+sQ1W+wQ1l,ZS1p,_,`Q2t-hQ5[0}Q5`1QQ5e1YQ6P1qQ8T5^Q8W5bQ9x8SR:w9y!U$zi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y!^%xy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pQ+e%vQ,O&YQ,R&ZQ,]&bQ.c(oQ1k,YU1o,^,_,`Q3].dQ5z1lS6O1p1qQ8m6P#f=t#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o=u<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YW%Ti%V*v=pS&Y!Q&gQ&Z!RQ&[!SQ+S%cR+|&W%]%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}T)x$u)yV*{%[<e<fW'Y!e%h*X-ZS({#y#zQ+`%qQ+v&RS.](k(lQ1b,SQ4x0cR8^5k'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s$i$^c#Y#e%p%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.w.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ'W!eR2i-W!W!nQ!e!r!v!y!z$|'U']'^'j'k'l*X*h*l*n*o-W-^-`-p0U0X1g5q5sR1d,UnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&w!^Q't!xS(q#u<OQ+i%yQ,W&]Q,X&_Q-e'bQ-r'mS.m(v<qS0k+U<{Q0y+jQ1f,VQ2Z,uQ2],vQ2e-RQ2r-fQ2u-jS5P0l=VQ5W0zS5Z0|=WQ6j2gQ6n2sQ6s2zQ8R5XQ8}6lQ9O6oQ9R6tR:`8z$d$]c#Y#e%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gS(m#p'gQ(}#zS+_%p.wS.^(l(nR3U._'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS#q];wQ&r!XQ&s!YQ&u![Q&v!]R2R,qQ'_!hQ+b%vQ-c'aS.`(o+eQ2p-bW3Y.c.d0q0sQ6m2qW6z3V3X3]5TU9U6{6}7PU:e9W9X9ZS;T:d:gQ;b;UR;j;cU!wQ'^-`T5o1g5q!Q_OXZ`st!V!Z#d#h%d%l&g&i&p&r&s&u(h,n,s.V2S2V]!pQ!r'^-`1g5qT#q];w%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS({#y#zS.](k(l!s=^$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU$fd)],hS(n#p'gU*s%R(u3vU0e*z.i7]Q5T0rQ6{3WQ9X7OR:g9Ym!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sQ'r!uS(d#g1|S-n'i'uQ/n*ZQ/{*gQ2|-qQ4]/oQ4i/}Q4j0OQ4o0WQ7h4WS7s4k4mS7w4p4rQ9g7iQ9k7oQ9p7tQ9u7yS:o9l9mS;Y:p:sS;e;Z;[S;m;f;gS;q;n;oR;t;rQ#wbQ'q!uS(c#g1|S(e#m+TQ+V%eQ+g%wQ+m%}U-m'i'r'uQ.R(dQ/m*ZQ/|*gQ0P*iQ0x+hQ1m,[S2y-n-qQ3R.ZS4[/n/oQ4e/yS4h/{0WQ4l0QQ5|1nQ6u2|Q7g4WQ7k4]U7r4i4o4rQ7u4nQ8k5}S9f7h7iQ9j7oQ9r7wQ9s7xQ:V8lQ:m9gS:n9k9mQ:v9uQ;P:WS;X:o:sS;d;Y;ZS;l;e;gS;p;m;oQ;s;qQ;u;tQ=a=[Q=l=eR=m=fV!wQ'^-`%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS#wz!j!r=Z$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=a=r%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SQ%ej!^%wy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pS%}z!jQ+h%xQ,[&bW1n,],^,_,`U5}1o1p1qS8l6O6PQ:W8m!r=[$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ=e=qR=f=r%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SY#bWZ#W#Z(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ,i&m!p=]$Z$n)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=`'VU'Z!e%h*XR2k-Z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9S!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ,h&mQ0r+dQ3W.bQ7O3[R9Y7Q!b$Tc#Y%p(Q(W(r(w)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!P<U)[)o-U.w2c2f3h3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!f$Vc#Y%p(Q(W(r(w)U)V)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!T<W)[)o-U.w2c2f3h3n3o3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!^$Zc#Y%p(Q(W(r(w)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;xQ4V/fz=s)[)o-U.w2c2f3h3w4P6k7W7a7b8`8|9[9b9c:y;R=gQ=x=zR=y={'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS$oh$pR3|/P'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$kf$qQ$ifS)h$l)lR)t$qT$jf$qT)j$l)l'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$oh$pQ$rhR)s$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9S!s=q$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s#glOPXZst!Z!`!o#S#d#o#{$n%l&i&l&m&p&r&s&u&y'R'`(|)q*f+Y+d,k,n,s-d.b/Q/i0V0d1j1z1{1}2P2S2V2X3[3{4q5y6Z6[6_7Q8i8x!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}Q+P%`Q/^)|o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!U$yi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yQ*`$zU*i$|*X*lQ+Q%aQ0Q*j#f=c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n=d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YQ=h=tQ=i=uQ=j=vR=k=w!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YnoOXst!Z#d%l&p&r&s&u,n,s2S2VS*c${*WQ,|&|Q,}'OR4`/s%[%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q,P&ZQ1`,RQ5i1_R8]5jV*k$|*X*lU*k$|*X*lT5p1g5qS/y*f/iQ4n0VT7x4q:PQ+g%wQ0P*iQ0x+hQ1m,[Q5|1nQ8k5}Q:V8lR;P:W!U%Oi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yx*P$v)c*Q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=oS0Y*q0Z#f<a#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<b<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!d<t(s)a*Y*b.e.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={`<u3u7X7[7`9]:h:k;kS=P.g3aT=Q7Z9`!U%Qi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y|*R$v)c*S*q+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=oS0[*r0]#f<c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!h<v(s)a*Y*b.f.g.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={d<w3u7Y7Z7`9]9^:h:i:k;kS=R.h3bT=S7[9arnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ&d!UR,k&mrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR&d!UQ,T&[R1[+|snOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ1h,YS5w1k1lU8e5u5v5zS:R8g8hS:{:Q:TQ;_:|R;i;`Q&k!VR,d&gR6T1tR:Y8nS&P|&UR1T+sQ&p!WR,n&qR,t&vT2T,s2VR,x&wQ,w&wR2^,xQ'w!{R-t'wSsOtQ#dXT%os#dQ#OTR'y#OQ#RUR'{#RQ)y$uR/Z)yQ#UVR(O#UQ#XWU(U#X(V-{Q(V#YR-{(WQ-X'WR2j-XQ.p(wS3e.p3fR3f.qQ-`'^R2n-`Y!rQ'^-`1g5qR'h!rQ.{)cR3z.{U#_W%g*WU(]#_(^-|Q(^#`R-|(XQ-['ZR2l-[t`OXst!V!Z#d%l&g&i&p&r&s&u,n,s2S2VS#hZ%dU#r`#h.VR.V(hQ(i#jQ.S(eW.[(i.S3P6wQ3P.TR6w3QQ)l$lR/R)lQ$phR)r$pQ$`cU)_$`-w<[Q-w;xR<[)oQ/l*ZW4Y/l4Z7j9hU4Z/m/n/oS7j4[4]R9h7k$e*O$v(s)a)c*Y*b*q*r*|*}+R.g.h.j.k.l/Y/b/d/f/q/v0^0_0p1]3^3_3`3u3y4S4^4_4c4s4u4{4|4}5h7R7S7T7U7Z7[7^7_7`7f7m7p7z7}8P9]9^9_9i9q9v9w:h:i:j:k:l:q:u;W;];h;k=b=n=o=z={Q/t*bU4b/t4d7nQ4d/vR7n4cS*l$|*XR0S*lx*Q$v)c*q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=o!d.e(s)a*Y*b.g.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/c*Q.e7Xa7X3u7Z7[7`9]:h:k;kQ0Z*qQ3a.gU4t0Z3a9`R9`7Z|*S$v)c*q*r+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=o!h.f(s)a*Y*b.g.h.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/e*S.f7Ye7Y3u7Z7[7`9]9^:h:i:k;kQ0]*rQ3b.hU4v0]3b9aR9a7[Q*w%UR0a*wQ5S0pR8O5SQ+[%jR0o+[Q5l1bS8_5l:OR:O8`Q,V&]R1e,VQ5q1gR8b5qQ1s,aS6R1s8oR8o6TQ1O+oW5_1O5a8V9zQ5a1RQ8V5`R9z8WQ+t&PR1U+tQ2V,sR6c2VYrOXst#dQ&t!ZQ+^%lQ,m&pQ,o&rQ,p&sQ,r&uQ2Q,nS2T,s2VR6b2SQ%npQ&x!_Q&{!aQ&}!bQ'P!cQ'o!uQ+]%kQ+i%yQ+{&VQ,c&kQ,z&zW-k'i'q'r'uQ-r'mQ0R*kQ0y+jS1v,d,gQ2_,yQ2`,|Q2a,}Q2u-jW2w-m-n-q-sQ5W0zQ5d1XQ5g1]Q5{1mQ6V1xQ6a2RU6p2v2y2|Q6s2zQ8R5XQ8Z5fQ8[5hQ8a5pQ8j5|Q8p6US9P6q6uQ9R6tQ9{8XQ:U8kQ:Z8qQ:b9QQ:x9|Q;O:VQ;S:cR;a;PQ%yyQ'b!iQ'm!uU+j%z%{%|Q-R'TU-f'c'd'eS-j'i'sQ/z*gS0z+k+lQ2g-TS2s-g-hQ2z-oS4g/{0OQ5X0{Q6l2mQ6o2tQ6t2{U7q4i4j4mQ9o7sR:r9pS$wi=pR*x%VU%Ui%V=pR0`*vQ$viS(s#v+fS)a$b$cQ)c$dQ*Y$xS*b${*WQ*q%OQ*r%QQ*|%]Q*}%^Q+R%bQ.g<aQ.h<cQ.j<gQ.k<iQ.l<kQ/Y)wQ/b*PQ/d*RQ/f*TQ/q*^S/v*d/hQ0^*tQ0_*ul0p+c,Q.a1a1i3Z5x6|8f9V:S:f:};VQ1]+}Q3^<tQ3_<vQ3`<yS3u<^<_Q3y.zS4S/_4UQ4^/rQ4_/sQ4c/uQ4s0YQ4u0[Q4{0gQ4|0hQ4}0iQ5h1^Q7R<}Q7S=PQ7T=RQ7U=TQ7Z<bQ7[<dQ7^<hQ7_<jQ7`<lQ7f4VQ7m4aQ7p4fQ7z4wQ7}5RQ8P5UQ9]<zQ9^<uQ9_<wQ9i7lQ9q7vQ9v7|Q9w8QQ:h=OQ:i=QQ:j=SQ:k=UQ:l9eQ:q9nQ:u9tQ;W=XQ;]:tQ;h;^Q;k=YQ=b=pQ=n=xQ=o=yQ=z=|R={=}Q*z%[Q.i<eR7]<fnpOXst!Z#d%l&p&r&s&u,n,s2S2VQ!fPS#fZ#oQ&z!`W'f!o*f0V4qQ'}#SQ)O#{Q)p$nS,g&i&lQ,l&mQ,y&yS-O'R/iQ-b'`Q.s(|Q/V)qQ0m+YQ0s+dQ2O,kQ2q-dQ3X.bQ4O/QQ4y0dQ5v1jQ6X1zQ6Y1{Q6^1}Q6`2PQ6e2XQ7P3[Q7c3{Q8h5yQ8t6ZQ8u6[Q8w6_Q9Z7QQ:T8iR:_8x#[cOPXZst!Z!`!o#d#o#{%l&i&l&m&p&r&s&u&y'R'`(|*f+Y+d,k,n,s-d.b/i0V0d1j1z1{1}2P2S2V2X3[4q5y6Z6[6_7Q8i8xQ#YWQ#eYQ%puQ%rvS%tw!gS(Q#W(TQ(W#ZQ(r#uQ(w#xQ)P$OQ)Q$PQ)R$QQ)S$RQ)T$SQ)U$TQ)V$UQ)W$VQ)X$WQ)Y$XQ)[$ZQ)^$_Q)`$aQ)e$eW)o$n)q/Q3{Q+a%sQ+u&QS-U'V2hQ-s'pS-x(R-zQ-}(ZQ.P(bQ.n(vQ.q(xQ.u;vQ.w;yQ.x;zQ.y;}Q/]){Q0j+UQ2c-PQ2f-SQ2v-lQ2}.QQ3c.oQ3h<OQ3i<PQ3j<QQ3k<RQ3l<SQ3m<TQ3n<UQ3o<VQ3p<WQ3q<XQ3r<YQ3s.vQ3t<]Q3w<`Q3x<mQ4P<ZQ5O0lQ5Y0|Q6k<pQ6q2xQ6v3OQ7V3dQ7W<qQ7a<sQ7b<{Q8`5mQ8|6iQ9Q6rQ9[<|Q9b=VQ9c=WQ:c9SQ:y9}Q;R:aQ;x#SR=g=sR#[WR'X!el!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sS'T!e-WU*g$|*X*lS-T'U']S0O*h*nQ0W*oQ2m-^Q4m0UR4r0XR(y#xQ!fQT-_'^-`]!qQ!r'^-`1g5qQ#p]R'g;wR)d$dY!uQ'^-`1g5qQ'i!rS's!v!yS'u!z5sS-o'j'kQ-q'lR2{-pT#kZ%dS#jZ%dS%jm,jU(e#h#i#lS.T(f(gQ.X(hQ0n+ZQ3Q.UU3R.V.W.YS6x3S3TR9T6yd#^W#W#Z%g(R([*W+W.O/hr#gZm#h#i#l%d(f(g(h+Z.U.V.W.Y3S3T6yS*Z$x*_Q/o*[Q1|,jQ2d-QQ4W/kQ6g2[Q7i4XQ8{6hT=_'V+XV#aW%g*WU#`W%g*WS(S#W([U(X#Z+W/hS-V'V+XT-y(R.OV'[!e%h*XQ$lfR)v$qT)k$l)lR3}/PT*]$x*_T*e${*WQ0q+cQ1_,QQ3V.aQ5j1aQ5u1iQ6}3ZQ8g5xQ9W6|Q:Q8fQ:d9VQ:|:SQ;U:fQ;`:}R;c;VnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&j!VR,c&gtmOXst!U!V!Z#d%l&g&p&r&s&u,n,s2S2VR,j&mT%km,jR1c,SR,b&eQ&T|R+z&UR+p&OT&n!W&qT&o!W&qT2U,s2V",nodeNames:" ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:378,context:Rfe,nodeProps:[["isolate",-8,5,6,14,35,37,49,51,53,""],["group",-26,9,17,19,66,206,210,214,215,217,220,223,233,235,241,243,245,247,250,256,262,264,266,268,270,272,273,"Statement",-34,13,14,30,33,34,40,49,52,53,55,60,68,70,74,78,80,82,83,108,109,118,119,135,138,140,141,142,143,144,146,147,166,168,170,"Expression",-23,29,31,35,39,41,43,172,174,176,177,179,180,181,183,184,185,187,188,189,200,202,204,205,"Type",-3,86,101,107,"ClassItem"],["openedBy",23,"<",36,"InterpolationStart",54,"[",58,"{",71,"(",159,"JSXStartCloseTag"],["closedBy",-2,24,167,">",38,"InterpolationEnd",48,"]",59,"}",72,")",164,"JSXEndTag"]],propSources:[Ffe],skippedNodes:[0,5,6,276],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$h&j(Up(X!b'z0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(V#S$h&j'{0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$h&j(Up(X!b'{0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$h&j!n),Q(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(T':f$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$h&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$c`$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$c``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$c`$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(X!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$c`(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$h&j(Up(X!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$h&j(Up(X!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$h&j(X!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$h&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(X!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$h&j(UpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(UpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Up(X!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$h&j(m%1l(Up(X!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$h&j(Up(X!b$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$h&j(Up(X!b$[#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$h&j(Up(X!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$h&j$P(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(x+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$h&j#y(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(W';W$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$h&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$c`$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(UpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$c`(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!j/.^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!i!Lf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$h&j(Up(X!b(S%&f#o(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$h&j(Up(X!b#l(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$h&j(Up(X!bp+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!Z+Jf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$h&j(Up(X!b!O.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_!Y!L^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$h&j(Up(X!b#m(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$h&j(X!b!V7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$h&j!V7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$h&j!V7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!V7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!V7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$h&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$h&j(X!b!V7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(X!b!V7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(X!b!V7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(X!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$h&j(X!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$h&j(Up!V7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$h&j(Up!V7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Up!V7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Up!V7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(UpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$h&j(UpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$h&j(Up(X!b!V7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Up(X!b!V7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Up(X!b!V7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Up(X!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$h&j(Up(X!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$h&j(Up(X!b'|0/l!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$h&j(Up(X!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$h&j(X!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$h&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(X!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$h&j(UpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(UpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Up(X!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$h&j$P(Ch(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Y#t$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!e$b$h&j#})Lv(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#P-<U(Up(X!b$m7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$j&j(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#p(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$P(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#q(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#^*!Y$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#i(Cl$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#q(Ch$e#|$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#q(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(p(Ct$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$h&j#z(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!z$Ip$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!Q0,v$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$h&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$h&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$h&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$h&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$h&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!W#)l$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#w(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$h&j(Up(X!b(_+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$h&j(Up(X!b(R,2j$^#t(c$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$h&j(Up(X!b$^#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!]#Hb(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(w+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_![(CdtBr$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!o7`$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$h&j(Up(X!b'z0/l$[#t(R,2j(c$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$h&j(Up(X!b'{0/l$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[Ife,Dfe,$fe,Mfe,2,3,4,5,6,7,8,9,10,11,12,13,14,Lfe,new ep("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOv~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!S~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(a~~",141,338),new ep("j~RQYZXz{^~^O(O~~aP!P!Qd~iO(P~~",25,321)],topRules:{Script:[0,7],SingleExpression:[1,274],SingleClassItem:[2,275]},dialects:{jsx:0,ts:15091},dynamicPrecedences:{78:1,80:1,92:1,168:1,198:1},specialized:[{term:325,get:i=>Nfe[i]||-1},{term:341,get:i=>Qfe[i]||-1},{term:93,get:i=>Bfe[i]||-1}],tokenPrec:15116}),Tb=[bi("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),bi("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),bi("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),bi("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),bi("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),bi(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),bi("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),bi(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),bi(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),bi('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),bi('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],u6=Tb.concat([bi("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),bi("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),bi("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),r2=new l$,c6=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Ql(i){return(e,t)=>{let n=e.node.getChild("VariableDefinition");return n&&t(n,i),!0}}const Vfe=["FunctionDeclaration"],Zfe={FunctionDeclaration:Ql("function"),ClassDeclaration:Ql("class"),ClassExpression:()=>!0,EnumDeclaration:Ql("constant"),TypeAliasDeclaration:Ql("type"),NamespaceDeclaration:Ql("namespace"),VariableDefinition(i,e){i.matchContext(Vfe)||e(i,"variable")},TypeDefinition(i,e){e(i,"type")},__proto__:null};function h6(i,e){let t=r2.get(e);if(t)return t;let n=[],r=!0;function s(o,a){let l=i.sliceString(o.from,o.to);n.push({label:l,type:a})}return e.cursor(it.IncludeAnonymous).iterate(o=>{if(r)r=!1;else if(o.name){let a=Zfe[o.name];if(a&&a(o,s)||c6.has(o.name))return!1}else if(o.to-o.from>8192){for(let a of h6(i,o.node))n.push(a);return!1}}),r2.set(e,n),n}const np=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Eb=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function f6(i){let e=bt(i.state).resolveInner(i.pos,-1);if(Eb.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&np.test(i.state.sliceDoc(e.from,e.to));if(!t&&!i.explicit)return null;let n=[];for(let r=e;r;r=r.parent)c6.has(r.name)&&(n=n.concat(h6(i.state.doc,r)));return{options:n,from:t?e.from:i.pos,validFor:np}}function xm(i,e,t){var n;let r=[];for(;;){let s=e.firstChild,o;if((s==null?void 0:s.name)=="VariableName")return r.push(i(s)),{path:r.reverse(),name:t};if((s==null?void 0:s.name)=="MemberExpression"&&((n=o=s.lastChild)===null||n===void 0?void 0:n.name)=="PropertyName")r.push(i(o)),e=s;else return null}}function d6(i){let e=n=>i.state.doc.sliceString(n.from,n.to),t=bt(i.state).resolveInner(i.pos,-1);return t.name=="PropertyName"?xm(e,t.parent,e(t)):(t.name=="."||t.name=="?.")&&t.parent.name=="MemberExpression"?xm(e,t.parent,""):Eb.indexOf(t.name)>-1?null:t.name=="VariableName"||t.to-t.from<20&&np.test(e(t))?{path:[],name:e(t)}:t.name=="MemberExpression"?xm(e,t,""):i.explicit?{path:[],name:""}:null}function jfe(i,e){let t=[],n=new Set;for(let r=0;;r++){for(let o of(Object.getOwnPropertyNames||Object.keys)(i)){if(!/^[a-zA-Z_$\xaa-\uffdc][\w$\xaa-\uffdc]*$/.test(o)||n.has(o))continue;n.add(o);let a;try{a=i[o]}catch{continue}t.push({label:o,type:typeof a=="function"?/^[A-Z]/.test(o)?"class":e?"function":"method":e?"variable":"property",boost:-r})}let s=Object.getPrototypeOf(i);if(!s)return t;i=s}}function Gfe(i){let e=new Map;return t=>{let n=d6(t);if(!n)return null;let r=i;for(let o of n.path)if(r=r[o],!r)return null;let s=e.get(r);return s||e.set(r,s=jfe(r,!n.path.length)),{from:t.pos-n.name.length,options:s,validFor:np}}}const fn=Xa.define({name:"javascript",parser:Ufe.configure({props:[gl.add({IfStatement:Mf({except:/^\s*({|else\b)/}),TryStatement:Mf({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:Vae,SwitchBody:i=>{let e=i.textAfter,t=/^\s*\}/.test(e),n=/^\s*(case|default)\b/.test(e);return i.baseIndent+(t?0:n?1:2)*i.unit},Block:Uae({closing:"}"}),ArrowFunction:i=>i.baseIndent+i.unit,"TemplateString BlockComment":()=>null,"Statement Property":Mf({except:/^{/}),JSXElement(i){let e=/^\s*<\//.test(i.textAfter);return i.lineIndent(i.node.from)+(e?0:i.unit)},JSXEscape(i){let e=/\s*\}/.test(i.textAfter);return i.lineIndent(i.node.from)+(e?0:i.unit)},"JSXOpenTag JSXSelfClosingTag"(i){return i.column(i.node.from)+i.unit}}),Cc.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":m$,BlockComment(i){return{from:i.from+2,to:i.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),p6={test:i=>/^JSX/.test(i.name),facet:Mp({commentTokens:{block:{open:"{/*",close:"*/}"}}})},wb=fn.configure({dialect:"ts"},"typescript"),_b=fn.configure({dialect:"jsx",props:[J1.add(i=>i.isTop?[p6]:void 0)]}),Cb=fn.configure({dialect:"jsx ts",props:[J1.add(i=>i.isTop?[p6]:void 0)]},"typescript");let g6=i=>({label:i,type:"keyword"});const m6="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(g6),Hfe=m6.concat(["declare","implements","private","protected","public"].map(g6));function v6(i={}){let e=i.jsx?i.typescript?Cb:_b:i.typescript?wb:fn,t=i.typescript?u6.concat(Hfe):Tb.concat(m6);return new qa(e,[fn.data.of({autocomplete:Due(Eb,d3(t))}),fn.data.of({autocomplete:f6}),i.jsx?O6:[]])}function Xfe(i){for(;;){if(i.name=="JSXOpenTag"||i.name=="JSXSelfClosingTag"||i.name=="JSXFragmentTag")return i;if(i.name=="JSXEscape"||!i.parent)return null;i=i.parent}}function s2(i,e,t=i.length){for(let n=e==null?void 0:e.firstChild;n;n=n.nextSibling)if(n.name=="JSXIdentifier"||n.name=="JSXBuiltin"||n.name=="JSXNamespacedName"||n.name=="JSXMemberExpression")return i.sliceString(n.from,Math.min(n.to,t));return""}const zfe=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),O6=le.inputHandler.of((i,e,t,n,r)=>{if((zfe?i.composing:i.compositionStarted)||i.state.readOnly||e!=t||n!=">"&&n!="/"||!fn.isActiveAt(i.state,e,-1))return!1;let s=r(),{state:o}=s,a=o.changeByRange(l=>{var u;let{head:c}=l,h=bt(o).resolveInner(c-1,-1),f;if(h.name=="JSXStartTag"&&(h=h.parent),!(o.doc.sliceString(c-1,c)!=n||h.name=="JSXAttributeValue"&&h.to>c)){if(n==">"&&h.name=="JSXFragmentTag")return{range:l,changes:{from:c,insert:"</>"}};if(n=="/"&&h.name=="JSXStartCloseTag"){let d=h.parent,p=d.parent;if(p&&d.from==c-2&&((f=s2(o.doc,p.firstChild,c))||((u=p.firstChild)===null||u===void 0?void 0:u.name)=="JSXFragmentTag")){let g=`${f}>`;return{range:G.cursor(c+g.length,-1),changes:{from:c,insert:g}}}}else if(n==">"){let d=Xfe(h);if(d&&d.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(o.doc.sliceString(c,c+2))&&(f=s2(o.doc,d,c)))return{range:l,changes:{from:c,insert:`</${f}>`}}}}return{range:l}});return a.changes.empty?!1:(i.dispatch([s,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)});function Wfe(i,e){return e||(e={parserOptions:{ecmaVersion:2019,sourceType:"module"},env:{browser:!0,node:!0,es6:!0,es2015:!0,es2017:!0,es2020:!0},rules:{}},i.getRules().forEach((t,n)=>{t.meta.docs.recommended&&(e.rules[n]=2)})),t=>{let{state:n}=t,r=[];for(let{from:s,to:o}of fn.findRegions(n)){let a=n.doc.lineAt(s),l={line:a.number-1,col:s-a.from,pos:s};for(let u of i.verify(n.sliceDoc(s,o),e))r.push(qfe(u,n.doc,l))}return r}}function o2(i,e,t,n){return t.line(i+n.line).from+e+(i==1?n.col-1:-1)}function qfe(i,e,t){let n=o2(i.line,i.column,e,t),r={from:n,to:i.endLine!=null&&i.endColumn!=1?o2(i.endLine,i.endColumn,e,t):n,message:i.message,source:i.ruleId?"eslint:"+i.ruleId:"eslint",severity:i.severity==1?"warning":"error"};if(i.fix){let{range:s,text:o}=i.fix,a=s[0]+t.pos-n,l=s[1]+t.pos-n;r.actions=[{name:"fix",apply(u,c){u.dispatch({changes:{from:c+a,to:c+l,insert:o},scrollIntoView:!0})}}]}return r}const qh=Object.freeze(Object.defineProperty({__proto__:null,autoCloseTags:O6,completionPath:d6,esLint:Wfe,javascript:v6,javascriptLanguage:fn,jsxLanguage:_b,localCompletionSource:f6,scopeCompletionSource:Gfe,snippets:Tb,tsxLanguage:Cb,typescriptLanguage:wb,typescriptSnippets:u6},Symbol.toStringTag,{value:"Module"})),Bl=["_blank","_self","_top","_parent"],Sm=["ascii","utf-8","utf-16","latin1","latin1"],km=["get","post","put","delete"],Tm=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],Ii=["true","false"],fe={},Yfe={a:{attrs:{href:null,ping:null,type:null,media:null,target:Bl,hreflang:null}},abbr:fe,address:fe,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:fe,aside:fe,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:fe,base:{attrs:{href:null,target:Bl}},bdi:fe,bdo:fe,blockquote:{attrs:{cite:null}},body:fe,br:fe,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:Tm,formmethod:km,formnovalidate:["novalidate"],formtarget:Bl,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:fe,center:fe,cite:fe,code:fe,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:fe,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:fe,div:fe,dl:fe,dt:fe,em:fe,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:fe,figure:fe,footer:fe,form:{attrs:{action:null,name:null,"accept-charset":Sm,autocomplete:["on","off"],enctype:Tm,method:km,novalidate:["novalidate"],target:Bl}},h1:fe,h2:fe,h3:fe,h4:fe,h5:fe,h6:fe,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:fe,hgroup:fe,hr:fe,html:{attrs:{manifest:null}},i:fe,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:Tm,formmethod:km,formnovalidate:["novalidate"],formtarget:Bl,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:fe,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:fe,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:fe,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:Sm,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:fe,noscript:fe,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:fe,param:{attrs:{name:null,value:null}},pre:fe,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:fe,rt:fe,ruby:fe,samp:fe,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:Sm}},section:fe,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:fe,source:{attrs:{src:null,type:null,media:null}},span:fe,strong:fe,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:fe,summary:fe,sup:fe,table:fe,tbody:fe,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:fe,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:fe,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:fe,time:{attrs:{datetime:null}},title:fe,tr:fe,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:fe,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:fe},y6={accesskey:null,class:null,contenteditable:Ii,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:Ii,autocorrect:Ii,autocapitalize:Ii,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":Ii,"aria-autocomplete":["inline","list","both","none"],"aria-busy":Ii,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":Ii,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":Ii,"aria-hidden":Ii,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":Ii,"aria-multiselectable":Ii,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":Ii,"aria-relevant":null,"aria-required":Ii,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},b6="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map(i=>"on"+i);for(let i of b6)y6[i]=null;class Ku{constructor(e,t){this.tags=Object.assign(Object.assign({},Yfe),e),this.globalAttrs=Object.assign(Object.assign({},y6),t),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}Ku.default=new Ku;function Ja(i,e,t=i.length){if(!e)return"";let n=e.firstChild,r=n&&n.getChild("TagName");return r?i.sliceString(r.from,Math.min(r.to,t)):""}function el(i,e=!1){for(;i;i=i.parent)if(i.name=="Element")if(e)e=!1;else return i;return null}function x6(i,e,t){let n=t.tags[Ja(i,el(e))];return(n==null?void 0:n.children)||t.allTags}function Ab(i,e){let t=[];for(let n=el(e);n&&!n.type.isTop;n=el(n.parent)){let r=Ja(i,n);if(r&&n.lastChild.name=="CloseTag")break;r&&t.indexOf(r)<0&&(e.name=="EndTag"||e.from>=n.firstChild.to)&&t.push(r)}return t}const S6=/^[:\-\.\w\u00b7-\uffff]*$/;function a2(i,e,t,n,r){let s=/\s*>/.test(i.sliceDoc(r,r+5))?"":">",o=el(t,!0);return{from:n,to:r,options:x6(i.doc,o,e).map(a=>({label:a,type:"type"})).concat(Ab(i.doc,t).map((a,l)=>({label:"/"+a,apply:"/"+a+s,type:"type",boost:99-l}))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function l2(i,e,t,n){let r=/\s*>/.test(i.sliceDoc(n,n+5))?"":">";return{from:t,to:n,options:Ab(i.doc,e).map((s,o)=>({label:s,apply:s+r,type:"type",boost:99-o})),validFor:S6}}function Kfe(i,e,t,n){let r=[],s=0;for(let o of x6(i.doc,t,e))r.push({label:"<"+o,type:"type"});for(let o of Ab(i.doc,t))r.push({label:"</"+o+">",type:"type",boost:99-s++});return{from:n,to:n,options:r,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}function Jfe(i,e,t,n,r){let s=el(t),o=s?e.tags[Ja(i.doc,s)]:null,a=o&&o.attrs?Object.keys(o.attrs):[],l=o&&o.globalAttrs===!1?a:a.length?a.concat(e.globalAttrNames):e.globalAttrNames;return{from:n,to:r,options:l.map(u=>({label:u,type:"property"})),validFor:S6}}function ede(i,e,t,n,r){var s;let o=(s=t.parent)===null||s===void 0?void 0:s.getChild("AttributeName"),a=[],l;if(o){let u=i.sliceDoc(o.from,o.to),c=e.globalAttrs[u];if(!c){let h=el(t),f=h?e.tags[Ja(i.doc,h)]:null;c=(f==null?void 0:f.attrs)&&f.attrs[u]}if(c){let h=i.sliceDoc(n,r).toLowerCase(),f='"',d='"';/^['"]/.test(h)?(l=h[0]=='"'?/^[^"]*$/:/^[^']*$/,f="",d=i.sliceDoc(r,r+1)==h[0]?"":h[0],h=h.slice(1),n++):l=/^[^\s<>='"]*$/;for(let p of c)a.push({label:p,apply:f+p+d,type:"constant"})}}return{from:n,to:r,options:a,validFor:l}}function k6(i,e){let{state:t,pos:n}=e,r=bt(t).resolveInner(n,-1),s=r.resolve(n);for(let o=n,a;s==r&&(a=r.childBefore(o));){let l=a.lastChild;if(!l||!l.type.isError||l.from<l.to)break;s=r=a,o=l.from}return r.name=="TagName"?r.parent&&/CloseTag$/.test(r.parent.name)?l2(t,r,r.from,n):a2(t,i,r,r.from,n):r.name=="StartTag"?a2(t,i,r,n,n):r.name=="StartCloseTag"||r.name=="IncompleteCloseTag"?l2(t,r,n,n):r.name=="OpenTag"||r.name=="SelfClosingTag"||r.name=="AttributeName"?Jfe(t,i,r,r.name=="AttributeName"?r.from:n,n):r.name=="Is"||r.name=="AttributeValue"||r.name=="UnquotedAttributeValue"?ede(t,i,r,r.name=="Is"?n:r.from,n):e.explicit&&(s.name=="Element"||s.name=="Text"||s.name=="Document")?Kfe(t,i,r,n):null}function T6(i){return k6(Ku.default,i)}function E6(i){let{extraTags:e,extraGlobalAttributes:t}=i,n=t||e?new Ku(e,t):Ku.default;return r=>k6(n,r)}const tde=fn.parser.configure({top:"SingleExpression"}),w6=[{tag:"script",attrs:i=>i.type=="text/typescript"||i.lang=="ts",parser:wb.parser},{tag:"script",attrs:i=>i.type=="text/babel"||i.type=="text/jsx",parser:_b.parser},{tag:"script",attrs:i=>i.type=="text/typescript-jsx",parser:Cb.parser},{tag:"script",attrs(i){return/^(importmap|speculationrules|application\/(.+\+)?json)$/i.test(i.type)},parser:tde},{tag:"script",attrs(i){return!i.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(i.type)},parser:fn.parser},{tag:"style",attrs(i){return(!i.lang||i.lang=="css")&&(!i.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(i.type))},parser:Yu.parser}],_6=[{name:"style",parser:Yu.parser.configure({top:"Styles"})}].concat(b6.map(i=>({name:i,parser:fn.parser}))),Pb=Xa.define({name:"html",parser:Fhe.configure({props:[gl.add({Element(i){let e=/^(\s*)(<\/)?/.exec(i.textAfter);return i.node.to<=i.pos+e[0].length?i.continue():i.lineIndent(i.node.from)+(e[2]?0:i.unit)},"OpenTag CloseTag SelfClosingTag"(i){return i.column(i.node.from)+i.unit},Document(i){if(i.pos+/\s*/.exec(i.textAfter)[0].length<i.node.to)return i.continue();let e=null,t;for(let n=i.node;;){let r=n.lastChild;if(!r||r.name!="Element"||r.to!=n.to)break;e=n=r}return e&&!((t=e.lastChild)&&(t.name=="CloseTag"||t.name=="SelfClosingTag"))?i.lineIndent(e.from)+i.unit:null}}),Cc.add({Element(i){let e=i.firstChild,t=i.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:t.name=="CloseTag"?t.from:i.to}}}),O$.add({"OpenTag CloseTag":i=>i.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}}),bu=Pb.configure({wrap:e6(w6,_6)});function C6(i={}){let e="",t;i.matchClosingTags===!1&&(e="noMatch"),i.selfClosingTags===!0&&(e=(e?e+" ":"")+"selfClosing"),(i.nestedLanguages&&i.nestedLanguages.length||i.nestedAttributes&&i.nestedAttributes.length)&&(t=e6((i.nestedLanguages||[]).concat(w6),(i.nestedAttributes||[]).concat(_6)));let n=t?Pb.configure({wrap:t,dialect:e}):e?bu.configure({dialect:e}):bu;return new qa(n,[bu.data.of({autocomplete:E6(i)}),i.autoCloseTags!==!1?A6:[],v6().support,a6().support])}const u2=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),A6=le.inputHandler.of((i,e,t,n,r)=>{if(i.composing||i.state.readOnly||e!=t||n!=">"&&n!="/"||!bu.isActiveAt(i.state,e,-1))return!1;let s=r(),{state:o}=s,a=o.changeByRange(l=>{var u,c,h;let f=o.doc.sliceString(l.from-1,l.to)==n,{head:d}=l,p=bt(o).resolveInner(d,-1),g;if(f&&n==">"&&p.name=="EndTag"){let m=p.parent;if(((c=(u=m.parent)===null||u===void 0?void 0:u.lastChild)===null||c===void 0?void 0:c.name)!="CloseTag"&&(g=Ja(o.doc,m.parent,d))&&!u2.has(g)){let v=d+(o.doc.sliceString(d,d+1)===">"?1:0),O=`</${g}>`;return{range:l,changes:{from:d,to:v,insert:O}}}}else if(f&&n=="/"&&p.name=="IncompleteCloseTag"){let m=p.parent;if(p.from==d-2&&((h=m.lastChild)===null||h===void 0?void 0:h.name)!="CloseTag"&&(g=Ja(o.doc,m,d))&&!u2.has(g)){let v=d+(o.doc.sliceString(d,d+1)===">"?1:0),O=`${g}>`;return{range:G.cursor(d+O.length,-1),changes:{from:d,to:v,insert:O}}}}return{range:l}});return a.changes.empty?!1:(i.dispatch([s,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),ide=Object.freeze(Object.defineProperty({__proto__:null,autoCloseTags:A6,html:C6,htmlCompletionSource:T6,htmlCompletionSourceWith:E6,htmlLanguage:bu,htmlPlain:Pb},Symbol.toStringTag,{value:"Module"})),P6=Mp({commentTokens:{block:{open:"<!--",close:"-->"}}}),R6=new Te,L6=Lce.configure({props:[Cc.add(i=>!i.is("Block")||i.is("Document")||ZO(i)!=null||nde(i)?void 0:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})),R6.add(ZO),gl.add({Document:()=>null}),vs.add({Document:P6})]});function ZO(i){let e=/^(?:ATX|Setext)Heading(\d)$/.exec(i.name);return e?+e[1]:void 0}function nde(i){return i.name=="OrderedList"||i.name=="BulletList"}function rde(i,e){let t=i;for(;;){let n=t.nextSibling,r;if(!n||(r=ZO(n.type))!=null&&r<=e)break;t=n}return t.to}const sde=Zae.of((i,e,t)=>{for(let n=bt(i).resolveInner(t,-1);n&&!(n.from<e);n=n.parent){let r=n.type.prop(R6);if(r==null)continue;let s=rde(n,r);if(s>t)return{from:t,to:s}}return null});function Rb(i){return new Gi(P6,i,[sde],"markdown")}const I6=Rb(L6),ode=L6.configure([Zce,Gce,jce,Hce,{props:[Cc.add({Table:(i,e)=>({from:e.doc.lineAt(i.from).to,to:i.to})})]}]),Lb=Rb(ode);function ade(i,e){return t=>{if(t&&i){let n=null;if(t=/\S*/.exec(t)[0],typeof i=="function"?n=i(t):n=N.matchLanguageName(i,t,!0),n instanceof N)return n.support?n.support.language.parser:Oo.getSkippingParser(n.load());if(n)return n.parser}return e?e.parser:null}}class Em{constructor(e,t,n,r,s,o,a){this.node=e,this.from=t,this.to=n,this.spaceBefore=r,this.spaceAfter=s,this.type=o,this.item=a}blank(e,t=!0){let n=this.spaceBefore+(this.node.name=="Blockquote"?">":"");if(e!=null){for(;n.length<e;)n+=" ";return n}else{for(let r=this.to-this.from-n.length-this.spaceAfter.length;r>0;r--)n+=" ";return n+(t?this.spaceAfter:"")}}marker(e,t){let n=this.node.name=="OrderedList"?String(+$6(this.item,e)[2]+t):"";return this.spaceBefore+n+this.type+this.spaceAfter}}function D6(i,e){let t=[],n=[];for(let r=i;r;r=r.parent){if(r.name=="FencedCode")return n;(r.name=="ListItem"||r.name=="Blockquote")&&t.push(r)}for(let r=t.length-1;r>=0;r--){let s=t[r],o,a=e.lineAt(s.from),l=s.from-a.from;if(s.name=="Blockquote"&&(o=/^ *>( ?)/.exec(a.text.slice(l))))n.push(new Em(s,l,l+o[0].length,"",o[1],">",null));else if(s.name=="ListItem"&&s.parent.name=="OrderedList"&&(o=/^( *)\d+([.)])( *)/.exec(a.text.slice(l)))){let u=o[3],c=o[0].length;u.length>=4&&(u=u.slice(0,u.length-4),c-=4),n.push(new Em(s.parent,l,l+c,o[1],u,o[2],s))}else if(s.name=="ListItem"&&s.parent.name=="BulletList"&&(o=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(a.text.slice(l)))){let u=o[4],c=o[0].length;u.length>4&&(u=u.slice(0,u.length-4),c-=4);let h=o[2];o[3]&&(h+=o[3].replace(/[xX]/," ")),n.push(new Em(s.parent,l,l+c,o[1],u,h,s))}}return n}function $6(i,e){return/^(\s*)(\d+)(?=[.)])/.exec(e.sliceString(i.from,i.from+10))}function wm(i,e,t,n=0){for(let r=-1,s=i;;){if(s.name=="ListItem"){let a=$6(s,e),l=+a[2];if(r>=0){if(l!=r+1)return;t.push({from:s.from+a[1].length,to:s.from+a[0].length,insert:String(r+2+n)})}r=l}let o=s.nextSibling;if(!o)break;s=o}}function Ib(i,e){let t=/^[ \t]*/.exec(i)[0].length;if(!t||e.facet(pl)!="	")return i;let n=Nr(i,4,t),r="";for(let s=n;s>0;)s>=4?(r+="	",s-=4):(r+=" ",s--);return r+i.slice(t)}const M6=({state:i,dispatch:e})=>{let t=bt(i),{doc:n}=i,r=null,s=i.changeByRange(o=>{if(!o.empty||!Lb.isActiveAt(i,o.from,0))return r={range:o};let a=o.from,l=n.lineAt(a),u=D6(t.resolveInner(a,-1),n);for(;u.length&&u[u.length-1].from>a-l.from;)u.pop();if(!u.length)return r={range:o};let c=u[u.length-1];if(c.to-c.spaceAfter.length>a-l.from)return r={range:o};let h=a>=c.to-c.spaceAfter.length&&!/\S/.test(l.text.slice(c.to));if(c.item&&h){let m=c.node.firstChild,v=c.node.getChild("ListItem","ListItem");if(m.to>=a||v&&v.to<a||l.from>0&&!/[^\s>]/.test(n.lineAt(l.from-1).text)){let O=u.length>1?u[u.length-2]:null,y,x="";O&&O.item?(y=l.from+O.from,x=O.marker(n,1)):y=l.from+(O?O.to:0);let b=[{from:y,to:a,insert:x}];return c.node.name=="OrderedList"&&wm(c.item,n,b,-2),O&&O.node.name=="OrderedList"&&wm(O.item,n,b),{range:G.cursor(y+x.length),changes:b}}else{let O=h2(u,i,l);return{range:G.cursor(a+O.length+1),changes:{from:l.from,insert:O+i.lineBreak}}}}if(c.node.name=="Blockquote"&&h&&l.from){let m=n.lineAt(l.from-1),v=/>\s*$/.exec(m.text);if(v&&v.index==c.from){let O=i.changes([{from:m.from+v.index,to:m.to},{from:l.from+c.from,to:l.to}]);return{range:o.map(O),changes:O}}}let f=[];c.node.name=="OrderedList"&&wm(c.item,n,f);let d=c.item&&c.item.from<l.from,p="";if(!d||/^[\s\d.)\-+*>]*/.exec(l.text)[0].length>=c.to)for(let m=0,v=u.length-1;m<=v;m++)p+=m==v&&!d?u[m].marker(n,1):u[m].blank(m<v?Nr(l.text,4,u[m+1].from)-p.length:null);let g=a;for(;g>l.from&&/\s/.test(l.text.charAt(g-l.from-1));)g--;return p=Ib(p,i),lde(c.node,i.doc)&&(p=h2(u,i,l)+i.lineBreak+p),f.push({from:g,to:a,insert:i.lineBreak+p}),{range:G.cursor(g+p.length+1),changes:f}});return r?!1:(e(i.update(s,{scrollIntoView:!0,userEvent:"input"})),!0)};function c2(i){return i.name=="QuoteMark"||i.name=="ListMark"}function lde(i,e){if(i.name!="OrderedList"&&i.name!="BulletList")return!1;let t=i.firstChild,n=i.getChild("ListItem","ListItem");if(!n)return!1;let r=e.lineAt(t.to),s=e.lineAt(n.from),o=/^[\s>]*$/.test(r.text);return r.number+(o?0:1)<s.number}function h2(i,e,t){let n="";for(let r=0,s=i.length-2;r<=s;r++)n+=i[r].blank(r<s?Nr(t.text,4,Math.min(t.text.length,i[r+1].from))-n.length:null,r<s);return Ib(n,e)}function ude(i,e){let t=i.resolveInner(e,-1),n=e;c2(t)&&(n=t.from,t=t.parent);for(let r;r=t.childBefore(n);)if(c2(r))n=r.from;else if(r.name=="OrderedList"||r.name=="BulletList")t=r.lastChild,n=t.to;else break;return t}const F6=({state:i,dispatch:e})=>{let t=bt(i),n=null,r=i.changeByRange(s=>{let o=s.from,{doc:a}=i;if(s.empty&&Lb.isActiveAt(i,s.from)){let l=a.lineAt(o),u=D6(ude(t,o),a);if(u.length){let c=u[u.length-1],h=c.to-c.spaceAfter.length+(c.spaceAfter?1:0);if(o-l.from>h&&!/\S/.test(l.text.slice(h,o-l.from)))return{range:G.cursor(l.from+h),changes:{from:l.from+h,to:o}};if(o-l.from==h&&(!c.item||l.from<=c.item.from||!/\S/.test(l.text.slice(0,c.to)))){let f=l.from+c.from;if(c.item&&c.node.from<c.item.from&&/\S/.test(l.text.slice(c.from,c.to))){let d=c.blank(Nr(l.text,4,c.to)-Nr(l.text,4,c.from));return f==l.from&&(d=Ib(d,i)),{range:G.cursor(f+d.length),changes:{from:f,to:l.from+c.to,insert:d}}}if(f<o)return{range:G.cursor(f),changes:{from:f,to:o}}}}}return n={range:s}});return n?!1:(e(i.update(r,{scrollIntoView:!0,userEvent:"delete"})),!0)},N6=[{key:"Enter",run:M6},{key:"Backspace",run:F6}],Q6=C6({matchClosingTags:!1});function B6(i={}){let{codeLanguages:e,defaultCodeLanguage:t,addKeymap:n=!0,base:{parser:r}=I6,completeHTMLTags:s=!0,htmlTagLanguage:o=Q6}=i;if(!(r instanceof Vp))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let a=i.extensions?[i.extensions]:[],l=[o.support],u;t instanceof qa?(l.push(t.support),u=t.language):t&&(u=t);let c=e||u?ade(e,u):void 0;a.push(Dce({codeParser:c,htmlParser:o.language.parser})),n&&l.push(Vr.high(wc.of(N6)));let h=Rb(r.configure(a));return s&&l.push(h.data.of({autocomplete:cde})),new qa(h,l)}function cde(i){let{state:e,pos:t}=i,n=/<[:\-\.\w\u00b7-\uffff]*$/.exec(e.sliceDoc(t-25,t));if(!n)return null;let r=bt(e).resolveInner(t,-1);for(;r&&!r.type.isTop;){if(r.name=="CodeBlock"||r.name=="FencedCode"||r.name=="ProcessingInstructionBlock"||r.name=="CommentBlock"||r.name=="Link"||r.name=="Image")return null;r=r.parent}return{from:t-n[0].length,to:t,options:hde(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let _m=null;function hde(){if(_m)return _m;let i=T6(new fb(Be.create({extensions:Q6}),0,!0));return _m=i?i.options:[]}const fde=Object.freeze(Object.defineProperty({__proto__:null,commonmarkLanguage:I6,deleteMarkupBackward:F6,insertNewlineContinueMarkup:M6,markdown:B6,markdownKeymap:N6,markdownLanguage:Lb},Symbol.toStringTag,{value:"Module"})),dde={title:{type:String,default:""},trigger:{type:[String,Object],default:void 0},onClick:{type:Function,default:void 0},insert:{type:Function,default:void 0},language:{type:String,default:void 0},theme:{type:String,default:void 0},previewTheme:{type:String,default:void 0},codeTheme:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},showToolbarName:{type:Boolean,default:void 0}},Qf=Ze({name:"NormalToolbar",props:dde,emits:["onClick"],setup(i,e){return()=>{const t=pi({props:i,ctx:e},"trigger"),n=pi({props:i,ctx:e});return R("div",{class:[`${C}-toolbar-item`,i.disabled&&`${C}-disabled`],title:i.title,onClick:r=>{var s;i.disabled||((s=i.onClick)==null||s.call(i,r),e.emit("onClick",r))}},[n||t])}}});Qf.install=i=>(i.component(Qf.name,Qf),i);function pde(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!O5(i)}const gde={title:{type:String,default:""},modalTitle:{type:[String,Object],default:""},visible:{type:Boolean,default:void 0},width:{type:String,default:"auto"},height:{type:String,default:"auto"},trigger:{type:[String,Object],default:void 0},onClick:{type:Function,default:void 0},onClose:{type:Function,default:void 0},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:void 0},class:{type:String,default:void 0},style:{type:[Object,String],default:void 0},showMask:{type:Boolean,default:!0},insert:{type:Function,default:void 0},language:{type:String,default:void 0},theme:{type:String,default:void 0},previewTheme:{type:String,default:void 0},codeTheme:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},showToolbarName:{type:Boolean,default:void 0}},Bf=Ze({name:"ModalToolbar",props:gde,emits:["onClick","onClose","onAdjust"],setup(i,e){return()=>{const t=pi({props:i,ctx:e},"trigger"),n=pi({props:i,ctx:e},"modalTitle"),r=pi({props:i,ctx:e});return R(bo,null,[R("div",{class:[`${C}-toolbar-item`,i.disabled&&`${C}-disabled`],title:i.title,onClick:()=>{var s;i.disabled||((s=i.onClick)==null||s.call(i),e.emit("onClick"))}},[t]),R(ya,{style:i.style,class:i.class,width:i.width,height:i.height,title:n,visible:i.visible,showMask:i.showMask,onClose:()=>{var s;(s=i.onClose)==null||s.call(i),e.emit("onClose")},showAdjust:i.showAdjust,isFullscreen:i.isFullscreen,onAdjust:s=>{var o;(o=i.onAdjust)==null||o.call(i,s),e.emit("onAdjust",s)}},pde(r)?r:{default:()=>[r]})])}}});Bf.install=i=>(i.component(Bf.name,Bf),i);var mde=Object.defineProperty,vde=(i,e,t)=>e in i?mde(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Yr=(i,e,t)=>vde(i,typeof e!="symbol"?e+"":e,t);const Ode=Ze({name:`${C}-divider`,setup(){return()=>R("div",{class:`${C}-divider`},null)}}),yde={noPrettier:{type:Boolean},toolbars:{type:Array,default:()=>[]},toolbarsExclude:{type:Array,default:()=>[]},setting:{type:Object,default:()=>({})},screenfull:{type:Object,default:null},screenfullJs:{type:String,default:""},updateSetting:{type:Function,default:()=>{}},tableShape:{type:Array,default:()=>[6,4]},defToolbars:{type:Object},noUploadImg:{type:Boolean},showToolbarName:{type:Boolean},catalogVisible:{type:Boolean},codeTheme:{type:String}},bde=i=>{const e=xe("editorId"),{editorExtensions:t,editorExtensionsAttrs:n}=Ct;let r=t.screenfull.instance;const s=ce(!1),o=u=>{if(!r){Y.emit(e,_o,{name:"fullscreen",message:"fullscreen is undefined"});return}r.isEnabled?(s.value=!0,(u===void 0?!r.isFullscreen:u)?r.request():r.exit()):console.error("browser does not support screenfull!")},a=()=>{r&&r.isEnabled&&r.on("change",()=>{(s.value||i.setting.fullscreen)&&(s.value=!1,i.updateSetting("fullscreen"))})},l=()=>{r=window.screenfull,a()};return ft(()=>{var u;a(),r||sn("script",{...(u=n.screenfull)==null?void 0:u.js,src:t.screenfull.js,id:on.screenfull,onload:l},"screenfull")}),ft(()=>{Y.on(e,{name:ZL,callback:o})}),{fullscreenHandler:o}},xde={tableShape:{type:Array,default:()=>[6,4]},onSelected:{type:Function,default:()=>{}}},Sde=Ze({name:"TableShape",props:xde,setup(i){const e=di({x:-1,y:-1}),t=De(()=>JSON.stringify(i.tableShape)),n=()=>{const s=[...JSON.parse(t.value)];return(!s[2]||s[2]<s[0])&&(s[2]=s[0]),(!s[3]||s[3]<s[3])&&(s[3]=s[1]),s},r=ce(n());return pe([t],()=>{r.value=n()}),()=>R("div",{class:`${C}-table-shape`,onMouseleave:()=>{r.value=n(),e.x=-1,e.y=-1}},[new Array(r.value[1]).fill("").map((s,o)=>R("div",{class:`${C}-table-shape-row`,key:`table-shape-row-${o}`},[new Array(r.value[0]).fill("").map((a,l)=>R("div",{class:`${C}-table-shape-col`,key:`table-shape-col-${l}`,onMouseenter:()=>{e.x=o,e.y=l,l+1===r.value[0]&&l+1<r.value[2]?r.value[0]++:l+2<r.value[0]&&r.value[0]>i.tableShape[0]&&r.value[0]--,o+1===r.value[1]&&o+1<r.value[3]?r.value[1]++:o+2<r.value[1]&&r.value[1]>i.tableShape[1]&&r.value[1]--},onClick:()=>{i.onSelected(e)}},[R("div",{class:[`${C}-table-shape-col-default`,o<=e.x&&l<=e.y&&`${C}-table-shape-col-include`]},null)]))]))])}}),kde={type:{type:String,default:"link"},visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},Tde=Ze({name:`${C}-modal-link`,props:kde,setup(i){const e=xe("usedLanguageText"),t=xe("editorId"),n=De(()=>{var s,o;switch(i.type){case"link":return(s=e.value.linkModalTips)==null?void 0:s.linkTitle;case"image":return(o=e.value.linkModalTips)==null?void 0:o.imageTitle;default:return""}}),r=di({desc:"",url:""});return pe(()=>i.visible,s=>{s||setTimeout(()=>{r.desc="",r.url=""},200)}),()=>R(ya,{title:n.value,visible:i.visible,onClose:i.onCancel},{default:()=>{var s,o,a,l,u;return[R("div",{class:`${C}-form-item`},[R("label",{class:`${C}-label`,for:`link-desc-${t}`},[(s=e.value.linkModalTips)==null?void 0:s.descLabel]),R("input",{placeholder:(o=e.value.linkModalTips)==null?void 0:o.descLabelPlaceHolder,class:`${C}-input`,id:`link-desc-${t}`,type:"text",value:r.desc,onChange:c=>{r.desc=c.target.value},autocomplete:"off"},null)]),R("div",{class:`${C}-form-item`},[R("label",{class:`${C}-label`,for:`link-url-${t}`},[(a=e.value.linkModalTips)==null?void 0:a.urlLabel]),R("input",{placeholder:(l=e.value.linkModalTips)==null?void 0:l.urlLabelPlaceHolder,class:`${C}-input`,id:`link-url-${t}`,type:"text",value:r.url,onChange:c=>{r.url=c.target.value},autocomplete:"off"},null)]),R("div",{class:`${C}-form-item`},[R("button",{class:[`${C}-btn`,`${C}-btn-row`],type:"button",onClick:()=>{i.onOk(r),r.desc="",r.url=""}},[(u=e.value.linkModalTips)==null?void 0:u.buttonOK])])]}})}}),Ede={visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},wde=Ze({name:`${C}-modal-clip`,props:Ede,setup(i){const e=xe("usedLanguageText"),t=xe("editorId"),n=xe("rootRef");let r=Ct.editorExtensions.cropper.instance;const s=ce(),o=ce(),a=ce(),l=di({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});let u=null;pe(()=>i.visible,()=>{i.visible&&!l.cropperInited&&(r=r||window.Cropper,s.value.onchange=()=>{if(!r){Y.emit(t,_o,{name:"Cropper",message:"Cropper is undefined"});return}const h=s.value.files||[];if(l.imgSelected=!0,(h==null?void 0:h.length)>0){const f=new FileReader;f.onload=d=>{l.imgSrc=d.target.result},f.readAsDataURL(h[0])}})}),pe(()=>[l.imgSelected],()=>{a.value.style=""}),pe([Nn(()=>l.isFullscreen),Nn(()=>l.imgSrc)],()=>{l.imgSrc&&wi(()=>{u==null||u.destroy(),a.value.style="",o.value&&(u=new r(o.value,{viewMode:2,preview:n.value.getRootNode().querySelector(`.${C}-clip-preview-target`)}))})});const c=()=>{u.clear(),u.destroy(),u=null,s.value.value="",l.imgSelected=!1};return()=>{var h;return R(ya,{class:`${C}-modal-clip`,title:(h=e.value.clipModalTips)==null?void 0:h.title,visible:i.visible,onClose:i.onCancel,showAdjust:!0,isFullscreen:l.isFullscreen,onAdjust:f=>{l.isFullscreen=f},width:"668px",height:"421px"},{default:()=>{var f,d,p;return[R("div",{class:`${C}-form-item ${C}-clip`},[R("div",{class:`${C}-clip-main`},[l.imgSelected?R("div",{class:`${C}-clip-cropper`},[R("img",{src:l.imgSrc,ref:o,style:{display:"none"},alt:""},null),R("div",{class:`${C}-clip-delete`,onClick:c},[R(Me,{name:"delete"},null)])]):R("div",{class:`${C}-clip-upload`,onClick:()=>{s.value.click()},role:"button",tabindex:"0","aria-label":(f=e.value.imgTitleItem)==null?void 0:f.upload},[R(Me,{name:"upload"},null)])]),R("div",{class:`${C}-clip-preview`},[R("div",{class:`${C}-clip-preview-target`,ref:a},null)])]),R("div",{class:`${C}-form-item`},[R("button",{class:`${C}-btn`,type:"button",onClick:()=>{if(u){const g=u.getCroppedCanvas();Y.emit(t,_p,[gne(g.toDataURL("image/png"))],i.onOk),c()}}},[((d=e.value.clipModalTips)==null?void 0:d.buttonUpload)||((p=e.value.linkModalTips)==null?void 0:p.buttonOK)])]),R("input",{ref:s,accept:"image/*",type:"file",multiple:!1,style:{display:"none"},"aria-hidden":"true"},null)]}})}}}),_de={type:{type:String,default:"link"},linkVisible:{type:Boolean,default:!1},clipVisible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},Cde=Ze({name:`${C}-modals`,props:_de,setup(i){return()=>R(bo,null,[R(Tde,{type:i.type,visible:i.linkVisible,onOk:i.onOk,onCancel:i.onCancel},null),R(wde,{visible:i.clipVisible,onOk:i.onOk,onCancel:i.onCancel},null)])}}),Ade=Ze({name:"MDEditorToolbar",props:yde,setup(i){const e=xe("editorId"),t=xe("usedLanguageText"),n=xe("theme"),r=xe("previewTheme"),s=xe("language"),o=xe("disabled"),{fullscreenHandler:a}=bde(i),l=`${e}-toolbar-wrapper`,u=ce(),c=di({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),h=(O,y)=>{if(o!=null&&o.value)return!1;Y.emit(e,Ye,O,y)},f=di({type:"link",linkVisible:!1,clipVisible:!1}),d=ce();ft(()=>{Y.on(e,{name:Dv,callback(O){f.type=O,f.linkVisible=!0}})});const p=De(()=>{const O=i.toolbars.filter(E=>!i.toolbarsExclude.includes(E)),y=O.indexOf("="),x=y===-1?O:O.slice(0,y+1),b=y===-1?[]:O.slice(y,Number.MAX_SAFE_INTEGER);return[x,b]}),g=ce(),m=()=>{Y.emit(e,_p,Array.from(g.value.files||[])),g.value.value=""};ft(()=>{g.value.addEventListener("change",m)});const v=O=>{var y,x,b,E,T,_,D,A,I,L,$,B,Z,j,ie,ne,z,W,he,se,oe,Se,$e,Ke,kt,Ai,jr,Lc,Ao,Po,Ic,Dc,Ro,$c,Mc,bl,Nb,Qb,Bb,Ub,Vb,Zb,jb,Gb,Hb,Xb,zb,Wb,qb,Yb,Kb,Jb,ex,tx,ix,nx,rx,sx,ox,ax,lx,ux,cx,hx,fx,dx,px,gx,mx,vx,Ox,yx,bx,xx,Sx,kx,Tx,Ex,wx,_x,Cx;if(UL.includes(O))switch(O){case"-":return R(Ode,null,null);case"bold":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(y=t.value.toolbarTips)==null?void 0:y.bold,onClick:()=>{h("bold")}},[R(Me,{name:"bold"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(x=t.value.toolbarTips)==null?void 0:x.bold])]);case"underline":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(b=t.value.toolbarTips)==null?void 0:b.underline,onClick:()=>{h("underline")}},[R(Me,{name:"underline"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(E=t.value.toolbarTips)==null?void 0:E.underline])]);case"italic":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(T=t.value.toolbarTips)==null?void 0:T.italic,onClick:()=>{h("italic")}},[R(Me,{name:"italic"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(_=t.value.toolbarTips)==null?void 0:_.italic])]);case"strikeThrough":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(D=t.value.toolbarTips)==null?void 0:D.strikeThrough,onClick:()=>{h("strikeThrough")}},[R(Me,{name:"strike-through"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(A=t.value.toolbarTips)==null?void 0:A.strikeThrough])]);case"title":return R(ia,{relative:`#${l}`,visible:c.title,onChange:we=>{c.title=we},disabled:o==null?void 0:o.value,overlay:R("ul",{class:`${C}-menu`,onClick:()=>{c.title=!1},role:"menu"},[R("li",{class:`${C}-menu-item ${C}-menu-item-title`,onClick:()=>{h("h1")},role:"menuitem",tabindex:"0"},[(I=t.value.titleItem)==null?void 0:I.h1]),R("li",{class:`${C}-menu-item ${C}-menu-item-title`,onClick:()=>{h("h2")},role:"menuitem",tabindex:"0"},[(L=t.value.titleItem)==null?void 0:L.h2]),R("li",{class:`${C}-menu-item ${C}-menu-item-title`,onClick:()=>{h("h3")},role:"menuitem",tabindex:"0"},[($=t.value.titleItem)==null?void 0:$.h3]),R("li",{class:`${C}-menu-item ${C}-menu-item-title`,onClick:()=>{h("h4")},role:"menuitem",tabindex:"0"},[(B=t.value.titleItem)==null?void 0:B.h4]),R("li",{class:`${C}-menu-item ${C}-menu-item-title`,onClick:()=>{h("h5")},role:"menuitem",tabindex:"0"},[(Z=t.value.titleItem)==null?void 0:Z.h5]),R("li",{class:`${C}-menu-item ${C}-menu-item-title`,onClick:()=>{h("h6")},role:"menuitem",tabindex:"0"},[(j=t.value.titleItem)==null?void 0:j.h6])])},{default:()=>{var we,Jt;return[R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(we=t.value.toolbarTips)==null?void 0:we.title},[R(Me,{name:"title"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Jt=t.value.toolbarTips)==null?void 0:Jt.title])])]}});case"sub":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(ie=t.value.toolbarTips)==null?void 0:ie.sub,onClick:()=>{h("sub")}},[R(Me,{name:"sub"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(ne=t.value.toolbarTips)==null?void 0:ne.sub])]);case"sup":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(z=t.value.toolbarTips)==null?void 0:z.sup,onClick:()=>{h("sup")}},[R(Me,{name:"sup"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(W=t.value.toolbarTips)==null?void 0:W.sup])]);case"quote":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(he=t.value.toolbarTips)==null?void 0:he.quote,onClick:()=>{h("quote")}},[R(Me,{name:"quote"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(se=t.value.toolbarTips)==null?void 0:se.quote])]);case"unorderedList":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(oe=t.value.toolbarTips)==null?void 0:oe.unorderedList,onClick:()=>{h("unorderedList")}},[R(Me,{name:"unordered-list"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Se=t.value.toolbarTips)==null?void 0:Se.unorderedList])]);case"orderedList":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:($e=t.value.toolbarTips)==null?void 0:$e.orderedList,onClick:()=>{h("orderedList")}},[R(Me,{name:"ordered-list"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Ke=t.value.toolbarTips)==null?void 0:Ke.orderedList])]);case"task":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(kt=t.value.toolbarTips)==null?void 0:kt.task,onClick:()=>{h("task")}},[R(Me,{name:"task"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Ai=t.value.toolbarTips)==null?void 0:Ai.task])]);case"codeRow":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(jr=t.value.toolbarTips)==null?void 0:jr.codeRow,onClick:()=>{h("codeRow")}},[R(Me,{name:"code-row"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Lc=t.value.toolbarTips)==null?void 0:Lc.codeRow])]);case"code":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Ao=t.value.toolbarTips)==null?void 0:Ao.code,onClick:()=>{h("code")}},[R(Me,{name:"code"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Po=t.value.toolbarTips)==null?void 0:Po.code])]);case"link":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Ic=t.value.toolbarTips)==null?void 0:Ic.link,onClick:()=>{if(o!=null&&o.value)return!1;f.type="link",f.linkVisible=!0}},[R(Me,{name:"link"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Dc=t.value.toolbarTips)==null?void 0:Dc.link])]);case"image":return i.noUploadImg?R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Ro=t.value.toolbarTips)==null?void 0:Ro.image,onClick:()=>{if(o!=null&&o.value)return!1;f.type="image",f.linkVisible=!0}},[R(Me,{name:"image"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[($c=t.value.toolbarTips)==null?void 0:$c.image])]):R(ia,{relative:`#${l}`,visible:c.image,onChange:we=>{c.image=we},disabled:o==null?void 0:o.value,overlay:R("ul",{class:`${C}-menu`,onClick:()=>{c.title=!1},role:"menu"},[R("li",{class:`${C}-menu-item ${C}-menu-item-image`,onClick:()=>{f.type="image",f.linkVisible=!0},role:"menuitem",tabindex:"0"},[(Mc=t.value.imgTitleItem)==null?void 0:Mc.link]),R("li",{class:`${C}-menu-item ${C}-menu-item-image`,onClick:()=>{g.value.click()},role:"menuitem",tabindex:"0"},[(bl=t.value.imgTitleItem)==null?void 0:bl.upload]),R("li",{class:`${C}-menu-item ${C}-menu-item-image`,onClick:()=>{f.clipVisible=!0},role:"menuitem",tabindex:"0"},[(Nb=t.value.imgTitleItem)==null?void 0:Nb.clip2upload])])},{default:()=>{var we,Jt;return[R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(we=t.value.toolbarTips)==null?void 0:we.image},[R(Me,{name:"image"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Jt=t.value.toolbarTips)==null?void 0:Jt.image])])]}});case"table":return R(ia,{relative:`#${l}`,visible:c.table,onChange:we=>{c.table=we},disabled:o==null?void 0:o.value,key:"bar-table",overlay:R(Sde,{tableShape:i.tableShape,onSelected:we=>{h("table",{selectedShape:we})}},null)},{default:()=>{var we,Jt;return[R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(we=t.value.toolbarTips)==null?void 0:we.table},[R(Me,{name:"table"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Jt=t.value.toolbarTips)==null?void 0:Jt.table])])]}});case"revoke":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Qb=t.value.toolbarTips)==null?void 0:Qb.revoke,onClick:()=>{if(o!=null&&o.value)return!1;Y.emit(e,jL)}},[R(Me,{name:"revoke"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Bb=t.value.toolbarTips)==null?void 0:Bb.revoke])]);case"next":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Ub=t.value.toolbarTips)==null?void 0:Ub.next,onClick:()=>{if(o!=null&&o.value)return!1;Y.emit(e,GL)}},[R(Me,{name:"next"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Vb=t.value.toolbarTips)==null?void 0:Vb.next])]);case"save":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Zb=t.value.toolbarTips)==null?void 0:Zb.save,onClick:()=>{if(o!=null&&o.value)return!1;Y.emit(e,wp)}},[R(Me,{name:"save"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(jb=t.value.toolbarTips)==null?void 0:jb.save])]);case"prettier":return i.noPrettier?"":R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Gb=t.value.toolbarTips)==null?void 0:Gb.prettier,onClick:()=>{h("prettier")}},[R(Me,{name:"prettier"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Hb=t.value.toolbarTips)==null?void 0:Hb.prettier])]);case"pageFullscreen":return!i.setting.fullscreen&&R("div",{class:[`${C}-toolbar-item`,i.setting.pageFullscreen&&`${C}-toolbar-active`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Xb=t.value.toolbarTips)==null?void 0:Xb.pageFullscreen,onClick:()=>{if(o!=null&&o.value)return!1;i.updateSetting("pageFullscreen")}},[R(Me,{name:i.setting.pageFullscreen?"minimize":"maximize"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(zb=t.value.toolbarTips)==null?void 0:zb.pageFullscreen])]);case"fullscreen":return R("div",{class:[`${C}-toolbar-item`,i.setting.fullscreen&&`${C}-toolbar-active`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Wb=t.value.toolbarTips)==null?void 0:Wb.fullscreen,onClick:()=>{if(o!=null&&o.value)return!1;a()}},[R(Me,{name:i.setting.fullscreen?"fullscreen-exit":"fullscreen"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(qb=t.value.toolbarTips)==null?void 0:qb.fullscreen])]);case"preview":return R("div",{class:[`${C}-toolbar-item`,i.setting.preview&&`${C}-toolbar-active`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Yb=t.value.toolbarTips)==null?void 0:Yb.preview,onClick:()=>{if(o!=null&&o.value)return!1;i.updateSetting("preview")}},[R(Me,{name:"preview"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Kb=t.value.toolbarTips)==null?void 0:Kb.preview])]);case"previewOnly":return R("div",{class:[`${C}-toolbar-item`,i.setting.previewOnly&&`${C}-toolbar-active`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(Jb=t.value.toolbarTips)==null?void 0:Jb.previewOnly,onClick:()=>{if(o!=null&&o.value)return!1;i.updateSetting("previewOnly")}},[R(Me,{name:"preview-only"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(ex=t.value.toolbarTips)==null?void 0:ex.previewOnly])]);case"htmlPreview":return R("div",{class:[`${C}-toolbar-item`,i.setting.htmlPreview&&`${C}-toolbar-active`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(tx=t.value.toolbarTips)==null?void 0:tx.htmlPreview,onClick:()=>{if(o!=null&&o.value)return!1;i.updateSetting("htmlPreview")}},[R(Me,{name:"preview-html"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(ix=t.value.toolbarTips)==null?void 0:ix.htmlPreview])]);case"catalog":return R("div",{class:[`${C}-toolbar-item`,i.catalogVisible&&`${C}-toolbar-active`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(nx=t.value.toolbarTips)==null?void 0:nx.catalog,onClick:()=>{if(o!=null&&o.value)return!1;Y.emit(e,_1)},key:"bar-catalog"},[R(Me,{name:"catalog"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(rx=t.value.toolbarTips)==null?void 0:rx.catalog])]);case"github":return R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(sx=t.value.toolbarTips)==null?void 0:sx.github,onClick:()=>{if(o!=null&&o.value)return!1;XJ("https://github.com/imzbf/md-editor-v3")}},[R(Me,{name:"github"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(ox=t.value.toolbarTips)==null?void 0:ox.github])]);case"mermaid":return R(ia,{relative:`#${l}`,visible:c.mermaid,onChange:we=>{c.mermaid=we},disabled:o==null?void 0:o.value,overlay:R("ul",{class:`${C}-menu`,onClick:()=>{c.mermaid=!1},role:"menu"},[R("li",{class:`${C}-menu-item ${C}-menu-item-mermaid`,onClick:()=>{h("flow")},role:"menuitem",tabindex:"0"},[(ax=t.value.mermaid)==null?void 0:ax.flow]),R("li",{class:`${C}-menu-item ${C}-menu-item-mermaid`,onClick:()=>{h("sequence")},role:"menuitem",tabindex:"0"},[(lx=t.value.mermaid)==null?void 0:lx.sequence]),R("li",{class:`${C}-menu-item ${C}-menu-item-mermaid`,onClick:()=>{h("gantt")},role:"menuitem",tabindex:"0"},[(ux=t.value.mermaid)==null?void 0:ux.gantt]),R("li",{class:`${C}-menu-item ${C}-menu-item-mermaid`,onClick:()=>{h("class")},role:"menuitem",tabindex:"0"},[(cx=t.value.mermaid)==null?void 0:cx.class]),R("li",{class:`${C}-menu-item ${C}-menu-item-mermaid`,onClick:()=>{h("state")},role:"menuitem",tabindex:"0"},[(hx=t.value.mermaid)==null?void 0:hx.state]),R("li",{class:`${C}-menu-item ${C}-menu-item-mermaid`,onClick:()=>{h("pie")},role:"menuitem",tabindex:"0"},[(fx=t.value.mermaid)==null?void 0:fx.pie]),R("li",{class:`${C}-menu-item ${C}-menu-item-mermaid`,onClick:()=>{h("relationship")},role:"menuitem",tabindex:"0"},[(dx=t.value.mermaid)==null?void 0:dx.relationship]),R("li",{class:`${C}-menu-item ${C}-menu-item-mermaid`,onClick:()=>{h("journey")},role:"menuitem",tabindex:"0"},[(px=t.value.mermaid)==null?void 0:px.journey])]),key:"bar-mermaid"},{default:()=>{var we,Jt;return[R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(we=t.value.toolbarTips)==null?void 0:we.mermaid},[R(Me,{name:"mermaid"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Jt=t.value.toolbarTips)==null?void 0:Jt.mermaid])])]}});case"katex":return R(ia,{relative:`#${l}`,visible:c.katex,onChange:we=>{c.katex=we},disabled:o==null?void 0:o.value,overlay:R("ul",{class:`${C}-menu`,onClick:()=>{c.katex=!1},role:"menu"},[R("li",{class:`${C}-menu-item ${C}-menu-item-katex`,onClick:()=>{h("katexInline")},role:"menuitem",tabindex:"0"},[(gx=t.value.katex)==null?void 0:gx.inline]),R("li",{class:`${C}-menu-item ${C}-menu-item-katex`,onClick:()=>{h("katexBlock")},role:"menuitem",tabindex:"0"},[(mx=t.value.katex)==null?void 0:mx.block])]),key:"bar-katex"},{default:()=>{var we,Jt;return[R("div",{class:[`${C}-toolbar-item`,(o==null?void 0:o.value)&&`${C}-disabled`],title:(we=t.value.toolbarTips)==null?void 0:we.katex},[R(Me,{name:"formula"},null),i.showToolbarName&&R("div",{class:`${C}-toolbar-item-name`},[(Jt=t.value.toolbarTips)==null?void 0:Jt.katex])])]}})}else if(i.defToolbars instanceof Array){const we=i.defToolbars[O];return we?xu(we,{theme:((vx=we.props)==null?void 0:vx.theme)||n.value,previewTheme:((Ox=we.props)==null?void 0:Ox.theme)||r.value,language:((yx=we.props)==null?void 0:yx.theme)||s.value,codeTheme:((bx=we.props)==null?void 0:bx.codeTheme)||i.codeTheme,disabled:((xx=we.props)==null?void 0:xx.disabled)||(o==null?void 0:o.value),showToolbarName:((Sx=we.props)==null?void 0:Sx.showToolbarName)||i.showToolbarName,insert(jp){Y.emit(e,Ye,"universal",{generate:jp})}}):""}else if(i.defToolbars&&i.defToolbars.children instanceof Array){const we=i.defToolbars.children[O];return we?xu(we,{theme:((kx=we.props)==null?void 0:kx.theme)||n.value,previewTheme:((Tx=we.props)==null?void 0:Tx.theme)||r.value,language:((Ex=we.props)==null?void 0:Ex.theme)||s.value,codeTheme:((wx=we.props)==null?void 0:wx.codeTheme)||i.codeTheme,disabled:((_x=we.props)==null?void 0:_x.disabled)||(o==null?void 0:o.value),showToolbarName:((Cx=we.props)==null?void 0:Cx.showToolbarName)||i.showToolbarName,insert(jp){Y.emit(e,Ye,"universal",{generate:jp})}}):""}else return""};return pe(()=>i.toolbars,()=>{wi(()=>{u.value&&WJ(u.value)})},{immediate:!0}),()=>{var O;const y=p.value[0].map(b=>v(b)),x=p.value[1].map(b=>v(b));return R(bo,null,[i.toolbars.length>0&&R("div",{class:`${C}-toolbar-wrapper`,ref:u,id:l},[R("div",{class:[`${C}-toolbar`,i.showToolbarName&&`${C}-stn`]},[R("div",{class:`${C}-toolbar-left`,ref:d},[y]),R("div",{class:`${C}-toolbar-right`},[x])])]),R("label",{for:`${l}_label`,style:{display:"none"},"aria-label":(O=t.value.imgTitleItem)==null?void 0:O.upload},null),R("input",{id:`${l}_label`,ref:g,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}},null),R(Cde,{linkVisible:f.linkVisible,clipVisible:f.clipVisible,type:f.type,onCancel:()=>{f.linkVisible=!1,f.clipVisible=!1},onOk:b=>{b&&h(f.type,{desc:b.desc,url:b.url,transform:f.type==="image"}),f.linkVisible=!1,f.clipVisible=!1}},null)])}}}),Pde=(i,e,t)=>{const n=xe("editorId");let r=()=>{},s=()=>{};const o=()=>{var a;r();const l=(a=t.value)==null?void 0:a.view.contentDOM.getRootNode(),u=l.querySelector(`#${n} .cm-scroller`),c=l.querySelector(`[id="${n}-preview-wrapper"]`),h=l.querySelector(`[id="${n}-html-wrapper"]`);(c||h)&&([s,r]=(c?Wre:zre)(u,c||h,t.value),i.scrollAuto&&s())};pe([e,Nn(i.setting,"preview"),Nn(i.setting,"htmlPreview"),Nn(i.setting,"fullscreen"),Nn(i.setting,"pageFullscreen")],()=>{wi(o)}),pe(()=>i.scrollAuto,a=>{a?s():r()}),pe(()=>i.setting.previewOnly,a=>{a?r():s()}),ft(o)},Cm=async(i,e,t)=>{if(/^h[1-6]$/.test(i))return Rde(i,e);if(i==="prettier")return await Lde(e,t);switch(i){case"bold":case"underline":case"italic":case"strikeThrough":case"sub":case"sup":case"codeRow":case"katexInline":case"katexBlock":return Dde(i,e);case"quote":case"orderedList":case"unorderedList":case"task":return Mde(i,e);case"code":return Fde(t,e);case"table":return Bde(t);case"link":return{text:`[${t.desc}](${t.url})`,options:{select:!1}};case"image":return Qde(t);case"flow":case"sequence":case"gantt":case"class":case"state":case"pie":case"relationship":case"journey":return Nde(i);case"universal":return Ude(e.getSelectedText(),t);default:return{text:"",options:{}}}},Rde=(i,e)=>{const t=i.slice(1),n="#".repeat(Number(t)),[r,s,o]=Db(e,{wholeLine:!0});return{text:`${n} ${r}`,options:{deviationStart:n.length+1,replaceStart:s,replaceEnd:o}}},Lde=async(i,e)=>{var t,n,r;const s=window.prettier||((t=Ct.editorExtensions.prettier)==null?void 0:t.prettierInstance),o=[((n=window.prettierPlugins)==null?void 0:n.markdown)||((r=Ct.editorExtensions.prettier)==null?void 0:r.parserMarkdownInstance)];return!s||!o[0]?(Y.emit(e.editorId,_o,{name:"prettier",message:"prettier is undefined"}),{text:i.getValue(),options:{select:!1,replaceAll:!0}}):{text:await s.format(i.getValue(),{parser:"markdown",plugins:o}),options:{select:!1,replaceAll:!0}}},Ide={bold:["**","**",2,-2],underline:["<u>","</u>",3,-4],italic:["*","*",1,-1],strikeThrough:["~~","~~",2,-2],sub:["~","~",1,-1],sup:["^","^",1,-1],codeRow:["`","`",1,-1],katexInline:["$","$",1,-1],katexBlock:[`
$$
`,`
$$
`,4,-4]},Dde=(i,e)=>{const t=e.getSelectedText(),[n,r,s,o]=Ide[i];return{text:`${n}${t}${r}`,options:{deviationStart:s,deviationEnd:o}}},$de={quote:"> ",unorderedList:"- ",orderedList:1,task:"- [ ] "},Mde=(i,e)=>{const[t,n,r]=Db(e,{wholeLine:!0}),s=t.split(`
`),o=$de[i],a=i==="orderedList"?s.map((c,h)=>`${o+h}. ${c}`):s.map(c=>`${o}${c}`),l=i==="orderedList"?"1. ":o.toString(),u=s.length===1?l.length:0;return{text:a.join(`
`),options:{deviationStart:u,replaceStart:n,replaceEnd:r}}},Fde=(i,e)=>{const[t,n,r]=Db(e),s=i.mode||"language",o=`
\`\`\`${s}
${i.text||t||""}
\`\`\`
`;return{text:o,options:{deviationStart:4,deviationEnd:4+s.length-o.length,replaceStart:n,replaceEnd:r}}},Nde=i=>({text:`
\`\`\`mermaid
${{flow:`flowchart TD 
  Start --> Stop`,sequence:`sequenceDiagram
  A->>B: hello!
  B-->>A: hi!`,gantt:`gantt
title Gantt Chart
dateFormat  YYYY-MM-DD`,class:`classDiagram
  class Animal`,state:`stateDiagram-v2
  s1 --> s2`,pie:`pie
  "Dogs" : 386
  "Cats" : 85
  "Rats" : 15`,relationship:`erDiagram
  CAR ||--o{ NAMED-DRIVER : allows`,journey:`journey
  title My Journey`,...Ct.editorConfig.mermaidTemplate}[i]}
\`\`\`
`,options:{deviationStart:12,deviationEnd:-5}}),Qde=i=>{const{desc:e,url:t,urls:n}=i;let r="";return n instanceof Array?r=n.reduce((s,o)=>{const{url:a="",alt:l="",title:u=""}=typeof o=="object"?o:{url:o};return s+`![${l}](${a}${u?" '"+u+"'":""})
`},""):r=`![${e}](${t})
`,{text:r,options:{select:!1}}},Bde=i=>{const{selectedShape:e={x:1,y:1}}=i,{x:t,y:n}=e;let r=`
| Column`;for(let s=0;s<=n;s++)r+=" |";r+=`
|`;for(let s=0;s<=n;s++)r+=" - |";for(let s=0;s<=t;s++){r+=`
|`;for(let o=0;o<=n;o++)r+=" |"}return r+=`
`,{text:r,options:{deviationStart:3,deviationEnd:10-r.length}}},Ude=(i,e)=>{const{generate:t}=e,n=t(i);return{text:n.targetValue,options:{select:n.select??!0,deviationStart:n.deviationStart||0,deviationEnd:n.deviationEnd||0}}},Db=(i,e={wholeLine:!1})=>{const t=i.view.state,n=t.selection.main;if(n.empty){const r=t.doc.lineAt(n.from);return[t.doc.lineAt(n.from).text,r.from,r.to]}else if(e.wholeLine){const r=t.doc.lineAt(n.from),s=t.doc.lineAt(n.to);return[t.doc.sliceString(r.from,s.to),r.from,s.to]}return[t.doc.sliceString(n.from,n.to),n.from,n.to]},Vde="#e5c07b",f2="var(--md-color)",Zde="#56b6c2",jde="#ffffff",iu="var(--md-color)",d2="#e5c07b",Gde="#e5c07b",Hde="var(--md-color)",p2="#d19a66",Xde="#c678dd",zde="#21252b",Wde="#2c313a",g2="var(--md-bk-color)",Am="var(--md-bk-color)",qde="#ceedfa33",m2="#528bff",Yde=le.theme({"&":{color:iu,backgroundColor:g2},".cm-content":{caretColor:m2},".cm-cursor, .cm-dropCursor":{borderLeftColor:m2},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:qde},".cm-panels":{backgroundColor:zde,color:iu},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:g2,color:iu,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Wde},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Am},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Am,borderBottomColor:Am},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:iu}}},{dark:!0}),Kde=ml.define([{tag:w.keyword,color:Xde},{tag:[w.name,w.deleted,w.character,w.propertyName,w.macroName],color:f2},{tag:[w.function(w.variableName),w.labelName],color:Gde},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:p2},{tag:[w.definition(w.name),w.separator],color:iu},{tag:[w.typeName,w.className,w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:Vde},{tag:[w.operator,w.operatorKeyword,w.url,w.escape,w.regexp,w.link,w.special(w.string)],color:Zde},{tag:[w.meta,w.comment],color:d2},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.link,color:d2,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:f2},{tag:[w.atom,w.bool,w.special(w.variableName)],color:p2},{tag:[w.processingInstruction,w.string,w.inserted],color:Hde},{tag:w.invalid,color:jde}]),v2=[Yde,v$(Kde)],Jde="#e5c07b",O2="var(--md-color)",epe="#56b6c2",tpe="#fff",nu="#3f4a54",y2="#2d8cf0",ipe="#2d8cf0",npe="#3f4a54",b2="#d19a66",rpe="#c678dd",spe="#f6f6f6",ope="#ceedfa33",x2="var(--md-bk-color)",Pm="var(--md-bk-color)",ape="#bad5fa",S2="#3f4a54",lpe=le.theme({"&":{color:nu,backgroundColor:x2},".cm-content":{caretColor:S2},".cm-cursor, .cm-dropCursor":{borderLeftColor:S2},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:ape},".cm-panels":{backgroundColor:spe,color:nu},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:x2,color:nu,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:ope},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Pm},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Pm,borderBottomColor:Pm},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:nu}}}),upe=ml.define([{tag:w.keyword,color:rpe},{tag:[w.name,w.deleted,w.character,w.propertyName,w.macroName],color:O2},{tag:[w.function(w.variableName),w.labelName],color:ipe},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:b2},{tag:[w.definition(w.name),w.separator],color:nu},{tag:[w.typeName,w.className,w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:Jde},{tag:[w.operator,w.operatorKeyword,w.url,w.escape,w.regexp,w.link,w.special(w.string)],color:epe},{tag:[w.meta,w.comment],color:y2},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.link,color:y2,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:O2},{tag:[w.atom,w.bool,w.special(w.variableName)],color:b2},{tag:[w.processingInstruction,w.string,w.inserted],color:npe},{tag:w.invalid,color:tpe}]),k2=[lpe,v$(upe)],Yh=(i,e,t,n,r)=>(s,o,a,l)=>{const u=`${i}${e}`.slice(l-a);s.dispatch(s.state.replaceSelection(`${u}${t}${n}`));const c=a+o.label.length+(r==="title"?t.length:0);s.dispatch({selection:G.create([G.range(a+o.label.length+(r==="title"?1:-e.length),c),G.cursor(c)],1)}),s.focus()},T2=i=>(e,t,n,r)=>{const s=i.slice(r-n);e.dispatch(e.state.replaceSelection(`${s} `))},E2=i=>{const e=t=>{const n=t.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|\$\$?|!+\s*\w*/);return n===null||n.from==n.to&&t.explicit?null:{from:n.from,options:[...["h2","h3","h4","h5","h6"].map((r,s)=>{const o=new Array(s+2).fill("#").join("");return{label:o,type:"text",apply:T2(o)}}),...["unchecked","checked"].map(r=>{const s=r==="checked"?"- [x]":"- [ ]";return{label:s,type:"text",apply:T2(s)}}),...[["`",""],["```","language"],["```mermaid\n",""]].map(r=>({label:`${r[0]}${r[1]}`,type:"text",apply:Yh(r[0],r[1],"",r[0]==="`"?"`":"\n```","type")})),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:`| col | col | col |
| - | - | - |
| content | content | content |
| content | content | content |`},{label:"$",type:"text",apply:Yh("$","","","$","type")},{label:"$$",type:"text",apply:Yh("$$","",`
`,`
$$`,"title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map(r=>({label:`!!! ${r}`,type:"text",apply:Yh("!!!",` ${r}`," Title",`

!!!`,"title")}))]}};return mce({override:i?[e,...i]:[e]})},Yo=i=>{const e=new sr;return n=>(e.get(i.state)?i.dispatch({effects:e.reconfigure(n)}):i.dispatch({effects:Ve.appendConfig.of(e.of(n))}),!0)};class cpe{constructor(e){Yr(this,"view"),Yr(this,"maxLength",Number.MAX_SAFE_INTEGER),Yr(this,"toggleTabSize"),Yr(this,"togglePlaceholder"),Yr(this,"setExtensions"),Yr(this,"toggleDisabled"),Yr(this,"toggleReadOnly"),Yr(this,"toggleMaxlength"),this.view=e,this.toggleTabSize=Yo(this.view),this.togglePlaceholder=Yo(this.view),this.setExtensions=Yo(this.view),this.toggleDisabled=Yo(this.view),this.toggleReadOnly=Yo(this.view),this.toggleMaxlength=Yo(this.view)}getValue(){return this.view.state.doc.toString()}setValue(e,t=0,n=this.view.state.doc.length){this.view.dispatch({changes:{from:t,to:n,insert:e}})}getSelectedText(){const{from:e,to:t}=this.view.state.selection.main;return this.view.state.sliceDoc(e,t)}replaceSelectedText(e,t,n){const r={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1,replaceStart:-1,replaceEnd:-1,...t};try{if(r.replaceAll){if(this.setValue(e),e.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+e.length>this.maxLength)throw new Error("The input text is too long");const{from:s}=this.view.state.selection.main;r.replaceStart!==-1?this.view.dispatch({changes:{from:r.replaceStart,to:r.replaceEnd,insert:e}}):this.view.dispatch(this.view.state.replaceSelection(e)),r.select&&this.view.dispatch({selection:{anchor:r.replaceStart===-1?s+r.deviationStart:r.replaceStart+r.deviationStart,head:r.replaceStart===-1?s+e.length+r.deviationEnd:r.replaceStart+e.length+r.deviationEnd}}),this.view.focus()}catch(s){if(s.message==="The input text is too long")Y.emit(n,_o,{name:"overlength",message:s.message,data:e});else throw s}}setTabSize(e){this.toggleTabSize([Be.tabSize.of(e),pl.of(" ".repeat(e))])}setPlaceholder(e){this.togglePlaceholder(oae(e))}focus(e){if(this.view.focus(),!e)return;let t=0,n=0,r=0;switch(e){case"start":break;case"end":{t=n=r=this.getValue().length;break}default:t=e.rangeAnchor||e.cursorPos,n=e.rangeHead||e.cursorPos,r=e.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:G.create([G.range(t,n),G.cursor(r)],1)})}setDisabled(e){this.toggleDisabled([le.editable.of(!e)])}setReadOnly(e){this.toggleReadOnly([Be.readOnly.of(e)])}setMaxLength(e){this.maxLength=e,this.toggleMaxlength([Be.changeFilter.of(t=>t.newDoc.length<=e)])}}const hpe=(i,e)=>{const t=xe("editorId"),n=s=>{s instanceof Promise?s.then(o=>{Y.emit(t,Ye,"universal",{generate(){return{targetValue:o}}})}).catch(o=>{console.error(o)}):Y.emit(t,Ye,"universal",{generate(){return{targetValue:s}}})};return s=>{var o,a,l;if(!s.clipboardData)return;if(s.clipboardData.files.length>0){const{files:g}=s.clipboardData;Y.emit(t,_p,Array.from(g).filter(m=>/image\/.*/.test(m.type))),s.preventDefault();return}const u=s.clipboardData.getData("text/plain"),c=((o=e.value)==null?void 0:o.view.state.selection.main.to)||0,h=((a=e.value)==null?void 0:a.view.state.doc.lineAt(c).from)||0,f=((l=e.value)==null?void 0:l.view.state.doc.sliceString(h,c))||"",d=/!\[.*\]\(\s*$/.test(f),p=/!\[.*\]\((.*)\s?.*\)/.test(u);if(d){const g=i.transformImgUrl(u);n(g),s.preventDefault();return}else if(p){const g=u.match(new RegExp(`(?<=!\\[.*\\]\\()([^)\\s]+)(?=\\s?["']?.*["']?\\))`,"g"));g?Promise.all(g.map(m=>i.transformImgUrl(m))).then(m=>{n(m.reduce((v,O,y)=>v.replace(g[y],O),u))}):n(u),s.preventDefault();return}if(i.autoDetectCode&&s.clipboardData.types.includes("vscode-editor-data")){const g=JSON.parse(s.clipboardData.getData("vscode-editor-data"));Y.emit(t,Ye,"code",{mode:g.mode,text:s.clipboardData.getData("text/plain")}),s.preventDefault();return}i.maxlength&&u.length+i.modelValue.length>i.maxlength&&Y.emit(t,_o,{name:"overlength",message:"The input text is too long",data:u})}},fpe=(i,e)=>[{key:"Ctrl-b",mac:"Cmd-b",run:()=>(Y.emit(i,Ye,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:J$,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:x=>(Y.emit(i,wp,x.state.doc.toString()),!0),shift:()=>(Y.emit(i,Ye,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",preventDefault:!0,run:()=>(Y.emit(i,Ye,"underline"),!0),shift:()=>(Y.emit(i,Ye,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",preventDefault:!0,run:()=>(Y.emit(i,Ye,"italic"),!0),shift:()=>(Y.emit(i,Dv,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>(Y.emit(i,Ye,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>(Y.emit(i,Ye,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>(Y.emit(i,Ye,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>(Y.emit(i,Ye,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>(Y.emit(i,Ye,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>(Y.emit(i,Ye,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>(Y.emit(i,Ye,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>(Y.emit(i,Ye,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>(Y.emit(i,Ye,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>(Y.emit(i,Ye,"code"),!0),any(x,b){return(b.ctrlKey||b.metaKey)&&b.altKey&&b.code==="KeyC"?(Y.emit(i,Ye,"codeRow"),!0):!1}},{key:"Ctrl-l",mac:"Cmd-l",run:()=>(Y.emit(i,Dv,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>e.noPrettier?!1:(Y.emit(i,Ye,"prettier"),!0)},{any:(x,b)=>(b.ctrlKey||b.metaKey)&&b.altKey&&b.shiftKey&&b.code==="KeyT"?(Y.emit(i,Ye,"table"),!0):!1},...Aue];le.EDIT_CONTEXT=!1;const dpe=i=>{const e=xe("tabWidth"),t=xe("editorId"),n=xe("theme"),r=ce(),s=Qn(),o=ce(!1),a=new sr,l=new sr,u=new sr,c=new sr,h=new sr,f=fpe(t,i),d=()=>[...f,...hue,...xle,fue],g={paste:hpe(i,s),blur:i.onBlur,focus:i.onFocus,drop:i.onDrop,compositionstart:()=>{o.value=!0},compositionend:(O,y)=>{o.value=!1,i.updateModelValue(y.state.doc.toString())},input:O=>{i.onInput&&i.onInput(O);const{data:y}=O;i.maxlength&&i.modelValue.length+y.length>i.maxlength&&Y.emit(t,_o,{name:"overlength",message:"The input text is too long",data:y})}},m=[wc.of(d()),c.of(sC()),a.of(B6({codeLanguages:yce})),le.lineWrapping,le.updateListener.of(O=>{O.docChanged&&(i.onChange(O.state.doc.toString()),o.value||i.updateModelValue(O.state.doc.toString()))}),h.of(le.domEventHandlers(g)),tae()],v=()=>{const O=[...m,l.of(n.value==="light"?k2:v2),u.of(E2(i.completions))];return Ct.codeMirrorExtensions(n.value,O,d(),{editorId:t})};return ft(()=>{const O=new le({doc:i.modelValue,parent:r.value,extensions:[v()]}),y=new cpe(O);s.value=y,setTimeout(()=>{y.setTabSize(e),y.setDisabled(i.disabled),y.setReadOnly(i.readonly),i.placeholder&&y.setPlaceholder(i.placeholder),typeof i.maxlength=="number"&&y.setMaxLength(i.maxlength),i.autofocus&&O.focus()},0),Y.on(t,{name:jL,callback(){ob(O)}}),Y.on(t,{name:GL,callback(){Vd(O)}}),Y.on(t,{name:Ye,async callback(x,b={}){var E,T;if(x==="image"&&b.transform){const _=i.transformImgUrl(b.url);if(_ instanceof Promise)_.then(async D=>{var A;const{text:I,options:L}=await Cm(x,s.value,{...b,url:D});(A=s.value)==null||A.replaceSelectedText(I,L,t)}).catch(D=>{console.error(D)});else{const{text:D,options:A}=await Cm(x,s.value,{...b,url:_});(E=s.value)==null||E.replaceSelectedText(D,A,t)}}else{const{text:_,options:D}=await Cm(x,s.value,b);(T=s.value)==null||T.replaceSelectedText(_,D,t)}}}),Y.on(t,{name:XL,callback:zJ(x=>{var b;const E={...g},T=Object.keys(g);for(const _ in x){const D=_;T.includes(D)?E[D]=(A,I)=>{x[D](A,I),A.defaultPrevented||g[D](A,I)}:E[D]=x[D]}(b=s.value)==null||b.view.dispatch({effects:h.reconfigure(le.domEventHandlers(E))})})}),Y.on(t,{name:zL,callback:(x,b)=>{const E=O.state.doc.line(x);O.dispatch(O.state.update({changes:{from:E.from,to:E.to,insert:b}}))}}),Y.on(t,{name:WL,callback(){Y.emit(t,kd,O)}}),Y.emit(t,kd,O)}),pe(n,()=>{var O;(O=s.value)==null||O.view.dispatch({effects:l.reconfigure(n.value==="light"?k2:v2)})},{deep:!0}),pe(()=>i.completions,()=>{var O;(O=s.value)==null||O.view.dispatch({effects:u.reconfigure(E2(i.completions))})},{deep:!0}),pe(()=>i.modelValue,()=>{var O,y;((O=s.value)==null?void 0:O.getValue())!==i.modelValue&&((y=s.value)==null||y.setValue(i.modelValue))}),pe(()=>i.placeholder,()=>{var O;(O=s.value)==null||O.setPlaceholder(i.placeholder)}),pe(()=>i.disabled,()=>{var O;(O=s.value)==null||O.setDisabled(i.disabled)}),pe(()=>i.readonly,()=>{var O;(O=s.value)==null||O.setDisabled(i.readonly)}),pe(()=>i.maxlength,()=>{var O;i.maxlength&&((O=s.value)==null||O.setMaxLength(i.maxlength))}),{inputWrapperRef:r,codeMirrorUt:s,resetHistory(){var O,y;(O=s.value)==null||O.view.dispatch({effects:c.reconfigure([])}),(y=s.value)==null||y.view.dispatch({effects:c.reconfigure(sC())})}}},ppe=(i,e,t)=>{const n=De(()=>/px$/.test(`${i.inputBoxWidth}`)?"50%":i.inputBoxWidth),r=di({resizedWidth:n.value}),s=di({width:n.value}),o=di({left:n.value,display:"initial"}),a=c=>{var h,f,d;const p=((h=e.value)==null?void 0:h.offsetWidth)||0,g=((f=e.value)==null?void 0:f.getBoundingClientRect().x)||0;let m=c.x-g;m/p<Sh?m=p*Sh:m>p-p*Sh&&(m=p-p*Sh);const v=`${m/p*100}%`;s.width=v,o.left=v,r.resizedWidth=v,(d=i.oninputBoxWidthChange)==null||d.call(i,v)},l=c=>{c.target===t.value&&document.addEventListener("mousemove",a)},u=()=>{document.removeEventListener("mousemove",a)};return pe([t],()=>{document.removeEventListener("mousedown",l),document.removeEventListener("mouseup",u),document.addEventListener("mousedown",l),document.addEventListener("mouseup",u)}),ft(()=>{document.addEventListener("mousedown",l),document.addEventListener("mouseup",u)}),Rs(()=>{document.removeEventListener("mousedown",l),document.removeEventListener("mouseup",u)}),pe([n],([c])=>{r.resizedWidth=c,s.width=c,o.left=c}),pe([Nn(i.setting,"htmlPreview"),Nn(i.setting,"preview"),Nn(i.setting,"previewOnly")],()=>{i.setting.previewOnly?(s.width="0%",o.display="none"):!i.setting.htmlPreview&&!i.setting.preview?(s.width="100%",o.display="none"):(s.width=r.resizedWidth,o.display="initial")},{immediate:!0}),{inputWrapperStyle:s,resizeOperateStyle:o}},gpe=QL(),mpe=Ze({name:"MDEditorContent",props:Yne,setup(i,e){const t=xe("editorId"),n=ce(""),r=ce(),s=ce(),{inputWrapperRef:o,codeMirrorUt:a,resetHistory:l}=dpe(i),{inputWrapperStyle:u,resizeOperateStyle:c}=ppe(i,r,s);return Pde(i,n,a),e.expose({getSelectedText(){var h;return(h=a.value)==null?void 0:h.getSelectedText()},focus(h){var f;(f=a.value)==null||f.focus(h)},resetHistory:l,getEditorView(){var h;return(h=a.value)==null?void 0:h.view}}),()=>R("div",{class:`${C}-content`},[R("div",{class:`${C}-content-wrapper`,ref:r},[R("div",{class:`${C}-input-wrapper`,style:u,ref:o},null),(i.setting.htmlPreview||i.setting.preview)&&R("div",{class:`${C}-resize-operate`,style:c,ref:s},null),R(CI,{modelValue:i.modelValue,onChange:i.onChange,setting:i.setting,onHtmlChanged:h=>{n.value=h,i.onHtmlChanged(h)},onGetCatalog:i.onGetCatalog,mdHeadingId:i.mdHeadingId,noMermaid:i.noMermaid,sanitize:i.sanitize,noKatex:i.noKatex,formatCopiedText:i.formatCopiedText,noHighlight:i.noHighlight,noImgZoomIn:i.noImgZoomIn,sanitizeMermaid:i.sanitizeMermaid,codeFoldable:i.codeFoldable,autoFoldThreshold:i.autoFoldThreshold,onRemount:i.onRemount},null)]),i.catalogVisible&&R(fu,{theme:i.theme,class:`${C}-catalog-editor ${C}-catalog-${i.catalogLayout}`,editorId:t,mdHeadingId:i.mdHeadingId,key:"internal-catalog",scrollElementOffsetTop:2,syncWith:i.setting.preview?"preview":"editor",onClick:(h,f)=>{var d,p;if(!i.setting.preview&&f.line!==void 0){h.preventDefault();const g=(d=a.value)==null?void 0:d.view;if(g){const m=g.state.doc.line(f.line+1),v=(p=g.lineBlockAt(m.from))==null?void 0:p.top,O=g.scrollDOM;gpe(O,v)}}}},null)])}}),vpe=Ze({props:{modelValue:{type:String,default:""}},setup(i){const e=xe("usedLanguageText");return()=>{var t,n;return R("div",{class:`${C}-footer-item`},[R("label",{class:`${C}-footer-label`},[`${(t=e.value.footer)==null?void 0:t.markdownTotal}:`]),R("span",null,[((n=i.modelValue)==null?void 0:n.length)||0])])}}}),Ope={checked:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},disabled:{type:Boolean,default:void 0}},ype=Ze({name:`${C}-checkbox`,props:Ope,setup(i){return()=>R("div",{class:[`${C}-checkbox`,i.checked&&`${C}-checkbox-checked`,i.disabled&&`${C}-disabled`],onClick:()=>{i.disabled||i.onChange(!i.checked)}},null)}}),bpe={scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}}},xpe=Ze({props:bpe,setup(i){const e=xe("usedLanguageText"),t=xe("disabled");return()=>{var n;return R("div",{class:[`${C}-footer-item`,(t==null?void 0:t.value)&&`${C}-disabled`]},[R("label",{class:`${C}-footer-label`,onClick:()=>{i.onScrollAutoChange(!i.scrollAuto)}},[(n=e==null?void 0:e.value.footer)==null?void 0:n.scrollAuto]),R(ype,{checked:i.scrollAuto,onChange:i.onScrollAutoChange,disabled:t==null?void 0:t.value},null)])}}}),Spe={modelValue:{type:String,default:""},footers:{type:Array,default:[]},scrollAuto:{type:Boolean},noScrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}},defFooters:{type:Object}},kpe=Ze({name:"MDEditorFooter",props:Spe,setup(i){const e=xe("theme"),t=xe("language"),n=xe("disabled"),r=De(()=>{const o=i.footers.indexOf("="),a=o===-1?i.footers:i.footers.slice(0,o),l=o===-1?[]:i.footers.slice(o,Number.MAX_SAFE_INTEGER);return[a,l]}),s=o=>{var a,l,u,c,h,f;if(VL.includes(o))switch(o){case"markdownTotal":return R(vpe,{modelValue:i.modelValue},null);case"scrollSwitch":return!i.noScrollAuto&&R(xpe,{scrollAuto:i.scrollAuto,onScrollAutoChange:i.onScrollAutoChange},null)}else if(i.defFooters instanceof Array){const d=i.defFooters[o];return d?xu(d,{theme:((a=d.props)==null?void 0:a.theme)||e.value,language:((l=d.props)==null?void 0:l.language)||t.value,disabled:((u=d.props)==null?void 0:u.disabled)||(n==null?void 0:n.value)}):""}else if(i.defFooters&&i.defFooters.children instanceof Array){const d=i.defFooters.children[o];return d?xu(d,{theme:((c=d.props)==null?void 0:c.theme)||e.value,language:((h=d.props)==null?void 0:h.language)||t.value,disabled:((f=d.props)==null?void 0:f.disabled)||(n==null?void 0:n.value)}):""}else return""};return()=>{const o=r.value[0].map(l=>s(l)),a=r.value[1].map(l=>s(l));return R("div",{class:`${C}-footer`},[R("div",{class:`${C}-footer-left`},[o]),R("div",{class:`${C}-footer-right`},[a])])}}}),Uf=Ze({name:"MdEditorV3",props:are,emits:lre,setup(i,e){const{noKatex:t,noMermaid:n,noPrettier:r,noUploadImg:s,noHighlight:o}=i,a=di({scrollAuto:i.scrollAuto}),l=ce(),u=ce(),{editorId:c}=Jne(i,l),[h,f]=ire(i,e,{editorId:c}),d=nre(i,{editorId:c});return Kne(i,e,{editorId:c}),ere(i),tre(i,e,{editorId:c}),rre(i,e,{editorId:c,catalogVisible:d,setting:h,updateSetting:f,codeRef:u}),Rs(()=>{Y.clear(c)}),()=>{const p=pi({props:i,ctx:e},"defToolbars"),g=pi({props:i,ctx:e},"defFooters");return R("div",{id:c,class:[C,i.class,i.theme==="dark"&&`${C}-dark`,h.fullscreen||h.pageFullscreen?`${C}-fullscreen`:""],style:i.style,ref:l},[i.toolbars.length>0&&R(Ade,{noPrettier:r,toolbars:i.toolbars,toolbarsExclude:i.toolbarsExclude,setting:h,updateSetting:f,tableShape:i.tableShape,defToolbars:p,noUploadImg:s,showToolbarName:i.showToolbarName,catalogVisible:d.value,codeTheme:i.codeTheme},null),R(mpe,{ref:u,modelValue:i.modelValue,setting:h,mdHeadingId:i.mdHeadingId,noMermaid:n,noPrettier:r,sanitize:i.sanitize,placeholder:i.placeholder,noKatex:t,scrollAuto:a.scrollAuto,formatCopiedText:i.formatCopiedText,autofocus:i.autoFocus,disabled:i.disabled,readonly:i.readOnly,maxlength:i.maxLength,autoDetectCode:i.autoDetectCode,noHighlight:o,updateModelValue:m=>{e.emit("update:modelValue",m)},onChange:m=>{var v;(v=i.onChange)==null||v.call(i,m),e.emit("onChange",m)},onHtmlChanged:m=>{var v;(v=i.onHtmlChanged)==null||v.call(i,m),e.emit("onHtmlChanged",m)},onGetCatalog:m=>{var v;(v=i.onGetCatalog)==null||v.call(i,m),e.emit("onGetCatalog",m)},onBlur:m=>{var v;(v=i.onBlur)==null||v.call(i,m),e.emit("onBlur",m)},onFocus:m=>{var v;(v=i.onFocus)==null||v.call(i,m),e.emit("onFocus",m)},onInput:m=>{var v;(v=i.onInput)==null||v.call(i,m),e.emit("onInput",m)},completions:i.completions,catalogVisible:d.value,theme:i.theme,noImgZoomIn:i.noImgZoomIn,onDrop:m=>{var v;(v=i.onDrop)==null||v.call(i,m),e.emit("onDrop",m)},inputBoxWidth:i.inputBoxWidth,oninputBoxWidthChange:m=>{var v;(v=i.oninputBoxWidthChange)==null||v.call(i,m),e.emit("oninputBoxWidthChange",m)},sanitizeMermaid:i.sanitizeMermaid,transformImgUrl:i.transformImgUrl,codeFoldable:i.codeFoldable,autoFoldThreshold:i.autoFoldThreshold,onRemount:()=>{var m;(m=i.onRemount)==null||m.call(i),e.emit("onRemount")},catalogLayout:i.catalogLayout},null),i.footers.length>0&&R(kpe,{modelValue:i.modelValue,footers:i.footers,defFooters:g,noScrollAuto:!h.preview&&!h.htmlPreview||h.previewOnly,scrollAuto:a.scrollAuto,onScrollAutoChange:m=>a.scrollAuto=m},null)])}}});Uf.install=i=>(i.component(Uf.name,Uf),i.use(Qf).use(bf).use(Bf).use(fu).use(_f),i);const Tpe={onClick:{type:Function,default:void 0},language:{type:String,default:void 0},theme:{type:String,default:void 0},disabled:{type:Boolean,default:void 0}},Rm=Ze({name:"NormalFooterToolbar",props:Tpe,emits:["onClick"],setup(i,e){return()=>{const t=pi({props:i,ctx:e});return R("div",{class:[`${C}-footer-item`,i.disabled&&`${C}-disabled`],onClick:n=>{var r;i.disabled||((r=i.onClick)==null||r.call(i,n),e.emit("onClick",n))}},[t])}}});Rm.install=i=>(i.component(Rm.name,Rm),i);var w2={exports:{}},mt={},jO={exports:{}},Co={};function U6(){var i={};return i["align-content"]=!1,i["align-items"]=!1,i["align-self"]=!1,i["alignment-adjust"]=!1,i["alignment-baseline"]=!1,i.all=!1,i["anchor-point"]=!1,i.animation=!1,i["animation-delay"]=!1,i["animation-direction"]=!1,i["animation-duration"]=!1,i["animation-fill-mode"]=!1,i["animation-iteration-count"]=!1,i["animation-name"]=!1,i["animation-play-state"]=!1,i["animation-timing-function"]=!1,i.azimuth=!1,i["backface-visibility"]=!1,i.background=!0,i["background-attachment"]=!0,i["background-clip"]=!0,i["background-color"]=!0,i["background-image"]=!0,i["background-origin"]=!0,i["background-position"]=!0,i["background-repeat"]=!0,i["background-size"]=!0,i["baseline-shift"]=!1,i.binding=!1,i.bleed=!1,i["bookmark-label"]=!1,i["bookmark-level"]=!1,i["bookmark-state"]=!1,i.border=!0,i["border-bottom"]=!0,i["border-bottom-color"]=!0,i["border-bottom-left-radius"]=!0,i["border-bottom-right-radius"]=!0,i["border-bottom-style"]=!0,i["border-bottom-width"]=!0,i["border-collapse"]=!0,i["border-color"]=!0,i["border-image"]=!0,i["border-image-outset"]=!0,i["border-image-repeat"]=!0,i["border-image-slice"]=!0,i["border-image-source"]=!0,i["border-image-width"]=!0,i["border-left"]=!0,i["border-left-color"]=!0,i["border-left-style"]=!0,i["border-left-width"]=!0,i["border-radius"]=!0,i["border-right"]=!0,i["border-right-color"]=!0,i["border-right-style"]=!0,i["border-right-width"]=!0,i["border-spacing"]=!0,i["border-style"]=!0,i["border-top"]=!0,i["border-top-color"]=!0,i["border-top-left-radius"]=!0,i["border-top-right-radius"]=!0,i["border-top-style"]=!0,i["border-top-width"]=!0,i["border-width"]=!0,i.bottom=!1,i["box-decoration-break"]=!0,i["box-shadow"]=!0,i["box-sizing"]=!0,i["box-snap"]=!0,i["box-suppress"]=!0,i["break-after"]=!0,i["break-before"]=!0,i["break-inside"]=!0,i["caption-side"]=!1,i.chains=!1,i.clear=!0,i.clip=!1,i["clip-path"]=!1,i["clip-rule"]=!1,i.color=!0,i["color-interpolation-filters"]=!0,i["column-count"]=!1,i["column-fill"]=!1,i["column-gap"]=!1,i["column-rule"]=!1,i["column-rule-color"]=!1,i["column-rule-style"]=!1,i["column-rule-width"]=!1,i["column-span"]=!1,i["column-width"]=!1,i.columns=!1,i.contain=!1,i.content=!1,i["counter-increment"]=!1,i["counter-reset"]=!1,i["counter-set"]=!1,i.crop=!1,i.cue=!1,i["cue-after"]=!1,i["cue-before"]=!1,i.cursor=!1,i.direction=!1,i.display=!0,i["display-inside"]=!0,i["display-list"]=!0,i["display-outside"]=!0,i["dominant-baseline"]=!1,i.elevation=!1,i["empty-cells"]=!1,i.filter=!1,i.flex=!1,i["flex-basis"]=!1,i["flex-direction"]=!1,i["flex-flow"]=!1,i["flex-grow"]=!1,i["flex-shrink"]=!1,i["flex-wrap"]=!1,i.float=!1,i["float-offset"]=!1,i["flood-color"]=!1,i["flood-opacity"]=!1,i["flow-from"]=!1,i["flow-into"]=!1,i.font=!0,i["font-family"]=!0,i["font-feature-settings"]=!0,i["font-kerning"]=!0,i["font-language-override"]=!0,i["font-size"]=!0,i["font-size-adjust"]=!0,i["font-stretch"]=!0,i["font-style"]=!0,i["font-synthesis"]=!0,i["font-variant"]=!0,i["font-variant-alternates"]=!0,i["font-variant-caps"]=!0,i["font-variant-east-asian"]=!0,i["font-variant-ligatures"]=!0,i["font-variant-numeric"]=!0,i["font-variant-position"]=!0,i["font-weight"]=!0,i.grid=!1,i["grid-area"]=!1,i["grid-auto-columns"]=!1,i["grid-auto-flow"]=!1,i["grid-auto-rows"]=!1,i["grid-column"]=!1,i["grid-column-end"]=!1,i["grid-column-start"]=!1,i["grid-row"]=!1,i["grid-row-end"]=!1,i["grid-row-start"]=!1,i["grid-template"]=!1,i["grid-template-areas"]=!1,i["grid-template-columns"]=!1,i["grid-template-rows"]=!1,i["hanging-punctuation"]=!1,i.height=!0,i.hyphens=!1,i.icon=!1,i["image-orientation"]=!1,i["image-resolution"]=!1,i["ime-mode"]=!1,i["initial-letters"]=!1,i["inline-box-align"]=!1,i["justify-content"]=!1,i["justify-items"]=!1,i["justify-self"]=!1,i.left=!1,i["letter-spacing"]=!0,i["lighting-color"]=!0,i["line-box-contain"]=!1,i["line-break"]=!1,i["line-grid"]=!1,i["line-height"]=!1,i["line-snap"]=!1,i["line-stacking"]=!1,i["line-stacking-ruby"]=!1,i["line-stacking-shift"]=!1,i["line-stacking-strategy"]=!1,i["list-style"]=!0,i["list-style-image"]=!0,i["list-style-position"]=!0,i["list-style-type"]=!0,i.margin=!0,i["margin-bottom"]=!0,i["margin-left"]=!0,i["margin-right"]=!0,i["margin-top"]=!0,i["marker-offset"]=!1,i["marker-side"]=!1,i.marks=!1,i.mask=!1,i["mask-box"]=!1,i["mask-box-outset"]=!1,i["mask-box-repeat"]=!1,i["mask-box-slice"]=!1,i["mask-box-source"]=!1,i["mask-box-width"]=!1,i["mask-clip"]=!1,i["mask-image"]=!1,i["mask-origin"]=!1,i["mask-position"]=!1,i["mask-repeat"]=!1,i["mask-size"]=!1,i["mask-source-type"]=!1,i["mask-type"]=!1,i["max-height"]=!0,i["max-lines"]=!1,i["max-width"]=!0,i["min-height"]=!0,i["min-width"]=!0,i["move-to"]=!1,i["nav-down"]=!1,i["nav-index"]=!1,i["nav-left"]=!1,i["nav-right"]=!1,i["nav-up"]=!1,i["object-fit"]=!1,i["object-position"]=!1,i.opacity=!1,i.order=!1,i.orphans=!1,i.outline=!1,i["outline-color"]=!1,i["outline-offset"]=!1,i["outline-style"]=!1,i["outline-width"]=!1,i.overflow=!1,i["overflow-wrap"]=!1,i["overflow-x"]=!1,i["overflow-y"]=!1,i.padding=!0,i["padding-bottom"]=!0,i["padding-left"]=!0,i["padding-right"]=!0,i["padding-top"]=!0,i.page=!1,i["page-break-after"]=!1,i["page-break-before"]=!1,i["page-break-inside"]=!1,i["page-policy"]=!1,i.pause=!1,i["pause-after"]=!1,i["pause-before"]=!1,i.perspective=!1,i["perspective-origin"]=!1,i.pitch=!1,i["pitch-range"]=!1,i["play-during"]=!1,i.position=!1,i["presentation-level"]=!1,i.quotes=!1,i["region-fragment"]=!1,i.resize=!1,i.rest=!1,i["rest-after"]=!1,i["rest-before"]=!1,i.richness=!1,i.right=!1,i.rotation=!1,i["rotation-point"]=!1,i["ruby-align"]=!1,i["ruby-merge"]=!1,i["ruby-position"]=!1,i["shape-image-threshold"]=!1,i["shape-outside"]=!1,i["shape-margin"]=!1,i.size=!1,i.speak=!1,i["speak-as"]=!1,i["speak-header"]=!1,i["speak-numeral"]=!1,i["speak-punctuation"]=!1,i["speech-rate"]=!1,i.stress=!1,i["string-set"]=!1,i["tab-size"]=!1,i["table-layout"]=!1,i["text-align"]=!0,i["text-align-last"]=!0,i["text-combine-upright"]=!0,i["text-decoration"]=!0,i["text-decoration-color"]=!0,i["text-decoration-line"]=!0,i["text-decoration-skip"]=!0,i["text-decoration-style"]=!0,i["text-emphasis"]=!0,i["text-emphasis-color"]=!0,i["text-emphasis-position"]=!0,i["text-emphasis-style"]=!0,i["text-height"]=!0,i["text-indent"]=!0,i["text-justify"]=!0,i["text-orientation"]=!0,i["text-overflow"]=!0,i["text-shadow"]=!0,i["text-space-collapse"]=!0,i["text-transform"]=!0,i["text-underline-position"]=!0,i["text-wrap"]=!0,i.top=!1,i.transform=!1,i["transform-origin"]=!1,i["transform-style"]=!1,i.transition=!1,i["transition-delay"]=!1,i["transition-duration"]=!1,i["transition-property"]=!1,i["transition-timing-function"]=!1,i["unicode-bidi"]=!1,i["vertical-align"]=!1,i.visibility=!1,i["voice-balance"]=!1,i["voice-duration"]=!1,i["voice-family"]=!1,i["voice-pitch"]=!1,i["voice-range"]=!1,i["voice-rate"]=!1,i["voice-stress"]=!1,i["voice-volume"]=!1,i.volume=!1,i["white-space"]=!1,i.widows=!1,i.width=!0,i["will-change"]=!1,i["word-break"]=!0,i["word-spacing"]=!0,i["word-wrap"]=!0,i["wrap-flow"]=!1,i["wrap-through"]=!1,i["writing-mode"]=!1,i["z-index"]=!1,i}function Epe(i,e,t){}function wpe(i,e,t){}var _pe=/javascript\s*\:/img;function Cpe(i,e){return _pe.test(e)?"":e}Co.whiteList=U6();Co.getDefaultWhiteList=U6;Co.onAttr=Epe;Co.onIgnoreAttr=wpe;Co.safeAttrValue=Cpe;var Ape={indexOf:function(i,e){var t,n;if(Array.prototype.indexOf)return i.indexOf(e);for(t=0,n=i.length;t<n;t++)if(i[t]===e)return t;return-1},forEach:function(i,e,t){var n,r;if(Array.prototype.forEach)return i.forEach(e,t);for(n=0,r=i.length;n<r;n++)e.call(t,i[n],n,i)},trim:function(i){return String.prototype.trim?i.trim():i.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(i){return String.prototype.trimRight?i.trimRight():i.replace(/(\s*$)/g,"")}},Ul=Ape;function Ppe(i,e){i=Ul.trimRight(i),i[i.length-1]!==";"&&(i+=";");var t=i.length,n=!1,r=0,s=0,o="";function a(){if(!n){var c=Ul.trim(i.slice(r,s)),h=c.indexOf(":");if(h!==-1){var f=Ul.trim(c.slice(0,h)),d=Ul.trim(c.slice(h+1));if(f){var p=e(r,o.length,f,d,c);p&&(o+=p+"; ")}}}r=s+1}for(;s<t;s++){var l=i[s];if(l==="/"&&i[s+1]==="*"){var u=i.indexOf("*/",s+2);if(u===-1)break;s=u+1,r=s+1,n=!1}else l==="("?n=!0:l===")"?n=!1:l===";"?n||a():l===`
`&&a()}return Ul.trim(o)}var Rpe=Ppe,Kh=Co,Lpe=Rpe;function _2(i){return i==null}function Ipe(i){var e={};for(var t in i)e[t]=i[t];return e}function V6(i){i=Ipe(i||{}),i.whiteList=i.whiteList||Kh.whiteList,i.onAttr=i.onAttr||Kh.onAttr,i.onIgnoreAttr=i.onIgnoreAttr||Kh.onIgnoreAttr,i.safeAttrValue=i.safeAttrValue||Kh.safeAttrValue,this.options=i}V6.prototype.process=function(i){if(i=i||"",i=i.toString(),!i)return"";var e=this,t=e.options,n=t.whiteList,r=t.onAttr,s=t.onIgnoreAttr,o=t.safeAttrValue,a=Lpe(i,function(l,u,c,h,f){var d=n[c],p=!1;if(d===!0?p=d:typeof d=="function"?p=d(h):d instanceof RegExp&&(p=d.test(h)),p!==!0&&(p=!1),h=o(c,h),!!h){var g={position:u,sourcePosition:l,source:f,isWhite:p};if(p){var m=r(c,h,g);return _2(m)?c+":"+h:m}else{var m=s(c,h,g);if(!_2(m))return m}}});return a};var Dpe=V6;(function(i,e){var t=Co,n=Dpe;function r(o,a){var l=new n(a);return l.process(o)}e=i.exports=r,e.FilterCSS=n;for(var s in t)e[s]=t[s];typeof window<"u"&&(window.filterCSS=i.exports)})(jO,jO.exports);var $b=jO.exports,Mb={indexOf:function(i,e){var t,n;if(Array.prototype.indexOf)return i.indexOf(e);for(t=0,n=i.length;t<n;t++)if(i[t]===e)return t;return-1},forEach:function(i,e,t){var n,r;if(Array.prototype.forEach)return i.forEach(e,t);for(n=0,r=i.length;n<r;n++)e.call(t,i[n],n,i)},trim:function(i){return String.prototype.trim?i.trim():i.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(i){var e=/\s|\n|\t/,t=e.exec(i);return t?t.index:-1}},$pe=$b.FilterCSS,Mpe=$b.getDefaultWhiteList,rp=Mb;function Z6(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var j6=new $pe;function Fpe(i,e,t){}function Npe(i,e,t){}function Qpe(i,e,t){}function Bpe(i,e,t){}function G6(i){return i.replace(Vpe,"&lt;").replace(Zpe,"&gt;")}function Upe(i,e,t,n){if(t=Y6(t),e==="href"||e==="src"){if(t=rp.trim(t),t==="#")return"#";if(!(t.substr(0,7)==="http://"||t.substr(0,8)==="https://"||t.substr(0,7)==="mailto:"||t.substr(0,4)==="tel:"||t.substr(0,11)==="data:image/"||t.substr(0,6)==="ftp://"||t.substr(0,2)==="./"||t.substr(0,3)==="../"||t[0]==="#"||t[0]==="/"))return""}else if(e==="background"){if(Jh.lastIndex=0,Jh.test(t))return""}else if(e==="style"){if(C2.lastIndex=0,C2.test(t)||(A2.lastIndex=0,A2.test(t)&&(Jh.lastIndex=0,Jh.test(t))))return"";n!==!1&&(n=n||j6,t=n.process(t))}return t=K6(t),t}var Vpe=/</g,Zpe=/>/g,jpe=/"/g,Gpe=/&quot;/g,Hpe=/&#([a-zA-Z0-9]*);?/gim,Xpe=/&colon;?/gim,zpe=/&newline;?/gim,Jh=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,C2=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,A2=/u\s*r\s*l\s*\(.*/gi;function H6(i){return i.replace(jpe,"&quot;")}function X6(i){return i.replace(Gpe,'"')}function z6(i){return i.replace(Hpe,function(t,n){return n[0]==="x"||n[0]==="X"?String.fromCharCode(parseInt(n.substr(1),16)):String.fromCharCode(parseInt(n,10))})}function W6(i){return i.replace(Xpe,":").replace(zpe," ")}function q6(i){for(var e="",t=0,n=i.length;t<n;t++)e+=i.charCodeAt(t)<32?" ":i.charAt(t);return rp.trim(e)}function Y6(i){return i=X6(i),i=z6(i),i=W6(i),i=q6(i),i}function K6(i){return i=H6(i),i=G6(i),i}function Wpe(){return""}function qpe(i,e){typeof e!="function"&&(e=function(){});var t=!Array.isArray(i);function n(o){return t?!0:rp.indexOf(i,o)!==-1}var r=[],s=!1;return{onIgnoreTag:function(o,a,l){if(n(o))if(l.isClosing){var u="[/removed]",c=l.position+u.length;return r.push([s!==!1?s:l.position,c]),s=!1,u}else return s||(s=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return rp.forEach(r,function(u){a+=o.slice(l,u[0]),l=u[1]}),a+=o.slice(l),a}}}function Ype(i){for(var e="",t=0;t<i.length;){var n=i.indexOf("<!--",t);if(n===-1){e+=i.slice(t);break}e+=i.slice(t,n);var r=i.indexOf("-->",n);if(r===-1)break;t=r+3}return e}function Kpe(i){var e=i.split("");return e=e.filter(function(t){var n=t.charCodeAt(0);return n===127?!1:n<=31?n===10||n===13:!0}),e.join("")}mt.whiteList=Z6();mt.getDefaultWhiteList=Z6;mt.onTag=Fpe;mt.onIgnoreTag=Npe;mt.onTagAttr=Qpe;mt.onIgnoreTagAttr=Bpe;mt.safeAttrValue=Upe;mt.escapeHtml=G6;mt.escapeQuote=H6;mt.unescapeQuote=X6;mt.escapeHtmlEntities=z6;mt.escapeDangerHtml5Entities=W6;mt.clearNonPrintableCharacter=q6;mt.friendlyAttrValue=Y6;mt.escapeAttrValue=K6;mt.onIgnoreTagStripAll=Wpe;mt.StripTagBody=qpe;mt.stripCommentTag=Ype;mt.stripBlankChar=Kpe;mt.attributeWrapSign='"';mt.cssFilter=j6;mt.getDefaultCSSWhiteList=Mpe;var Zp={},ls=Mb;function Jpe(i){var e=ls.spaceIndex(i),t;return e===-1?t=i.slice(1,-1):t=i.slice(1,e+1),t=ls.trim(t).toLowerCase(),t.slice(0,1)==="/"&&(t=t.slice(1)),t.slice(-1)==="/"&&(t=t.slice(0,-1)),t}function ege(i){return i.slice(0,2)==="</"}function tge(i,e,t){var n="",r=0,s=!1,o=!1,a=0,l=i.length,u="",c="";e:for(a=0;a<l;a++){var h=i.charAt(a);if(s===!1){if(h==="<"){s=a;continue}}else if(o===!1){if(h==="<"){n+=t(i.slice(r,a)),s=a,r=a;continue}if(h===">"||a===l-1){n+=t(i.slice(r,s)),c=i.slice(s,a+1),u=Jpe(c),n+=e(s,n.length,u,c,ege(c)),r=a+1,s=!1;continue}if(h==='"'||h==="'")for(var f=1,d=i.charAt(a-f);d.trim()===""||d==="=";){if(d==="="){o=h;continue e}d=i.charAt(a-++f)}}else if(h===o){o=!1;continue}}return r<l&&(n+=t(i.substr(r))),n}var ige=/[^a-zA-Z0-9\\_:.-]/gim;function nge(i,e){var t=0,n=0,r=[],s=!1,o=i.length;function a(f,d){if(f=ls.trim(f),f=f.replace(ige,"").toLowerCase(),!(f.length<1)){var p=e(f,d||"");p&&r.push(p)}}for(var l=0;l<o;l++){var u=i.charAt(l),c,h;if(s===!1&&u==="="){s=i.slice(t,l),t=l+1,n=i.charAt(t)==='"'||i.charAt(t)==="'"?t:sge(i,l+1);continue}if(s!==!1&&l===n){if(h=i.indexOf(u,l+1),h===-1)break;c=ls.trim(i.slice(n+1,h)),a(s,c),s=!1,l=h,t=l+1;continue}if(/\s|\n|\t/.test(u))if(i=i.replace(/\s|\n|\t/g," "),s===!1)if(h=rge(i,l),h===-1){c=ls.trim(i.slice(t,l)),a(c),s=!1,t=l+1;continue}else{l=h-1;continue}else if(h=oge(i,l-1),h===-1){c=ls.trim(i.slice(t,l)),c=P2(c),a(s,c),s=!1,t=l+1;continue}else continue}return t<i.length&&(s===!1?a(i.slice(t)):a(s,P2(ls.trim(i.slice(t))))),ls.trim(r.join(" "))}function rge(i,e){for(;e<i.length;e++){var t=i[e];if(t!==" ")return t==="="?e:-1}}function sge(i,e){for(;e<i.length;e++){var t=i[e];if(t!==" ")return t==="'"||t==='"'?e:-1}}function oge(i,e){for(;e>0;e--){var t=i[e];if(t!==" ")return t==="="?e:-1}}function age(i){return i[0]==='"'&&i[i.length-1]==='"'||i[0]==="'"&&i[i.length-1]==="'"}function P2(i){return age(i)?i.substr(1,i.length-2):i}Zp.parseTag=tge;Zp.parseAttr=nge;var lge=$b.FilterCSS,Ji=mt,J6=Zp,uge=J6.parseTag,cge=J6.parseAttr,Vf=Mb;function ef(i){return i==null}function hge(i){var e=Vf.spaceIndex(i);if(e===-1)return{html:"",closing:i[i.length-2]==="/"};i=Vf.trim(i.slice(e+1,-1));var t=i[i.length-1]==="/";return t&&(i=Vf.trim(i.slice(0,-1))),{html:i,closing:t}}function fge(i){var e={};for(var t in i)e[t]=i[t];return e}function dge(i){var e={};for(var t in i)Array.isArray(i[t])?e[t.toLowerCase()]=i[t].map(function(n){return n.toLowerCase()}):e[t.toLowerCase()]=i[t];return e}function e5(i){i=fge(i||{}),i.stripIgnoreTag&&(i.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),i.onIgnoreTag=Ji.onIgnoreTagStripAll),i.whiteList||i.allowList?i.whiteList=dge(i.whiteList||i.allowList):i.whiteList=Ji.whiteList,this.attributeWrapSign=i.singleQuotedAttributeValue===!0?"'":Ji.attributeWrapSign,i.onTag=i.onTag||Ji.onTag,i.onTagAttr=i.onTagAttr||Ji.onTagAttr,i.onIgnoreTag=i.onIgnoreTag||Ji.onIgnoreTag,i.onIgnoreTagAttr=i.onIgnoreTagAttr||Ji.onIgnoreTagAttr,i.safeAttrValue=i.safeAttrValue||Ji.safeAttrValue,i.escapeHtml=i.escapeHtml||Ji.escapeHtml,this.options=i,i.css===!1?this.cssFilter=!1:(i.css=i.css||{},this.cssFilter=new lge(i.css))}e5.prototype.process=function(i){if(i=i||"",i=i.toString(),!i)return"";var e=this,t=e.options,n=t.whiteList,r=t.onTag,s=t.onIgnoreTag,o=t.onTagAttr,a=t.onIgnoreTagAttr,l=t.safeAttrValue,u=t.escapeHtml,c=e.attributeWrapSign,h=e.cssFilter;t.stripBlankChar&&(i=Ji.stripBlankChar(i)),t.allowCommentTag||(i=Ji.stripCommentTag(i));var f=!1;t.stripIgnoreTagBody&&(f=Ji.StripTagBody(t.stripIgnoreTagBody,s),s=f.onIgnoreTag);var d=uge(i,function(p,g,m,v,O){var y={sourcePosition:p,position:g,isClosing:O,isWhite:Object.prototype.hasOwnProperty.call(n,m)},x=r(m,v,y);if(!ef(x))return x;if(y.isWhite){if(y.isClosing)return"</"+m+">";var b=hge(v),E=n[m],T=cge(b.html,function(_,D){var A=Vf.indexOf(E,_)!==-1,I=o(m,_,D,A);return ef(I)?A?(D=l(m,_,D,h),D?_+"="+c+D+c:_):(I=a(m,_,D,A),ef(I)?void 0:I):I});return v="<"+m,T&&(v+=" "+T),b.closing&&(v+=" /"),v+=">",v}else return x=s(m,v,y),ef(x)?u(v):x},u);return f&&(d=f.remove(d)),d};var pge=e5;(function(i,e){var t=mt,n=Zp,r=pge;function s(a,l){var u=new r(l);return u.process(a)}e=i.exports=s,e.filterXSS=s,e.FilterXSS=r,function(){for(var a in t)e[a]=t[a];for(var l in n)e[l]=n[l]}(),typeof window<"u"&&(window.filterXSS=i.exports);function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=i.exports)})(w2,w2.exports);const gge={class:"h-full w-full"},tf=Ze({__name:"code-viewer",setup(i){const{file:e,data:t}=mi(Or()),{isDark:n}=mi($2()),r=ce(""),s=ce("vs"),o=ce("python");pe(n,d=>{d&&s.value==="vs"?s.value="vs-dark":d||(s.value="vs")}),tl(async()=>{var p;if(!t.value)return;const d=await t.value.text();d&&(r.value=d,o.value=u(((p=e.value)==null?void 0:p.name)??""))});const a=De(()=>({colorDecorators:!0,readOnly:!0,theme:s.value})),l=["c","cpp","csharp","go","html","java","javascript","json","jsx","kotlin","markdown","ruby","rust","python","swift","tsx","txt","typescript","xml","yaml"];function u(d){var m;const p={c:"c",cpp:"cpp",cs:"csharp",go:"go",html:"html",java:"java",js:"javascript",json:"json",kt:"kotlin",md:"markdown",rb:"ruby",rs:"rust",py:"python",swift:"swift",ts:"typescript",yaml:"yaml",yml:"yaml",xml:"xml",vue:"typescript",jsx:"javascript",tsx:"typescript"},g=(m=d.split(".").pop())==null?void 0:m.toLowerCase();return g&&p[g]?p[g]:"txt"}const c=De(()=>{var d;return((d=e.value)==null?void 0:d.mediaType)==="md"}),h=ce("monaco"),f=De(()=>s.value==="vs"?"light":"dark");return(d,p)=>{const g=S5,m=k5,v=T5,O=E5,y=w5,x=_5;return Ei(),$r("div",gge,[R(x,{class:"h-[6%] ml-6 pt-1",wrap:""},{default:ti(()=>[R(v,{label:""},{default:ti(()=>[R(m,{"model-value":ze(s),"onUpdate:modelValue":p[0]||(p[0]=b=>Nc(s)?s.value=b:null),style:{width:"120px"}},{default:ti(()=>[R(g,null,{default:ti(()=>p[4]||(p[4]=[tr("vs")])),_:1}),R(g,null,{default:ti(()=>p[5]||(p[5]=[tr("vs-dark")])),_:1}),R(g,null,{default:ti(()=>p[6]||(p[6]=[tr("hc-black")])),_:1})]),_:1},8,["model-value"])]),_:1}),p[9]||(p[9]=tr("  ")),R(v,{label:""},{default:ti(()=>[R(m,{"model-value":ze(o),"onUpdate:modelValue":p[1]||(p[1]=b=>Nc(o)?o.value=b:null),style:{width:"120px"}},{default:ti(()=>[(Ei(),$r(bo,null,N2(l,b=>R(g,{key:b,value:b},{default:ti(()=>[tr(y5(b),1)]),_:2},1032,["value"])),64))]),_:1},8,["model-value"])]),_:1}),p[10]||(p[10]=tr("  ")),ze(c)?(Ei(),tc(v,{key:0,label:""},{default:ti(()=>[R(y,{type:"button","model-value":ze(h),"onUpdate:modelValue":p[2]||(p[2]=b=>Nc(h)?h.value=b:null)},{default:ti(()=>[R(O,{value:"monaco"},{default:ti(()=>p[7]||(p[7]=[tr("monaco")])),_:1}),R(O,{value:"md-viewer"},{default:ti(()=>p[8]||(p[8]=[tr("md-viewer")])),_:1})]),_:1},8,["model-value"])]),_:1})):Q2("",!0)]),_:1}),Rx(R(ze(Uf),{"model-value":ze(r),"read-only":"",toolbars:["catalog","previewOnly","preview","fullscreen"],theme:ze(f),class:"h-[94%]"},null,8,["model-value","theme"]),[[Lx,ze(c)&&ze(h)==="md-viewer"]]),Rx(R(ze(VJ),{value:ze(r),"onUpdate:value":p[3]||(p[3]=b=>Nc(r)?r.value=b:null),options:ze(a),language:ze(o),class:"max-h-[94%]"},null,8,["value","options","language"]),[[Lx,!(ze(c)&&ze(h)==="md-viewer")]])])}}}),mge={class:"flex flex-col justify-center items-center"},vge={key:0,class:"mt-3"},R2=Ze({__name:"unknown-viewer",setup(i){const{file:e}=mi(Or()),{getData:t}=Or(),n=["zip"],r=De(()=>{var o;return!n.includes(((o=e.value)==null?void 0:o.mediaType)??"unknown")}),s=async()=>{e.value.mediaType="text",await t()};return(o,a)=>{const l=b5("icon-exclamation-circle-fill"),u=C5,c=A5;return Ei(),$r("div",mge,[R(u,null,{image:ti(()=>[R(l)]),default:ti(()=>[a[0]||(a[0]=tr("  "))]),_:1}),ze(r)?(Ei(),$r("div",vge,[R(c,{type:"primary",onClick:s},{default:ti(()=>a[1]||(a[1]=[tr("")])),_:1})])):Q2("",!0)])}}}),sp=il("baseFileStore",()=>{const{userInfo:i}=mi(Lm()),{updateUserInfo:e}=Lm(),{breadcrumbs:t,switchTo:n,replaceExcludeFirst:r}=f5(),s=De(()=>t.value[t.value.length-1]),o=ce("block"),a=De(()=>o.value==="tree"),l=De(()=>D5(s.value)>=i.value.maxFolderLevel),u=ce(""),c=ce("change"),h=ce(!1),f=ce({keyword:""});return{breadcrumbs:t,switchTo:n,replaceExcludeFirst:r,currParentFolder:s,isMaxFolderLevel:l,layoutType:o,isTree:a,editingId:u,editNameOp:c,isContextmenuShow:h,baseQuery:f,prepareEditName:(O,y)=>{u.value=O,c.value=y},finishCreateFolder:async({pid:O,name:y,ok:x,fail:b,err:E})=>{try{const T=await r5({pid:O,name:y});T.code===200?(Dt.success(""),x==null||x()):(Dt.error(T.message),b==null||b())}catch{Dt.error(""),E==null||E()}finally{u.value=""}},finishRename:async({id:O,name:y,ok:x,fail:b,err:E})=>{try{const T=await s5({id:O,name:y});T.code===200?(Dt.success(""),x==null||x()):(Dt.error(T.message),b==null||b())}catch{Dt.error(""),E==null||E()}finally{u.value=""}},deleteFiles:async({completely:O,ids:y,ok:x,fail:b,err:E})=>{try{const T=await o5(y,O);T.code===200?(Dt.success(""),x==null||x(),e()):(Dt.error(T.message),b==null||b())}catch{Dt.error(""),E==null||E()}},pasteFiles:async({peers:O,targetId:y,ok:x,fail:b,err:E,op:T,filesNeedMove:_})=>{if(!_.length){Dt.info("//");return}const D=O.map(L=>L.name),A=_.map(L=>L.name);if(new Set([...D,...A]).size!==D.length+A.length){Dt.warning("//");return}const I=T==="copy"?"":"";try{const L=await a5({idList:_.map($=>$.id),targetId:y,op:T});L.code===200?(Dt.success(`${I}`),x==null||x(),_=[],e()):(Dt.error(L.message),b==null||b())}catch{Dt.error(`${I}`),E==null||E()}}}}),Zge=il("fileItemStore",()=>{const i=HO(),{selectedIds:e,contextmenuItem:t,contextmenuType:n,clearSelected:r}=V2(),s=De(()=>m.value.records.filter(L=>e.value.includes(L.id))),{breadcrumbs:o,isContextmenuShow:a,baseQuery:l,isTree:u,isMaxFolderLevel:c}=mi(sp()),{switchTo:h,prepareEditName:f,deleteFiles:d,pasteFiles:p}=sp(),g=ce({category:"all",page:1,pageSize:10,pid:"",orderByUpdateTime:Zl.DEFAULT,orderBySize:Zl.DEFAULT}),m=ce({total:0,parent:{id:"",name:" ",updateTime:"",pid:"",level:"",category:"all",mediaType:"folder",status:GO.NO_NEED,lyricPath:""},records:[],category:"all",page:g.value.page,pageSize:g.value.pageSize,keyword:(l==null?void 0:l.value.keyword)??"",orderByUpdateTime:Zl.DEFAULT,orderBySize:Zl.DEFAULT}),v=De(()=>m.value.records.filter(U2)),O=De(()=>m.value.records.filter(B2));pe(o,L=>g.value.pid=L[L.length-1].id);const y=async L=>{try{const $=await l5({...g.value,...l.value,...L||{}});if($.code===200)return m.value=$.data,h($.data.parent),!0;Dt.error(" "+($.message??""))}catch{Dt.error("")}};pe([()=>g.value.category,()=>g.value.page,()=>g.value.pid,()=>g.value.pageSize,()=>g.value.orderByUpdateTime,()=>g.value.orderBySize],()=>{!u.value&&y()},{immediate:!0}),pe(()=>i.params.category,L=>{r(),L&&(g.value.category=L)}),pe(l,()=>{u.value||y()},{deep:!0});const x=De(()=>s.value.length>1&&s.value.some(L=>{var $;return L.id===(($=t.value)==null?void 0:$.id)})),b=async()=>{if(c.value){Dt.warning("");return}const L={id:M2(m.value.records.map($=>$.id)),name:F2(m.value.records.map($=>$.name)),updateTime:h5(),mediaType:"folder"};f(L.id,"create"),m.value.records.unshift(L)},E=async L=>{const $=x.value?s.value.map(B=>B.id):[t.value.id];d({completely:L,ids:$,ok(){m.value.records=m.value.records.filter(B=>!$.includes(B.id))}})},T=ce("copy"),_=ce([]);return{selectedIds:e,selectedFiles:s,contextmenuItem:t,contextmenuType:n,isContextmenuShow:a,clearSelected:r,query:g,itemList:m,folderList:v,fileList:O,updateFileItem:y,shouldHandleGroup:x,prepareCreateFolder:b,doDelete:E,filesNeedMove:_,prepareCut:L=>{T.value="cut",_.value=L},prepareCopy:L=>{T.value="copy",_.value=L},doPaste:async()=>{p({peers:m.value.records,targetId:m.value.parent.id,ok:()=>{y(),_.value=[]},op:T.value,filesNeedMove:_.value})}}}),jge=il("fileNodeStore",()=>{const{selectedIds:i,contextmenuItem:e,contextmenuType:t}=V2(),{FileIcons:n}=mi($2()),{baseQuery:r,breadcrumbs:s}=mi(sp()),o=De(()=>i.value.map(x=>Px(c.value,x)).filter(x=>x!==null)),{prepareEditName:a,deleteFiles:l,pasteFiles:u}=sp(),{treeDataAllowFile:c,rawLevel:h,selectedIds:f,selectedPaths:d,updateTreeLayerData:p}=n5();function g(x){const b=E=>{const T=[];return E.forEach(_=>{if(_.name.toLowerCase().includes(x.toLowerCase()))T.push({..._});else if(_.children){const D=b(_.children);D.length&&T.push({..._,children:D})}}),T};return b(c.value)}const m=De(()=>r.value.keyword?g(r.value.keyword):c.value);return{treeData:c,rawTreeData:h,treeSelectedIds:f,treeSelectedPaths:d,updateTreeData:p,selectedIds:i,selectedFiles:o,contextmenuItem:e,contextmenuType:t,filteredTreeData:m,prepareCreateFolder:x=>{const b=x??Px(c.value,s.value[s.value.length-1].id)??{children:c.value},E={id:M2(b.children.map(T=>T.id)),name:F2(b.children.map(T=>T.name)),children:[],level:"",status:GO.NO_NEED,category:"all",mediaType:"folder",icon:()=>n.value.folder,disabled:!1,lyricPath:""};a(E.id,"create"),b.children.unshift(E)},doDelete:async(x,b)=>{l({completely:x,ids:b,ok(){u5(h.value,b)}})},doDropCut:(x,b,E)=>{u({peers:x,targetId:b,op:"cut",filesNeedMove:[E],ok:p})}}}),Gge=il("uploadFileStore",()=>{const i=ce([]),e=ce([]);return{uploadFileList:i,uploadedFileUidList:e}}),Hge=il("fileDetailStore",()=>{const i=ce({}),e=ce(!1);return{detail:i,isDetailModalShow:e,openDetailModal:n=>{i.value=n,e.value=!0}}}),Or=il("viewFileStore",()=>{const i=ce(!1),e=ce(null),t=ce(null),n=ce("text"),r=ce(!1),s=HO();let o=new AbortController;const a=()=>{o.abort(),o=new AbortController};pe(i,(f,d)=>{d&&!f&&a()});const l=async()=>{if(e.value&&(I5(e.value)&&e.value.status!==GO.OK&&Dt.warning(""),!["unknown","zip"].includes(e.value.mediaType))){r.value=!0;try{t.value=null;const f=await c5(e.value.id,o,s.params.shareId);t.value=f}catch(f){f.message!=="canceled"&&Dt.error("")}finally{r.value=!1}}},u=async f=>{e.value=f,i.value=!0,await l()},c={video:{component:LK,needFullscreen:!1},audio:{component:uz,needFullscreen:!1},image:{component:FK,needFullscreen:!1},zip:{component:R2,needFullscreen:!0},text:{component:tf,needFullscreen:!0},ppt:{component:XE,needFullscreen:!0},pptx:{component:XE,needFullscreen:!0},pdf:{component:QK,needFullscreen:!0},xlsx:{component:DK,needFullscreen:!0},csv:{component:tf,needFullscreen:!0},doc:{component:zE,needFullscreen:!0},docx:{component:zE,needFullscreen:!0},code:{component:tf,needFullscreen:!0},md:{component:tf,needFullscreen:!0},unknown:{component:R2,needFullscreen:!0}},h=De(()=>{var f;return c[((f=e.value)==null?void 0:f.mediaType)??"unknown"]});return{isModalShow:i,file:e,spinning:r,openPreviewModal:u,data:t,getData:l,mediaType:n,refreshControl:a,currentItem:h}});export{s6 as A,le as B,Z3 as C,G as D,Sn as E,C6 as F,u$ as G,O$ as H,it as I,fn as J,Xa as L,l$ as N,Zl as O,Zge as a,jge as b,Gge as c,Or as d,Hge as e,Rge as f,D5 as g,Pge as h,U2 as i,I5 as j,gl as k,Mf as l,Cc as m,qa as n,Ka as o,Due as p,d3 as q,bt as r,dl as s,w as t,sp as u,Vae as v,Uae as w,m$ as x,ep as y,bi as z};
