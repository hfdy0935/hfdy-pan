/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{g}from"./index-CdIjDISF.js";/* empty css              */import{c as M}from"./calc-CYjR0slx.js";import{d as D,am as V,o as i,a as r,aY as c,aG as d,n as N,ap as o,ao as n,aE as U,a_ as q,b9 as F,ag as E,aV as O,az as z,av as K,by as $,bq as G,aX as f,bz as R,bA as j,bB as A,aS as J,bs as P,aU as X}from"./arco-design-vue-wpZPvk8Z.js";import"./arco-design-vue-icon-S64ufJhU.js";function Y(){return g({url:"/admin/users",method:"GET"})}function H(p){return g({url:"/admin/users",method:"DELETE",params:{id:p}})}function Q(p){return g({url:"/admin/users",method:"PUT",data:p})}const W={key:0,class:"h-14 flex justify-center items-center"},Z={key:1,class:"w-24 text-center"},h={key:3,class:"w-24 text-center"},ee={key:4,class:"w-28 text-center"},te={key:5,class:"flex w-24 justify-evenly items-center"},oe={key:6,class:"w-48 text-center truncate"},ae=D({__name:"table-cell",props:{column:{},record:{},rowIndex:{}},emits:["deleteUser","openModal"],setup(p,{emit:u}){const y=u,I=async()=>{(await H(p.record.id)).code===200&&(U.success("删除成功"),y("deleteUser",p.rowIndex))};return(a,t)=>{const b=V("icon-edit"),x=q,s=V("icon-delete"),e=F;return i(),r("td",null,[a.column.dataIndex==="index"?(i(),r("div",W,c(a.rowIndex+1),1)):a.column.dataIndex==="downloadSpeed"?(i(),r("div",Z,c(d(M)(a.record.downloadSpeed))+"/s ",1)):a.column.dataIndex==="status"?(i(),r("div",{key:2,class:N(["w-24 text-center font-bold",`${a.record.status?"text-[#23C343]":"text-[red]"}`])},c(a.record.status?"正常":"封禁"),3)):a.column.dataIndex==="isVip"?(i(),r("div",h,c(a.record.isVip?"vip用户":"普通用户"),1)):a.column.dataIndex==="usedSpace"?(i(),r("div",ee,c((a.record.usedSpace*100/a.record.totalSpace).toFixed(2))+"% ",1)):a.column.dataIndex==="operation"?(i(),r("div",te,[o(x,{onClick:t[0]||(t[0]=v=>a.$emit("openModal",a.rowIndex)),type:"primary"},{icon:n(()=>[o(b)]),_:1}),o(e,{type:"warning",position:"lt",content:"确定要删除该用户吗？",onOk:I},{default:n(()=>[o(x,{type:"primary",status:"danger"},{icon:n(()=>[o(s)]),_:1})]),_:1})])):(i(),r("div",oe,c(a.record[a.column.dataIndex]),1))])}}}),_e=D({__name:"index",setup(p){const u=E([]);O(async()=>{const s=await Y();s.code===200&&(u.value=s.data)});const y=[{title:"序号",dataIndex:"index",width:60},{title:"昵称",dataIndex:"nickName"},{title:"邮箱",dataIndex:"email"},{title:"注册时间",dataIndex:"registerTime"},{title:"上次登录时间",dataIndex:"lastLoginTime"},{title:"状态",dataIndex:"status"},{title:"已使用空间",dataIndex:"usedSpace"},{title:"用户身份",dataIndex:"isVip"},{title:"上传并发数量限制",dataIndex:"uploadLimit"},{title:"下载速度",dataIndex:"downloadSpeed"},{title:"操作",dataIndex:"operation",fixed:"right"}].map(s=>({...s,align:"center"})),I=E([]),a=s=>{u.value.splice(s,1)},t=z({show:!1,idx:-1,userInfo:{}}),b=s=>{t.idx=s,t.userInfo=JSON.parse(JSON.stringify(u.value[s])),t.userInfo.downloadSpeed=+(t.userInfo.downloadSpeed/1024).toFixed(2),t.show=!0},x=async()=>{const{userInfo:{isVip:s,status:e,uploadLimit:v,downloadSpeed:S,id:m}}=t,_=S*1024;(await Q({isVip:s,status:e,uploadLimit:v,userId:m,downloadSpeed:_})).code===200?(U.success("修改成功"),u.value[t.idx]={...u.value[t.idx],isVip:s,status:e,uploadLimit:v,downloadSpeed:_}):U.error("修改失败")};return(s,e)=>{const v=R,S=$,m=j,_=A,w=J,k=P,L=X,T=G;return i(),r("div",null,[o(S,{columns:d(y),class:"m-3 mt-8",data:d(u),hoverable:"",pagination:!1,selectedKeys:d(I),"onUpdate:selectedKeys":e[0]||(e[0]=l=>K(I)?I.value=l:null)},{td:n(({column:l,record:B,rowIndex:C})=>[o(ae,{column:l,record:B,rowIndex:C,onDeleteUser:a,onOpenModal:b},null,8,["column","record","rowIndex"])]),empty:n(()=>[o(v,{description:"还没有任何文件~"})]),_:1},8,["columns","data","selectedKeys"]),o(T,{title:"修改用户信息",visible:d(t).show,"onUpdate:visible":e[5]||(e[5]=l=>d(t).show=l),closable:!1,onOk:x},{default:n(()=>[o(L,{model:d(t)},{default:n(()=>[o(w,{label:"状态"},{default:n(()=>[o(_,{type:"button","model-value":d(t).userInfo.status,"onUpdate:modelValue":e[1]||(e[1]=l=>d(t).userInfo.status=l)},{default:n(()=>[o(m,{value:0},{default:n(()=>e[6]||(e[6]=[f("封禁")])),_:1}),o(m,{value:1},{default:n(()=>e[7]||(e[7]=[f("正常")])),_:1})]),_:1},8,["model-value"])]),_:1}),o(w,{label:"身份"},{default:n(()=>[o(_,{type:"button","model-value":d(t).userInfo.isVip,"onUpdate:modelValue":e[2]||(e[2]=l=>d(t).userInfo.isVip=l)},{default:n(()=>[o(m,{value:0},{default:n(()=>e[8]||(e[8]=[f("普通用户")])),_:1}),o(m,{value:1},{default:n(()=>e[9]||(e[9]=[f(" vip ")])),_:1})]),_:1},8,["model-value"])]),_:1}),o(w,{label:"上传并发数"},{default:n(()=>[o(k,{min:1,"model-value":d(t).userInfo.uploadLimit,"onUpdate:modelValue":e[3]||(e[3]=l=>d(t).userInfo.uploadLimit=l),style:{width:"240px"}},null,8,["model-value"]),e[10]||(e[10]=f(" 个 "))]),_:1}),o(w,{label:"下载速度"},{default:n(()=>[o(k,{min:1,"model-value":d(t).userInfo.downloadSpeed,"onUpdate:modelValue":e[4]||(e[4]=l=>d(t).userInfo.downloadSpeed=l),style:{width:"240px"}},null,8,["model-value"]),e[11]||(e[11]=f(" KB/s "))]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])}}});export{_e as default};
